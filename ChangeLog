2013-01-04 11:48  xavier

	* [r9805] Missing build dependency.

2013-01-05 13:51  xavier

	* [r9806] Removed useless return statments from the json code.

2013-01-05 13:58  xavier

	* [r9807] More cleaning of the json module.

2013-01-05 14:41  xavier

	* [r9808] The json code is causing problems with the Blue Gene/Q,
	  so I disabled the json output of the geometry. This should not be
	  a problem since this output is not used.

2013-01-06 10:54  xavier

	* [r9809] Removed PUSH_SUB/POP_SUB from a subroutine and declared
	  it pure to avoid recursive I/O.

2013-01-06 11:10  xavier

	* [r9810] Some integer values were initialized using M_ZERO.

2013-01-06 12:11  xavier

	* [r9811] Declared pure and removed PUSH_SUB/POP_SUB from two
	  functions that are called from an I/O statement.

2013-01-06 12:22  xavier

	* [r9812] * More fixes about recursive I/O.
	  * Fixed a FLOAT literal declaration.

2013-01-06 15:00  xavier

	* [r9813] Increased the tolerance for the Fortran derivatives
	  tests, as it appears
	  that this implementation is more compiler dependent that the C
	  version.

2013-01-07 15:19  xavier

	* [r9814] A reduction of size 0 caused a problem on the Blue Gene
	  Q.

2013-01-07 15:58  xavier

	* [r9815] Added a check for size 0 in reductions of dimension 2.

2013-01-07 18:11  xavier

	* [r9816] A fix to my last commit. An optional value was used, even
	  when not present.

2013-01-11 09:44  joseba

	* [r9817] Updated the label of the PFFT plans to be properly
	  printed.

2013-01-14 19:25  dstrubbe

	* [r9818] * Typos.
	  * Putting warning about 1D and 2D ion-ion interaction in variable
	  reference too.

2013-01-14 20:49  dstrubbe

	* [r9819] Added directory names to TestGroups for each test, as
	  suggested by Carlo.

2013-01-14 22:16  dstrubbe

	* [r9820] * Removed 'oct' test group, now superseded by
	  'optimal_control'.
	  * Updated TestGroups file.

2013-01-14 23:56  dstrubbe

	* [r9821] * Error message if no coordinates are given in input.
	  * Clarification to documentation.

2013-01-15 02:51  dstrubbe

	* [r9822] Clarification and separation lines.

2013-01-15 09:27  joseba

	* [r9823] * Added the possibility to disable the execution of the
	  partition, since it is used only with the only purpose of
	  printing information. The importance of this changes comes from
	  the fact that computing this part in big systems with large
	  number of processes takes longer and longer (even hours),
	  consuming almost useless core-hours.
	  * Added the possibility to disable the execution of symmetries
	  calculation
	  * Some line breaks

2013-01-15 12:43  marques

	* [r9824] Let's see if this corrects the bug with B97-like
	  functionals

2013-01-15 12:47  marques

	* [r9825] Added interface as noted by Fabien Tran.

2013-01-15 13:56  marques

	* [r9827] The same kind of bug was also present in TPSS.

2013-01-15 15:03  marques

	* [r9828] And again the same error in vsxc

2013-01-15 19:31  dstrubbe

	* [r9829] Improvements to r9823: 'SymmetriesCompute' disables all
	  symmetry calculations, not just for finite systems, and does
	  leave proper initialization to identity. Also, fixed typo and
	  unnecessarily added variables.

2013-01-16 09:47  marques

	* [r9831] Still another POLARIZED missing in a functional that uses
	  the stoll decomposition.

2013-01-16 13:42  marques

	* [r9832] Added new metagga functionals: X_MS0, X_MS1, X_MS2, and
	  X_MS2H (a hybrid version of MS2)

2013-01-16 20:37  dstrubbe

	* [r9833] Improvements to Poisson solver info, including reference
	  to recent arXiV paper.

2013-01-16 21:12  dstrubbe

	* [r9834] Clarifications to documentation and output regarding
	  Poisson solvers.

2013-01-17 21:26  dstrubbe

	* [r9835] Reducing verbosity of warnings by making only one comment
	  about Lsize or Spacing not matching the recommended value if they
	  were specified as one value rather than separately for each
	  direction in the input file.

2013-01-17 21:49  dstrubbe

	* [r9836] * Small bugfix: condition for warning about Smearing
	  needing ExtraStates was mistaken for spin-polarized calculations.
	  * Message when disabling symmetries for user-defined species now
	  says only that non-spherically symmetric species "may" be
	  present, rather than definitely are present, since we are not
	  actually analyzing that.

2013-01-17 23:19  dstrubbe

	* [r9837] * Corrected misplaced PUSH_SUB.
	  * Warning about no XSF except in 3D now states which function it
	  is talking about.

2013-01-18 00:06  dstrubbe

	* [r9838] * For 2D systems periodic in 2D, the default Poisson FFT
	  kernel was set to be the planar one, but that was not even
	  considered a possibility in later code, leading to an assertion
	  failure and/or nonsensical results. Now the default is fft_nocut,
	  which seems to have been the intention from the rest of the code.
	  * The default for PoissonFFTKernel are enumerated in the
	  documentation.
	  * Removed attempts at HTML formatting in output.

2013-01-18 08:59  marques

	* [r9839] Small bug fixes. Micael can you check if any of the
	  segfaults disapears?

2013-01-18 18:46  dstrubbe

	* [r9841] Removed keyword 'OnlyUserDef' from input files which does
	  not exist, and is presumably obsolete.

2013-01-18 21:52  dstrubbe

	* [r9842] Added tests for total energy components in sodium chain
	  test. I am surprised that we get a negative number for the
	  Hartree energy here.

2013-01-18 21:59  dstrubbe

	* [r9843] Fix of uninitialized use of 'idir' as flagged by
	  valgrind.

2013-01-18 22:08  dstrubbe

	* [r9844] svn:ignore for new file 'test-driver'

2013-01-19 05:37  dstrubbe

	* [r9845] More specific and helpful error messages when an
	  incompatible Poisson solver is chosen.

2013-01-19 05:41  dstrubbe

	* [r9846] Removed variable DELTA_R in favor of M_EPSILON which is
	  our standard tolerance for floating-point comparisons.

2013-01-19 20:25  dstrubbe

	* [r9847] Restored if-condition accidentally removed in r9845,
	  which broke a lot of tests.

2013-01-19 20:55  dstrubbe

	* [r9848] * Direct3D Poisson solver (at least in serial case) was
	  only working for curvilinear coordinates. Now it works for
	  regular grids too.
	  * Added a test for this solver.

2013-01-19 22:15  dstrubbe

	* [r9849] * The serial version of the direct3D Poisson solver was
	  mistakenly using a prefactor copied from the 2D case. Also, the
	  parallel case used two subtly different values for no good
	  reason. Now the same prefactor is always used.
	  * This improves slightly the accuracy of the integration in the
	  test.

2013-01-19 22:40  dstrubbe

	* [r9850] Documenting a secret variable and specifying when it
	  applies.

2013-01-19 23:01  dstrubbe

	* [r9851] Consolidated useless repeated code in select statement.

2013-01-19 23:10  dstrubbe

	* [r9852] Consolidated options for direct-sum Poisson solver into
	  one, rather than separately for each dimension. It is better to
	  select automatically the correct dimensionality than to just
	  complain or give a wrong answer if a different dimensionality was
	  selected.

2013-01-19 23:22  dstrubbe

	* [r9853] Removed useless routine zpoisson1D_solve for complex
	  scaling: it adds unnecessary complexity and computational
	  expense, compared to the approach used for the other solvers.

2013-01-19 23:28  dstrubbe

	* [r9854] Now the direct Poisson solver actually tries to work in
	  curvilinear mode, as claimed by the code elsewhere.

2013-01-19 23:48  dstrubbe

	* [r9855] Updating name in testsuite file.

2013-01-20 00:01  dstrubbe

	* [r9856] * In 3D direct solver, simplified code in parallel branch
	  with volume_element and vol_pp, and in serial branch, removed
	  unstated assumption that the spacing is identical in all
	  directions. (At this point, I think that this solver existing
	  only for "testing" is actually correct...)
	  * Began generalizing to arbitrary number of dimensions.

2013-01-20 00:04  dstrubbe

	* [r9857] Removed explicit reference to 3D and useless variable xg.

2013-01-20 00:12  dstrubbe

	* [r9858] The 2D direct Poisson solver is decommissioned in favor
	  of a general 2D/3D one. This corrects several problems with the
	  2D one which I recently fixed in the 3D one.

2013-01-20 00:35  dstrubbe

	* [r9859] Removing 2D direct solver since the general 2D/3D one is
	  now used.

2013-01-20 00:40  dstrubbe

	* [r9860] Fixing exponent on volume which is 1/3 in 3D but 1/2 in
	  2D. Moving to prefactor when not curvilinear to help performance.

2013-01-20 00:49  dstrubbe

	* [r9861] It is better not to have so many if's in the inner do
	  loop.

2013-01-20 01:04  dstrubbe

	* [r9862] Removed unneeded PoissonSolver lines in input files that
	  have TheoryLevel = independent_particles.

2013-01-20 01:09  dstrubbe

	* [r9863] Fixing syntax errors.

2013-01-20 03:25  dstrubbe

	* [r9864] Allowing compilation with BerkeleyGW and
	  --with-max-dim=4.

2013-01-20 03:30  dstrubbe

	* [r9865] Explicit bounds to avoid an issue with max dim = 4 on
	  lascar. Also, a 3 was accidentally left in one place that would
	  cause trouble for 2D direct sum Poisson.

2013-01-20 03:43  dstrubbe

	* [r9866] intel doesn't seem to like my syntax. Bringing back the
	  temporary variable 'xg'.

2013-01-20 04:27  dstrubbe

	* [r9867] * Documenting secret variable PoissonCutoffRadius. I am
	  not sure why you would wish to adjust this though.
	  * Some combinations of dimensionality did not parse the variable
	  or write output, now they all do the same thing.
	  * The default, and condition for warning, should be based only on
	  finite directions, not on periodic directions -- in the case that
	  a periodic direction was larger than a finite direction (unusual
	  but certainly possible), I think you would get the wrong answer.

2013-01-21 10:11  marques

	* [r9868] No more NaNs in optc ;)

2013-01-21 10:23  marques

	* [r9869] No more NaN in gga_c_wl

2013-01-21 12:29  marques

	* [r9870] This fixes the NaNs that were appearing on the HJS_B88
	  functional

2013-01-21 12:34  marques

	* [r9871] Fixed NaNs in the TPSS and PKZB

2013-01-21 14:40  micael

	* [r9872] * Some NaN were still appearing.

2013-01-21 16:37  micael

	* [r9874] * Tagging Libxc version 2.0.1.

2013-01-22 12:25  marques

	* [r9875] Added interfaces to get/set hybrid and cam parameters

2013-01-22 13:15  marques

	* [r9876] Added the variant PBE (vPBE) functional. From my tests
	  this is virtually identical to the PBE.

2013-01-22 13:20  marques

	* [r9877] Reset of the testsuite after all the bug corrections

2013-01-22 13:28  mjv500

	* [r9878] bug in normalization of propag spectrum, for non kick
	  case - this has been patched before...

2013-01-22 13:40  marques

	* [r9879] Added revisedTPSS correlation

2013-01-23 09:23  marques

	* [r9880] Corrected reference. Thanks David.

2013-01-23 09:52  marques

	* [r9881] Removed interface to _set_cam and _set_exx.
	  Added interface to set mixing of both pbe0 and hse

2013-01-23 11:52  marques

	* [r9882] Changed the name of a variable and a comment. Thanks
	  Fabien.

2013-01-24 10:39  joseba

	* [r9883] Corrections in the explanations of Hamiltonian/Poisson
	  input variables
	  Deleted unused input variables
	  
	  Changes by Pablo Garcia Risueño

2013-01-24 14:41  joseba

	* [r9884] Removed useless white spaces
	  Added few doxygen comments

2013-01-24 14:49  joseba

	* [r9885] More useless white spaces

2013-01-24 17:14  dstrubbe

	* [r9886] Little cleanups of documentation.

2013-01-24 17:34  joseba

	* [r9887] Adapted the configuration to the new library of LIBFM
	  included in the general ScaFaCos.
	  Cleaning of variables in the code.

2013-01-24 17:39  joseba

	* [r9888] Updated my name in the (c)

2013-01-24 20:04  dstrubbe

	* [r9889] References.

2013-01-25 17:35  dstrubbe

	* [r9890] Making a routine name more specific.

2013-01-25 18:24  dstrubbe

	* [r9891] Blocking multipole corrections for Poisson in periodic
	  systems.

2013-01-27 12:24  xavier

	* [r9892] Missing call to opencl_finish.

2013-01-27 12:34  xavier

	* [r9893] Removed some PUSH_SUBs from routines that are called too
	  often.

2013-01-27 13:09  xavier

	* [r9894] * Added clamdblas and clamdfft to the list of optional
	  libraries and
	  config options.

2013-01-27 13:13  xavier

	* [r9895] Added a test for the OpenCL Poisson solver.

2013-01-28 15:11  xavier

	* [r9896] * Added the new tests to the makefile.
	  * Changed the title of the specific Hatree tests.

2013-01-28 16:58  xavier

	* [r9897] Bugfix: the size of the Fourier space operator was wrong
	  for OpenCL.

2013-01-28 17:05  dstrubbe

	* [r9898] Removed unnecessary output.

2013-01-28 17:51  dstrubbe

	* [r9899] Comments and more checking.

2013-01-28 18:10  dstrubbe

	* [r9900] Removed unused variables 'gx'.

2013-01-28 21:08  dstrubbe

	* [r9901] * Fixed confusing names of arguments to intcoslog: its gx
	  and gy were named in reverse from other occurrences.
	  * Making sure to use double precision in converting integer to
	  float.
	  * Removed useless variable 'vec'.
	  * Some comments.
	  * Formatting.

2013-01-29 10:59  acastro

	* [r9902] Initialized a variable that sometimes could be used
	  uninitialized.
	  
	  Added gsl_set_error_handler_off in oct_1dminimize routine, since
	  the code
	  should continue even if the minimization is not successful.
	  (Perhaps we should
	  think about a general policy for gsl_set_error_handler_off?)

2013-01-29 16:16  xavier

	* [r9903] The opencl implementation of mesh_to_cube was wrong.

2013-01-29 19:43  dstrubbe

	* [r9904] Just as the spherical cut-off FFT kernel takes the
	  maximum box size for a finite direction as the one to use in all
	  directions, the cylindrical cut-off FFT kernel should take the
	  maximum box size for the two finite directions to use in both of
	  those. This was not happening and could easily give spurious
	  interactions.

2013-01-29 21:06  dstrubbe

	* [r9905] * The unocc mode now obeys 'OutputEvery' so you can get
	  restart data written for calculations that get killed by a
	  scheduler.
	  * Clarified and updated documentation on OutputEvery, which was
	  quite misleading. Note: the Sternheimer modes write restart data
	  on every iteration always.

2013-01-30 02:01  dstrubbe

	* [r9906] Option for testing to show convergence of occupied states
	  too in unocc mode.

2013-01-30 02:28  dstrubbe

	* [r9907] Clarifications to documentation about mesh partitioners.

2013-01-30 03:51  dstrubbe

	* [r9908] Some comments regarding mesh partitioning.

2013-01-30 11:02  xavier

	* [r9909] Missing condition for an if.

2013-01-30 19:13  dstrubbe

	* [r9910] Fixing race condition in clean_stop: proc 0 might find
	  the file 'stop' present, delete it, and then exit the loop, but
	  other processors arriving in the routine later would not see the
	  file there anymore, and not exit the loop, so the code would hang
	  rather than exit cleanly.

2013-01-30 19:42  dstrubbe

	* [r9911] * Fixed intent.
	  * Indentation.

2013-01-30 22:43  dstrubbe

	* [r9912] Missing deallocation.

2013-01-31 05:20  dstrubbe

	* [r9913] Formatting, indentation, push/pop.

2013-01-31 18:07  dstrubbe

	* [r9914] * Improved usefulness of DebugLevel = 1 output from CG
	  eigensolver by expressing residual in scientific notation.
	  * Added similar output for CG_new and evolution solvers.
	  * Fixed indentation in LOBPCG.

2013-01-31 23:03  dstrubbe

	* [r9915] On chum intel mpich2, my recent change to clean_stop
	  involving MPI_Bcast (r9910) caused the CAETRS test to hang
	  because it uses 'task parallelization' with slave nodes for the
	  Poisson equation. The slaves do not enter the "calculation mode"
	  routine and thus do not call clean_stop. That routine, therefore,
	  should broadcast only over the communicator for the masters, not
	  MPI world. To do so, we must now pass the multicomm object in
	  some more places.

2013-02-01 16:52  dstrubbe

	* [r9916] Initialization to zero of the eigensolver errors for each
	  state. Otherwise, if you do rmmdiis without subspace
	  diagonalization (or with independent particles), since the
	  routine for the initial minimization steps does not calculate
	  residuals, you will may get scary NaN or 10^200 or something in
	  the Error column since it was uninitialized. Now you will have
	  zero there instead, which still looks odd but doesn't imply that
	  the calculation has gone crazy.

2013-02-01 17:41  dstrubbe

	* [r9917] Reducing error verbosity a little.

2013-02-01 17:42  dstrubbe

	* [r9918] Increasing the label length for profiling tags since some
	  were being cut off.

2013-02-01 18:03  dstrubbe

	* [r9919] Typo in variable documentation.

2013-02-01 20:18  dstrubbe

	* [r9920] Revision to documentation on ParallelizationGroupRanks,
	  which seemed to suggest there was no way of specifying
	  domain/other parallelization.

2013-02-01 21:50  dstrubbe

	* [r9921] Removed conflicting duplicated input tag.

2013-02-01 22:46  dstrubbe

	* [r9922] Adding an option to require convergence of the individual
	  eigenvectors.

2013-02-01 23:49  dstrubbe

	* [r9923] Two more errors should be only_root_writes in casida.

2013-02-02 05:29  dstrubbe

	* [r9924] Inserting a note when a test run wants more than 4 MPI
	  tasks. This can be done (in moderation) to increase the
	  likelihood of finding race conditions, says Xavier.

2013-02-02 19:23  dstrubbe

	* [r9925] Comment about running with more than 4 MPI tasks in the
	  testsuite.

2013-02-04 09:43  marques

	* [r9926] Added the functionals MGGA_X_MN12_L and MGGA_X_MN12_SX

2013-02-04 11:10  marques

	* [r9927] Made PW91 code a bit more general.
	  Reset of the testsuite

2013-02-04 12:16  marques

	* [r9928] Added more flexibility to Becke95

2013-02-04 12:34  marques

	* [r9929] Added mgga_xc_pwb6k and mgga_xc_pw6b95

2013-02-04 13:17  marques

	* [r9930] Added mgga_xc_tpsslyp1w

2013-02-04 13:47  marques

	* [r9931] Added hyb_gga_xc_mpwlyp1m

2013-02-05 09:31  marques

	* [r9932] Added the functionals GGA_X_N12 and GGA_X_N12_SX. Note
	  that the library "Minnesota Functional Module" seems to have a
	  bug: F1 is initialized, so Pi=acos(-F1) gets the value of Pi/2
	  ;(((

2013-02-05 11:46  marques

	* [r9933] Added GGA_C_N12 and GGA_C_N12_SX.
	  Corrected the spelling of Minnesota.

2013-02-05 13:34  marques

	* [r9934] Added functionals MGGA_C_M08_HX, MGGA_C_M08_SO,
	  MGGA_C_M11, MGGA_C_M11_L, MGGA_C_MN12_L, and MGGA_C_MN12_SX

2013-02-05 15:53  marques

	* [r9935] Added the functionals hyb_mgga_x_m11 and mgga_x_m11_l. I
	  guess that most of the functionals of Truhlar are now in.

2013-02-05 22:59  xavier

	* [r9936] Removed 5 from the factors used for the OpenCL FFT. This
	  fixes an
	  error (fpe) and improves performance.

2013-02-06 00:33  acastro

	* [r9937] One variable could be used uninitialized sometimes.

2013-02-06 14:25  marques

	* [r9938] Added functional mgga_c_cc06

2013-02-06 22:04  dstrubbe

	* [r9939] Adding an extra initialization to stop the test failure
	  which began with r9922.

2013-02-07 08:45  marques

	* [r9940] Added the functionals MGGA_X_MK00 and MGGA_X_MK00B. Now
	  we have all functionals of molpro.
	  Corrected bug in the evaluation of fxc for the metaggas that
	  depend both in tau and nabla^2 n (only br89 up to now, actually).

2013-02-08 13:25  marques

	* [r9941] Default is now to calculate the symmetries if there are
	  less than 100
	  atoms.

2013-02-08 13:49  marques

	* [r9942] Updated functional list for libxc 2.0.1 I explicitly
	  removed from the
	  list kinetic energy functionals and the CAM hybrids.

2013-02-08 13:50  marques

	* [r9943] Changed documentation of SymmetriesCompute in order to
	  reflect the new
	  default

2013-02-08 21:48  xavier

	* [r9944] * Move the direct 3d poisson test takes too long. So I
	  moved it to an
	  independent long-run test.

2013-02-08 21:50  xavier

	* [r9945] Added explicit boundaries to the operations in the direct
	  poisson
	  solver.

2013-02-08 22:11  xavier

	* [r9946] Added ks_inversion to the list of functionals and to the
	  generator script.

2013-02-09 01:39  xavier

	* [r9947] Declared mixed periodicity systems as experimental.

2013-02-09 03:55  xavier

	* [r9949] The new name for the development version (chosen by
	  David) is 'octopus
	  superciliosus', the frilled pygmy octopus:
	  
	  http://portphillipmarinelife.net.au/species/7307

2013-02-09 05:06  xavier

	* [r9950] Two clAmdFft plans are now used. This is required for
	  real ffts.

2013-02-09 13:25  xavier

	* [r9951] The direct 3D test started failing in parallel. It seems
	  to me that
	  there was an obvious error in the code, but I don't understand
	  why the
	  test was working before.

2013-02-09 22:26  xavier

	* [r9953] * Now the Poisson test honors the TestRepetitions
	  variable.
	  
	  * The OpenCL fft Poisson solver has some problems with the real
	  FFT,
	  it segfaults for more than one call to the Poisson solver, so I
	  am
	  switching back to complex FFTs for the moment.

2013-02-10 01:03  xavier

	* [r9954] The problem with the real FFT appears to be a bug with
	  the library. It
	  is avoided by passing an external temporary buffer.

2013-02-10 01:28  xavier

	* [r9955] * The real FFT is done directly, instead of using an
	  intermediate
	  complex array (that was used to simplify testing).
	  
	  * Fixed non-cl compilation.

2013-02-10 01:32  xavier

	* [r9956] Removed some unused variables.

2013-02-10 21:42  xavier

	* [r9957] Improved the output for the FFT and the FFT poisson
	  solver.

2013-02-10 22:29  xavier

	* [r9958] The array strides are now stored for the opencl fft.

2013-02-10 23:03  xavier

	* [r9959] For OpenCL, the Fourier space kernel is now stored
	  according to the
	  stride used by the library.

2013-02-12 13:20  marques

	* [r9960] I had forgotten the Colle and Salvetti functional. It is
	  added now ;)

2013-02-12 14:29  micael

	* [r9961] * Added calculation of OEP potentials with non-collinear
	  spin. This is still a work in progress, as there are still some
	  functionallities that do not work, like parallelization in
	  states, and the code still needs some improvements.
	  
	  Most of this work was done by Myrta Gruning and Pedro Melo.

2013-02-12 20:08  dstrubbe

	* [r9962] Clarifications to variable documentation for Output =
	  potential.

2013-02-13 10:08  micael

	* [r9963] * Fixed bug introduced by the recent changes in the OEP
	  part that affected parallelization in states.

2013-02-13 21:05  dstrubbe

	* [r9964] Making an array explicit just to avoid (unimportant)
	  warnings about array temporaries.

2013-02-13 21:38  dstrubbe

	* [r9965] Unused arguments.

2013-02-13 21:48  dstrubbe

	* [r9966] Removing explicit array bounds.

2013-02-13 22:17  dstrubbe

	* [r9967] Note on test.

2013-02-14 18:16  dstrubbe

	* [r9968] Fixing -n "dry run" behavior for testsuite script: it
	  ignored most of the logic about determining what would be on the
	  command line.

2013-02-14 19:26  dstrubbe

	* [r9969] Simplifying the interface for restart_read_lr_rho by
	  using the density directly instead of the lr_t object.

2013-02-14 19:57  dstrubbe

	* [r9970] Beginning implementation of Casida excited-state forces.

2013-02-14 20:45  dstrubbe

	* [r9971] Casida K_term now can be separately queried for the
	  Hartree and fxc parts.

2013-02-14 22:52  dstrubbe

	* [r9972] * Calculating lr_fxc = kxc * dl_rho for excited-state
	  forces.
	  * K_term can now work with either fxc or lr_fxc.

2013-02-14 23:04  xavier

	* [r9973] Lets see if we can move to C99, last time some autoconf
	  versions
	  didn't have the macro.

2013-02-14 23:09  dstrubbe

	* [r9974] Cleaner way of setting xc for K_term.

2013-02-14 23:35  dstrubbe

	* [r9975] A bit of reorganization, and making eps_diff work too,
	  for excited-state forces.

2013-02-15 02:46  dstrubbe

	* [r9976] Refactored out the calculation of transition matrix
	  elements in Casida. Also, now Arto Sakko's q-dependent X-ray
	  stuff is enabled for complex as well as real wavefunctions.

2013-02-15 03:58  dstrubbe

	* [r9977] Casida Petersilka/eps_diff now use
	  X(transition_matrix_element).

2013-02-15 04:03  dstrubbe

	* [r9978] Casida Petersilka/eps_diff now uses the same routine for
	  oscillator strengths as the other Casida theory levels. They are
	  all automatically able to use q-dependence now.

2013-02-15 04:38  dstrubbe

	* [r9979] Casida info and profiling.

2013-02-15 17:41  dstrubbe

	* [r9980] Nicer matches in Casida test.

2013-02-16 15:27  dstrubbe

	* [r9981] Bugfix: the x,y,z columns from oct-casida_spectrum were
	  not physically meaningful. They need to be the sum of the squares
	  of the matrix elements from each transition, not just the sum of
	  the matrix elements, or else this quantity is dependent on the
	  arbitrary phase of the wavefunctions. Now they are really the
	  cross sections for each polarization.

2013-02-16 15:29  dstrubbe

	* [r9982] * Running all the theory levels in the Casida test.
	  * Adding matches for oscillator strengths and spectra from the
	  utility run.

2013-02-16 20:37  xavier

	* [r9983] Added explicit functions for the calculation of the
	  matrix elements in
	  rmmdiis.

2013-02-16 22:07  xavier

	* [r9984] Implemented the rmmdiis iteration for packed batches.

2013-02-17 00:19  xavier

	* [r9985] Initial implementation of rmmdiis_iter_3 for OpenCL.

2013-02-17 01:36  xavier

	* [r9986] Compilation works better if I include all the files in
	  the commit.

2013-02-17 16:40  xavier

	* [r9987] Adding special code for the rmmdiis matrix elements
	  complicates the
	  code too much, so I will remove it.

2013-02-17 17:40  xavier

	* [r9988] The default value of MeshBlockSize is selected by the
	  value of
	  StatesBlockSize.

2013-02-17 19:03  xavier

	* [r9989] The default value of StatesBlockSize is reduced when it
	  is too large
	  for the system.

2013-02-17 20:55  xavier

	* [r9990] A space was missing in the configuration output.

2013-02-18 02:01  xavier

	* [r9992] Split the Hartree test. This should help with the
	  valgrind buildbot.

2013-02-18 03:45  xavier

	* [r9993] Increased tolerance to a test that started failing after
	  my changes to
	  the default value of MeshBlockSize.

2013-02-18 05:13  xavier

	* [r9995] Declared non-orthogonal cells as experimental.

2013-02-18 05:54  xavier

	* [r9997] Fixed the problem with periodic systems and spinors
	  reported by
	  Fabiana Da Pieve.

2013-02-18 06:02  xavier

	* [r9999] Forwardport: updated the debian changelog.

2013-02-18 06:12  xavier

	* [r10000] Added the OpenCLBenchmark variable, that runs benchmarks
	  to test the
	  hardware capabilities. This is useful to detect bugs in the
	  implementation. For the moment only the PCIe link is tested.

2013-02-18 14:56  xavier

	* [r10001] Fixed the problem with compilation without OpenCL.

2013-02-19 04:53  dstrubbe

	* [r10002] In a system with degeneracies (such as N2), our
	  Petersilka implementation does not give well-defined answers, and
	  so we should not test its spectrum results. (We need to construct
	  and diagonalize the whole matrix in degenerate subspaces.)

2013-02-19 05:01  dstrubbe

	* [r10003] More helpful alignment of PUSH_SUB with respect to error
	  message.

2013-02-19 05:03  dstrubbe

	* [r10004] Bugfix: oct-casida_spectrum would misinterpret the
	  columns for a spin-polarized eps_diff or petersilka calculation.

2013-02-19 16:19  dstrubbe

	* [r10006] Loosening tolerance very slightly, since polarizability
	  xx for finite diffs failed with discrepancy 0.0011 on chum pgi
	  test.

2013-02-19 18:45  dstrubbe

	* [r10010] Now we can do the utility runs with mpiexec on one
	  processor. This should allow testing the utilities always in the
	  buildslaves and when running the testsuite on supercomputers.
	  Assuming no problem arises with this, we can make utilities be
	  built always, even when MPI is enabled.

2013-02-19 18:48  dstrubbe

	* [r10011] Removing line which I think was debugging info
	  accidentally left in r8324: we will see what command_suffix in
	  the next line of output anyway.

2013-02-19 19:08  dstrubbe

	* [r10012] More helpful error message.

2013-02-19 19:13  dstrubbe

	* [r10013] Removing hard-coding of dim=3 in oct-casida_spectrum.

2013-02-19 19:25  dstrubbe

	* [r10014] Redundant initializations.

2013-02-19 20:01  dstrubbe

	* [r10015] Adding some caveats for Casida: triplets, Tamm-Dancoff,
	  CV(2), and CasidaMomentumTransfer are experimental. k-points and
	  partial occupations are not implemented. CasidaQuadratureOrder
	  need only be read when CasidaMomentumTransfer is set; made
	  documentation reflect this.

2013-02-19 20:07  dstrubbe

	* [r10016] Triplets have no oscillator strength, due to the
	  symmetry of their wavefunctions (|up -> up> - |dn -> dn>).

2013-02-19 22:06  dstrubbe

	* [r10019] Making treatment of dimensionality more general in
	  Casida.

2013-02-19 22:42  dstrubbe

	* [r10020] * The dimension cas%nspin should really be st%d%nik to
	  be correct for spinors and/or k-points.
	  * Partially and half filled states should be included as both
	  occupied and unoccupied when we have occupations implemented in
	  Casida.

2013-02-19 23:18  dstrubbe

	* [r10021] Fixing silly mistake in r10006.

2013-02-19 23:32  dstrubbe

	* [r10023] Adding a useful script. Automatic backport by, e.g.
	  'backport.sh 10006'. It is a little perverse to put a bash script
	  in the perl directory, but I don't see a better place for it. Not
	  worthwhile to install to bin since it is only for development
	  anyway.

2013-02-20 02:29  xavier

	* [r10024] * Added a messages about the memory requirements of the
	  rmmdiis
	  eigensolver.
	  
	  * The eigensolver output is now "stressed".

2013-02-20 03:17  dstrubbe

	* [r10025] Renaming 'perl' directory to 'scripts' since it now has
	  a bash one. Hopefully I changed everything necessary for that.

2013-02-20 03:36  dstrubbe

	* [r10026] Pure 'other' parallelization is a bad default. Trying to
	  solve Poisson separately on each node consumes excessive memory
	  and time. In principle, we would have joint domain/other
	  parallelization, but 'other' parallelization takes precedence,
	  especially since multicomm_init does not know the actual problem
	  size and uses a fictitious value of 10000, making it impossible
	  to choose joint parallelization wisely, and generally resulting
	  in a choice of only one domain group. This should be fixed later.
	  
	  * For now, I have made domain parallelization the default for
	  Casida.
	  * Clarified that the parallelization is not in e-h pairs really,
	  but their matrix elements (i.e. between two e-h pairs).
	  * Using hybrid domain/other parallelization for the Casida test.

2013-02-20 04:02  dstrubbe

	* [r10027] Output from casida and oct-casida_spectrum now include
	  the units in a header.

2013-02-20 05:28  dstrubbe

	* [r10028] * Fixing mistaken 'clarification' from r10026: yes it
	  really is e-h pairs, not matrix elements; I misunderstood the
	  code.
	  * Comment on reuse of Poisson solution in Casida.

2013-02-20 14:52  dstrubbe

	* [r10029] Fixing indentation.

2013-02-20 14:58  dstrubbe

	* [r10030] Suppressing some warnings from g95:
	  * Added intents in command_line interfaces, and removed an unused
	  variable (in the interface!)
	  * Some places target should be specified so the compiler realizes
	  an intent(out) variable will be changed via being put into a
	  batch.
	  * Unused profiling variable.

2013-02-20 15:02  dstrubbe

	* [r10031] Clarification to variable reference.

2013-02-20 17:03  dstrubbe

	* [r10034] ParallelizationGroupRanks writes a warning for each
	  parallelization strategy that is not available, no matter what
	  you write in the corresponding column. This is not helpful. Let's
	  warn only if the value is not 1, i.e. there was an attempt to use
	  that strategy.

2013-02-20 19:10  dstrubbe

	* [r10037] Warnings for inappropriate pseudopotential species
	  input.

2013-02-20 19:59  dstrubbe

	* [r10038] * Grammar and spelling.
	  * Formatting.
	  * Fixed an intent, as suggested by a WARNING that has been there
	  since r2526, 6 years ago...
	  * Doxygen comments.

2013-02-20 20:29  dstrubbe

	* [r10039] Changing warnings to fatal errors about bad values of
	  lmax and lloc, since Micael points out (and I verified with -g
	  -C) that all kinds of things go wrong if these values are not ok,
	  even if the run would superficially seem ok otherwise.

2013-02-20 22:54  dstrubbe

	* [r10040] Reverting r9973 until such time as someone upgrades
	  chum's autoconf to support AC_PROG_CC_C99.

2013-02-20 23:04  dstrubbe

	* [r10042] * Declaring unocc + spinors experimental. This kind of
	  run is not tested, and in my tests I found it destroys the gs
	  wfns and makes everything unpolarized, even in LCAO is not used.
	  gs + ExtraStates seems fine though.
	  * The variable SpinComponents accepts 'non_collinear' and
	  'spinors' as equivalent, but the way the info is displayed on the
	  website, only 'spinors' shows up. Both are used extensively in
	  the testsuite, and appear in other documentation, so I won't
	  remove one, but just make sure the documentation makes clear that
	  both can be used. (This was added in r1581.)

2013-02-21 00:15  dstrubbe

	* [r10044] Undoing intent change from r10038, which does not
	  compile on pathscale. Miguel lied in his comment...

2013-02-21 00:39  xavier

	* [r10045] * In rmmdiis the residual is recalculated instead of
	  calculated as a
	  linear combination.
	  
	  * Simplified the allocation in rmmdiis.

2013-02-21 01:12  xavier

	* [r10046] Removed a double allocation in my last commit.

2013-02-21 03:55  dstrubbe

	* [r10047] LCAO debug now writes more info on the orbital indices.

2013-02-21 04:41  dstrubbe

	* [r10048] Building utilities is now enabled by default, unless in
	  single precision. If you don't want them for some reason, use
	  --disable-utils. Of course, if you prefer to run them in serial
	  without "mpirun -n 1", you can ignore the MPI-built ones and make
	  a separate serial build, just as before.

2013-02-21 10:34  joseba

	* [r10049] Updated the creation of the mesh/cube map, to need only
	  a constant time for a given system. Until now it doubles the
	  execution time doubling the number of processes

2013-02-21 15:55  xavier

	* [r10050] Added an option to save memory in rmmdiis eigensolver
	  (EigensolverSaveMem).

2013-02-21 17:00  xavier

	* [r10051] A small fix in my previous commit.

2013-02-21 19:16  dstrubbe

	* [r10052] Suppressing (very small) array copies, to avoid
	  meaningless warnings from ifort -check all.

2013-02-21 19:19  dstrubbe

	* [r10053] Re-enabling hybrid domain/state parallelization for a
	  test, which had it commented out due to some disabling that is
	  clearly no longer the case. Also, setting number of states and
	  processors to compatible values, since 5 states and 4 procs
	  causes an error due to an empty states-group.

2013-02-21 19:52  dstrubbe

	* [r10054] * Simplifying documentation for Species block: column 4
	  is basically always the same.
	  * More explanation about LCAO orbitals.
	  * LCAOStart = lcao_none should be default for species_from_file
	  and spec_jelli_slab and spec_charge_density, not just for
	  spec_user_def, since these three have in common that they do not
	  represent an atom and so we do not know where (if anywhere) it
	  would be appropriate to have the orbitals centered.
	  * Message tells how many LCAO orbitals are available for
	  pseudopotential species.

2013-02-21 22:18  dstrubbe

	* [r10055] Enabling LCAO for some jellium runs, which speeds up
	  convergence a bit, and allows more testing of LCAO for
	  non-pseudopotential species.

2013-02-21 22:32  dstrubbe

	* [r10056] Documentation on atomic guess densities.

2013-02-22 00:56  dstrubbe

	* [r10059] I am pretty sure any 'experiment' with non-orthogonal
	  cells will fail.

2013-02-22 01:07  dstrubbe

	* [r10060] * Making optional arguments explicit by keyword.
	  * Removing explicit array bounds which caused a (small) array
	  temporary.

2013-02-22 01:19  dstrubbe

	* [r10062] The big box test has such a large volume/point that it
	  overflowed the format statement.

2013-02-22 03:39  dstrubbe

	* [r10064] Typo.

2013-02-22 11:11  joseba

	* [r10066] Implemented a new Poisson solver using ISF solver of
	  BigDFT (version 1.6.0)
	  
	  I did this to get a separate library ISF library:
	  - Compile BigDFT in the machine
	  - Install it
	  - Copy all these libraries to a empty directory:
	  libabinit.a libbigdft.a libdft_common.a libpoissonsolver.a
	  libxc.a
	  
	  - Extract all *.o of those libraries:
	  ar x lib*.a
	  
	  - Collect all *.o in a new library:
	  ar cru libisfsolver.a *.o
	  ranlib libisfsolver.a
	  - Copy to a new directory the libisfsolver.a and the module
	  poisson_solver.mod
	  Include both when compiling with this new library. Mandatory to
	  include also blas and lapack librari
	  es.
	  
	  @TODO Prepare a m4 script to link with the library
	  @TODO Adapt this library to all options that now has the previous
	  ISF
	  @TODO Remove old version and integrate there this one
	  @TODO Clean memory

2013-02-22 12:24  acastro

	* [r10067] Fix of a bug reported by Maria Tsoneva: the use of a
	  laser field with spinors
	  was unphysical. The reason is that the non-diagonal parts of the
	  local
	  potential were also populated with the electric potential.

2013-02-22 16:10  dstrubbe

	* [r10068] * Removed unnecessary module usage of poisson_cutoff_m
	  which was causing compilation failures due to lack of a
	  corresponding dependency.
	  * Removing apostrophes in comments.
	  * Removed duplicate dependency, and broke a long one into two
	  lines.

2013-02-22 16:18  joseba

	* [r10069] Deleted unused variable and also related comment in
	  basque. Sorry for that

2013-02-22 16:24  dstrubbe

	* [r10070] It is best to do Petersilka last, for performance
	  reasons, due to the better ability to reuse Poisson solutions
	  when generating the whole matrix.

2013-02-22 17:48  dstrubbe

	* [r10071] Clarifying that Tamm-Dancoff calculations are ok with
	  complex wavefunctions, actually.

2013-02-22 19:37  dstrubbe

	* [r10073] I don't see any reason not to use orbitals for LCAO that
	  are above the maximum angular momentum being considered for the
	  pseudopotential. This was apparently introduced in r3233 by
	  Miguel. If you don't want so many orbitals, you can always avoid
	  them with LCAODimension. Perhaps the intention was to avoid
	  unbound atomic orbitals (maybe correlated with being above the
	  lmax of the pseudo?), but we remove these since r7551.

2013-02-22 20:10  askhl

	* [r10074] add complex-scaling code which hopefully doesn't break
	  everything

2013-02-22 20:20  dstrubbe

	* [r10075] svn:ignore properties for new directory.

2013-02-22 21:54  dstrubbe

	* [r10076] * No buildslaves have arpack, so the complex_scaling
	  tests must check for that option or they will definitely fail.
	  * Fixing TestGroups in accordance with current conventions.

2013-02-22 21:57  dstrubbe

	* [r10077] Creating a new subsubroutine for Casida forces.

2013-02-22 22:02  askhl

	* [r10078] reinstate hamiltonian/Makefile.am to its former glory

2013-02-22 22:04  askhl

	* [r10079] remove comments from old conflict in common-rules.make

2013-02-23 01:34  xavier

	* [r10080] * Added some profiling regions to the rmmdiis
	  eigensolver.
	  * Some functions should be executed only in 'save memory' mode.

2013-02-23 03:21  xavier

	* [r10081] Removed debugging output.

2013-02-23 04:11  dstrubbe

	* [r10082] Adding ComplexScaling.html to Makefile for installation,
	  to fix the dist check buildslave.

2013-02-23 04:29  dstrubbe

	* [r10083] Tweaking tolerances to let mauchly pass the tests.

2013-02-23 04:53  dstrubbe

	* [r10084] * Fixing non-ARPACK compilation: functions calling
	  ARPACK routines were not inside #ifdef's. Surprising this was ok
	  for some compilers.
	  * Indentation.
	  * A variable systematically contained a typo.
	  * The arpack_debug and arpack_check_error routines need not be
	  hidden since they do not contain ARPACK calls.
	  * Fixing PUSH/POPs.

2013-02-23 05:04  dstrubbe

	* [r10085] Actually the variable section 'ComplexScaling' appears
	  to be a mistake. Everything else is in section 'Hamiltonian.' I
	  recommend to Ask to put it all in 'Hamiltonian::ComplexScaling'
	  for tidiness.

2013-02-23 05:16  askhl

	* [r10086] remove debugging variables for now

2013-02-23 05:27  xavier

	* [r10087] Added a run with StatesPack=yes to the fullerene test.

2013-02-23 13:40  xavier

	* [r10088] * Optimized the batch_get_points and batch_set_points
	  functions.

2013-02-23 15:35  xavier

	* [r10089] Now states_overlap is calculated by blocks of points
	  instead of blocks
	  of states.

2013-02-23 16:44  xavier

	* [r10090] Moved the calculation of the subspace hamiltonian to a
	  subroutine.

2013-02-23 16:48  askhl

	* [r10091] clean up and remove older function

2013-02-23 16:50  askhl

	* [r10092] indentation

2013-02-23 16:51  askhl

	* [r10093] remove direct eigensolver as it is slightly unsightly
	  and unlikely to be used from now on

2013-02-23 17:19  dstrubbe

	* [r10094] * Fixed mistaken #ifdef symbol.
	  * Formatting, corrected PUSH/POP's.

2013-02-23 17:29  xavier

	* [r10095] When using OpenCL the subspace diagonalization is done
	  by blocks of points.

2013-02-23 17:39  askhl

	* [r10096] minor cleanups and style fixes mostly in complex scaling
	  code

2013-02-23 17:41  dstrubbe

	* [r10097] Removed unnecessary module usages. Somehow this seems to
	  fix the BOMD test on chum.

2013-02-23 17:43  askhl

	* [r10098] more minor style fixes

2013-02-23 18:33  askhl

	* [r10099] slightly more cleanup

2013-02-23 19:44  dstrubbe

	* [r10100] Updating documentation to reflect r10073.

2013-02-23 19:47  dstrubbe

	* [r10101] Making it possible to call calc_hvar without having set
	  up linear_response_t and sternheimer_t objects.

2013-02-23 20:30  dstrubbe

	* [r10102] Setting up for derivatives of eigenvalues in Casida
	  forces.

2013-02-23 23:25  xavier

	* [r10103] This part of the test cannot be run parallel in states.

2013-02-23 23:31  xavier

	* [r10104] When all the states are in one block, blas can be called
	  directly.

2013-02-23 23:40  xavier

	* [r10105] Merged the calls to syrk and herk.

2013-02-23 23:41  xavier

	* [r10106] Reverting change made by mistake.

2013-02-24 02:07  dstrubbe

	* [r10107] fxc must be an optional argument to calc_hvar, or else
	  we would be passing it unallocated for magnetic or kdotp
	  perturbations. This made the g95 tests fail with a runtime error.

2013-02-24 14:35  xavier

	* [r10108] Added a batch interface for the Poisson solver.

2013-02-24 16:54  acastro

	* [r10110] Small modification to the backport.sh script to make
	  sure that it works with
	  version 1.7.8 of subversion.

2013-02-24 22:49  xavier

	* [r10111] Replaces access to st%dpsi with a call to
	  states_get_state.

2013-02-25 01:05  xavier

	* [r10112] * Added the states_get_points function, that returns the
	  value of the
	  states for a range of points.
	  
	  * Removed an access to st%X(psi) from the Casida code, replaced
	  by a
	  states_get_points call.

2013-02-25 01:35  xavier

	* [r10113] More calls to states_get_state. Now st%X(psi) is not
	  used by Casida.

2013-02-25 02:28  xavier

	* [r10114] Removed other access to st%X(psi). In this case the
	  previous code was
	  broken. This is part of the frozen orbitals implementation, that
	  I
	  think was never used.

2013-02-25 02:46  xavier

	* [r10115] Removed a reference to st%X(psi).

2013-02-25 02:57  dstrubbe

	* [r10116] Implementing the proper single-pole approximation of
	  Petersilka. We now construct the whole matrix, but set to zero
	  everything except diagonals and degenerate subspaces. This should
	  make the Petersilka match that was failing pass, since the
	  results will no longer be dependent on the arbitrary choice of
	  orbitals in the degenerate subspaces. Also, Petersilka spectrum
	  matches are enabled.
	  
	  The Petersilka results used to differ strongly from both Casida
	  and Tamm-Dancoff for the N2 test. Now the Petersilka spectrum
	  looks identical to Tamm-Dancoff, actually, as it should when
	  there is little mixing between (non-degenerate) transitions.
	  
	  As a result, we no longer can write the 'From' and 'To' indices
	  for Petersilka eigenvalues, since they may be a mixture in
	  degenerate subspaces, but we write an 'excitations' directory
	  like for Casida, where you can see what the eigenvector is.
	  
	  Still to be done: better treatment of degeneracy threshold,
	  better progress bar.

2013-02-25 04:57  xavier

	* [r10117] More st%X(psi) removed.

2013-02-25 05:08  dstrubbe

	* [r10118] * Cleaning up remnants of old Petersilka implementation.
	  * Separating 'solve_casida' routine into two parts.

2013-02-25 11:27  askhl

	* [r10119] remove commas after string format specification to
	  appease bluegene xlf compiler

2013-02-25 14:36  xavier

	* [r10120] Replaced st%X(psi) with states_set_state.

2013-02-25 20:42  dstrubbe

	* [r10121] More comments on backport script.

2013-02-26 20:48  dstrubbe

	* [r10122] Fixing progress bar for Petersilka.

2013-02-27 04:25  dstrubbe

	* [r10123] * Reusing 'rho' for something unrelated in K_term is
	  dubious. Let's use a different variable there.
	  * More promptly deallocating.
	  * Consolidated statements for unpolarized and spin-polarized.
	  * Notes on what needs to be done for casida run mode to work for
	  complex wavefunctions.

2013-02-27 16:09  dstrubbe

	* [r10124] * Adding some new components to casida_t.
	  * Making messages_experimental arguments singular, so the
	  resulting sentence is more grammatical.
	  * hvar from vib_modes should always be real, even with complex
	  wavefunctions.

2013-02-27 16:12  dstrubbe

	* [r10125] While Tamm-Dancoff calculations with complex
	  wavefunctions are possible in principle, the current code assumes
	  things are real in some places that will make the result
	  incorrect.

2013-02-27 19:40  dstrubbe

	* [r10128] Another plural for messages_experimental.

2013-02-27 20:38  dstrubbe

	* [r10129] Refactored real/cplx poisson start and finish routines
	  into an included file.

2013-02-27 21:25  dstrubbe

	* [r10130] * Fixing unnecessarily generous intents: inout that
	  should be in mostly, but a few that should be out (init
	  routines).
	  * Formatting.
	  * Doxygen comments.
	  * der in poisson_multigrid_solver was target, for no apparent
	  reason. Not anymore.

2013-02-27 21:43  dstrubbe

	* [r10131] * gr was unnecessarily 'inout' in pert routines.
	  * Indentation.
	  * Doxygen comments.
	  * Fixing unterminated apostrophe.

2013-02-27 23:11  dstrubbe

	* [r10132] Adding a component cas%nst to the casida_t type, and
	  using it in some places to make the appropriate generalization
	  for partial occupations. Also, the second dimension of cas%index
	  was being allocated with one more element (at the bottom of the
	  range) than necessary.

2013-02-27 23:24  dstrubbe

	* [r10133] Calculating electron-phonon matrix elements for change
	  in eigenvalues part of Casida matrix, for excited-state forces.

2013-02-28 05:11  dstrubbe

	* [r10134] * Changed cas%forces (logical) to cas%calc_forces, and
	  used cas%forces for a FLOAT array of the actual forces.
	  * A bit of rearrangement.
	  * The actual forces for eps_diff are now calculated and written
	  out.
	  * Fixing initializations for lr_hmat arrays.
	  * Making array indices for lr_hmat1 more intuitive.

2013-02-28 20:56  dstrubbe

	* [r10135] Clarified warnings about bad excitation energies in
	  Casida.

2013-02-28 22:48  dstrubbe

	* [r10137] Rationalized sorting in Casida: only eps_diff actually
	  needs it, as diagonalization returns sorted eigenvalues anyway.

2013-03-01 03:35  dstrubbe

	* [r10138] Doxygen comments.

2013-03-01 04:53  dstrubbe

	* [r10139] * Implemented (nearly) degenerate perturbation theory
	  for excited-state forces, only eps_diff so far. This
	  consideration seems to have been wholly neglected in previous
	  literature on the subject!
	  * Correcting sign error for forces, and using ordering index
	  properly.

2013-03-01 16:05  xavier

	* [r10140] Some operations are now counted.

2013-03-01 17:44  askhl

	* [r10141] adapt 1d direct poisson solver for complex scaling. This
	  is necessary because the soft-Coulomb kernel does not correspond
	  to a linear system, so one cannot solve separately for real/imag
	  parts. Reinstate the relevant parts of the complex scaling tests.

2013-03-01 20:39  dstrubbe

	* [r10142] Reverting r10141 which did not compile for several
	  reasons. I am not sure what was intended, it needs another try.

2013-03-01 22:11  dstrubbe

	* [r10143] Writing out saved matrix elements for Casida will now be
	  in casida_get_matrix not casida_solve.

2013-03-01 23:02  dstrubbe

	* [r10144] * Loading saved data is done by casida_get_matrix.
	  * saved_K renamed is_saved, and moved inside casida_get_matrix.
	  * is_saved array and restart filename are passed as arguments.

2013-03-01 23:18  dstrubbe

	* [r10145] We use an array for the effective triplet kernel of the
	  same size as for the singlet kernel.

2013-03-01 23:31  dstrubbe

	* [r10146] The matrix is now passed as an argument to various
	  routines in Casida.

2013-03-02 00:15  acastro

	* [r10147] Support for LDA kernel with non-collinear spin
	  densities.

2013-03-02 00:24  dstrubbe

	* [r10148] Casida restart data now goes to a directory
	  restart/casida, and a file kernel or kernel_triplet. Note: this
	  breaks compatibility with restart data written by 4.1.x, though
	  you can just create the directory and rename the files, and then
	  it is compatible.

2013-03-02 00:51  dstrubbe

	* [r10149] * Fixed extra slash with Casida restart path.
	  * Implemented forces for Petersilka and Tamm-Dancoff theory
	  levels.

2013-03-02 02:23  askhl

	* [r10150] attempt 2: adapt 1d direct poisson solver for complex
	  scaling. This is necessary because the soft-Coulomb kernel does
	  not correspond to a linear system, so one cannot solve separately
	  for real/imag parts.

2013-03-02 02:26  askhl

	* [r10151] reinstate complex scaling tests that use 1d poisson
	  solver

2013-03-02 03:41  dstrubbe

	* [r10152] In r10148, I tried to use loct_rm to delete the restart
	  directory, which does not work (and was probably not a good idea
	  anyway). Instead, we delete the individual restart files, if they
	  are the ones we will be working with.

2013-03-02 13:08  acastro

	* [r10153] Added some comments, some PUSH_SUB/POP_SUB, and removed
	  some unnecessary
	  duplicated code, regarding the noncollinear LDA kernel.

2013-03-02 17:44  xavier

	* [r10154] * Added a function that returns the points block-size
	  for a batch. For
	  the moment this is a constant.
	  
	  * Removed an extra operation count.

2013-03-02 18:07  dstrubbe

	* [r10155] * In r10116, I boasted that now the Petersilka spectrum
	  looks the same as Tamm-Dancoff. Now I realized that they were the
	  same to machine precision. Turns out I was not handling the
	  restart data correctly, so exactly the same matrix was being
	  diagonalized for Petersilka as for Tamm-Dancoff. This needs to be
	  fixed better, but for now we just neither use nor generate
	  restart data in a Petersilka run, to ensure correctness. The
	  Petersilka spectrum is no longer identical to Tamm-Dancoff, but
	  still much more similar than before r10116. In particular, the
	  oscillator strengths used to be identical to eps_diff, which are
	  quite inaccurate in degenerate subspaces.
	  * Marking excited-state forces as experimental.

2013-03-02 23:30  dstrubbe

	* [r10156] * Petersilka now uses saved matrix elements again, but
	  zeroes the ones that should not be used.
	  * An array stores which were being calculated, and is used to
	  decide which to write out as restart info, so we do not store
	  zeroes that would be used incorrectly by another theory level.
	  * A function decides whether two pairs are degenerate or not.

2013-03-03 15:02  xavier

	* [r10157] Some optimization of the projector code.

2013-03-03 18:08  acastro

	* [r10158] This avoids (at least some, hopefully all) NaNs returned
	  when computing the
	  kernel with very small non-collinear densities.

2013-03-03 19:19  xavier

	* [r10159] More optimization of the projectors.

2013-03-04 17:15  joseba

	* [r10160] Corrected a bug that affected LIBISF and PFFT with one
	  MPI process

2013-03-04 21:40  xavier

	* [r10161] Reverted some optimizations. There is some issue with my
	  changes that
	  produces segfaults and other errors, but that I haven't been able
	  to
	  locate.

2013-03-06 10:02  micael

	* [r10162] * Bug fix in the calculation of the OEP exchange energy
	  with non-collinear spin.

2013-03-06 23:04  dstrubbe

	* [r10163] Enabling use of environment variables LIBS_LIBXC and
	  FCFLAGS_LIBXC as alternative to --with-libxc-prefix.

2013-03-06 23:10  dstrubbe

	* [r10164] Removing unterminated apostrophe.

2013-03-06 23:14  dstrubbe

	* [r10165] Using a more explicit syntax for linking libxc. I think
	  this should help with the problems users are always reporting,
	  that earlier versions of libxc are interfing in the linking and
	  giving errors about unresolved symbols.

2013-03-07 10:46  acastro

	* [r10166] Made sure that some constants are used with the correct
	  precision.
	  
	  Removed some unused variables.

2013-03-07 14:17  askhl

	* [r10167] remove imaginary part of fermi energy in complex
	  scaling, which was somewhat ill-defined anyway. Should also fix a
	  complaint from valgrind

2013-03-07 17:12  dstrubbe

	* [r10168] Fixing mistaken units for current density, introduced
	  r5962, as reported by Yalei Jia.

2013-03-07 17:20  dstrubbe

	* [r10170] * Moving progress bar finishing to casida_get_matrix, so
	  it comes out right for forces.
	  * Excited-state forces were mistakenly restarting from data from
	  a different displacement. Now they each have their own restart
	  file.

2013-03-07 20:00  dstrubbe

	* [r10171] Petersilka should not have the "From", "To" header
	  anymore since r10116.

2013-03-07 20:24  dstrubbe

	* [r10172] Clarifications about complex wavefunctions in Casida,
	  and nature of Petersilka theory level.

2013-03-07 20:42  dstrubbe

	* [r10174] CasidaCalcForces = yes with CasidaTheoryLevel containing
	  lrtddft_casida no longer causes an error, rather just a warning
	  and it does not try to perform that calculation.

2013-03-07 21:54  dstrubbe

	* [r10175] Defining strings to hold test programs, so they are not
	  duplicated in the m4 macros.

2013-03-07 22:04  dstrubbe

	* [r10176] The libxc m4 macro now tries to link dynamically after
	  trying static linkage. This is necessary to keep my change in
	  r10165 from breaking compilation with libxc supplied by a
	  package.

2013-03-07 22:43  dstrubbe

	* [r10177] A helpful message for debugging.

2013-03-07 23:30  dstrubbe

	* [r10178] Removing a barrier I did not mean to leave in the
	  previous commit, and which broke serial compilation.

2013-03-07 23:33  dstrubbe

	* [r10179] * Fixing the filenames for deletion of old Casida force
	  restart files when starting from scratch.
	  * Forgot to set the pointer for use of lr_fxc for forces matrix
	  elements.

2013-03-07 23:50  dstrubbe

	* [r10180] For excited-state forces, the Hartree term was
	  mistakenly being calculated.

2013-03-08 04:46  dstrubbe

	* [r10181] * Initializing the lower triangle of lr_hmat2.
	  * Aligning arguments.

2013-03-09 04:12  dstrubbe

	* [r10182] Adding FilterPotentials = filter_TS to the Casida test,
	  in preparation for adding excited-state forces to it. Some small
	  changes in results occur.

2013-03-09 04:42  dstrubbe

	* [r10183] Added vibrational calculation to Casida test.

2013-03-10 02:47  dstrubbe

	* [r10184] A little cleaning up:
	  * The obsolete message for PolConvAbsDens was in two places.
	  * Module alphabetization.
	  * Formatting.
	  * PUSH/POP's.

2013-03-10 02:54  dstrubbe

	* [r10188] Trying to make test pass by reducing density convergence
	  threshold.

2013-03-10 04:15  dstrubbe

	* [r10189] Adding an option LRConvRelDens for Sternheimer, like the
	  ground-state case.

2013-03-10 04:20  dstrubbe

	* [r10190] Adding gs matches for VdW test.

2013-03-10 04:43  dstrubbe

	* [r10191] * Reducing duplication in m4 macros.
	  * The (P)ARPACK macros were leaving guess links (e.g. -larpack)
	  to be substituted into the final link line, even when the
	  relevant library was not found.

2013-03-10 05:02  dstrubbe

	* [r10192] * Making adaptive tol scheme with both LRConvAbsDens and
	  LRConvRelDens.
	  * Fixing default for LRConvRelDens.
	  * Formatting.

2013-03-10 05:12  dstrubbe

	* [r10193] * Fixing mistake in previous commit.
	  * Less blank space in output.

2013-03-10 17:22  dstrubbe

	* [r10194] Loosening tolerances.

2013-03-10 19:35  dstrubbe

	* [r10195] * Casida load_saved zeroes out the matrix first, for
	  safety.
	  * Formatting.
	  * Removing obsolete comment.

2013-03-10 21:35  dstrubbe

	* [r10196] Fixing accidental doubling of diagonal elements in
	  lr_hmat2 (r10181).

2013-03-11 03:34  dstrubbe

	* [r10197] * Setting factor for degenerate perturbation theory in
	  excited-state forces to a more reasonable number; the previous
	  value was throwing away most of the significant figures in the
	  result.
	  * The Casida test now runs the force calculation and has matches
	  for forces.

2013-03-11 17:08  dstrubbe

	* [r10198] Fixing allocation and deallocation of cas%mat_save and
	  cas%forces so things work for multiple theory levels, and the
	  test does not seg fault.

2013-03-11 17:11  micael

	* [r10199] Bug fix: a MPI allreduce was missing in the
	  non-collinear spin OEP implementation.

2013-03-11 18:33  dstrubbe

	* [r10200] Unterminated apostrophes.

2013-03-11 18:39  dstrubbe

	* [r10201] Adding matches for Tamm-Dancoff excitations, and more
	  excited-state force matches.

2013-03-11 19:10  dstrubbe

	* [r10202] The vib_modes test in Casida takes far too long with the
	  convergence threshold I set. However, that level of convergence
	  makes almost no difference to the excited-state forces, so let's
	  relax it.

2013-03-11 19:37  dstrubbe

	* [r10203] In fact, the kernel derivative was not being included in
	  the excited-state force calculation. Now it is enabled (but still
	  off by default for the time being). It appears surprisingly
	  unimportant.

2013-03-11 20:41  dstrubbe

	* [r10204] * Fixed typo of dmat2 instead of zmat2 in complex
	  branch.
	  * The electron-phonon matrix elements are now written to restart,
	  though they are not read in.
	  * Comments.

2013-03-11 21:31  dstrubbe

	* [r10205] The factors of two for spin and the variational theory
	  need to be applied in the forces case too.

2013-03-11 22:10  dstrubbe

	* [r10206] Turning on kernel derivatives for excited-state forces.

2013-03-11 22:19  dstrubbe

	* [r10207] Let us be bold and let the complex-scaling tests run.
	  The tigger buildslave has arpack and parpack actually, so it can
	  run these. It is parallel but we can run on just one processor to
	  use the serial implementation only.

2013-03-11 22:34  dstrubbe

	* [r10208] * Adding a test for oct-center-geom.
	  * Clarifications to documentation.

2013-03-12 01:33  dstrubbe

	* [r10209] Adding a test run for oct-xyz-anim.

2013-03-12 16:30  dstrubbe

	* [r10210] Forgot a file in r10209.

2013-03-12 16:43  dstrubbe

	* [r10211] Removing something mistakenly committed in r10204:
	  Petersilka forces only need off-diagonals in degenerate
	  subspaces.

2013-03-12 17:30  dstrubbe

	* [r10212] Being less profligate with memory for excited-state
	  forces: we do not need to keep the derivative of the density or
	  the kernel for all the displacements, just the current one.

2013-03-12 17:45  dstrubbe

	* [r10213] If you try 'clean stop' on geometry optimization, it
	  just breaks out of the current SCF run, but continues the
	  optimization cycle. To pass this info into the C routines for
	  optimization seems complicated, and while GSL in principle can
	  receive an error code of the forces being NaN, it does not seem
	  to care and keeps going. Therefore, we will remember whether a
	  clean stop was requested in the SCF object, and die when asked to
	  run if this is set, so the calculation actually will finish.

2013-03-12 19:11  dstrubbe

	* [r10214] oct-xyz-anim was broken for max-dim=4 (non-alphanumeric
	  characters were written as dim=4 of the coordinates, even for a
	  3D system). Simply using the routine available elsewhere for
	  writing xyz files fixes this.

2013-03-12 19:16  dstrubbe

	* [r10215] The barrier I introduced in Casida in r9629 is no longer
	  necessary, after improving the handling of restart info.

2013-03-12 19:17  dstrubbe

	* [r10216] oct-xyz-anim now behaves properly for an arbitrary
	  number of dimensions (rather than just 3).

2013-03-12 19:36  dstrubbe

	* [r10219] Correcting and clarifying documentation about geometry
	  optimization convergence criteria.

2013-03-12 19:59  dstrubbe

	* [r10220] Removing unused variable.

2013-03-12 21:37  dstrubbe

	* [r10221] Recentering reference value for Casida N2 bond stretch
	  so tests pass.

2013-03-12 21:42  dstrubbe

	* [r10222] If an atom moves outside the box during geometry
	  optimization, results will be meaningless afterward, so the run
	  should terminate with an error.

2013-03-12 22:24  dstrubbe

	* [r10224] * The code now identifies how coordinates are read in
	  (filename, or block).
	  * Clarifying comments about Coordinates inputs.

2013-03-12 22:54  dstrubbe

	* [r10225] Adding units to geometry optimization output, and a
	  message about min.xyz.

2013-03-12 23:33  dstrubbe

	* [r10227] The gs forces can now be included to give total
	  excited-state forces rather than gradients of the excitation
	  energy.

2013-03-13 03:19  dstrubbe

	* [r10230] For ease in dealing with restarting geometry
	  optimization runs, the old contents of the 'geom' directory are
	  deleted to avoid confusion, and each step is written to last.xyz
	  (overwriting the old) so this can be used as the coordinates for
	  restart. (By constrast, min.xyz is only written if the
	  optimization finishes.)

2013-03-13 16:11  xavier

	* [r10231] Moved the minimization functions to its own module.

2013-03-13 21:21  dstrubbe

	* [r10232] * GSL error codes are now written out.
	  * Writing a unit label with energies.

2013-03-13 21:59  dstrubbe

	* [r10233] Typo.

2013-03-13 23:03  dstrubbe

	* [r10234] PUSH/POPs.

2013-03-13 23:05  dstrubbe

	* [r10235] Actually, the error unknown to GSL is not an error, but
	  a code reported by our routine what GOMaxIter is hit.

2013-03-13 23:19  dstrubbe

	* [r10236] Testing some more features of geometry optimization.

2013-03-13 23:20  dstrubbe

	* [r10237] Dividing subspace_diag routine into wrapper and standard
	  algorithm.

2013-03-14 03:33  dstrubbe

	* [r10238] Unifying the options EigensolverSubspaceDiag (turning it
	  on or off) and SubspaceDiagonalization (choosing a method) in
	  favor of the latter. Set SubspaceDiagonalization = none to turn
	  it off. I also noted that doing so is generally a bad idea. When
	  EigensolverSubspaceDiag was introduced in r6312, Miguel commented
	  that subspace diagonalization was destroying his calculations and
	  could be a bad idea for restarting unocc with a larger number of
	  states. I think the root cause of this problem (possibly
	  inconsistent LAPACK diagonalization on each processor?) has
	  probably been solved since then, so I removed the comment. You
	  may lose orthogonality and get bad results if subspace
	  diagonalization is not used for unocc.

2013-03-14 18:33  dstrubbe

	* [r10239] Adding PUSH/POPs.

2013-03-14 19:15  dstrubbe

	* [r10240] Vibrational calculations with max-dim=4 (specifically
	  the Casida one) had a small discrepancy from the proper values.
	  Changing MAX_DIM to ndim in some places seems to fix it. (Also
	  for simplicity used this shortcut for some longer references to
	  the same value.)

2013-03-14 20:20  dstrubbe

	* [r10241] * Some m4 scripts were making changes to CFLAGS and
	  LIBS, which they should not do.
	  * It is best to allow use of environment variables such as
	  FCFLAGS_PSPIO to control the behavior, not to set them to blank
	  in the m4 macros.

2013-03-15 01:41  dstrubbe

	* [r10242] Cleaning.

2013-03-15 01:59  dstrubbe

	* [r10243] Correcting variable section, to the utility's actual
	  name.

2013-03-15 03:11  dstrubbe

	* [r10246] Option to test Hermiticity of Casida matrix. In the
	  testsuite run, it makes no difference in the casida matches, and
	  only very small differences in the oct-casida_spectrum matches.

2013-03-15 03:27  dstrubbe

	* [r10247] * Link to GSL optimization documentation.
	  * Only use 1:sb%dim of forces, not up to MAX_DIM.
	  * With GOMethod = simplex, a spurious line of output (message(6)
	  was not assigned, and was the correlation energy from a previous
	  write) was being written for each iteration. I converted to the
	  new style of message writing, and fixed it.

2013-03-15 18:21  dstrubbe

	* [r10249] Formatting.

2013-03-15 19:40  dstrubbe

	* [r10250] Changing two intent's that were causing errors about
	  uninitialized value created by a stack allocation, from valgrind,
	  with linear_response/04-vib_modes.01-gs.inp.

2013-03-15 19:58  dstrubbe

	* [r10251] Better formatting in variable reference.

2013-03-15 20:58  dstrubbe

	* [r10253] When I removed GSL_CFLAGS and GD_CFLAGS from CFLAGS in
	  r10241, it broke compilation on some systems (if the
	  corresponding include files were not in a default path, I guess).
	  Now these CFLAGS are explicitly added to the compilation command
	  for C source files, following the treatment of Zoltan, METIS,
	  spglib, etc.

2013-03-15 21:55  dstrubbe

	* [r10254] Fixing another intent problem flagged by valgrind, with
	  max-dim = 4.

2013-03-16 03:32  dstrubbe

	* [r10257] Submesh should use only the relevant dimensions.

2013-03-16 16:16  dstrubbe

	* [r10258] Warning if occupied states are not converged in an unocc
	  calculation, which can indicate serious problems.

2013-03-16 22:37  dstrubbe

	* [r10259] Little improvement to documentation.

2013-03-16 23:00  dstrubbe

	* [r10260] * If lmax = 0 for a pseudopotential species (typical for
	  H!), its projector was not really initialized, but some of its
	  components could be used later anyway. This was causing
	  segmentation faults with mesh%sb%dim in submesh_overlap, for atom
	  coloring. Now we initialize as much as is relevant for this case.
	  * Added an assertion that could have detected this problem.
	  * Adding initialization to 'null' for submesh%mesh.

2013-03-17 02:38  dstrubbe

	* [r10261] Moved ASSERT inside if condition so it doesn't make
	  every run with non-pseudotential species crash...

2013-03-17 03:09  dstrubbe

	* [r10262] Undoing ill-advised parts of r10260.

2013-03-17 20:11  dstrubbe

	* [r10263] * I think we should be checking overlaps provided there
	  are any projectors, not just if they are KB projectors (i.e.
	  include HGH and RKB too).
	  * Skip overlap check if there are no projectors, to avoid seg
	  faulting for lmax = 0.

2013-03-18 15:54  acastro

	* [r10264] Some intent(in)'s that should be intent(inout)'s.

2013-03-19 13:39  helbig

	* [r10265] Occupation numbers minimization in RDMFT

2013-03-19 17:36  joseba

	* [r10266] Added the possibility to use a bigger domain partition
	  than the actual number of domains. Sometimes is not possible to
	  run serial domain partitioning in big computers, and instead
	  partition files can be transfered.

2013-03-19 17:55  joseba

	* [r10267] Started adding support for 8 byte long integers.
	  The code should compile and run with 8 byte integer support in
	  the near future.

2013-03-19 20:47  acastro

	* [r10268] A message in controlfunction.F90 was not properly
	  output.
	  
	  In the fft_init routine, I have moved the warning about
	  non-optimal grid sizes
	  to the place where the info about the grid size is printed. This
	  way it is not
	  printed multiple times when the routine is called multiple times
	  with the same
	  FFT size.

2013-03-20 11:49  xavier

	* [r10269] * The rdmft file was in DOS format, converted to Unix
	  format.
	  
	  * Several style fixes and code cleaning.
	  
	  * Removed unnecessary arguments.

2013-03-20 11:50  xavier

	* [r10270] I forgot to commit this file removal.

2013-03-20 13:00  xavier

	* [r10271] Defines an intermediate function for multidimensional
	  minimization
	  instead of calling GSL directly.
	  
	  Alberto: Do you think we can integrate Newuoa to this function,
	  instead of calling it directly?

2013-03-20 15:45  xavier

	* [r10272] * Now the minimize functions receive an array instead of
	  the first
	  element.
	  
	  * Started the implementation of a native version of steepest
	  descent.
	  Nicole and Iris are having issues with the GSL minimization
	  routines
	  for optimizing occupation numbers that are very similar to the
	  ones we
	  have with geometry optimization. So I want to implement some
	  minimizers directly to check if there is something wrong with our
	  GSL
	  implementation.

2013-03-20 15:52  joseba

	* [r10273] Initialized to false has_virtual_partition, in case it
	  is not readed the input parameter
	  Corrected grammar

2013-03-20 21:00  acastro

	* [r10274] Integrated the newuoa function into the new
	  "minimize_multimin_nograd"
	  function in the minimizer_m module, as suggested by Xavier.

2013-03-20 21:26  dstrubbe

	* [r10275] Fixing some more intents for command-line function
	  interfaces.

2013-03-20 21:29  dstrubbe

	* [r10276] Typo in call to input_error.

2013-03-21 02:34  dstrubbe

	* [r10278] Standardizing indentation.

2013-03-21 02:37  dstrubbe

	* [r10279] PUSH/POPs.

2013-03-21 02:47  dstrubbe

	* [r10280] Correcting name of utility.

2013-03-21 19:32  xavier

	* [r10281] Now the rdmft code uses states_get_state.

2013-03-22 17:00  umberto

	* [r10282] loosen the test criteria in order to match the changes
	  with NFFT 3.2.2

2013-03-22 17:30  umberto

	* [r10283] Calculate forces also when a td-external field is
	  expressed in velocity gauge.

2013-03-22 17:50  umberto

	* [r10284] Cleaning

2013-03-22 17:54  umberto

	* [r10285] Documentiation:
	  * possible choices of file format in UserDefinedStates
	  * documenting the carrier phase option in TDExternalFields

2013-03-22 17:57  umberto

	* [r10286] preamble and credits

2013-03-22 18:04  umberto

	* [r10287] * nn_temp was not initialized when library_= FFTLIB_NFFT
	  * reserving FFTLIB_PNFFT = 5 for coming PNFFT support

2013-03-24 12:14  acastro

	* [r10288] Added a new high harmonic generation target for optimal
	  control runs.

2013-03-26 09:29  marques

	* [r10289] Small typo found by Xavier Gonze

2013-03-26 18:52  dstrubbe

	* [r10291] Typos.

2013-03-27 00:57  dstrubbe

	* [r10293] A new variable GOLineTol enables the user to set the
	  tolerance for line minimization in GSL methods that use the
	  forces, for CalculationMode = go. We were just using the
	  recommended value of 0.1, but perhaps playing around with this
	  will help improve the behavior.

2013-04-01 15:08  acastro

	* [r10294] Use of FFTs instead of DFTs for the hhg target in the
	  optimal control module.

2013-04-01 18:02  dstrubbe

	* [r10295] Typo.

2013-04-06 17:24  xavier

	* [r10296] Bugfix: the periodic boundary conditions were not
	  properly set for calculations done only with the gamma point.

2013-04-07 01:20  xavier

	* [r10298] Bugfix: an assertion failed in the rmmdiis eigensolver
	  in systems
	  where the Hamiltonian cannot be applied packed.

2013-04-07 02:06  xavier

	* [r10299] Added a short test for benzene in a supercell with the
	  rmmdiis
	  eigensolver. This test would have detected the two bugs I fixed
	  previously.

2013-04-07 02:30  xavier

	* [r10300] Implemented periodic boundary conditions for non-cl
	  packed batches.

2013-04-07 04:30  xavier

	* [r10301] Implemented setting periodic boundary condition for
	  non-cl packed
	  batches and domain parallelization.

2013-04-07 12:30  xavier

	* [r10302] Setting the periodic boundary conditions now uses the
	  same MPI copies for the packed and non-packed.

2013-04-07 12:54  xavier

	* [r10303] Removed the definition of the datatypes for copying the
	  periodic
	  points. They are no longer required.

2013-04-07 13:31  xavier

	* [r10304] Improvements and openmp parallelization in the periodic
	  boundary copies.

2013-04-07 16:02  xavier

	* [r10305] Implemented periodic boundary conditions with OpenCL
	  (gamma point only).

2013-04-07 22:10  xavier

	* [r10306] Implementation of periodic boundaries with OpenCL and
	  domain
	  parallelization.

2013-04-07 22:34  xavier

	* [r10307] Fixed a bug in the copy of periodic points.

2013-04-07 23:22  xavier

	* [r10308] Fixed non-cl compilation.

2013-04-08 00:36  xavier

	* [r10309] Fixed some out of bound errors I introduced in [9793].

2013-04-08 01:35  xavier

	* [r10310] Changed the silicon test to used k-points generated by
	  octopus instead
	  of k-points given in the input file. For some reasons the points
	  for a
	  4x4x4 with a 1/2 shift are different from the ones we have in the
	  input file, that were generated with an old version of Octopus.

2013-04-08 13:39  askhl

	* [r10312] remove extraneous message_info

2013-04-08 13:46  askhl

	* [r10313] introduce parameter ArpackInitialTolerance to use a
	  coarse eigensolver convergence criterion in the beginning of an
	  scf cycle. This is done by communicationg rel_dens error from scf
	  to the eigensolver on each iteration. Update complex-scaling test
	  to use this feature

2013-04-08 16:42  joseba

	* [r10314] Code makeup
	  Few documentation

2013-04-09 12:59  joseba

	* [r10315] Deallocated vp%xghost_neigh at the initialization, as is
	  not used anymore in the code
	  Parallelized the check of the number of ghost neighbours. Each
	  process computing a part will result having computed all

2013-04-09 16:02  joseba

	* [r10316] Code makeup: all the logical expressions are now in the
	  same format

2013-04-09 22:26  dstrubbe

	* [r10317] Typo.

2013-04-10 10:25  joseba

	* [r10318] Deleted unused subroutines; never are called.
	  Improved Doxyfile

2013-04-10 10:49  joseba

	* [r10319] Deleted more unused subroutines

2013-04-10 16:02  dstrubbe

	* [r10320] * Commenting out SAFE_(DE)ALLOCATE macros is not good
	  since in some cases they are expanded into multiple lines which
	  may no longer be commented. I think this was the cause of the
	  tigger compilation failure after r10313. You can fix this by
	  inserting extra exclamation marks into the macro.
	  * Removed extra exclamation marks from header.
	  * Unterminated apostrophe.

2013-04-10 16:55  joseba

	* [r10321] Deleted more unused subroutines

2013-04-10 18:19  askhl

	* [r10322] use M_ZERO rather than 0. Include default value in
	  ArpackInitialTolerance parameter documentation. Pass current
	  relative density error from scf to eigensolver on each iteration.
	  (We should use the more general src/hamiltonian/scf_tol.F90
	  eventually)

2013-04-11 01:57  xavier

	* [r10323] * Since the complex scaling module does not have
	  anything to do with the
	  grid, I moved it from grid/ to states/ where I think it belongs.
	  
	  * Improved formatting.
	  
	  * td_m needs to include cmplxscl_m.

2013-04-11 13:27  joseba

	* [r10324] Code makeup: now pv_t has np_global instead of np, just
	  the same as mesh_t. Now np is reserved to the local number of
	  points

2013-04-12 18:55  xavier

	* [r10325] * Improved the output of kpoints printed to static/info.
	  * Added a match for the number of k-points to the silicon test.

2013-04-13 03:43  xavier

	* [r10326] Bugfix: an error in the batch_copy routine caused
	  problems in the
	  rmmdiis eigensolver for spinors. Thanks David for reporting this
	  problem.

2013-04-13 03:44  xavier

	* [r10327] Added a test that would have detected the problem fixed
	  in [10326].

2013-04-13 05:16  xavier

	* [r10329] Improved the interface for converting batch indexes.

2013-04-13 13:52  xavier

	* [r10330] Improved the sorting of k-points, to prevent changes in
	  the order from
	  small differences in numerical calculations.

2013-04-13 16:10  xavier

	* [r10331] * More improvements to the k-point sorting.
	  * Updated test results.

2013-04-13 18:40  xavier

	* [r10332] * K-points are now printed in relative coordinates to
	  the screen and
	  to the restart files.
	  * This commit breaks backwards compatibility for restarting open
	  systems.

2013-04-13 20:09  xavier

	* [r10333] The complex DFT code had introduced an extra field for
	  the imaginary
	  part of the eigenvalues in the 'occs' file, this means that the
	  file
	  was read different depending on the input variable. Since this is
	  a
	  bad idea, the extra field is now always present.
	  
	  This change breaks backwards compatibility of the restart files,
	  if
	  you want to fix an old 'occs' file you need to add a column of
	  zeros
	  by hand after the column of eigenvalues. Compatibility is also
	  broken
	  for complex DFT, since their format was missing a '|' character.

2013-04-14 20:47  xavier

	* [r10334] Now Octopus can use packed batches with k-points.

2013-04-15 03:00  xavier

	* [r10336] * Now the kernels required for the projectors are
	  compiled by the
	  subroutine that calls them.
	  
	  * Started the implementation of opencl support for k-points.

2013-04-15 04:00  xavier

	* [r10337] Projectors with k-points can now be applied with OpenCL.

2013-04-15 14:25  xavier

	* [r10338] * Added a function to apply the k-point phase.
	  * The k-point phase is now allocated and stored for opencl.

2013-04-15 16:28  joseba

	* [r10339] Made vp%np_ghost and vp%np_bndry local. During the
	  initialization have to be global yet.

2013-04-15 17:21  xavier

	* [r10340] Now periodic systems calculation with k-points can be
	  done on the GPU.

2013-04-15 20:45  dstrubbe

	* [r10341] Unused arguments.

2013-04-15 22:13  xavier

	* [r10342] Apparently the preconditioner works better without the
	  k-point phase.

2013-04-16 03:54  dstrubbe

	* [r10343] Widening the profiling label field so things don't get
	  cut off, and making sure the header formatting matches.

2013-04-16 10:41  umberto

	* [r10345] Fixes LB94 NaN in TD runs with adsorbing boundaries.

2013-04-16 13:34  xavier

	* [r10346] There is a problem with the benzene supercell test that
	  is taking too
	  much in the boundary communication. I added some profiling
	  regions,
	  whose results are printed by the test, to try to locate the
	  problem.

2013-04-16 14:51  xavier

	* [r10347] Removed the dummy checks, since they only work with
	  parallel runs.

2013-04-16 17:11  joseba

	* [r10348] * Made vp%np_ghost_neigh deallocated in the
	  initialization part. This becomes a huge array with many
	  processes; e.g. with 8192 domains will have 256 MiB. Instead two
	  arrays equals to the number of domain processes are exported.
	  * Few documentation
	  * rank+1 => vp%partno

2013-04-16 17:14  xavier

	* [r10349] Removed the forall loops in the communication of the
	  periodic
	  boundaries. Lets see if this fixes the performance problem with
	  the
	  pgi "compiler".

2013-04-16 18:34  xavier

	* [r10350] Added the LCAOMaximumOrbitalRadius variable, that
	  removes from the
	  LCAO orbitals that are to large. The default value is 20.0.

2013-04-16 20:36  xavier

	* [r10351] * Added the option of rescaling the atomic orbitals for
	  LCAO.
	  * Fixed the documentation for LCAOMaximumOrbitalRadius.

2013-04-16 23:17  dstrubbe

	* [r10352] Adding a test for quadrupole moments, which are not
	  tested anywhere else I could see.

2013-04-17 01:12  dstrubbe

	* [r10354] * Renamed TDDipoleLmax to TDMultipoleLmax, since we have
	  multipoles beyond dipoles whenever this is greater than 1.
	  * A needless restriction to multipoles of order < 4 (or < 5,
	  according to documentation...) was being enforced. There does not
	  seem to be any maximum we need to check for. I ran with lmax = 7
	  with no problem.

2013-04-17 01:19  dstrubbe

	* [r10355] Adding forgotten specification to test. Fortunately it
	  is only in the long run so it didn't fail yet!

2013-04-17 02:41  xavier

	* [r10356] Fix for orthogonalization with complex functions.

2013-04-17 03:42  xavier

	* [r10357] Fixed opencl compilation.

2013-04-17 03:52  dstrubbe

	* [r10358] Cleaned up documentation and setting of defaults
	  regarding TDOutput variable.

2013-04-17 10:23  joseba

	* [r10359] * Made xghost_neigh only be used in the initialization.
	  * Removed a counter array of size PxP.
	  * Added missing deallocations.
	  * Removed a variable

2013-04-17 10:57  joseba

	* [r10360] Actually, xghost_neigh_partno is the same as xghost. So
	  is removed

2013-04-17 11:28  joseba

	* [r10361] Previous commit -r 10360 is not passing all the tests,
	  reverting changes.
	  Sorry

2013-04-17 13:13  xavier

	* [r10362] * Added a message at the end of the run warning (and
	  hopefully
	  frightening) users about experimental features.

2013-04-17 14:29  xavier

	* [r10363] * Now the error messages for experimental variables
	  points to the
	  website and does not mention the ExperimentalFeatures variable.
	  
	  * The url form experimental features is given in the
	  documentation for
	  the variable.

2013-04-17 20:51  dstrubbe

	* [r10364] Unused variables.

2013-04-17 21:49  dstrubbe

	* [r10365] Write the command to matches.sh before execution, for
	  help in debugging if the command fails.

2013-04-18 11:01  joseba

	* [r10366] Get rid of xghost_neigh of size PxP. Instead a two
	  vector of size P are used and an extra communication step is
	  performed

2013-04-18 18:33  dstrubbe

	* [r10369] k-points unit removed since the reduced coords since
	  r10332 are dimensionless.

2013-04-18 18:55  dstrubbe

	* [r10370] Actually, there is no point in writing the 'k-points'
	  line at all when we do not have a unit.

2013-04-18 19:04  dstrubbe

	* [r10371] Enabling all output from unocc mode.

2013-04-18 19:23  dstrubbe

	* [r10372] Updating documentation about specifying kpoints
	  manually, given r10332.

2013-04-19 09:59  joseba

	* [r10373] Deleted never used subroutines: mf_copy,
	  mf_partial_integrate and mf_interpolate

2013-04-19 14:28  xavier

	* [r10374] Added an alias for the experimental features url. This
	  shortens the
	  url and allows to keep the link updated if we change the website
	  in
	  the future.

2013-04-19 14:29  joseba

	* [r10375] With this change doxygen compiles without stoping in any
	  error.
	  Tested with 1.7.6.1, 1.8.1 and 1.8.3.1

2013-04-19 21:13  dstrubbe

	* [r10380] A deallocation failed in the finemesh test because of an
	  attempt to deallocate zrho even when not using complex scaling.

2013-04-19 21:21  dstrubbe

	* [r10381] The finemesh test was checking the first 4 eigenvalues 4
	  times, instead of checking eigenvalues 1-16.

2013-04-19 22:34  xavier

	* [r10382] The atom coloring algorithm was not working due to last
	  changes.

2013-04-20 22:13  xavier

	* [r10384] Added output of geometries in OpenSCAD format. This
	  format can be
	  opened by the program of the same name.

2013-04-21 15:59  xavier

	* [r10385] Improved the openscad geometry files to make them
	  simpler to edit.

2013-04-21 20:33  dstrubbe

	* [r10386] Using LCAOMaximumOrbitalRadius to restore results for
	  Casida test.

2013-04-21 22:23  dstrubbe

	* [r10387] Standardizing indentation (pertaining to the placement
	  of 'contains').

2013-04-21 22:45  dstrubbe

	* [r10388] A few trivial fixes to formatting, comments, Doxygen.

2013-04-21 22:57  xavier

	* [r10389] Initial dirty implementation of output of fields with
	  OpenSCAD.

2013-04-21 23:05  dstrubbe

	* [r10390] Some trivial cleaning.

2013-04-21 23:11  dstrubbe

	* [r10391] Fixing indentation.

2013-04-21 23:14  dstrubbe

	* [r10392] Adding a reference.

2013-04-22 00:15  dstrubbe

	* [r10393] I guess chum_x86_64_pgi wants messages_m to compile this
	  file.

2013-04-22 10:39  joseba

	* [r10395] Rearrangement of the Doxygen stuff:
	  * With only one Doxyfile the entire documentation is created
	  (with the newest version it needs only few minutes)
	  * Updated Doxyfile to the 1.8.3 version
	  * Deleted accordingly index.html and menu.html
	  * Updated the script of the creation
	  * Updated svn:ignore properties

2013-04-22 15:16  umberto

	* [r10396] Profiled minimum density values for lb94 functional.
	  The value previously set to 5e-13 is now 1e-14.
	  I haven''t checked against an extensive test set so the threshold
	  value may not be definitive.

2013-04-22 16:06  micael

	* [r10397] * Removed the fft_alpha component from the simulation
	  box. This is now read in the Poisson solver, where it belongs.
	  This also breaks backward compatibility of the restart files. To
	  fix it, one just needs to add or remove one line in the correct
	  place from the "mesh" file.

2013-04-22 17:23  dstrubbe

	* [r10398] The TDDeltaStrengthMode was being written out for all
	  calculation modes. This is confusing for non-td calculations,
	  where it is not going to be used anyway, and is unnecessary for
	  td, since more complete information about the kick is written out
	  later.

2013-04-22 20:57  dstrubbe

	* [r10399] Fixing output of the wrong variable.

2013-04-22 21:38  dstrubbe

	* [r10400] Filtering out symmetry operations with fractional
	  translations when the system is a supercell, in accordance with
	  treatment by Quantum ESPRESSO. This is to be sure the operations
	  form a group.

2013-04-23 01:18  dstrubbe

	* [r10401] Checking that k-point weights are positive, and
	  renormalizing them to sum to 1.

2013-04-23 01:22  dstrubbe

	* [r10402] * unocc should say what kind of wavefunctions it is
	  using.
	  * Sternheimer should not say it is SCF in the corresponding
	  message.

2013-04-23 04:14  xavier

	* [r10403] Added a check for the size of the arrays passed to
	  io_function_output_global.

2013-04-23 12:51  xavier

	* [r10404] Some style changes:
	  * Added () to some subroutines without arguments.
	  * Using the name 'target' for a variable is a bad idea, since
	  this is
	  a Fortran keyword. Renamed it to oct_target.

2013-04-23 13:01  joseba

	* [r10405] * If the system is not periodic the vp%bndry vector
	  becomes local to the running process, instead of being of size
	  vp%total
	  * Also xbndry becomes local
	  * np_ghost_neigh is used only once
	  * Small changes

2013-04-23 13:11  xavier

	* [r10406] * Renamed a single letter variable.
	  * Added a progress bar to the optimal control propagation.

2013-04-23 13:40  joseba

	* [r10407] Changed single letter variable i to index in
	  nl_operator_t
	  Improved a doxygen comment

2013-04-23 14:12  micael

	* [r10408] * Restored header that was once again delete from
	  scf/rdmft.F90. Added svn:keywords to this file.

2013-04-23 15:59  joseba

	* [r10409] * xghost is only local
	  * Deleted xghost_neigh_partno, xghost_neigh_back and
	  np_ghost_neigh_back. The first two are only used at the
	  initialization and the third one is equal to rcounts

2013-04-23 16:16  dstrubbe

	* [r10410] Disabling fractional translation for a supercell does
	  not really need to be a warning.

2013-04-24 12:48  xavier

	* [r10411] Implemented the marching cubes algorithm to generate
	  isosurfaces in
	  openscad format. The surfaces are very smooth now. In fact, I
	  think
	  this algorithm could be useful to do more precise integration
	  over
	  subregions of the grid.

2013-04-24 18:35  xavier

	* [r10412] Impromevents in openscad geometry output.

2013-04-25 02:13  dstrubbe

	* [r10413] unocc mode has no business writing a density. It should
	  already be present from the gs calculation, and can easily get
	  corrupted if unocc has problems.

2013-04-25 02:35  dstrubbe

	* [r10414] Clarifications to Poisson solver info.

2013-04-25 03:37  xavier

	* [r10415] Defined a polyhedron object to improve the openscad
	  output.

2013-04-25 03:47  dstrubbe

	* [r10416] Blocking em_resp calculations where the k-points were
	  reduced by symmetries, because some more sophisticated operations
	  need to be performed to get the right answer for a tensor, rather
	  than a scalar such as total energy.

2013-04-25 09:49  umberto

	* [r10417] Modified XC tail correction to dump (debug) data only in
	  in_debug_mode.

2013-04-25 11:59  joseba

	* [r10418] * Separated xlocal and xlocal_vec; np_local and
	  np_local_vec; and, local and local_vec. Thus, we can identify the
	  local and global usage of those vectors
	  * Improved documentation

2013-04-25 12:08  acastro

	* [r10419] Bug fixed: one of the optimization modes of optimal
	  control (hhg) was not
	  working for gradient-less optimization methods.

2013-04-25 12:53  xavier

	* [r10420] All the triangles associated to a cube are stored in a
	  single
	  polyhedron.

2013-04-25 15:57  joseba

	* [r10422] * Deleted list vector of size np_global. Actually, is
	  the same vector as vp%local_vec
	  * A small change in Doxygen comment of Lapack

2013-04-25 16:02  joseba

	* [r10423] Deleted variables that are not used any longer, due to
	  previous commit

2013-04-25 20:14  dstrubbe

	* [r10430] Fixing an intent.

2013-04-25 21:04  dstrubbe

	* [r10431] Consolidating unneeded if.

2013-04-26 11:01  micael

	* [r10432] * Bug fix: an index was wrong in the Poisson solver for
	  3d periodic systems when looping over the cube points. This only
	  affected calculations that had different sizes along the y and z
	  directions.

2013-04-26 15:23  umberto

	* [r10434] Added PFFT tests to the photo_electron set.

2013-04-26 19:12  umberto

	* [r10435] Beginning implementation of PNFFT support.

2013-04-27 02:10  dstrubbe

	* [r10436] * Removing unused 'geo' argument from restart_write.
	  * Better memory management of 'zrho_fine' in restart_write.

2013-04-27 02:26  dstrubbe

	* [r10437] * Fixing formatting of ./configure --help with
	  AS_HELP_STRING, for GSL.
	  * Removing mistaken AC_ARG_ENABLE lines in configure.ac: they are
	  for --enable strings, not --with strings, and fortunately did not
	  seem to show up in ./configure --help anyway.

2013-04-27 02:31  dstrubbe

	* [r10438] Fixing indentation in m4 scripts, and formatting of PFX.

2013-04-27 02:58  dstrubbe

	* [r10439] * Cleaning up nfft.m4.
	  * Undoing orphaned output from 'checking' in p(n)fft.m4.

2013-04-27 03:01  dstrubbe

	* [r10440] * Implemented reading of density from restart info.
	  * unocc mode now reads the density, and only constructs it from
	  the wavefunctions if the density could not be read. I think this
	  will enable nscf calculations with a different k-grid from scf.

2013-04-27 03:10  dstrubbe

	* [r10441] Fixes for restart_read_rho with fine mesh.

2013-04-27 03:44  dstrubbe

	* [r10442] * density_calc in unocc for complex-scaling case too.
	  * Unused variables.
	  * Doxygen comment.

2013-04-27 03:56  dstrubbe

	* [r10443] Removing meaningless configuration option --with-fft,
	  which is a relic of FFTW2 support, long-ago decommissioned. If
	  this was set to anything other than 'fftw3', the configure script
	  would not merely fail to find FFTW, but would crash with a syntax
	  error.

2013-04-27 05:49  dstrubbe

	* [r10444] Labeling the initialization output of the Poisson solver
	  on the fine mesh.

2013-04-27 06:03  dstrubbe

	* [r10445] * Removing unused variables from fft.m4 and td.F90.
	  * PUSH/POP's.

2013-04-27 13:37  xavier

	* [r10446] * Simplified the interface for geometry_write_xyz and
	  geometry_write_openscad.
	  * The openscad output of functions now includes the geometry.

2013-04-27 21:09  dstrubbe

	* [r10450] "Crank-Nicolson" was systematically misspelled as
	  "Crank-Nicholson" (compare
	  http://link.springer.com/article/10.1007%2FBF02127704). I have
	  removed the extra "h" everywhere. The input options using
	  'nicholson' still exist as synonyms to the corrected ones with
	  'nicolson'.

2013-04-27 21:13  dstrubbe

	* [r10451] * Unused variables.
	  * Subroutine calls missing parentheses.

2013-04-27 21:40  dstrubbe

	* [r10453] Changing input variables in testsuite from Nicholson to
	  Nicolson.

2013-04-27 23:33  dstrubbe

	* [r10456] Adding some ground-state matches for optimal-control
	  tests.

2013-04-28 01:46  dstrubbe

	* [r10457] Typo, correcting and adding PUSH/POP's, parentheses for
	  subroutines, formatting.

2013-04-28 02:11  dstrubbe

	* [r10458] More informative error message.

2013-04-28 02:13  dstrubbe

	* [r10459] Missing files for testsuite installation.

2013-04-28 02:15  dstrubbe

	* [r10460] Adding a test for the Crank-Nicolson propagator.

2013-04-28 16:51  dstrubbe

	* [r10462] Running TDPropagator = crank_nicolson with domain/state
	  parallelism never converges currently. I am changing the test to
	  do only domain parallelism, which runs but has a number of
	  warnings and some resulting discrepancies in the matches,
	  compared to state parallelism and serial which both agree fine.
	  This propagator seems to have some bugs.

2013-04-28 17:18  dstrubbe

	* [r10463] Removing the warning about unconverged occupied states
	  in each iteration of unocc mode (added r10258), and corresponding
	  writing of all the states in the output, because it is very
	  common for this to happen in early iterations; it is only a
	  problem at the end. Also, the possibility of corrupting the gs
	  data is gone, since unocc now uses the density from gs, which it
	  will not modify. Now, there is only a warning at the end about
	  unconverged occupied states, and the messages in
	  static/eigenvalues do not speak of 'unoccupied states', but just
	  of 'states', since they are dependent on convergence of all the
	  states.

2013-04-28 17:33  dstrubbe

	* [r10464] * Adding SPARSKIT Crank-Nicolson test. It is currently
	  disabled since it fails due to a runtime error.
	  * Adding missing final newline.

2013-04-29 13:38  joseba

	* [r10465] * Created a local version of vp%part vector
	  * Added the infrastructure needed by MPI_Alltoall to pv_t, almost
	  copied from mesh_batch_inc

2013-04-29 14:42  joseba

	* [r10466] * Backward map is not used anymore in the
	  mesh_batch_exchange_points. Consequently, vp%local_vec is not
	  used anymore (outside par_vec_m) if a parallel Poisson solver is
	  used.
	  * Simplified exchange points subroutine.

2013-04-29 15:41  joseba

	* [r10467] * Added another part local vector
	  * Used those in mesh_batch

2013-04-29 16:59  dstrubbe

	* [r10468] libxc: Fixing dependency that was poorly written (by me)
	  and could cause "make -j install" to fail.

2013-04-29 17:05  umberto

	* [r10469] Fixed crash with PFFT test when parallel writing pes wfs

2013-04-29 17:09  umberto

	* [r10470] correct dipole moment when complex scaling

2013-04-29 17:14  joseba

	* [r10471] Corrected POP/PUSH_SUBs

2013-04-29 17:33  dstrubbe

	* [r10472] * Making a real -> integer conversion explicit.
	  * Doxygen comments.

2013-04-29 17:54  dstrubbe

	* [r10473] * Removed now-unused argument 'geo' from
	  oct_prop_output.
	  * Doxygen comments.
	  * Making some real->complex conversions explicit.
	  * Fixing some use of floats where integers seem to have been
	  meant.
	  * Other unused variable ist2 in cpmd_inc.
	  * Vector expression.

2013-04-29 19:27  dstrubbe

	* [r10474] Fixing critical bug in lr_calc_current. A tautologous
	  initialization "np = NP" was not caught when the NP macro was
	  removed in r5114 (2009!), leaving np uninitialized, so probably
	  the arrays in this function were not allocated at all.
	  Fortunately, I don't think this function has been used much.

2013-04-29 19:45  dstrubbe

	* [r10475] * Explicit type conversions, and more appropriate
	  initialization type.
	  * Uncapitalizing variable names which seem to be relics of the
	  NP, NP_PART macros.

2013-04-30 22:02  nitsche

	* [r10477] Rewrote Crank-Nicolson propagator for SPARSKIT to fix
	  the problem with different times found by David. It also supports
	  the Complex scaling. If one wants to use it, 'SPARSKITSolver =
	  sk_bcg' should be added to the input file. The default sk_cg will
	  not work.

2013-05-01 02:16  dstrubbe

	* [r10478] Doxygen comments.

2013-05-01 02:18  dstrubbe

	* [r10479] * Setting default for SPARSKITSolver to sk_bcg, as
	  recommended by Danilo, since this one actually works in the
	  propagator, unlike sk_cg.
	  * All but one of the other SPARSKIT variables had incorrect
	  defaults listed.
	  * Clarified what the default -1 means anyway for SPARSKITIterOut.

2013-05-01 02:23  dstrubbe

	* [r10480] Updating the reference values for the SPARSKIT
	  propagation test (only slightly different from the native
	  Crank-Nicolson implementation), and enabling it (only when
	  SPARSKIT is linked, of course).

2013-05-01 03:15  dstrubbe

	* [r10481] td_zop and td_zopt don't need to be inside #ifdef
	  HAVE_SPARSKIT: while they are only being used with SPARSKIT, they
	  do not call it and can be compiled fine regardless.

2013-05-01 09:32  joseba

	* [r10482] Corrected a bug introduced by myself in r9496 that
	  prevented to run with only states parallelization and PFFT (now
	  also LibISF)

2013-05-01 10:19  joseba

	* [r10483] Partly correcte the bug introduced by myself in r10466
	  and reported by David.
	  Still working
	  
	  Thanks David!

2013-05-01 19:56  dstrubbe

	* [r10484] Making the module-scope global work arrays for sparskit
	  live instead in the sparskit object, for clearer information
	  flow.

2013-05-01 20:00  dstrubbe

	* [r10485] Corrected half of the error caused by r10466 in the
	  r10483 commit and the other correction is here. -- commit on
	  behalf of Joseba
	  At least in lascar corrected the error.

2013-05-01 22:11  dstrubbe

	* [r10486] I think this fixes the failure of the Crank-Nicolson
	  (non-SPARSKIT) propagator when parallel in domains. The problem
	  was that collective operations for dot products and norms were
	  not being defined. This is the same problem that was fixed for
	  QMR in the context of Sternheimer in r4811. Danilo, I believe
	  that ob_lippman_schwinger.F90 still suffers from the same
	  problem.

2013-05-02 08:54  joseba

	* [r10488] Corrected the error caused by r10466, intented to
	  correct in r10485 (it had to be changed a different line).

2013-05-02 09:19  nitsche

	* [r10489] Fixed problems with the QMR solver when parallel in
	  domains for Lippmann-Schwinger and Open-Boundary propagator
	  pointed out by David. I think there are still some issues left
	  related to parallel in domains, but the parallelization strategy
	  should be k-points as it is trivial.

2013-05-02 10:43  joseba

	* [r10490] Apparently mesh%vp%ghost(mesh%vp%xghost + ii - 1) and
	  mesh%vp%xghost + ii - 1 are the same

2013-05-02 15:48  umberto

	* [r10491] Partially reverted changes from r10473 due to mysterious
	  behavior of array assignment. This should fix PFFT pes tests.

2013-05-02 15:49  umberto

	* [r10492] Reviewed pfft and pnfft autoconf scripts according to
	  David suggestions.

2013-05-02 17:35  umberto

	* [r10493] The "mysterious" behavior was not mysterious at all.
	  The problem with r10473 is that is misses the PFFT index mapping
	  1->3
	  2->1
	  3->2
	  

2013-05-02 19:25  dstrubbe

	* [r10494] The SPARSKIT propagator does not work parallel in
	  domains. (I believe it is for the reason as discussed in r10486,
	  i.e. the dot product and norm being done by SPARSKIT is not
	  collective.)

2013-05-03 02:46  xavier

	* [r10495] Optimization and omp parallelization of batch_axpy.

2013-05-03 14:52  dstrubbe

	* [r10496] Loosening tolerances for vib_modes in casida test, since
	  they occasionally fail. This suggest a problem that needs to be
	  investigated in more detail.

2013-05-03 15:11  xavier

	* [r10497] Fixed the error in openmp parallelization in my last
	  commit.

2013-05-03 15:19  xavier

	* [r10498] * Added a profiling region for the calculation mode.
	  * Missing POP_SUB.
	  * Converted output to new format.

2013-05-03 16:07  joseba

	* [r10499] Updated the description of the restart_read_function.
	  Now each process never has the entire function

2013-05-03 16:51  dstrubbe

	* [r10500] The Bader analysis was broken since mesh%vol_pp was made
	  allocated for all the points only for curvilinear. Now it is
	  fixed with mesh%volume_element.

2013-05-03 17:59  dstrubbe

	* [r10501] Adding some units to Bader output.

2013-05-03 18:33  dstrubbe

	* [r10502] * Adding a test for ETSF_IO output. The files are
	  binary, so we cannot test anything about them, but at least we
	  can check that this run finished without crashing.
	  * Comment on what can be output with ETSF_IO.

2013-05-03 18:56  dstrubbe

	* [r10505] Removing unterminated apostrophe.

2013-05-03 21:31  dstrubbe

	* [r10507] * Adding a match type for file size.
	  * Using it to test ETSF_IO outputs.

2013-05-03 21:34  dstrubbe

	* [r10508] Doxygen comments.

2013-05-03 21:41  dstrubbe

	* [r10510] Let's output some more stuff in the output test.

2013-05-04 00:35  xavier

	* [r10512] Added a couple of profiling regions.

2013-05-04 00:51  dstrubbe

	* [r10513] Using interface instead of explicit preprocessing.

2013-05-04 01:00  dstrubbe

	* [r10514] * Bugfix: the 'average' column for infrared activity in
	  vib_modes was in fact the sum. Corrected corresponding test
	  match.
	  * Linear-response vib_modes assumes real wavefunctions in various
	  places.

2013-05-04 01:01  xavier

	* [r10515] OpenMP parallelization of the spline Bessel transform.

2013-05-04 01:11  dstrubbe

	* [r10516] * Adding appropriate units for IR intensities.
	  * Generalizing output to arbitrary number of dimensions.

2013-05-04 02:19  xavier

	* [r10517] Bugfix: vol_pp(1) replaced by volume_element.

2013-05-04 02:23  xavier

	* [r10518] Reverted the omp parallelization of the bessel
	  transform. It seems it
	  causes problems with ifort.

2013-05-04 02:39  xavier

	* [r10519] * Added the default in the description of a variable.
	  * Changed messages to new format.

2013-05-04 03:34  dstrubbe

	* [r10520] Restoring domain/states parallelization for native
	  Crank-Nicolson test.

2013-05-04 14:06  xavier

	* [r10521] Missing opencl_finish calls.

2013-05-04 14:18  xavier

	* [r10522] * Removed the profiling region for CL kernel run.
	  * Added a profiling region for mesh_batch_nrm2.

2013-05-04 15:37  dstrubbe

	* [r10523] SPARSKIT propagator is now working with domain
	  parallelization, after making the 'distdot' function use
	  mf_dotp_aux.

2013-05-04 16:07  dstrubbe

	* [r10524] * SPARSKIT is only in double precision, so it is
	  incorrect to define distdot with FLOAT in the single-precision
	  case.
	  * Initializing mesh_aux to null, and then adding an ASSERT for it
	  to be associated in dotp_aux, for safety.
	  * Adding some comments.

2013-05-04 18:49  dstrubbe

	* [r10525] Centralizing the auxiliary dot product and norm routines
	  from the linear solver module to mesh_function_m, where a
	  basically identical dotp function existed already.

2013-05-04 18:58  dstrubbe

	* [r10526] Propagators no longer use their own dotp and nrm2
	  functions. Also, removing some routines used only privately from
	  the public list.

2013-05-04 19:19  dstrubbe

	* [r10527] Open boundaries uses the aux mesh functions now.

2013-05-04 20:14  xavier

	* [r10529] Optimization: The norm calculation for the rmmdiis
	  eigensolver is now done by
	  mesh_batch_dotp_vector instead of mesh_batch_nrm2.

2013-05-04 21:09  dstrubbe

	* [r10530] Removing explicit array bounds from routines to avoid
	  array temporaries.

2013-05-04 21:22  dstrubbe

	* [r10531] Bugfix to r10526, which accidentally removed a call to
	  mesh_init_mesh_aux.

2013-05-04 22:00  dstrubbe

	* [r10532] Reading and writing the other half of a matrix avoids
	  array temporaries.

2013-05-04 22:19  dstrubbe

	* [r10533] Getting rid of more array temporaries.

2013-05-05 02:35  dstrubbe

	* [r10534] Purging more array temporaries.

2013-05-05 03:45  dstrubbe

	* [r10535] More array temporaries decommissioned.

2013-05-05 15:42  dstrubbe

	* [r10536] Correction to comments: our geneigensolve routines are
	  solving specifically the A*x=lambda*B*x form.

2013-05-05 16:25  dstrubbe

	* [r10537] * Comments, doxygen and otherwise.
	  * Organized argument list and made 'inout' variables just 'out'
	  since their input values are not used.

2013-05-06 01:52  dstrubbe

	* [r10538] Currently it is possible to run gs with complex
	  wavefunctions (e.g. via ForceComplex = true), and then read them
	  in for calculation with another mode, such as vib_modes, which
	  happens to be expecting real wavefunctions. In this case, the
	  restart will just result in the real part of the complex
	  wavefunctions being read, which of course will lead to incorrect
	  results. Now, the restart file 'wfns' will identify them as real
	  or complex, and this will be checked when reading restart for a
	  calculation expecting real wavefunctions. To avoid breaking
	  backward compatibility, failure to find this tag in 'wfns' will
	  result in a warning, but not an error.

2013-05-06 11:37  umberto

	* [r10539] Rationalized autoconf fft, pfft, and pnfft.
	  * removed mpifftw-prefix option.
	  * fft-lib is now turned into prefix with an optional fft-include
	  * added a test for fftw3_mpi for more flexibility
	  * moved @LIBS_FFT@ to core_LIBS where it should belong
	  
	  Setting
	  --with-pfft-prefix=$PFFT_PREFIX \
	  --with-fft-prefix=$FFT_PREFIX \
	  --with-pnfft-prefix=$PNFFT_PREFIX
	  
	  should now allow to compile with P/N/FFT libraries

2013-05-06 16:35  umberto

	* [r10540] No need to check for include 'fftw3.f' which actually
	  can cause problems.
	  Include check is done only in the fftw3_mpi part.

2013-05-06 16:54  umberto

	* [r10541] Reverted from --with-fft-prefix to --with-fft-lib.
	  The option is still treated as prefix.

2013-05-06 17:33  dstrubbe

	* [r10542] The libfm m4 macro was using cpp syntax for an include
	  file, but the way the test program was handled would not be
	  preprocessed, so warnings were being generated. Now we use the
	  Fortran built-in way of including files.

2013-05-06 17:47  dstrubbe

	* [r10543] Missing PUSH/POP's.

2013-05-06 19:16  umberto

	* [r10544] Try FCFLAGS only when checking for ffw3_mpi.
	  This should fix PGI configure fail.

2013-05-06 20:50  dstrubbe

	* [r10545] For some reason, we have been using the term
	  'Gram-Schmidt' to refer to orthogonalization in general. Seems to
	  date back to r5549. In fact, none of the methods that can be set
	  by StatesOrthogonalization are Gram-Schmidt any more: there is
	  'modified Gram-Schmidt', but the ones called gram_schmidt and
	  par_gram_schmidt are actually Cholesky decomposition.
	  
	  * Clarified documentation regarding meaning and range of validity
	  of orthogonalization methods.
	  * Warnings and errors refer more specifically to the actual
	  method being used.

2013-05-06 22:28  dstrubbe

	* [r10546] * The orthogonalization methods called Gram-Schmidt
	  which are actually Cholesky will now be named accordingly. (I
	  left the old options to StatesOrthogonalization as synonyms
	  though.)
	  * Doxygen comments.

2013-05-06 22:34  dstrubbe

	* [r10547] It seems I failed to commit the deletion part of the
	  moves in the previous commit.

2013-05-06 22:52  dstrubbe

	* [r10548] Let's test the complex QR orthogonalization too.

2013-05-06 23:14  dstrubbe

	* [r10549] Adding tests for parallel Cholesky orthogonalization.

2013-05-07 00:01  dstrubbe

	* [r10550] Fixing memory leak in symmetries_finite: improper axes
	  were not being deallocated. This was showing up in the valgrind
	  buildslave, for finite_systems_3d/20-eigensolver. Apparently that
	  is the only test with a structure possessing an improper axis.

2013-05-07 08:41  umberto

	* [r10551] reverted changes on fft.m4.

2013-05-07 08:59  umberto

	* [r10552] Rolled back to previous pfft configure script.
	  Probably --with-mpifftw-prefix is not strictly necessary since
	  fftw3.f constants are already included in the fftw_m module
	  anyways. Nevertheless I would like to keep it for the time it
	  takes to implement the pnfft module.
	  Also --with-mpifftw-prefix is optional and the test now tries to
	  figure out as much as possible from --with-fft-lib option.
	  A minimal set of configure options would be:
	  --with-fft-lib=$FFTW_PREFIX/lib/libfftw3.a
	  --with-pfft-prefix=$PFFT_PREFIX
	  

2013-05-07 21:51  dstrubbe

	* [r10555] Correction of references to dot product functions.

2013-05-08 03:54  dstrubbe

	* [r10556] * Let's write a warning in standard output as well as
	  the 'static/info' file if the eigenvectors are not converged in
	  scf.
	  * The corresponding warning in unocc was only looking at the
	  k-points held by the local process, so I think that would result
	  in the warning being written only if node 0 had the unconverged
	  states. Now this is fixed.

2013-05-08 10:40  micael

	* [r10557] *) Some cleaning in cube_init. This routine should not
	  need to know what is happening in the PES module or what other
	  parallelization modes are being used.

2013-05-08 10:46  micael

	* [r10558] * Reverted unintended changes.

2013-05-08 16:11  joseba

	* [r10559] Added the support to compile with ParMETIS. Copied from
	  DUNE project (GPL licence) http://users.dune-project.org/ with
	  small changes
	  Needs cleaning

2013-05-08 16:40  joseba

	* [r10560] Added header and ID.
	  Deleted unused stuff

2013-05-08 16:51  joseba

	* [r10561] Properly added the ID

2013-05-08 18:56  xavier

	* [r10562] Added some operation counts.

2013-05-09 10:18  umberto

	* [r10563] Reformatted nfft info output

2013-05-10 01:21  xavier

	* [r10564] Printing of information about the blocks of states.

2013-05-10 04:28  dstrubbe

	* [r10565] Better error-handling for ETSF_IO: its native
	  error-handling routine writes to standard output for some reason,
	  so I copied it here, and made it write to standard eror, and only
	  root write.

2013-05-10 08:28  micael

	* [r10566] * Removed genetic algorithm method to generate the mesh
	  partition.

2013-05-10 08:31  micael

	* [r10567] * Removed unused function "tranlate_point".

2013-05-10 10:20  micael

	* [r10568] * Removed unused components from partition_t.

2013-05-10 13:34  micael

	* [r10569] * Only the root node should output the DOS.

2013-05-10 13:48  joseba

	* [r10570] Implemented ParMETIS partition.
	  For the moment is using entire vector to create the local ones.
	  Once partition is calculated locally is gathered to continues as
	  in METIS

2013-05-10 16:44  dstrubbe

	* [r10571] Adding interface for oct_search_file_lr, and making one
	  of its pointer arguments const.

2013-05-10 16:54  dstrubbe

	* [r10572] Spelling.

2013-05-10 18:28  dstrubbe

	* [r10573] * Comments on why we cannot use intent's for
	  calc_point_ng.
	  * Interface for oct_wfs_list.

2013-05-11 20:40  dstrubbe

	* [r10574] Removing PUSH/POP's from some very frequently called
	  OpenCL and batch routines.

2013-05-11 23:07  dstrubbe

	* [r10575] Reverting accidental change in r10574.

2013-05-11 23:23  dstrubbe

	* [r10576] Removing PUSH/POP's from another routine called too
	  frequently.

2013-05-11 23:25  dstrubbe

	* [r10577] Initializing outp%how to an illegal value, so that it
	  can later be checked for having been set properly.

2013-05-12 01:38  dstrubbe

	* [r10578] Bugfix to r10577: I guess -1 by two's complement is
	  equivalent to having all bits set in the flag OutputHow. This
	  caused runtime errors for most of the slaves due to an attempt to
	  perform ETSF_IO output when the library is not linked, in almost
	  all the tests.

2013-05-12 18:38  dstrubbe

	* [r10579] * Reducing EigensolverTolerance for lobpcg test as it
	  could fail sometimes with a small discrepancy with ifort 13.
	  * Correcting the name of the molecule involved.

2013-05-12 21:50  dstrubbe

	* [r10580] TheKS inversion test could fail when writing final
	  output, with 50% probability, if compiled with MPI, because there
	  was a call to MPI_Barrier with an unitialized communicator (if <
	  0, the call was skipped, that is the only reason it ever worked).
	  The problem is that the aux_st states object is only partly
	  initialized.

2013-05-12 22:14  dstrubbe

	* [r10581] Symmetries are not used with a user-defined k-grid.

2013-05-12 23:14  dstrubbe

	* [r10582] All match commands in the testsuite now filter for only
	  reasonable numeric characters, and also NaN (or nan) is now
	  included too, which would otherwise show up as blank in the
	  results.

2013-05-13 00:57  dstrubbe

	* [r10583] Restoring a PUSH/POP removed in r10574. Somehow this
	  made periodic_systems/05-lithium.test fail on chum_x86_64_intel.
	  Also, fixed a typo.

2013-05-13 01:18  dstrubbe

	* [r10584] Fix to r10581: line was in the wrong place, needs to be
	  only if user-defined block is present.

2013-05-13 07:31  marques

	* [r10585] Bug found by Toon Verstraelen fixed.

2013-05-13 15:41  joseba

	* [r10590] xadj_size is equal to lsize(ipart), so the first one is
	  removed

2013-05-14 18:29  dstrubbe

	* [r10591] Fix to r10577, r10578: better way to make sure outp%how
	  is initialized, and avoiding valgrind error 'Uninitialised value
	  was created by a stack allocation' coming from trying to set it
	  in declaration.

2013-05-14 20:24  dstrubbe

	* [r10592] Fix to memory leak in optimal control: missing calls to
	  parse_block_end.

2013-05-14 20:27  dstrubbe

	* [r10593] Fixing memory leak in optimal control:
	  controlfunction_copy now calls end rather than nullify to make
	  sure the old one is deallocated (there were many loops containing
	  copies but no ends), and controlfunction_copy is made safe to
	  call even on a nullified object.

2013-05-14 20:30  dstrubbe

	* [r10594] Fixing memory leak in optimal_control: par_ was never
	  ended. Also, removing some controlfunction_end calls, no longer
	  necessary since this is now included in controlfunction_copy.

2013-05-15 13:42  umberto

	* [r10595] (Re)Introducing TDFreezeHXC input variable to select
	  hartree and exchange-correlation potential freeze during time
	  evolution.

2013-05-15 14:48  joseba

	* [r10596] Added support for METIS 5 as is Free Software, Apache
	  License 2.0
	  * Has to be compiled for example:
	  --with-metis="METIS_INSTALATION"
	  * For the moment ---disable-metis should be also added (not to be
	  confused with version 4 included here)

2013-05-15 18:24  dstrubbe

	* [r10601] Removing keywords from call to BerkeleyGW library, since
	  the renaming of one of the argument names there between versions
	  can cause compilation failure.

2013-05-16 12:47  joseba

	* [r10602] Added "multilevel recursive bisection" to METIS 5
	  Deleted unused variable
	  Selected METIS as default aslo if METIS 5 is compiled

2013-05-16 15:25  joseba

	* [r10603] Added METIS-5.1.0 version into our code. Still has to be
	  compiled separately through CMake

2013-05-16 16:09  dstrubbe

	* [r10604] Fixed oct-center-geom test, which was always being
	  skipped with message "No valid executable found for
	  ../../testsuite/components/14-center-geom.test". I think this was
	  because it could not respond to the query for options in the perl
	  script. Now it is setup like other utility tests, though this one
	  lacks a main octopus(_mpi) run.

2013-05-16 16:10  dstrubbe

	* [r10605] Forgotten word.

2013-05-16 16:50  joseba

	* [r10607] We don't need the previous makefile

2013-05-16 17:09  joseba

	* [r10608] We are not going to use CMake

2013-05-16 17:12  joseba

	* [r10609] Removing more file from CMake that we don't need

2013-05-16 17:14  joseba

	* [r10610] One more

2013-05-16 17:54  joseba

	* [r10611] Started with METIS 5 support with autotools, it doesn't
	  work yet
	  Added ID to Makefile.am and common-rules.make

2013-05-16 20:48  dstrubbe

	* [r10612] Some output from oct-center-geom.

2013-05-16 21:06  dstrubbe

	* [r10613] Widening precision for SIC test, since mauchly just
	  failed on this. Probably indicates numerical issues that need to
	  be fixed.

2013-05-17 02:50  dstrubbe

	* [r10614] * The oct-center-geom test was failing on chum path
	  because of the arbitrariness of the sign of the eigenvectors of
	  the moment of inertia. Now a particular arbitrary choice will be
	  made to fix the sign and make them reproducible.
	  * More info from oct-center-geom: center of mass, primary and
	  secondary axes used for alignment, moment of inertia tensor,
	  eigenvalues of moment of inertia.

2013-05-17 03:03  dstrubbe

	* [r10615] Adding a caveat: oct-center-geom is currently assuming
	  3D in many places.

2013-05-17 04:02  dstrubbe

	* [r10617] * Bugfix to oct-center-geom: the formula for moment of
	  inertia was wrong, and not even dimensionally correct. Seems to
	  have involved some false analogy to quadrupole moments. Does not
	  affect the results of the test I added recently though.
	  * Incorrect default was listed for MainAxis.
	  
	  These problems go all the way back to initial implementation of
	  this utility in r745-r746.

2013-05-17 04:41  dstrubbe

	* [r10618] * The piece of code to check axes for a linear molecule
	  is only triggered in an impossible case: the eigenvectors of the
	  moment of inertia tensor will be always be normalized coming from
	  LAPACK. An eigenvalue, not an eigenvector, will be zero for a
	  linear molecule.
	  * Removing unnecessary copy from tinertia to vec.

2013-05-17 08:56  joseba

	* [r10619] GKlib and libmetis are compiled inside METIS 5. Not yet
	  the entire library
	  Added ignore properties for Makefiles

2013-05-17 09:28  joseba

	* [r10620] Created Makefile.am for the include and ignored
	  Makefiles
	  Library is now compiled but when trying to link says: "could not
	  read symbols: Archive has no index"
	  Added Id for another Makefile.am

2013-05-17 09:33  marques

	* [r10621] Added BLOC meta-GGA

2013-05-17 10:16  joseba

	* [r10622] Reverted a bug of out of bound introduced in r10490

2013-05-17 10:17  joseba

	* [r10623] Reverted also in case of curvilinear meshes of bug
	  introduced in r10490

2013-05-17 11:40  marques

	* [r10624] Added functional gga_x_vmt

2013-05-17 12:48  marques

	* [r10625] Added two version of VMT{8,4}

2013-05-17 14:27  dstrubbe

	* [r10626] Typos in libxc.

2013-05-17 14:32  dstrubbe

	* [r10627] * oct-center-geom is generalized to other than 3
	  dimensions (other than the rotation part, which is complicated to
	  do).
	  * AxisType can now be 'none', to just do the centering but not
	  rotation.
	  * 'Moment of inertia' is now called 'Moment of pseudo-inertia' if
	  AxisType = pseudo_inertia.

2013-05-17 14:41  dstrubbe

	* [r10628] Fixing POP_SUB name.

2013-05-17 20:07  dstrubbe

	* [r10631] * Removing PUSH/POP's from function called too
	  frequently.
	  * Doxygen comments.

2013-05-18 01:10  xavier

	* [r10632] Fix for compilation of metis 5.1 out of the source
	  directory.

2013-05-18 01:37  xavier

	* [r10633] Fixed the article reference for the plan eigensolver.

2013-05-18 01:44  xavier

	* [r10634] * Fixed compilation with metis-5.1
	  * Removed metis-4.0 support and source.
	  

2013-05-18 01:50  xavier

	* [r10635] Updated the license for metis.

2013-05-18 02:41  xavier

	* [r10636] Removed Zoltan, this is no longer required since Metis
	  is now open
	  source.

2013-05-18 03:14  xavier

	* [r10637] Added a check for C compiler support for __thread, this
	  should fix the
	  problem with PGI.

2013-05-18 04:24  xavier

	* [r10638] Another fix to try to get metis to compile with PGI.

2013-05-18 19:33  umberto

	* [r10639] FIrst try at implementing PNFFT module. not working yet.

2013-05-18 19:38  umberto

	* [r10640] use PNFFT in fft_m

2013-05-18 19:44  umberto

	* [r10641] Making the cube able to initialize PNFFT and NFFT
	  libraries.

2013-05-18 20:11  dstrubbe

	* [r10642] Message for writing output: otherwise can look like the
	  calculation is hanging.

2013-05-19 18:57  dstrubbe

	* [r10643] Comment and colons.

2013-05-19 20:21  dstrubbe

	* [r10644] Bugfix: LCAO (standard, not alternative) produced
	  incorrect real-space wavefunctions when parallel in states. The
	  problem was confusion between 'lcao_start' in its original
	  meaning of the lowest state to be used from LCAO, and its new
	  value assigned as max(lcao_start, st%st_start). This led to the
	  states not being properly initialized to zero before accumulation
	  of contributions from the atomic orbitals. Also, only processors
	  in states-group 0 had the full list of eigenvalues, even though
	  they are supposed to be global; this probably was not a problem
	  though. I have converted use of st%X(psi) to states_set_state in
	  the initialization to zero, and also removed the distinction
	  between initialization when lcao_start == 1 and when it is not.
	  Finally, I had to rename the integer 'max' which interfered with
	  the ability to use the 'max' intrinsic Fortran function -- don't
	  use a Fortran keyword as a variable!
	  reported by Varadharajan Srinivasan.

2013-05-19 20:24  dstrubbe

	* [r10645] Adding a test that uses standard LCAO with states
	  parallelization, that might have caught the problem fixed in
	  r10644 (which was reported by Varadharajan Srinivasan), in which
	  the states resulting from LCAO are wrong, causing a huge
	  difference in eigenvalues between LCAO and SCF iteration 1 and
	  slow convergence, even if the LCAO eigenvalues are close to the
	  final answer.

2013-05-20 12:38  joseba

	* [r10647] Corrected the bug with OpenCL reported by Xavier.
	  This is an error from a forgotten change of r10348

2013-05-20 12:43  micael

	* [r10648] * Bug fix: k-points parallelization for spin-polarized
	  calculations was not done properly in states_calc_quantities.

2013-05-20 13:01  micael

	* [r10649] * Cleaned the calc_tb09_c routine and removed the very
	  annoying instruction to print the "c" parameter everytime it was
	  calculated.

2013-05-20 20:35  dstrubbe

	* [r10651] Comments on ETSF_IO test; Indentation.

2013-05-20 20:50  dstrubbe

	* [r10652] Fixing some intent's: _end routines should always be
	  inout, or else we may be trying to deallocate uninitialized
	  pointers/arrays, or not passing out the fact that they are
	  deallocated and nullified.

2013-05-20 21:25  dstrubbe

	* [r10653] * Removing explicit argument bounds in atomic.
	  * In one case, the debug info would not be written in CG. Now it
	  is.

2013-05-20 21:50  dstrubbe

	* [r10654] The parameter 'geo' cannot be optional in
	  v_ks_calc(_start) since it is passed regardless to v_a_xc. This
	  makes it be needed in update_hamiltonian_psi too.

2013-05-21 01:57  dstrubbe

	* [r10655] After reading in occupations on restart, the Fermi
	  energy was not computed, and could be used unitialized in a
	  certain case. In td mode, a call to energy_calc_total which in
	  turn called smear_calc_entropy would use the Fermi energy unless
	  the run used fixed occupations. Now the Fermi energy is computed
	  as part of initialization of the occupations.

2013-05-21 09:02  micael

	* [r10657] * I believe it is very misleading to have a routine that
	  can compute two different quantities, the kinetic energy density
	  and the gauge-independent kinetic energy density, and have some
	  variable (CurrentInTau) that might make the second quantity equal
	  to the first, i.e. the gauge-independent KED might in fact be
	  gauge-dependent (!) depending on some input option. It is much
	  more logical to use either the gauge-dependent or the
	  gauge-independent KED depending on the input option without
	  acutally changing the definintion of those quantities.
	  * Renamed the CurrentInTau variable XCUseGaugeIndependentKED and
	  moved it to xc_m module to make it clear that this is used when
	  evaluating the XC functional.

2013-05-21 10:09  nitsche

	* [r10658] * Added more checks while reading the open boundary
	  memory coefficients files. Hopefully this fixes the occasional
	  failures on mauchly.

2013-05-21 11:03  joseba

	* [r10659] Added support for PFFT 1.0.7 using with a patched
	  version of FFTW3.3.3, it won't work anymore with PFFT 1.0.5 as it
	  uses one less parameter. Now PFFT and FFTW3 flags are in a single
	  parameter.
	  Modified m4 to be able to compile it.
	  
	  Compiling instructions at
	  http://www-user.tu-chemnitz.de/~mpip/software.php?lang=en

2013-05-21 14:00  micael

	* [r10660] * Added an explicit Fortran interface to the (Par)Metis
	  routines.
	  * We now pass explicitly the NULL pointers to (Par)Metis using
	  the C interface.

2013-05-21 14:49  micael

	* [r10661] * Removed PFFT partition of the mesh.
	  * Removed unused variables.

2013-05-21 15:28  joseba

	* [r10662] More information about the versions in the m4 of PFFT
	  and also success with 1.0.7 and fails with 1.0.5
	  Thanks David

2013-05-21 16:28  dstrubbe

	* [r10663] Fix to r10655 which was wrong for restart with smearing
	  (causing test failures): we need the eigenvalues to compute the
	  Fermi energy in that case, which were not available yet. Now
	  there is just a call for td for states_fermi. I think the issue
	  addressed in r10655 is only formal currently: the TS term in the
	  energy would be wrong in the first iteration of time propagation,
	  but it was not written out anyway. Probably should be for systems
	  with smearing though.

2013-05-21 16:46  joseba

	* [r10664] Reverted the need of the fftw3 library
	  Removed unused variables in the check program
	  
	  Thanks to David and Umberto

2013-05-21 16:58  dstrubbe

	* [r10665] Changing some occurences of 'max' as a variable. Since
	  this is also an intrinsic function, it is a confusing name and
	  may cause trouble in some cases.

2013-05-21 17:00  dstrubbe

	* [r10666] SPARSKIT m4 should guess with the more flexible -l style
	  of linking so that both .a and .so libraries can be used.

2013-05-21 17:01  dstrubbe

	* [r10667] Typo.

2013-05-21 17:18  dstrubbe

	* [r10668] * The dune metis check gave the ridiculous output:
	  
	  checking for METIS library... failed
	  yes
	  
	  Now, an if-condition is written properly so that it doesn't write
	  'yes' when the check fails.
	  
	  * Using 'no' rather than 'failed' as a test result in m4 macros,
	  according to the standard for all our other macros.

2013-05-21 17:27  dstrubbe

	* [r10669] * Adding PUSH/POP's and Doxygen comment.
	  * Tests should not set DebugLevel = 0; this is default.

2013-05-21 18:07  dstrubbe

	* [r10670] Replacing AC_TRY_LINK_FUNC with AC_LINK_IFELSE. The
	  former has been considered obsolete since at least autoconf
	  version 2.59.
	  
	  http://www.gnu.org/software/autoconf/manual/autoconf-2.64/html_node/Obsolete-Macros.html#index-AC_005fTRY_005fLINK_005fFUNC-1990

2013-05-21 18:12  dstrubbe

	* [r10671] Adding 'implicit none' to test program makes it fail
	  properly for PFFT 1.0.4. Otherwise good old Fortran doesn't care
	  if the symbols are undefined...

2013-05-21 19:11  dstrubbe

	* [r10672] Fix to r10670: AC_LINK_IFELSE is supposed to be used in
	  conjection with AC_LANG_CALL. Otherwise, the test program is just
	  the text of the function. This only seemed to work because not
	  all the checks in each m4 macro used AC_LINK_IFELSE, some used
	  AC_CHECK_LIB.

2013-05-21 19:47  dstrubbe

	* [r10673] Updating tests in light of r10657.

2013-05-21 19:56  dstrubbe

	* [r10674] Fixing the intent for 'y' in numin: it should be
	  intent(inout) since it was partly set in numout already.
	  Formatting of argument list.

2013-05-21 21:12  dstrubbe

	* [r10675] Bugfix: external potential in periodic systems could be
	  incorrect if a pseudopotential projector spanned the whole cell.
	  This is the case for the sodium test, resulting in some slightly
	  different values. The problem is an ambiguous vector assignment,
	  dating back to r3830. The index sphere%map has duplicate values,
	  making it not entirely clear what the assignment means. Hence
	  this sort of thing is forbidden by the Fortran standard,
	  6.2.2.3.2((http://j3-fortran.org/doc/standing/archive/007/97-007r2/pdf/97-007r2.pdf).
	  Problem reported by Vittorio.

2013-05-22 01:42  dstrubbe

	* [r10676] * Removing explicit bounds from arguments.
	  * Doxygen comments.

2013-05-22 02:47  dstrubbe

	* [r10677] * Removed unused variables declared only for OpenMP.
	  * Formatting and Doxygen comments.

2013-05-22 03:34  dstrubbe

	* [r10678] * Avoiding operating on the part of l_tau which is not
	  in the current block. In some cases, this avoids accessing
	  uninitialized data.
	  * Fixing intent for preconditioner: while no data of bb comes in,
	  some other elements of the batch are set up previously.
	  Both addressing problems pointed out by Vittorio.

2013-05-22 09:24  joseba

	* [r10679] Removed few unused variables

2013-05-22 10:24  acastro

	* [r10680] Removed an unnecessary constraint on the choice of
	  propagators available for
	  QOCT runs.

2013-05-22 12:20  micael

	* [r10681] *) Move the content of the partition module to a single
	  routine in the mesh_partition module.
	  *) I'm not removing the partition module, as I will use it for
	  the distributed partition.

2013-05-22 13:00  joseba

	* [r10682] Added the inclusion of the mpi.h to be sure that the
	  datatype of MPI_Comm is defined

2013-05-22 13:03  micael

	* [r10683] * Renumbered the parameters in mesh_partition_m.
	  * Some clarifications to the variables documention.
	  * Cleaning.

2013-05-22 13:06  micael

	* [r10684] * Making the RCB and GRAPH parameters private.

2013-05-22 13:09  micael

	* [r10685] * The MeshPartition variable is only used with METIS.

2013-05-22 13:45  joseba

	* [r10686] Parmetis is only check if MPI is found
	  Moved to the proper place the mpi.h

2013-05-22 20:41  dstrubbe

	* [r10688] * Added missing intent's for bpdn and put arguments in
	  list.
	  * Fixed intent for compressed_sensing_spectral_analysis this.
	  (Reported by Vittorio Zecca.)
	  * Indentation, removed useless semicolon.

2013-05-22 21:40  dstrubbe

	* [r10689] Let's try a little harder to find dfftw_init_threads.

2013-05-23 08:09  micael

	* [r10690] Updated ChangeLog archive.

2013-05-23 08:20  micael

	* [r10692] I forgot the ChangeLog from 2012.

2013-05-23 09:41  micael

	* [r10695] A file was missing from the tarball.

2013-05-23 10:56  acastro

	* [r10697] Some info about the distribution of blocks in states was
	  printed to stdout
	  everytime that the states_init_block subroutine was called. I
	  added an
	  optional verbose option to give the option to the caller to
	  supress it (that
	  routine is called every time a states_copy is invoked, and this
	  is done very
	  often in some run modes).

2013-05-23 13:38  acastro

	* [r10698] The commit #10680 slightly changed the lanczos
	  propagation algorithm, which
	  slightly changed the values of some testsuite reference values. I
	  update here
	  those reference values.

2013-05-23 17:23  acastro

	* [r10699] The computation of hyperspherical coordinates from
	  cartesian coordinates had
	  the risk of attempting "atan2(0.0,0.0)". It is unclear from the
	  standard
	  definition what this could mean. I changed this, I think the
	  computation is
	  more robust now (thanks to Vittorio Zecca for reporting this).
	  
	  Also, the two-dimensional case had a bug.

2013-05-23 17:28  micael

	* [r10700] Now the graph is constructed and stored locally. It is
	  gathered in all nodes only when necessery, i.e. when METIS is
	  used or we run in debug mode.

2013-05-23 21:37  dstrubbe

	* [r10701] * Operating on only the relevant section of a_ind (i.e.
	  not up to np_part).
	  * Updating comments.
	  * Doxygen comments.

2013-05-23 21:46  dstrubbe

	* [r10702] Removed apostrophe making cpp warning, and Doxygen
	  comment.

2013-05-23 22:37  dstrubbe

	* [r10703] Making sure values are returned for the 'minimum' and
	  'ierr' arguments in the minimizers.

2013-05-24 01:44  dstrubbe

	* [r10704] A better guess and check for cpp for Fortran
	  preprocessing. Previously, we used a variable FCCPP for Fortran
	  preprocessing, which was set independently of CPP, with a value
	  of either the environment variable FCCPP, or "/lib/cpp -ansi".
	  However, there was no check that FCCPP (initialized by either of
	  this methods) was an existing or executable file, or any check
	  that it would actually work for our purposes. This is a problem
	  particularly on a Mac, where /lib/cpp does not exist, and the
	  default cpp in the path (/usr/bin/cpp) will fail in compilation.
	  
	  On the other hand, autoconf is finding cpp for C properly. So why
	  not just work with that? I abolished the FCCPP variable, and now
	  we use CPP for all purposes. However, we need to check that CPP
	  will work for Fortran, specifically for two issues:
	  * Will it strip C++ style comments, and thus destroy any F90
	  lines with a string concatenation? (running without -ansi
	  generally makes this problem occur)
	  * Will it concatenate strings with ## as we need for many macros?
	  (Mac's /usr/bin/cpp will fail this)
	  So, we perform these two checks, and add -ansi if necessary to
	  make them work, or otherwise throw an error, rather than have
	  peculiar compilation failures later. This change may mean we now
	  use some unnecessary flags for cpp on C files, but I don't see
	  any problem with that.
	  
	  In case you wonder how good the previous set up was, note these
	  original comments in the source from Miguel in r799:
	  "this should not be hardwired"
	  "this is a hack, and should be changed in the future"

2013-05-24 01:46  dstrubbe

	* [r10705] This was supposed to be in the last commit, as part of
	  changing FCCPP to CPP.

2013-05-24 02:06  dstrubbe

	* [r10706] Reverting r10704 and r10705, since I realize that gcc -E
	  will pass the tests but fail on a file with extension .F90!

2013-05-24 08:04  micael

	* [r10707] Changed the eigensolver of the Biot-Savart test to to
	  make its SCF convergence more stable.

2013-05-24 08:23  micael

	* [r10708] r10706 failed to revert the changes to this file.

2013-05-24 08:36  micael

	* [r10709] * New routines to define and store a distributed
	  partition. Not yet used in the rest of the code.

2013-05-24 13:22  acastro

	* [r10710] Removed the variable name "target", since it is a
	  Fortran language element and
	  could confuse the compilers.

2013-05-24 14:06  acastro

	* [r10711] I remove the possibility of doing phase-only OCT runs,
	  which was not being
	  properly maintained.

2013-05-24 14:44  umberto

	* [r10712] Updated version of PNFFT module.
	  New forward and backward transforms. fft_inc forward and backward
	  transforms pass an optional norm factor to help the inverse
	  rs-.fs mapping used with nfft.

2013-05-24 14:51  umberto

	* [r10713] Added additional vectors to cube_t to hold information
	  needed to gather fs functions when using PNFFT.
	  Updated accordingly cube_function_allgather and cube_do_mapping.

2013-05-24 15:06  umberto

	* [r10714] * Updated PES module to make use of PNFFT and all the
	  new cube_t technology. Both PNFFT and NFFT X_to_K maps now use
	  backward tranforms. this give slightly different numbers for the
	  nfft-test which has been updated accordingly.
	  * moved pes_mask_out_inc file as par t of pes_mask.F90 where it
	  should belong. Lot of cleaning still to be done on the module.

2013-05-24 15:16  umberto

	* [r10715] Fixed problem with pnfft module when PNFFT is not
	  available.

2013-05-24 16:34  umberto

	* [r10716] substitute => NULL() with nullify()

2013-05-24 16:46  umberto

	* [r10717] Cleaning unused modules.

2013-05-24 17:23  dstrubbe

	* [r10719] Unnecessary semicolon.

2013-05-24 17:50  acastro

	* [r10720] The "OCTLaserEnvelope" is now read using the
	  "TDFunctions" block.

2013-05-24 17:56  umberto

	* [r10721] Changed the EnlargeLev options into EnlargeFactor to
	  allow for real numbers bigger than one instead of just powers of
	  2. This allow for more flexibility in big simulations.
	  The testsuite has been changed accordingly.

2013-05-24 18:16  dstrubbe

	* [r10722] Another try at r10704:
	  
	  Better guesses and check for cpp for Fortran preprocessing. We
	  use a variable FCCPP for Fortran preprocessing, which was
	  previously set independently of CPP, with a value of either the
	  environment variable FCCPP, or "/lib/cpp -ansi". However, there
	  was no check that FCCPP (initialized by either of this methods)
	  was an existing or executable file, or any check that it would
	  actually work for our purposes. This is a problem particularly on
	  a Mac, where /lib/cpp does not exist, and the default cpp in the
	  path (/usr/bin/cpp) will fail in compilation.
	  Now we check in sequence FCCPP, CPP (initialized either from the
	  environment, or an autoconf check), `which cpp`, and /lib/cpp,
	  and for each we check that it can be run, and that it will work
	  for Fortran, specifically for two issues:
	  Will it strip C++ style comments, and thus destroy any F90 lines
	  with a string concatenation? (running without -ansi generally
	  makes this problem occur)
	  Will it concatenate strings with ## as we need for many macros?
	  (Mac's /usr/bin/cpp will fail this, as will gcc -E, but not gcc
	  -E -x c)
	  So, we perform these two checks, and add -ansi if necessary to
	  make them work, or otherwise throw an error, rather than have
	  peculiar compilation failures later.
	  
	  In case you wonder how good the previous set up was, note these
	  original comments in the source from Miguel:
	  r112: "this should not be hardwired" (regarding /lib/cpp)
	  r801: "this is a hack, and should be changed in the future"

2013-05-24 18:36  dstrubbe

	* [r10723] * autoconf on some machines would give this error on the
	  previous commit:
	  
	  sh: -c: line 0: syntax error near unexpected token `('
	  
	  Now, it doesn't, though it makes a number of warnings instead
	  about AC_LANG_PREPROC(Fortran).
	  
	  * /lib/cpp should be tried before CPP, since the check somehow
	  does not fail if '//' gets turned into '/ /'.

2013-05-27 09:58  micael

	* [r10724] Reverting #10345 and #10396.

2013-05-27 13:22  xavier

	* [r10727] Now the total torque is printed to static info.

2013-05-27 18:00  joseba

	* [r10728] Updated m4 of libfm to the library that creates Scafacos
	  Corrected the execution with 1 MPI process of the FMM
	  
	  Note. I used to compile with FMM the next line:
	  --with-libfm=" -I$LIBFM_HOME/include -L$LIBFM_HOME/lib -lfcs
	  -lfcs_fmm -lfcs_common -lfcs_direct -lfcs_near -lfcs_gridsort
	  -lfcs4fortran"

2013-05-28 13:11  marques

	* [r10729] Patch by Yann Pouillon:
	  
	  Please find attached a patch for LibXC 2.0.1 adding the following
	  Fortran
	  wrappers:
	  
	  * subroutine xc_f90_functional_get_name(id, name)
	  * integer function xc_f90_functional_get_number(name)
	  
	  that have been requested many times for various projects. In
	  particular, it
	  solves the issue of getting a functional number from the
	  corresponding
	  description string, avoiding many potential typos in input files
	  of Fortran
	  codes.

2013-05-28 13:18  marques

	* [r10730] Following Yann's suggestion, I separated libxc in two
	  libraries, one containing the actual library (libxc) and another
	  the Fortran bindings (libxcf).

2013-05-28 13:19  marques

	* [r10731] Corrected libxc.m4 so that it knowns how to compile with
	  the Fortran binding to libxc. Let's hope it works.

2013-05-28 14:18  marques

	* [r10732] Let's see if this fixes compilation with some slaves

2013-05-28 14:29  marques

	* [r10733] I really hate libtools

2013-05-28 14:35  marques

	* [r10734] Following's Xavier suggestion, I changed the name of the
	  library to libxcf90

2013-05-28 14:42  marques

	* [r10735] Next attempt at compiling in chum. But can someone
	  update the buggy libtool of this machine?

2013-05-28 16:52  joseba

	* [r10736] METIS has to be compiled only when desired, not always
	  as before

2013-05-28 17:21  micael

	* [r10737] We should compile Metis without debug options, otherwise
	  it is slower by several orders of magnitude.

2013-05-28 17:26  joseba

	* [r10738] If a METIS is found outside Octopus; it is not check our
	  version.
	  Fixed the compilation with the linked METIS

2013-05-28 17:46  joseba

	* [r10739] All the METIS checks are done in a unique file

2013-05-28 17:48  joseba

	* [r10740] Renamed to metis.m4
	  Deleted a forgotten comment

2013-05-28 19:13  dstrubbe

	* [r10741] * AC_ARG_VAR makes the variable there appear in
	  ./configure --help "Some influential environment variables".
	  METIS and PARMETIS are of low significance compared to FCFLAGS
	  etc. which are the other ones there, so I am removing the calls.
	  * Trying to clarify what HAVE_COMP_METIS means.
	  * Typos.

2013-05-28 20:36  dstrubbe

	* [r10742] * libxc.m4 now can accept the new separate Fortran
	  interface, or the old combined interface, by trying all the
	  possibilities.
	  * Some removing of duplicated lines or unnecessary intermediate
	  variables.
	  * Removing calls to $1 and $2 since no arguments are passed to
	  this routine anyway.

2013-05-28 21:18  dstrubbe

	* [r10743] Revision to m4 cpp check: making sure that in macro
	  expansions '//' is not expanded to '/ /'.

2013-05-29 09:26  micael

	* [r10744] Fixed problem with ParMETIS and OpenMPI.

2013-05-29 09:29  micael

	* [r10745] Reverted unintended changes.

2013-05-29 15:54  dstrubbe

	* [r10747] * Fix to libxc.m4: libraries for static linkage were in
	  the wrong order, so always failed.
	  * If LIBS_LIBXC is set in the environment, that will be used
	  first for trying to link.

2013-05-29 16:11  joseba

	* [r10748] Following David's suggestion, simplified the
	  configuration step to get FMM working. Now is enough to call it
	  --with-libfm="$LIBFM_HOME"

2013-05-29 16:45  joseba

	* [r10749] Updated the version of the Poisson solver included in
	  the BigDFT code and can be compiled as a separate library.
	  Library compilation instructions here:
	  http://bigdft.org/Wiki/index.php?title=Installation#Building_the_Poisson_Solver_library_only
	  Soon will be released

2013-05-29 16:52  joseba

	* [r10750] ISF kernel's datatype is defined in the library, so it
	  is compiled only with the library

2013-05-29 19:36  dstrubbe

	* [r10751] Message about writing output should be done only if some
	  output is occurring.

2013-05-30 16:28  dstrubbe

	* [r10752] * Removed funny characters (^L) from COPYING.
	  * Updated comment in testsuite file.
	  * Doxygenation (doxidation?)

2013-05-30 17:33  joseba

	* [r10753] To check FMM is used --with-libfm-prefix
	  Printed the result of the first check

2013-05-30 17:34  joseba

	* [r10754] Deleted a forgotten debug print

2013-05-31 08:57  umberto

	* [r10755] Try to avoid some ill-defined calculations.

2013-05-31 16:57  micael

	* [r10756] * Expanded the partition module by including several
	  useful functions.
	  * Started to use the distributed partition. At the moment this is
	  done mainly in the mesh_partition module, but it will extended to
	  all the code soon.
	  * The partition is now split in two: inner points and boundary
	  points. This is necessary to avoid strong load imbalance in
	  communications. This breaks backward compatibility for the mesh
	  partition restart, which is not too serious, as it is easy to
	  recalculate it.

2013-06-01 08:44  acastro

	* [r10757] Just some re-organization of the code.

2013-06-01 10:14  acastro

	* [r10758] Some more code cleaning.

2013-06-04 13:58  dstrubbe

	* [r10759] Typos.

2013-06-04 14:04  dstrubbe

	* [r10760] * Typos.
	  * Missing PUSH/POP.
	  * Adding asserts to be sure optionals are present when needed.

2013-06-04 15:36  dstrubbe

	* [r10761] Let's enable newuoa by default and see if all the slaves
	  are happy with it.

2013-06-04 15:56  dstrubbe

	* [r10762] Adding COPYING info for SPG1 in bpdn external library:
	  LGPL 2.1 from http://www.gnu.org/licenses/lgpl-2.1.txt

2013-06-04 16:19  dstrubbe

	* [r10763] Removing some unnecessary files from spglib.

2013-06-04 16:21  dstrubbe

	* [r10764] Adding COPYING info about FortranCL, newuoa, slatec, and
	  spglib. For simplicity, we can provide just LGPL 3 and GPL 3 (and
	  not versions 2.1 and 2) since the libraries using those allow
	  later versions too.

2013-06-04 16:24  dstrubbe

	* [r10765] Inserting LGPL 3 in place of LGPL 2.1 in COPYING since
	  it can serve for both libraries licensed under LGPL.

2013-06-04 16:28  dstrubbe

	* [r10766] newuoa's make clean rule was deficient, leaving *.mod
	  behind and making the distcheck buildslave fail.

2013-06-04 16:38  dstrubbe

	* [r10767] Removing useless logic and output from libfm.m4.

2013-06-04 18:54  dstrubbe

	* [r10768] Fixing libfm.m4:
	  * the cases listed were appropriate for lib not prefix
	  * FCFLAGS_LIBFM should be used
	  * removed tests that seem unlikely to work given the link line
	  Joseba says is needed

2013-06-06 16:20  dstrubbe

	* [r10769] Consolidated the Crank-Nicolson propagators with and
	  without SPARSKIT, since they differed by only a few lines.

2013-06-06 16:24  dstrubbe

	* [r10770] Doxygen comments.

2013-06-06 16:43  dstrubbe

	* [r10771] Adding unit conversion to NetCDF output. Guillermo
	  pointed out this was missing.
	  
	  Umberto -- an appropriate unit should be specified for the PES
	  mask output.

2013-06-06 17:08  dstrubbe

	* [r10772] Adding netcdf output to a test. Since ETSF requires
	  netcdf, we will always have netcdf support if this test is
	  runnable.

2013-06-06 17:11  dstrubbe

	* [r10773] * Renaming array 'select' for ARPACK: this is a poor
	  name since it is a Fortran keyword.
	  * Uses of 'real' were lacking REAL_PRECISION, so they could be
	  losing precision.

2013-06-06 17:14  dstrubbe

	* [r10774] Marking lobpcg with more than one block as experimental.
	  This is quite unfortunate, given the name "locally optimal
	  *block* preconditioned conjugate gradients", but in all cases
	  with more than one block which I tried, except for
	  finite_systems_3d/21-lobpcg.02-spinors.inp, the results were
	  totally wrong. For example, a large fraction of eigenvalues were
	  0.00000 after a few iterations.

2013-06-06 17:20  dstrubbe

	* [r10775] * Doxygen comments.
	  * More parsimonious sizes for variable 'pp'.
	  * Making 'lead' intent(inout) since lead_init_kin initializes
	  only part of the object, and the rest was done by a preceding
	  call.

2013-06-06 20:15  dstrubbe

	* [r10776] Seems to me that the complex scaling tests work as well,
	  or better, in parallel than in serial. All but one pass with
	  PARPACK on MacOS, whereas none pass with just ARPACK.

2013-06-06 20:26  dstrubbe

	* [r10777] * Typo.
	  * Doxygen comments.

2013-06-07 15:23  dstrubbe

	* [r10778] Fixing my improper use of messages_fatal.

2013-06-07 18:12  dstrubbe

	* [r10779] Typos, updated link.

2013-06-07 18:13  dstrubbe

	* [r10780] Documentation and error-checking for BoxShape =
	  box_image.

2013-06-07 19:03  dstrubbe

	* [r10781] * Comment on unusual number for BOX_USDEF.
	  * Doxygen comments.
	  * simul_box_t components pertaining to gdlib do not need to be
	  hidden when not compiling with gdlib.
	  * simul_box_t now stores the image filename, and writes it in
	  static/info.
	  * Note that there is no default for BoxShapeImage.

2013-06-07 19:31  dstrubbe

	* [r10782] * Clarifying error message from testsuite script.
	  * Fixing funny character and removing unterminated quote.

2013-06-07 19:35  dstrubbe

	* [r10783] BoxShapeImage now looks in /share as well as working
	  directory, and checks whether the file exists before trying to
	  open with gdlib.

2013-06-07 19:41  dstrubbe

	* [r10784] Adding a test for gdlib.

2013-06-07 19:55  dstrubbe

	* [r10785] * Typos and grammar.
	  * Removing cyclic dependency.

2013-06-07 21:13  dstrubbe

	* [r10786] * Documentation and comments.
	  * Better check for periodicity with cylinder box, and
	  construction without explicit reference to 3D.
	  * Formatting.

2013-06-07 21:15  dstrubbe

	* [r10787] I don't like silent resetting of OutputHow. Let's make
	  clear what is going on to the user.

2013-06-07 21:38  dstrubbe

	* [r10788] * Let's write only the real part for axis, plane, and
	  mesh_index output, when plotting a real function.
	  * Standardizing usage of mformat and iostat=ierr in these
	  routines.
	  * Indentation.

2013-06-08 00:03  dstrubbe

	* [r10790] Implementation of 2D XCrySDen output.

2013-06-08 00:16  dstrubbe

	* [r10791] * Write out image dimensions in output for box_image.
	  * Bugfix: The coordinate conversion for the image was flipped
	  vertically, due to confusion about the origin convention.

2013-06-08 01:10  dstrubbe

	* [r10792] Warning should go to standard error.

2013-06-08 01:57  dstrubbe

	* [r10793] * More info in variable reference.
	  * Box_image can be used for periodic systems.
	  * Removed empty loop accidentally left behind from r9835.
	  * Small adjustments to Lsize may be necessary depending on the
	  parity of the image size and of the grid.

2013-06-08 02:37  dstrubbe

	* [r10794] Apparently the block size is different on the CL intel
	  slave, so we need to set ExperimentalFeatures for two more tests.

2013-06-08 22:01  dstrubbe

	* [r10796] Reverting r10776: the complex-scaling tests fail with
	  PARPACK on tigger (Ubuntu).

2013-06-09 01:11  dstrubbe

	* [r10797] * Doxygen comments.
	  * Using nullify instead of =>NULL().

2013-06-09 02:15  dstrubbe

	* [r10798] * Formatting.
	  * messages_fatal instead of stop.

2013-06-09 02:21  dstrubbe

	* [r10799] * messages_fatal instead of stop.
	  * Removed unused file.

2013-06-09 02:50  dstrubbe

	* [r10800] * Fixing memory leak in
	  testsuite/optimal_control/01-asym_doublewell.03-oct_run.inp:
	  f%val was not deallocated for TDF_FOURIER_SERIES or
	  TDF_ZERO_FOURIER if tdf_init_numerical was called without rep
	  present.
	  * TDF_ZERO_FOURIER entirely lacked a case in tdf_end.
	  * Consolidating TDF_FOURIER_SERIES and TDF_ZERO_FOURIER cases in
	  several places.

2013-06-09 03:39  dstrubbe

	* [r10801] * Removing useless component coeffs to tdf_t.
	  * Including TDF_ZERO_FOURIER in multiply routine.

2013-06-09 04:02  dstrubbe

	* [r10802] * nullify instead of => NULL.
	  * Checks on calls to controlfunction_mod_init and
	  controlfunction_mod_close.

2013-06-09 04:46  dstrubbe

	* [r10803] The spacing with box_image is now only given a default
	  by the image resolution, but this can be set explicitly too.

2013-06-09 13:02  xavier

	* [r10804] Removed an unused function.

2013-06-09 14:45  dstrubbe

	* [r10805] Removed illegal options to OutputHow in complex_scaling
	  tests.

2013-06-09 14:52  dstrubbe

	* [r10806] Renaming complex scaling test files in accordance with
	  our conventions.

2013-06-09 19:59  xavier

	* [r10807] Added an object, states_group_t, that contains the
	  blocks from states_t.

2013-06-10 00:36  dstrubbe

	* [r10808] * Using units in parsing TDFunction block, and
	  consolidating select statements.
	  * Renaming variables named 'value' which is a Fortran 2003
	  keyword.

2013-06-10 01:22  dstrubbe

	* [r10809] Fixing the memory leak flagged by valgrind in
	  testsuite/optimal_control/01-asym_doublewell.02-oct_run.inp:
	  since tdf_read initializes a tdf_t object,
	  controlfunction_mod_init was initializing the td_penalty
	  functions twice, without ending them. The solution is to use only
	  tdf_read or tdf_init_numerical, but not both.

2013-06-10 01:31  dstrubbe

	* [r10810] Renaming variables called 'value', a Fortran 2003
	  keyword.

2013-06-10 01:51  dstrubbe

	* [r10811] * More info in journal reference about LOBPCG.
	  * Removing unnecessary (:, :, :) from array references.

2013-06-10 02:29  dstrubbe

	* [r10812] * Removing unused macro definition.
	  * Making some array arguments intent(inout), where the routine
	  doesn't necessarily set the whole array.

2013-06-10 03:00  dstrubbe

	* [r10813] * Making some arguments in intent(inout) which are often
	  passed as size np_part but only set 1:np.
	  * Making states_orthogonalize_single, complex-scaling part, use
	  lalg_scal instead of loop by hand, for efficiency and to avoid
	  referring to np+1:np_part section unnecessarily.

2013-06-10 16:08  dstrubbe

	* [r10814] The libration match needs a still wider tolerance: just
	  failed on hbar test with discrepancy 0.0227.

2013-06-10 18:12  umberto

	* [r10815] *Changed mode 3 oct-photoelectron-spectrum so that the z
	  axis is always aligned with the laser polarization. This helps
	  the averaging process when dealing with randomly oriented
	  molecules in the laboratory frame.
	  *Bugfix: apparently the rotation matrix had several flipped
	  signs.. (the reference is
	  http://en.wikipedia.org/wiki/Rotation_matrix for Q_u(\theta) -
	  rotation around a given vector u)

2013-06-10 18:30  umberto

	* [r10816] default value for pvec

2013-06-10 19:01  dstrubbe

	* [r10817] * Uses of nullify.
	  * Fixing intent for projector_matrix_deallocate.
	  * write instead of print.

2013-06-10 20:48  dstrubbe

	* [r10818] Bugfix: the CurrentThroughPlane output in 2D
	  accidentally used uninitalized outp%plane%origin instead of the
	  appropriate outp%line%origin. Thanks to Vittorio Zecca for
	  reporting the issue.

2013-06-10 21:17  dstrubbe

	* [r10819] New scheme for parallelization in electron-hole pairs
	  for Casida. The previous scheme divided up the columns of the
	  lower diagonal of the matrix, which was not very good since they
	  range in size from 1 to N. This also meant the progress bar was
	  fairly misleading. To improve load-balancing, we use a portion of
	  each column, taking advantage of Hermiticity to compute some
	  elements in the lower diagonal and some in the upper diagonal.
	  The portion of each column used is almost the same, differing
	  only by 1 depending on odd/evenness of the matrix size. The
	  results differ very slightly from the old implementation, only
	  insofar as our matrix has small deviations from Hermiticity.

2013-06-10 22:04  dstrubbe

	* [r10820] Testing external energy too.

2013-06-10 22:46  dstrubbe

	* [r10821] * The description of CurrentThroughPlane was too
	  limited.
	  * nullify
	  * Formatting.
	  * Using only the relevant part of line%n.

2013-06-10 22:58  dstrubbe

	* [r10822] Reverting umberto's r10815 temporarily, until he can
	  address the assertion failures it causes in the photoelectron
	  tests. Umberto, you can use "svn merge -c -10821 ." to undo this
	  change and restore your change, and then apply the fix, when you
	  find it. (I do appreciate putting the unit in the output, too!)

2013-06-10 23:03  dstrubbe

	* [r10823] Bugfix: when running parallel in states with spinors,
	  the reported spin directions <Sx>, <Sy>, <Sz> were scrambled
	  among states and directions, due to incorrect usage of the
	  allgatherv routine. Passing arrays with specified indices AFTER
	  colons will usually not give what you want. The test
	  finite_systems_3d/21-lobpcg.02-spinors.inp had this problem, but
	  unfortunately the spin directions were not being checked.

2013-06-11 03:59  dstrubbe

	* [r10824] An argument seemed to be missing for complex scaling
	  here.

2013-06-11 09:02  acastro

	* [r10825] Removed an unused subroutine, and corrected the
	  documentation of the
	  OCTLaserEnvelope variable, that changed a few commits ago.

2013-06-11 10:25  umberto

	* [r10826] Rolled back r10816 changes + assertion failure fix

2013-06-11 12:29  joseba

	* [r10827] Correted a deadlock while calculating the Hamiltonian,
	  introduced by myself in r10348

2013-06-11 16:34  dstrubbe

	* [r10830] Writing my own EGREP macro for Fortran preprocessing,
	  which will hopefully work generally and not cause warnings.
	  
	  My previous attempt at a proper check for FCCPP in the configure
	  script worked but caused a series of warnings in the autconf
	  stage of the form:
	  
	  configure.ac:190: warning: AC_LANG_PREPROC(Fortran) is
	  m4_require'd but is not m4_defun'd
	  configure.ac:190: AC_LANG_PREPROC(Fortran) is required by...
	  autoconf/lang.m4:338: AC_LANG_PREPROC_REQUIRE is expanded from...
	  autoconf/general.m4:2129: AC_EGREP_CPP is expanded from...
	  m4/fortran.m4:134: ACX_FCCPP is expanded from...
	  configure.ac:190: the top level
	  
	  I could not properly do AC_DEFUN([AC_LANG_PREPROC(Fortran)])
	  since there is a bug in older autoconf that was fixed by 2.69,
	  that makes that this cause autconf to crash.
	  (http://osdir.com/ml/sysutils.automake.general/2002-10/msg00018.html)
	  
	  I guess I should have taken more seriously the statement in
	  autconf documentation regarding AC_EGREP_CPP: "The macros
	  described in this section cannot be used for tests in Erlang,
	  Fortran, or Go, since those languages require no preprocessor"
	  ...

2013-06-11 17:20  dstrubbe

	* [r10831] The external energy was wrong for spinors, and would
	  vary depending on factors such as parallelization in states. The
	  origin seems to be that X(hamiltonian_external) was not
	  maintained with corresponding changes for batches as was
	  happening with the very similar X(hamiltonian_base_local). To fix
	  the problem and avoid it in future, both X(hamiltonian_external)
	  and X(hamiltonian_base_local) are now wrappers around a common
	  routine X(hamiltonian_base_local_sub) which is based on
	  X(hamiltonian_base_local) with only minor modifications to
	  generalize it. This changes the values for external energy in a
	  test (which was not being checked until a recent commit).

2013-06-11 17:49  dstrubbe

	* [r10832] Testing energy components and spin directions in
	  21-lobpcg, that would have detected the problems I recently fixed
	  in r10831 and r10823. Also, fixing mistaken labels for the
	  eigenvalues in the spinor case, which are not up or down.

2013-06-11 19:30  dstrubbe

	* [r10833] * Fixing variable name for OpenCL compilation.
	  * Removing unused variable.

2013-06-11 19:50  dstrubbe

	* [r10834] Checking some more things, in particular 'Int[n*v_xc]'
	  which was checked nowhere in the testsuite as far as I can tell.

2013-06-11 22:54  dstrubbe

	* [r10835] Bugfix: when parallel in k-points, the number of
	  matrix-vector operations, and the number of converged vectors,
	  were not reduced/gathered among processors in the k-points group.
	  As a result, the calculation would almost certainly warn that
	  some states were unconverged, even if they all were.

2013-06-11 23:33  dstrubbe

	* [r10836] Adding matches for oct-dielectric-function run.

2013-06-11 23:35  dstrubbe

	* [r10837] Removing possible array temporary.

2013-06-11 23:50  dstrubbe

	* [r10838] Consolidating energy_calc_eigenvalues and
	  energy_calc_electronic, which are almost the same, into wrappers
	  around a common subroutine. This makes some small changes to
	  energy_calc_electronic, in favor of the presumably better
	  maintained energy_calc_eigenvalues.

2013-06-12 02:24  dstrubbe

	* [r10839] Fixing calculation of external potential with OpenCL.

2013-06-12 02:43  dstrubbe

	* [r10840] Removed unused variables, one of which was being
	  deallocated.

2013-06-12 15:11  dstrubbe

	* [r10841] Fixing mistake in r10838: the start indices for array
	  'eigen' need to be specified in the argument declaration.

2013-06-12 15:55  dstrubbe

	* [r10842] Using $EGREP in the FCCPP m4 macro is not safe unless we
	  can require that a macro to set this variable was previously.
	  However, doing so causes warnings I don't understand. So we'll
	  just use ordinary unqualified 'grep'. Many other macros use plain
	  'grep' anyway.

2013-06-12 16:14  dstrubbe

	* [r10843] Removing unnecessary limitation on convergence in a
	  test, to help it pass with ifort 13 on Stampede.

2013-06-12 18:23  dstrubbe

	* [r10844] Fix to r10838: (z)states_eigenvalues_sum now expects
	  only a local k-point range, and the angular momentum calculation
	  provides just that now. Some calculations parallel in k-points
	  were having a runtime error (from energy_calc_electronic) due to
	  this issue. Incidentally, I doubt the ang mom code worked
	  parallel in states before this.

2013-06-13 04:12  dstrubbe

	* [r10845] The spinor lobpcg test requires StatesBlockSize to be
	  set so that each processor has only one block, or else if the
	  eigensolver tries more than 10 or so iterations, it will fail to
	  solve the states and give large residuals.

2013-06-13 12:51  marques

	* [r10846] Added a few functionals:
	  
	  *) mgga_x_modtpss : tpss with optimized coefficients
	  *) gga_x_oblyp_d, opwlyp_d, opbe_d, tpss_d : reoptimizations by
	  Grimme to include dispersion terms.

2013-06-13 13:46  marques

	* [r10847] Sorry, small mistake in definition.

2013-06-14 21:34  dstrubbe

	* [r10848] Fixing dependency.

2013-06-14 22:34  dstrubbe

	* [r10849] Making FCCPP show up on the './configure --help' list of
	  "Some influential environment variables".

2013-06-14 23:07  dstrubbe

	* [r10850] * Fixing default for Preconditioner.
	  * Making parameters capitalized.
	  * Improving variable documentation.
	  * Undoing my mistaken comment about dimensions of angular
	  momentum output.
	  * Removing unnecessary colons.
	  * Moving ARPACK eigensolver options to their own category.

2013-06-15 00:16  dstrubbe

	* [r10851] Bugfix: FilterPotentials = filter_TS caused an
	  uninitialized value to be returned for spline_cutoff_radius and
	  used in the initialization of the pseudopotential. This is
	  because 'oct_spline_fit' was used within splines.F90 to
	  initialize spline objects, rather than the wrapper 'spline_fit',
	  which also includes initialization of x_limit.
	  * Now, the wrapper is used everywhere, which simplifies the call
	  anyway.
	  * x_limit is initialized to illegal values, and then we assert
	  they are ok in the routines that use x_limit. ('ASSERT' makes
	  spline_cutoff_radius no longer pure. I don't see any particular
	  reason it was pure though.)

2013-06-15 02:23  dstrubbe

	* [r10854] Bugfix: for OutputMatrixElements = one_body, an array
	  was too small, given that a derivative was being applied to it,
	  causing a possible segmentation fault.

2013-06-15 02:24  dstrubbe

	* [r10855] Inserting an assertion for derivatives to make sure the
	  array is large enough for the boundary conditions to be handled.

2013-06-16 03:35  dstrubbe

	* [r10856] * Doxygen comments.
	  * PUSH/POP's.
	  * Formatting.

2013-06-16 21:43  dstrubbe

	* [r10857] Renaming oct-run_testsuite to oct-run_testsuite.sh to
	  make clear that it is a shell script. I think people rarely use
	  this directly, so this shouldn't be a very disruptive change.

2013-06-17 04:55  dstrubbe

	* [r10858] The OpenCL m4 macro is unnecessarily complicating
	  matters by putting X11 libraries on the link lines in the tests,
	  even though they are not necessary for octopus to link with
	  OpenCL, as far as I can tell.

2013-06-17 05:05  dstrubbe

	* [r10859] Renaming libxc m4 macro in accordance with name change
	  in octopus since it was copied in. This is in preparation for
	  merging recent changes in octopus file to libxc.

2013-06-17 15:05  dstrubbe

	* [r10860] Updating libxc build system from octopus changes:
	  * Replaced obsolete AC_TRY_LINK_FUNC with AC_LINK_IFELSE.
	  * Removed AC_LANG_PREPROC(Fortran) and imported new ACX_FCCPP and
	  its dependency ACX_GREP_FCCPP.
	  Now libxc will make sure that a proper preprocessor for Fortran
	  is available.

2013-06-17 16:21  dstrubbe

	* [r10861] Fixing mistaken title of test.

2013-06-17 16:51  dstrubbe

	* [r10862] Enhancement to job parallelism in testsuite
	  (OCT_TEST_NJOBS): rather than waiting until the first job in the
	  queue is done to write results and queue a new job, we will check
	  whether any of the jobs in the queue are done. This improves load
	  balancing, by keeping the queue full even while one long job
	  runs; make sure all tests that are done have their results
	  written, giving more info even the testsuite run is cut off for
	  some reason; and makes output more frequent, helping to keep
	  buildslave runs from timing out.

2013-06-17 21:28  dstrubbe

	* [r10863] * Removing unrealistically low convergence criterion.
	  * Adding matches for energy components, which are not otherwise
	  checked for curvilinear tests, I think.

2013-06-17 22:25  dstrubbe

	* [r10864] Merged tested features from
	  finite_systems_3d/18-current.test into
	  finite_systems_3d/13-full_potential_hydrogen.01-gs.inp.
	  
	  The test finite_systems_3d/18-current takes a long time, since it
	  cannot do LCAO for more than one state because there is only one
	  bound state for its H psf pseudopotential. SCF was converging
	  just by chance, or not at all in 200 iterations. We can do a
	  better job emulating the paper this test refers to by testing
	  current and induced magnetic field from a full-potential H
	  calculation, which we have already. Then, LCAO is usable and SCF
	  converges quickly. That test does not use curv_gygi, but that
	  feature is tested already in 02-curvilinear, so I don't see a
	  particular need to have it involved in this test.

2013-06-17 22:41  dstrubbe

	* [r10865] * Two routines (oct_nanosleep and get_memory_usage) in
	  oct_f.c contained #ifdef linux. This was presumably due to a
	  concern that routines inside that part might not exist on other
	  platforms. The more appropriate procedure is just to check
	  whether the desired routines (nanosleep, sysconf, getpid) are
	  available, which we are already doing in the configure script for
	  other routines. These are all available on MacOS, for example, so
	  it is unnecessarily restrictive to disable usage if not Linux.
	  * Documentation and clearer name for (l)oct_nanosleep arguments.
	  I think they were copied by false analogy from gettimeofday:
	  there usec means microseconds, but here it is nanoseconds.
	  * oct_nanosleep can just pass NULL for the rem argument, since we
	  are not going to use the possible return value there anyway.

2013-06-17 23:05  dstrubbe

	* [r10866] Reclassifying the variables StatesOrthogonalization to a
	  place that makes more sense to me.

2013-06-18 00:14  dstrubbe

	* [r10867] Adding an assertion to make sure there is room for the
	  data being received in lmpi_gen_allgatherv.

2013-06-18 15:05  marques

	* [r10868] Added a revised B3LYP functional.

2013-06-18 18:51  dstrubbe

	* [r10869] Clean stop message resulting from 'go' mode need only be
	  written by root node.

2013-06-18 20:36  dstrubbe

	* [r10870] Bugfix: The multigrid eigensolver did not deallocate
	  anything.

2013-06-18 20:59  dstrubbe

	* [r10871] * Declaring Eigensolver = multigrid experimental, in
	  accordance with the variable reference, and the fact that it
	  doesn't seem to work (and is not in the testsuite at all).
	  * Providing proper debug output from multigrid eigensolver.
	  * Fixing incorrect reference to vol_pp which would cause a seg
	  fault except for curvilinear coordinates.

2013-06-18 22:13  dstrubbe

	* [r10872] * Adding debug modes for LOBPCG, PLAN, and RMMDIIS
	  eigensolvers.
	  * Allocating 'eigen' once for all the various uses in RMMDIIS.
	  * Removed unused (but allocated and deallocated) variables in
	  rmmmdiis_min.
	  * Typo.
	  * Adding missing ID line.

2013-06-19 16:59  dstrubbe

	* [r10873] Bugfix to r10862: my enhanced job parallelism in the
	  testsuite broke the ability to count job failures properly,
	  because the return status of a sleep command was being used
	  rather than the return status of the call to
	  oct-run_regression_test.pl.

2013-06-19 17:17  dstrubbe

	* [r10874] Fix to ordering of lines in oct-run_testsuite.sh, for
	  newer version of autoconf. The 'local run' option wouldn't work
	  because the default testsuite path was missing the beginning.

2013-06-19 17:20  dstrubbe

	* [r10875] Older versions of svn do not ignore *.a by default.

2013-06-19 17:26  dstrubbe

	* [r10876] ifort 11.1 needs a slightly looser tolerance on
	  testsuite/components/01-derivatives_1d.01-inp.

2013-06-19 18:48  dstrubbe

	* [r10877] Removing unused variables and arguments.

2013-06-19 23:28  dstrubbe

	* [r10878] Checking that the number of rows in block Occupations is
	  correct, and that the number of columns is the same in all rows,
	  to give a more helpful message than the assertion failure that
	  would otherwise result from parse_block_float. Also, made
	  documentation clearer about these requirements.

2013-06-20 01:12  dstrubbe

	* [r10879] Removing spurious extra line in Occupations block for a
	  test which is not spin-polarized.

2013-06-20 02:43  dstrubbe

	* [r10880] Removing if-conditions that handle a situation that can
	  never happen.

2013-06-21 19:20  dstrubbe

	* [r10886] The derivatives tests do not use the Coordinates and
	  Species, but something must be present anyway for the
	  initialization to proceed without an error. However, it would be
	  better to provide something that at least would be acceptable for
	  an ordinary run. Thus, I am putting a dummy user-defined species
	  instead of the Na pseudopotential for the 1D and 2D runs.

2013-06-21 19:25  dstrubbe

	* [r10887] Notes and error message regarding pseudopotentials only
	  being usable in 3D. Also, adding an assertion that will be
	  triggered if double grid is called other than in 3D, which is
	  assumed extensively in those routines.

2013-06-23 01:55  dstrubbe

	* [r10888] When messages_fatal is called with only_root_writes =
	  .true., it is possible for a non-root process to call MPI_Abort
	  before root has written the error message, so it is never
	  printed. This seems to happen particularly when running directly
	  on the command line. To avoid this, the other processes will
	  wait, and then write it themselves if root does not. Also this
	  will avoid missing messages if only_root_writes is used
	  mistakenly for an error case that does not happen on root.

2013-06-23 17:41  dstrubbe

	* [r10889] 'input_error' should be implemented via
	  'messages_fatal', for consistency, and to take advantage of
	  messages_fatal's writing of the stack trace and new provision for
	  making sure message gets written before abort.

2013-06-23 18:11  dstrubbe

	* [r10890] * Offering another place to look for multicomm problems.
	  * Blocking some OutputMatrixElements calculations that are
	  incompatible with states parallelization.

2013-06-23 18:19  dstrubbe

	* [r10891] Bugfix: OutputMatrixElements = momentum or
	  angular_momentum suffered from a wide array of problems, too many
	  to bother listing. I hope no one was using them, because any
	  results were surely wrong. Now they work, and are tested.

2013-06-23 19:15  dstrubbe

	* [r10892] Fixing compilation error in serial.

2013-06-23 20:00  dstrubbe

	* [r10893] Getting rid of two array temporaries.

2013-06-24 15:36  dstrubbe

	* [r10894] Moving the ETSF_IO test to the long run only.

2013-06-24 16:19  dstrubbe

	* [r10895] Removing unused modules.

2013-06-24 20:02  dstrubbe

	* [r10896] * Correction to comment about orbital in test.
	  * Fixing format statement to avoid ****** output.
	  * Unused variable.
	  * More precision in output of mesh cutoff.

2013-06-24 20:05  dstrubbe

	* [r10897] * Fixing intent(out) :: y to intent(inout) in bpdn
	  interface for dgemv, as we correctly have in the main code.
	  * Doxygen comments.
	  * Replacing non-standard extension 'dfloat' with equivalent
	  'dble' in newuoa.

2013-06-25 03:41  dstrubbe

	* [r10898] * Removing (excessively large) explicit argument array
	  bound.
	  * Using optional_default.
	  * Adding extra checks in states_orthogonalize_single.

2013-06-25 04:53  dstrubbe

	* [r10899] Fixing intents in accordance with the actual LAPACK
	  routines.

2013-06-25 15:20  dstrubbe

	* [r10900] * Typos.
	  * Using float constant for float arithmetic.

2013-06-25 15:41  dstrubbe

	* [r10901] sgfft specifies the maximal size for argument 'trig'
	  which means uninitialized or out-of-bounds data might be copied
	  when the size is actually smaller. Since this is a module, there
	  is no need to specify the size anyway.

2013-06-25 15:58  dstrubbe

	* [r10902] Unnecessary dependency.

2013-06-25 16:13  askhl

	* [r10903] add comma to achieve what is presumably the correct
	  meaning

2013-06-25 17:14  dstrubbe

	* [r10904] Preventing some unlikely divide-by-zero cases for
	  convergence criteria.

2013-06-25 18:08  dstrubbe

	* [r10905] Creating C wrappers for calling dgemm with complex
	  values from hamiltonian_base, so we can actually use blas_m and
	  have interfaces. This is along the same lines as the existing
	  "dablas" wrappers for scaling a complex vector by a real scalar.

2013-06-25 18:18  dstrubbe

	* [r10906] Forgotten part of interface in previous commit.

2013-06-25 18:46  dstrubbe

	* [r10907] ifort and other compilers objected to previous interface
	  form for zdgemm. Now, unified into blas_gemm, which seems
	  satisfactory.

2013-06-25 19:22  dstrubbe

	* [r10908] Correction to generation of Fourier shell: in r8674 I
	  added a "convention" as to whether to include -N/2 or N/2 in the
	  shell. Well, to follow how plane-wave codes do it, we should
	  actually include neither of them.

2013-06-25 19:49  dstrubbe

	* [r10909] Fix to r10873 (job parallelism in testsuite): the check
	  for the status of a test via the return code of its pid could
	  fail, because it was possible for a new process with the same pid
	  to have started before the check occurred. This happened on the
	  chum_x86_64_pgi_test slave, producing error message:
	  
	  ./oct-run_testsuite.sh: line 123: wait: pid 23407 is not a child
	  of this shell
	  
	  The new approach is to capture the return code into a variable
	  named after the test, which will then be read when the job has
	  finished.

2013-06-26 13:49  dstrubbe

	* [r10910] * Updating ETSF_IO wfn file size in light of r10908.
	  * Removing debugging output left in r10909.

2013-06-26 16:46  askhl

	* [r10911] spelling

2013-06-27 01:07  dstrubbe

	* [r10912] * Removing some debugging output.
	  * Adding a warning if KPointsGrid is not set, when writing
	  BerkeleyGW.
	  * Allowing KPointsGrid to be set even if KPoints or
	  KPointsReduced is used to specify the k-points. This has no
	  effect (I hope!) except that BerkeleyGW output needs the values
	  from there.

2013-06-27 03:37  dstrubbe

	* [r10913] We are not testing TDOutput = populations anywhere.
	  Let's.

2013-06-27 15:16  dstrubbe

	* [r10914] For TDOutput = td_occup or populations, we copy the
	  whole states object, then deallocate a lot of it, then refill it.
	  It would be more efficient to just refrain from copying the parts
	  we don't need. In particular, before we needed memory available
	  for all the states again, whereas now, if TDProjStart > 1, we
	  will only need memory for the number of states we will actually
	  use.

2013-06-27 15:35  dstrubbe

	* [r10915] Fix to last commit: states_init_block needs to be in the
	  exclude section of states_copy too.

2013-06-27 18:30  dstrubbe

	* [r10916] Another fix to r10914/r10915: the original order of
	  things in states_copy must be preserved.

2013-06-27 18:40  dstrubbe

	* [r10917] * Fixing an intent.
	  * Comments on how to implement OutputMatrixElements for parallel
	  in states.

2013-06-27 19:04  dstrubbe

	* [r10918] * Bugfix: condition for when to read TDProjStateStart
	  was accidentally reversed in r3597 (6 yrs ago!).
	  * Improvement of documentation regarding TDOutput = td_occup,
	  populations.

2013-06-27 20:38  dstrubbe

	* [r10919] We should always write the k-points for periodic
	  systems.

2013-06-28 10:29  acastro

	* [r10920] Removed the "EigenSolverMaxIter = 1000" line, from some
	  test input files,
	  since this is not a recommended value and in fact the code emits
	  a warning if
	  it finds it.

2013-06-28 18:16  dstrubbe

	* [r10921] Adding tool to look up the values reported by the
	  buildslaves for a particular match. This can be helpful, for
	  example, in choosing an appropriate tolerance.

2013-06-28 21:01  dstrubbe

	* [r10923] Clarification to documentation.

2013-06-30 18:02  xavier

	* [r10924] Bugfix: CL buffer had the wrong mode.

2013-06-30 18:07  xavier

	* [r10925] Reverted an accidental change in my last commit.

2013-06-30 18:54  xavier

	* [r10926] Bugfix: A CL buffer was initialized with the wrong mode.
	  
	  With this changes Octopus appears to run correctly on the Intel
	  Xeon Phi.

2013-06-30 19:02  xavier

	* [r10927] * Added a check for the mode of CL buffers.
	  * Removed a CL compilation flag that causes problem with the Xeon
	  Phi.

2013-07-01 13:15  marques

	* [r10928] *) Corrected vug in c09x as reported by Lampros
	  Andrinopoulos
	  *) Corrected bug in xc-consistency

2013-07-01 13:20  marques

	* [r10929] Making sure we never divide by zero. Reported by
	  Vittorio Zecca and David.

2013-07-01 18:43  xavier

	* [r10930] * The OpenCL code now defines the SHARED_MEM
	  preprocessor macro. It is
	  defined for GPUs and undefined for accelerators and CPUs.
	  
	  * The type of processor is not printed.

2013-07-01 19:00  xavier

	* [r10931] Added non-shared memory version of the non-local
	  operator.

2013-07-02 01:27  xavier

	* [r10932] Fixed non-opencl compilation.

2013-07-02 10:58  acastro

	* [r10933] Changed some small things in some test inputs to avoid
	  warnings.

2013-07-02 13:16  xavier

	* [r10934] * Added an initial iteration to the derivatives test to
	  avoid benchmarking initializations.
	  * Registerization of a variable in the operate kernel.

2013-07-02 18:14  acastro

	* [r10935] Changed little details in tests input files to avoid the
	  emission of warnings.

2013-07-02 19:37  acastro

	* [r10936] Eliminated a rarely used feature (using "mixing" for the
	  optimal control
	  algorithms) that complicates the code.

2013-07-03 16:53  acastro

	* [r10940] Some clean-up of the optimal control code (current &
	  density targets)

2013-07-03 18:18  xavier

	* [r10941] A new feature: Ordering of grid points based on a
	  Hilbert space
	  filling curve.

2013-07-03 19:59  xavier

	* [r10942] Increased the size of the hilbert curve index to 64
	  bits.

2013-07-03 20:04  acastro

	* [r10943] Some more cleaning of the oct part of the code.

2013-07-03 20:48  xavier

	* [r10944] Bugfix: a CL buffer had the wrong intent.

2013-07-03 22:37  acastro

	* [r10945] Added one file for each one of the optimal control
	  targets.

2013-07-04 03:17  xavier

	* [r10946] Added a Hilbert 2D mesh order.

2013-07-04 08:21  acastro

	* [r10947] Increased the tolerance of a test that seems to be
	  rather sensitive to
	  machine/compiler/etc. changes.

2013-07-04 19:52  acastro

	* [r10948] Removed an unnecessary variable ("OCTMoveIons"), there
	  are too many
	  variables... Also, more splitting of the opt_control_target_m
	  module.

2013-07-05 14:22  umberto

	* [r10949] Added feature to prooct-photoelectron-spectrum that
	  allow to plot velocity map slices of the photoelectron-spectrum
	  integrated over an angle. This should help direct comparison with
	  experimental velocity-map images that are reconstructed by
	  imposing cylindrical symmetry around the laser polarization axis.

2013-07-06 20:01  xavier

	* [r10950] Added a new opencl non-local operator, it does not use a
	  map to get the neighbors indexes.

2013-07-07 22:22  xavier

	* [r10951] Improvements for the nomap operate.

2013-07-09 17:36  dstrubbe

	* [r10952] Typo.

2013-07-09 17:40  dstrubbe

	* [r10953] Clarification about MaximumIter = 0.

2013-07-09 17:42  xavier

	* [r10954] Removed some output in the calculation of the
	  propagation spectrum
	  introduced in [10074].

2013-07-09 21:46  acastro

	* [r10955] Added the "soft-Coulomb" potential as a new species
	  type. Of couse the "user
	  defined" type could be used to create soft-Coulomb potentials,
	  but then it is
	  terribly slow to do dynamics moving the ions, since the parsing
	  of the user
	  defined expressions is very slow. Since soft-Coulomb potentials
	  are used quite
	  often, I think they deserve their own type.
	  
	  [Perhaps a better solution would be to improve the parser to make
	  it faster,
	  but this is not an easy task]

2013-07-09 23:17  dstrubbe

	* [r10956] Valgrind and compiler debugging flags do not consider it
	  acceptable to pass null pointers. Thus, we will pass a whole
	  object containing the possibly null pointer.

2013-07-10 07:59  micael

	* [r10957] * Tagging version 2.0.2
	  * Updated ChangeLog, NEWS, etc.

2013-07-10 18:41  dstrubbe

	* [r10958] Moving to the new style with units for parse_float in a
	  few places.

2013-07-10 18:54  dstrubbe

	* [r10959] Documenting secret variables.

2013-07-10 19:08  dstrubbe

	* [r10960] * Another place to use the new unit parsing call.
	  * Default for GOMinimumMove will be zero except for simplex
	  method. Using only the forces as convergence criterion seems to
	  make more sense for the other methods.

2013-07-10 21:28  dstrubbe

	* [r10961] Bugfix: an error was not sent to standard error.

2013-07-10 21:33  dstrubbe

	* [r10962] Better documentation for curv_modine.

2013-07-10 23:08  dstrubbe

	* [r10965] Rationalizing filenames.

2013-07-10 23:16  dstrubbe

	* [r10966] Making states_matrix a little more compatible with
	  parallelization, and the possibility of not using all the states.

2013-07-11 02:00  dstrubbe

	* [r10967] * Fixing compilation error from previous commit.
	  * Go up to st_end instead of nst, in case they differ.

2013-07-11 02:30  xavier

	* [r10968] Added a C include file 'fortran_types.h' that defines
	  the types fint,
	  fint4 and fint8, equivalent to the Fortran integer, integer(4)
	  and
	  integer(8) types, respectively. (I still have to implement the
	  autoconf checks required to define the types.)
	  
	  C code that defines Fortran functions (using FC_FUNC) should
	  always
	  use these types in the interface to ensure compatibility with
	  8-byte
	  Fortran integers.

2013-07-11 02:49  dstrubbe

	* [r10969] Removing spurious argument.

2013-07-11 10:34  umberto

	* [r10970] Reimplemented buggy rotation matrix

2013-07-11 10:36  umberto

	* [r10971] Integrate velocity map along kx, ky, kz in order to
	  directly compare with experimental raw velocity map images

2013-07-11 12:17  umberto

	* [r10972] wrong angle

2013-07-11 12:50  micael

	* [r10973] * Fixed warnings about missing field initializers.

2013-07-11 13:19  micael

	* [r10975] * Removed unused variables in libxc.

2013-07-11 14:39  dstrubbe

	* [r10977] Resolving matter of degenerate perturbation theory for
	  Petersilka forces.

2013-07-11 15:28  micael

	* [r10978] Corrected the FSF address in the copyright.

2013-07-11 16:42  dstrubbe

	* [r10979] libxc has had occasional trouble with a parallel build
	  (make -j). I have tried to fix this before, but with only partial
	  success. I think this might be real solution. Dependencies are in
	  terms of the funny objects libtool makes, not the normal .o
	  files. Dependencies are declared on module files, and the module
	  files (while not having actual rules) are declared dependent on
	  the .lo files that will created in the same compilation that
	  produces the modules. It is necessary to declare dependencies for
	  both .lo and .o because 'make' and 'make install' don't both
	  necessary work with the same ones.

2013-07-11 16:54  dstrubbe

	* [r10980] Spurious comma.

2013-07-11 17:05  dstrubbe

	* [r10981] It seems GOMinimumMove and GOTolerance have to be
	  negative to be definitely not used as convergence criteria, since
	  tolgrad or toldr exactly zero is possible. Setting them negative
	  makes the condition impossible.

2013-07-11 18:39  dstrubbe

	* [r10982] I broke libxc compilation on chum (older
	  automake/libtool versions) with r10979, by explicitly referring
	  to the objects produced by libtool. Unfortunately, their names
	  are not always the same. Surprisingly, libtool/automake do not
	  seem to provide a macro or variable for what the object names
	  will be, so we have to extract it ourselves. LTPREF=libxcf90_la-,
	  or blank for older libtool/automake versions.
	  
	  Produces these warnings on some systems. Does not seem to matter.
	  
	  src/Makefile.am:140: subst xc_f.lo,,$(firstword
	  $(am_libxcf90_la_OBJECTS: non-POSIX variable name
	  src/Makefile.am:140: (probably a GNU make extension)

2013-07-11 18:45  dstrubbe

	* [r10983] * Fixing possible loss of precision in netcdf and cube
	  output where 'real' is used.
	  * Noting which options in OutputHow give only the real part.

2013-07-11 19:38  dstrubbe

	* [r10985] The variable OutputEvery had a confusing meaning,
	  differing in different CalculationModes, regarding whether it
	  controlled ordinary output, restart, or both. I have separated
	  its functionality into OutputInterval and RestartWriteInterval.
	  OutputInterval now works with OutputDuringSCF (whereas
	  OutputEvery did not).
	  
	  Three subtleties:
	  * RecalculateGSDuringEvolution presumably would make more sense
	  to work with OutputEvery than RestartWriteInterval, however it
	  overwrites the states and then restarts from the td directory, so
	  it will destroy the calculation if it does not perform a restart
	  write previous to that.
	  * The PES code does not distinguish clearly between output and
	  restart. PES_mask (but not PES_rc) writes restart files in a
	  function about output, and indeed will fail if called before the
	  restart directory is created. Umberto, you should clean this up.
	  For the time being, all PES output is controlled by
	  RestartWriteInterval and not OutputInterval.
	  * No tests seem to rely on the behavior of these variables at
	  all, though many set OutputEvery. I changed them all to
	  OutputInterval.

2013-07-11 21:24  dstrubbe

	* [r10986] Refactoring casida: casida_get_matrix is no longer
	  subordinate to casida_work, taking with it load_saved and K_term,
	  thus requiring some more arguments and elements of casida_t.

2013-07-12 02:30  dstrubbe

	* [r10987] Breaking casida_forces_init out of casida_work.

2013-07-12 10:08  acastro

	* [r10988] The code allows the possibility of changing the mass of
	  the particles, but
	  then forgets to consider this change of mass when applying the
	  magnetic terms
	  of the Hamiltonian.

2013-07-12 14:57  dstrubbe

	* [r10990] Fixing POP_SUB.

2013-07-12 16:07  dstrubbe

	* [r10991] * Making routines casida_get_matrix and write_K_term
	  into templated ones.
	  * casida_t now keeps track itself of whether it is real or
	  complex.
	  * cas%mat, cas%tm, cas%pot, and cas%mat_save now have real and
	  complex versions.
	  * casida_matrix_factors now is casida_matrix_factor and just
	  returns the factor rather than applying it.
	  * oscillator strengths are closer to working with complex.

2013-07-12 16:24  dstrubbe

	* [r10992] * There was an interface declared for assert_die in
	  global_m, but it
	  was private and so had no effect. Now it is public and thus
	  checked.
	  * assert_die itself does not need global_m, and cannot use it or
	  there
	  is a conflict with its own interface declared there.
	  * Removing useless variable from bpdn.

2013-07-12 16:36  dstrubbe

	* [r10993] * More generalization of Casida for complex wfns.
	  * Unused variables.

2013-07-12 17:00  dstrubbe

	* [r10994] * Made casida_forces_init a template routine, greatly
	  simplifying it.
	  * Fixed indentation for casida_matrix_factor.

2013-07-12 18:01  dstrubbe

	* [r10997] casida_matrix_factor did not actually return anything.
	  (Astonishing, the code still worked, at least when the expected
	  return value was 1...)

2013-07-12 18:37  dstrubbe

	* [r10998] * Renaming casida_forces_init to casida_forces, since it
	  does everything, not just initialize.
	  * Renaming casida_lr_hmat1 to casida_calc_lr_hmat1.
	  * Refactoring new routine casida_get_lr_hmat1 out of
	  casida_forces, which will read or calculate and write lr_hmat1.

2013-07-12 21:58  dstrubbe

	* [r10999] * The one-body matrix elements for Casida forces are now
	  used for restart.
	  * These files now are opened with is_tmp = .true. for consistency
	  with the other Casida restart files.
	  * Renamed 'is' and 'js' to 'ik' and 'jk' since they could be
	  k-points not just spin, in principle.
	  * Restart in casida now has error-handling for finding illegal
	  indices.

2013-07-13 03:43  dstrubbe

	* [r11000] * Skipping more work for forces when restarting.
	  * Must MPI broadcast what was read as saved.
	  * Hermitian conjugates for read matrix elements.

2013-07-13 04:03  dstrubbe

	* [r11001] Fixing compilation error in r11000.

2013-07-13 17:28  dstrubbe

	* [r11002] Fixing PUSH_SUB.

2013-07-14 00:47  dstrubbe

	* [r11003] newuoa should be in the list of configuration options.

2013-07-14 14:47  acastro

	* [r11004] The mesh_random routine places Gaussians with
	  characteristics widths and
	  center positions that are indpendent of the grid spacing. This is
	  a problem
	  when using very large grid spacing (for example when one works
	  with a 2DEG
	  with a small efective mass).

2013-07-14 16:49  acastro

	* [r11005] Last commit produced small but non-negligible changes in
	  this test.

2013-07-14 16:55  acastro

	* [r11006] Corrected a couple of things related to the use of a
	  velocity target in
	  optimal control runs. Added a test for this feature.

2013-07-14 18:17  acastro

	* [r11007] Fixed compilation problem.

2013-07-14 19:01  acastro

	* [r11008] The use of a wrong variable caused out-of-bounds error.

2013-07-16 07:41  acastro

	* [r11009] Wrong POP_SUB.

2013-07-16 16:56  micael

	* [r11010] Bug fix: some variable were used before being set when
	  calculating the second and third derivatives with
	  spin-polarization.

2013-07-16 16:59  micael

	* [r11011] * Improved the functional_get_name Fortran interface.

2013-07-17 11:54  acastro

	* [r11013] Bug fix for the problem reported by several users: the
	  laser printed in file
	  td.general/laser changes after performing a restart.

2013-07-18 18:19  dstrubbe

	* [r11016] Let's use 4 processors for all parts of the Casida test,
	  to help speed up the lengthy unocc and vib_modes calculations.

2013-07-19 07:48  acastro

	* [r11017] All the operations needed to propagate the system one
	  time step are done now
	  inside the propagator_m module (including both the electrons and
	  the ions),
	  instead of inside the iteration loop in the td_run subroutine. I
	  separated the
	  cases of Ehrenfest, CP, and BO dynamics, since mixing them led to
	  quite
	  complicated code.

2013-07-19 10:21  acastro

	* [r11018] A couple of bugs fixed: the propagator_dt routine did
	  not handle well the dt<0
	  case, and one uninitialized variable.

2013-07-19 15:48  dstrubbe

	* [r11019] * Expanding format for mesh_index since there can easily
	  be more than a million points. More than a trillion is probably
	  unlikely ;-)
	  * Documentation about display_mesh_index.gp.

2013-07-19 15:49  dstrubbe

	* [r11020] Adding mesh_index to the output test.

2013-07-19 20:36  dstrubbe

	* [r11021] * Removing zoltan from Doxygen config, since it is gone.
	  * 'make clean' should remove .deps files too, or things can
	  accumulate invisibly in there.

2013-07-19 20:53  dstrubbe

	* [r11022] Reverting previous addition of .deps to files to be
	  cleaned by 'make clean.' They are only created by configure, and
	  do not have appropriate dependencies set to regenerate them, so
	  my change made './configure; make clean; make install' fail,
	  which ought to work.

2013-07-20 16:05  dstrubbe

	* [r11023] Typo in POP_SUB.

2013-07-20 23:30  dstrubbe

	* [r11024] We were maintaining two ways of writing out the
	  configuration options for octopus, one to be accessed from the
	  command line and written in C, and one to write in the main
	  output file and written in Fortran. I have unified them into
	  Fortran routines that write strings which can be passed to C. I
	  added max-dim to the list given on the command line, and parmetis
	  also which was missing.

2013-07-21 21:31  dstrubbe

	* [r11025] Fixing two small issues with the extraction of the "true
	  compiler":
	  * echo from sh, at least on MacOS, does not support the -n
	  option, so this was ending up in the output from
	  true_compiler.sh. However, if we use bash everywhere, this seems
	  portable.
	  * MPI compilers/wrappers usually, but not always, called mpicc
	  and mpif90. For example, MacPorts openmpi calls them openmpicc
	  and openmpif90; Intel MPI calls the mpiicc and mpiifort. I made
	  true_compiler.sh be a bit more general, and try -show as long as
	  the name contains 'mpi', which includes all these cases.
	  
	  Also, for consistency and general good practice, I used
	  /usr/bin/env bash rather than just bash, and did the same for
	  svn_release_number.sh.

2013-07-22 00:06  dstrubbe

	* [r11026] Fixing two warnings flagged by clang:
	  * metis function did not use the same capitalization as in
	  metis.h, so it seemed not to be declared.
	  * warning: add explicit braces to avoid dangling else
	  [-Wdangling-else]

2013-07-22 00:22  dstrubbe

	* [r11027] This test, with task parallelization, requires MPI2.

2013-07-22 03:07  dstrubbe

	* [r11029] * Splitting the fullerene test into 3 separate ones,
	  since they are independent ground-state calculations, and
	  sometimes the build slaves are timing out on those long
	  calculations, which would be less likely if the process could
	  return after each one.
	  * Adding a missing test file in Makefile.am.

2013-07-22 17:38  acastro

	* [r11034] Eliminated the unnecessary variable
	  "OCTControlRepresentation". It made a
	  somehow artificial distinction between functions represented by a
	  "set of
	  parameters", and functions represented "in real time". In a
	  computer,
	  functions represented in real time are in fact represented by a
	  set of
	  parameters, which are the values of the function in the
	  discretized time
	  grid.

2013-07-22 18:47  dstrubbe

	* [r11035] "true compiler" support for Cray compiler wrappers cc
	  and ftn (which may or may not be in parallel).

2013-07-23 16:29  dstrubbe

	* [r11037] With debugging flags turned on, the call to
	  MPI_Alltoallv with explicit reference to the first element of
	  each array is considered illegal when the arrays have size zero,
	  which I found to be the case in a calculation of silicon with 32
	  processors.

2013-07-23 16:59  dstrubbe

	* [r11038] * BerkeleyGW wavefunction output was ignoring the way
	  that plane-wave codes do not use the same set of G-vectors for
	  all k-points, but rather construct the set of G-vectors such that
	  |k+G|^2/2 < cutoff. BerkeleyGW requires this so that k-points are
	  treated consistently for a certain cutoff. The Fourier shell now
	  does this if a k-point is supplied as an argument. ETSF_IO maybe
	  ought to do this too.
	  * All wavefunction G-vectors, and those resulting from symmetry
	  rotations on the k-points, need to yield G-vectors within the set
	  of G-vectors for the density. To ensure this, we cannot use the
	  same cutoff for the wavefunctions and the density, as we were
	  doing, but must reduce the wavefunction cutoff. The exception is
	  when we are doing a finite system, and there will be only Gamma.
	  * Thus we now need to find ngkmax, and use different Fourier
	  shells for each wavefunction, different from the density shell.
	  * A function is split off in Fourier shell to return this usable
	  wavefunction cutoff.

2013-07-23 20:41  acastro

	* [r11039] Started the generalization of the optimal control run
	  mode to deal with
	  Ehrenfest systems.

2013-07-24 08:00  acastro

	* [r11040] One more step in the generalization of the optimal
	  control procedures for
	  control of Ehrenfest systems.

2013-07-24 17:05  acastro

	* [r11041] Some more changes to allow for optimal control of
	  Ehrenfest systems.

2013-07-25 16:23  acastro

	* [r11042] Added the classical degrees of freedom to the
	  opt_control_state_t data
	  structure.

2013-07-25 21:55  dstrubbe

	* [r11044] * Missing dependencies.
	  * Renaming filters.F90 for consistency with its module filter_m.
	  
	  (Alberto, you should make the target and propagation modules and
	  filenames consistent too.)

2013-07-26 18:38  dstrubbe

	* [r11045] Missing dependency.

2013-07-27 09:32  acastro

	* [r11046] Little bug that affected backwards propagations only.

2013-07-29 02:04  dstrubbe

	* [r11047] * Adding a test for BerkeleyGW output, only in serial
	  for now.
	  * Adding missing files to Makefile.am.

2013-07-29 07:43  acastro

	* [r11048] Changed the name of some modules, to make them match the
	  corresponding
	  filenames.

2013-07-29 17:24  dstrubbe

	* [r11049] Implementing field-based LINE and GREP commands in the
	  testsuite script, that can be used instead of the column-based
	  ones we currently have (but which require lots of counting by
	  hand to set up, and the output must be in a fixed format).

2013-07-29 20:58  dstrubbe

	* [r11050] Using new LINEFIELD matches for BerkeleyGW test, and
	  testing diagonal elements only, which are not subject to
	  arbitrary phases.

2013-07-30 10:18  acastro

	* [r11051] Added the computation of the forces in a couple of
	  places where they were
	  missing. Improved the opt_control_state_t data structure.

2013-07-31 09:27  acastro

	* [r11052] During the backwards propagation, the ions need to be
	  frozen.

2013-08-01 10:20  acastro

	* [r11053] Added a new target to the OCT code. It depends only on
	  the classical degrees
	  of freedom. It does not really work yet.

2013-08-01 14:23  acastro

	* [r11054] Moved target_parse_velocity to the parser, where it
	  belongs.

2013-08-01 19:54  dstrubbe

	* [r11055] Typo.

2013-08-01 21:37  dstrubbe

	* [r11056] Bugfix: loop went only to 2 instead of 3 in a
	  poisson_fft routine. Fortunately, I don't think this mattered in
	  most casees. (I caused this in r8523.)

2013-08-02 01:48  xavier

	* [r11057] * Bugfix: The dynamical matrix had the wrong units, it
	  should have
	  dimensions of energy**2 instead of energy. This error was
	  discovered
	  by Jacob Sanders.
	  
	  * The dynamical matrix is now printed in scientific notation.

2013-08-02 11:35  xavier

	* [r11058] I forgot to update the precision values to the proper
	  units in the
	  vibrational modes test.

2013-08-02 13:49  acastro

	* [r11059] Added some necessary input variables to define classical
	  targets.

2013-08-02 21:42  dstrubbe

	* [r11060] Refactoring duplicated code in poisson_fft routines.

2013-08-03 19:34  dstrubbe

	* [r11061] The exchange operator is supposed to have a loop over
	  k-points. This is in preparation for implementing exchange for
	  k-points properly.

2013-08-03 23:36  dstrubbe

	* [r11062] Recentering dynamical-matrix match and increasing
	  tolerance slightly, so all can pass.

2013-08-05 05:46  dstrubbe

	* [r11063] I accidentally missed a zero in the precision in r11062.

2013-08-05 14:51  marques

	* [r11064] Added c_PBEint, c_zPBEsol, c_zPBEint

2013-08-05 15:04  marques

	* [r11065] Added x_pbeint

2013-08-05 15:09  xavier

	* [r11066] Bugfix: xc.h was defining FLOAT and other undocumented
	  macros that
	  could case name clashes with user code. Now these macros are not
	  declared. Internal libxc code that uses them needs to include
	  "xc_config.h" explicitly.

2013-08-05 21:36  acastro

	* [r11067] Corrected a couple of bugs that affected the classical
	  OCT target.

2013-08-05 23:31  dstrubbe

	* [r11068] Initialization, for the case UnoccMaximumIter = 0.

2013-08-05 23:46  dstrubbe

	* [r11069] Making the hamiltonian type keep track of its own
	  geometry, for convenience and to ensure that it deallocates
	  itself consistently.

2013-08-06 15:40  acastro

	* [r11070] The OCT classical target was assuming unit-mass for all
	  classical
	  particles. Changed the symbols "r" and "v" by "q" and "p" to
	  enter the
	  description of the classical target in the inp file.

2013-08-06 23:37  dstrubbe

	* [r11071] For simplicity, unocc can use the same variable name as
	  in SCF, namely MaximumIter.

2013-08-07 05:08  dstrubbe

	* [r11072] Removing a useless initialization (followed by another
	  initialization later), and removing modules which are not really
	  used.

2013-08-07 14:23  umberto

	* [r11073] Added interface to gsl_combination

2013-08-07 14:26  umberto

	* [r11074] Added ionization_channels to TDoutput.
	  This allow to calculate the multiple ionization probability based
	  on KS orbitals as done in:
	  C. Ullrich, Journal of Molecular Structure: THEOCHEM 501, 315
	  (2000)

2013-08-07 14:45  umberto

	* [r11075] Fixed error compiling with mpi.

2013-08-07 15:52  joseba

	* [r11076] Deleted two instances of part_vec

2013-08-07 16:04  umberto

	* [r11077] Fixed ionization channels when running parallel on
	  states.

2013-08-07 18:31  acastro

	* [r11078] Wrong allocation of one array.

2013-08-07 18:45  dstrubbe

	* [r11079] Ensuring initializations in restart.

2013-08-07 19:50  dstrubbe

	* [r11080] * Determining the actual number of occupied states, in
	  unocc, and using it for the warning about lack of convergence.
	  * Changing a variable name to avoid clashing with the
	  occupied_states routine.

2013-08-07 20:16  dstrubbe

	* [r11081] Using occ_states array in more places in unocc mode.

2013-08-07 22:11  dstrubbe

	* [r11082] Typos.

2013-08-08 04:58  dstrubbe

	* [r11083] Refactored out the reading of the lxyz file in restart.

2013-08-08 05:22  dstrubbe

	* [r11084] restart_read_rho can now handle a changed/reordered
	  grid, like restart_read.

2013-08-08 06:22  dstrubbe

	* [r11085] Checking validity of input to avoid possible array out
	  of bounds in optimal control.

2013-08-08 06:23  dstrubbe

	* [r11086] Documentation formatting.

2013-08-08 09:37  joseba

	* [r11087] SAFE_ALLOCATE started from 1 to be able to print in
	  profiling memory

2013-08-08 11:44  umberto

	* [r11088] Added interface for gsl_combination

2013-08-08 11:45  umberto

	* [r11089] use loct_math interfaces

2013-08-08 17:41  dstrubbe

	* [r11090] * We can't use PUSH/POP in loct_math as it does not load
	  the relevant modules.
	  * Doxygenation.

2013-08-08 18:39  dstrubbe

	* [r11091] Hartree-Fock was broken for parallelization in k-points
	  (and probably states too) due to incorrect communication in the
	  Poisson solve. I think I fixed the same problem in the OCT
	  exchange, and I suspect it is present in GCM and RDMFT too (which
	  I commented on but did not change).

2013-08-08 19:11  dstrubbe

	* [r11092] Bugfix: the check for more than one block in lobpcg was
	  not very accurate. (r10774)

2013-08-08 19:20  dstrubbe

	* [r11093] unocc should write density after all. While the physical
	  values should not be changed, it should be rewritten in case the
	  grid was reordered; otherwise the newly written wavefunctions
	  will be inconsistent with the old grid for the density from the
	  previous calculation.

2013-08-09 09:20  joseba

	* [r11094] Deleted cube_part of size mesh%np_global. Let's see if
	  it is fast enough with big systems
	  Addapted cube to the new requeriments

2013-08-09 18:35  dstrubbe

	* [r11095] Since 'map' is intent(out), it must be nullified if not
	  being allocated, or else the SAFE_DEALLOCATE_P may fail in
	  restart_read (as was happening on the mauchly intel slaves).

2013-08-09 18:42  dstrubbe

	* [r11096] I don't see a reason why calls to restart_read should
	  demand that they be on the same grid when they use 'exact'. Just
	  getting all the needed wavefunctions seems sufficient. This is
	  used in td, static_pol, one_shot, phonons_fd, and optimal
	  control.

2013-08-09 22:27  dstrubbe

	* [r11101] Blocking Hartree-Fock calculations parallel in states,
	  which will crash or be wrong.

2013-08-09 22:33  dstrubbe

	* [r11102] 'exact' restart from a changed grid now causes an error,
	  except if it is merely reordered.

2013-08-09 23:30  dstrubbe

	* [r11103] I don't see a need to make the distinction between
	  'exact' and 'rdmft' in restart_read. RDMFT can just use 'exact',
	  with a more general error message. (The 'exact' one before could
	  be triggered for HF too anyway.)

2013-08-09 23:51  dstrubbe

	* [r11104] Sternheimer calculations should read with 'exact' since
	  a different grid is not acceptable.

2013-08-12 13:06  marques

	* [r11105] Bug fix: the value of alpha of PBEalpha seems to be 0.52
	  and not 0.5. Strangely enough the original routine (with
	  alpha=0.5) had been sent to be by G. Madsen, the author of the
	  functional.

2013-08-12 23:42  dstrubbe

	* [r11106] Re-enabling the full OEP EXX test.

2013-08-13 04:33  dstrubbe

	* [r11107] Making some arguments in C const, and removing a goto
	  (!)

2013-08-13 05:10  dstrubbe

	* [r11108] Clarifying error messages.

2013-08-13 09:05  joseba

	* [r11109] All the partition is gathered together, intented to be a
	  faster implementation of r11076

2013-08-13 14:09  joseba

	* [r11110] Deleted an instance of part_vec
	  Renamed part_local to cube_part_local

2013-08-13 15:40  joseba

	* [r11111] Moved the usage of global par_vec to a local version.
	  All the tests are passed, but probably curvilinear implementation
	  in parallel is broken (before also to this commit).

2013-08-13 22:41  dstrubbe

	* [r11112] Updating match for PBEA in light for recent libxc
	  change.

2013-08-13 23:25  dstrubbe

	* [r11113] CalculationMode = unocc now decides how many states to
	  use via ExtraStates (as for gs) rather than NumberUnoccStates.
	  This is for convenience, in reducing the number of variables that
	  do similar things, and also helps for performance and
	  parallelization. Choices such as distribution of states over
	  nodes, and the block size for states and mesh, were being made
	  based on the number of states before NumberUnoccStates, rather
	  than the actual number of states being used. Now we can do things
	  more appropriately.

2013-08-14 04:46  dstrubbe

	* [r11118] Fixing types: floats were assigned to an integer
	  stsmear%%el_per_state, and a function state_spin needlessly
	  returned complex, and assigned it to the real st%spin.

2013-08-14 13:46  joseba

	* [r11119] Deleted part_vec from mesh_partition and by the way when
	  printing is only iterated over the local points.

2013-08-14 16:17  joseba

	* [r11121] Created a function to calculate the local number of
	  points for each partition. Then, adapted the call to vec_init and
	  deleted two instances of part_vec

2013-08-14 17:54  dstrubbe

	* [r11122] * Fixing compilation errors in serial.
	  * Doxygen comments.

2013-08-14 18:09  dstrubbe

	* [r11123] Missing dependency.

2013-08-14 18:18  dstrubbe

	* [r11124] Making the OEP exchange routine less OEP-specific:
	  * Replaced oep%socc ("spin occupation", apparently) with local
	  variable socc = 1 / el_per_state. This does not really have
	  anything to do with OEP per se.
	  * Replaced oep%socc * oep%sfact ("spin factor", apparently) with
	  1, since their product is always one.

2013-08-14 18:42  dstrubbe

	* [r11125] Further generalization of OEP's exchange routine.

2013-08-14 19:05  dstrubbe

	* [r11126] * Replacing parameter 'small' with standard M_EPSILON in
	  OEP.
	  * Moving profiling and PUSH_SUB to the beginning of X(oep_x).
	  * Adding caveat about k-points from
	  hamiltonian_exchange_operator.

2013-08-14 19:24  dstrubbe

	* [r11127] OEP exchange now uses der not gr, like
	  hamiltonian_exchange_operator.

2013-08-14 22:12  dstrubbe

	* [r11128] Correcting OEP exchange for parallel in states (bug from
	  r11125).

2013-08-15 05:11  dstrubbe

	* [r11129] Use the ground_state_run_init for unocc too, so that it
	  can run parallel in states, use scalapack, etc.

2013-08-15 17:28  dstrubbe

	* [r11130] unocc now does not require any wavefunctions to be
	  present for restart, as long as the density can be read. This is
	  helpful for doing a calculation on a different set of k-points,
	  which previously required some kind of dummy calculation first to
	  create the states.

2013-08-15 17:40  dstrubbe

	* [r11131] LCAO none when parallel in states would often fail with
	  an error from pdpotrf in cholesky_parallel. I think this is
	  because some states turned out to be linearly dependent, and that
	  was happening due to the same seed being used for different
	  states on different processors when generating the random
	  wavefunctions. An additional issue is that the random numbers
	  used were reproducible when not parallel in states, but were
	  different when parallel in states or k-points. Now, the results
	  are reproducible, and don't give the cholesky_parallel error in
	  some testsuite cases where they did before. I made that all
	  processors do the calls to X(mf_random), they just don't set the
	  states unless they are managing them, which ensures that the same
	  seed will be used for a given state and k-point regardless of
	  parallelization and processor count.

2013-08-17 04:25  dstrubbe

	* [r11132] Fixes to r11131:
	  * The bounds ist_start and ist_end need to be used for unocc
	  random wavefunctions to work.
	  * Seeds all are set to zero, independent of parallelization.
	  * Initialization of eigenvalues is before the cycle.
	  * Iterate over all k-points.

2013-08-18 06:40  dstrubbe

	* [r11133] Initial implementation of the long-range correction
	  (LRC) that can be added to the LDA kernel.

2013-08-18 07:06  dstrubbe

	* [r11134] Forgot a file in last commit.

2013-08-18 11:09  jrfsousa

	* [r11135] Starting to update frozen densities code.

2013-08-18 16:48  jrfsousa

	* [r11136] Continuing to update frozen densities code.

2013-08-18 20:10  jrfsousa

	* [r11137] Add corrections and a missing file

2013-08-18 21:31  jrfsousa

	* [r11138] * Add parameter SPEC_FROZEN = 5
	  
	  * Add subroutine species_set_type
	  
	  * Add subroutine species_nullify
	  
	  * Add subroutine species_end_species acessible trough generic
	  interface species_end

2013-08-19 14:03  jrfsousa

	* [r11139] * Several corrections

2013-08-19 15:47  jrfsousa

	* [r11140] * Add parameter C_OUTPUT_HOW_JSON = 524288 to
	  grid/io_function.F90
	  
	  * Numerous updates to json*.F90 files

2013-08-19 18:45  jrfsousa

	* [r11141] * Additional files for frozen calculation and some more
	  corrections.

2013-08-19 19:39  jrfsousa

	* [r11142] * Slowly start to go live.

2013-08-19 20:07  jrfsousa

	* [r11143] * Add parameter C_OUTPUT_FROZEN = 1073741824 for frozen
	  output.
	  
	  * Add output support for frozen calculations.

2013-08-19 20:21  jrfsousa

	* [r11144] * Tries to fix problems with Pathscale.

2013-08-19 20:59  jrfsousa

	* [r11145] * Add missing noinst_HEADERS

2013-08-19 21:07  jrfsousa

	* [r11146] * Let us try to make PGI happy.

2013-08-19 22:55  jrfsousa

	* [r11147] * Add references to libfrozen

2013-08-19 23:58  jrfsousa

	* [r11148] * Some shuffling of files to make PGI happy

2013-08-19 23:59  jrfsousa

	* [r11149] * Add missing file.

2013-08-20 00:29  jrfsousa

	* [r11150] * Fixes missing dependency and wrong subroutine name.

2013-08-20 14:36  marques

	* [r11151] Wrong citation

2013-08-20 15:03  jrfsousa

	* [r11152] * Adds missing dependency.

2013-08-21 09:57  marques

	* [r11153] Buf fixed: bpccac functional should use a different
	  version of revPBE. People should be more original with the names
	  of the functionals!!!
	  Added another revise dversion of PBE, that I called PBE_TCA

2013-08-21 10:24  marques

	* [r11154] Forgot to merge TODo

2013-08-21 16:25  micael

	* [r11155] * Removed references to already implemented functionals.
	  * Added several missing functionals.

2013-08-22 08:52  micael

	* [r11156] * Added more missing functionals to the TODO file.

2013-08-22 15:15  joseba

	* [r11157] Deleted several instances of part_vec
	  Created a subroutine to get the global points of the local array
	  Few formatting

2013-08-23 10:02  joseba

	* [r11158] Bugfix to the previous r11157 commit:
	  The send buffer is now big enough
	  Corrected the intent of the result buffer
	  Deleted commented and useless lines

2013-08-23 14:18  joseba

	* [r11159] The same logic of r11157 but using less memory

2013-08-23 23:01  jrfsousa

	* [r11160] * Move ./src/frozen/kinds.F90 to ./src/basic and reflect
	  changes.

2013-08-24 13:31  jrfsousa

	* [r11161] * Add equal and not equal operators to atom.F90
	  
	  * Code cleanup, add PUSH_SUB, POP_SUB
	  
	  * Remove redundant files.

2013-08-24 13:54  jrfsousa

	* [r11162] * Fix mistake.

2013-08-24 14:40  jrfsousa

	* [r11163] * Fix some more mistakes.

2013-08-24 20:32  jrfsousa

	* [r11164] * Code cleanup add PUSH_SUB & POP_SUB

2013-08-24 21:13  jrfsousa

	* [r11165] * Forgot Makefile...

2013-08-25 14:08  xavier

	* [r11166] Added some profiling regions to the casida code.

2013-08-26 08:19  joseba

	* [r11167] Variable simplification

2013-08-26 10:07  joseba

	* [r11168] Deleted one more usage of part_vec
	  Deallocated a matrix

2013-08-26 18:04  acastro

	* [r11169] Added the Bychkov-Rashba spin-orbit coupling term, for
	  2D electron systems.

2013-08-27 12:28  joseba

	* [r11170] Deleted a usage of part_vec
	  Reordered some commands
	  Improved few comments and fortmat

2013-08-27 12:58  joseba

	* [r11171] Another part_vec deletion

2013-08-27 14:55  joseba

	* [r11172] The calculation of the ghost points is done in another
	  way and so completely deleted part_vec from par_vec.F90

2013-08-27 15:23  jrfsousa

	* [r11173] * Add variable initialization and final variable cleanup
	  to symmetries_finite.c
	  
	  * Code cleanup, add PUSH_SUB POP_SUB and turn on the compiling of
	  a few more files.

2013-08-27 20:03  xavier

	* [r11174] * Added an object to store the previous potential,
	  instead of storing it
	  in a global object.
	  * Some code cleaning.

2013-08-28 02:36  dstrubbe

	* [r11175] Fixing a type.

2013-08-28 09:24  micael

	* [r11176] Added another missing functional to the TODO list.

2013-08-28 09:27  jrfsousa

	* [r11177] * Removes duplicate code.

2013-08-28 09:32  joseba

	* [r11178] Deleted two instances of part_vec
	  Still two more exists

2013-08-28 09:52  acastro

	* [r11179] Changed a test; now it uses effective atomic units.
	  Included a lengthy comment
	  about these units.

2013-08-28 11:26  jrfsousa

	* [r11180] * Make mesh_get_vol_pp in mesh_init.F90 visible.
	  
	  * Add PUSH_SUB and POP_SUB and some more small changes.
	  
	  * Turn on the compilation of a few more files.

2013-08-28 13:07  joseba

	* [r11181] Deleted one more time part_vec.
	  Still one is there.

2013-08-28 13:49  micael

	* [r11182] Bug fix: in some specific situations, the total number
	  of atomic wavefunctions for a given species could exceed the
	  hard-wired value of 6.

2013-08-28 18:44  dstrubbe

	* [r11184] * Bugfix to OEP/KLI: a complex conjugate was missing, so
	  results could have been wrong for complex wavefunctions (though
	  not for spinors which didn't use this routine).
	  * Citation had the wrong journal.

2013-08-28 20:18  dstrubbe

	* [r11185] * Made some complex -> real conversions explicit.
	  * Removed unnecessary temp variable 'occ' which unwisely was
	  R_TYPE even though it was always assigned a FLOAT value.

2013-08-28 21:14  dstrubbe

	* [r11186] * A variable had a mistaken type in Casida. This doesn't
	  matter until we implement fractional occupations.
	  * Refactoring the oscillator strengths out of two places they
	  were called. They also only need to be called on the root proc of
	  the Casida MPI group for the time being.

2013-08-28 22:36  dstrubbe

	* [r11187] Fixing a (tiny) memory leak flagged by valgrind, which I
	  inadvertently caused in r11107. I am glad to say I do not
	  understand well enough all the details of using 'goto' in C...

2013-08-28 22:44  dstrubbe

	* [r11188] An extra check for unocc LCAO.

2013-08-29 04:18  dstrubbe

	* [r11189] The utilities do not need to link the frozen stuff.

2013-08-29 16:48  dstrubbe

	* [r11190] Reverting r11189: apparently PGI does need libfrozen.a
	  for the utilities.

2013-08-29 20:44  dstrubbe

	* [r11191] OEP exchange now uses states_get_state instead of
	  st%X(psi).

2013-08-29 21:02  dstrubbe

	* [r11192] Making some type conversions explicit.

2013-08-29 21:15  dstrubbe

	* [r11193] Removing duplicative commented code and fixing
	  indentation.

2013-08-29 21:20  dstrubbe

	* [r11194] We don't need 'recv_buffer' anymore.

2013-08-29 21:43  dstrubbe

	* [r11195] Simplifying the proliferating thetas a bit in the
	  Poisson solvers: we can just set it in the object and not pass it
	  around so much.

2013-08-29 22:23  dstrubbe

	* [r11196] * Fix to r11195: routine zpoisson1d_solve must only be
	  called for POISSON_DIRECT_SUM, or an assertion fails.
	  * Making a parameter POISSON_NULL instead of the -99's around.
	  * Using POISSON_DIRECT_SUM instead of -1 in the assert.
	  * ASSERT must not come before PUSH_SUB, for debug stack to be
	  useful.

2013-08-29 22:26  dstrubbe

	* [r11197] Clarifying a routine's name.

2013-08-29 22:31  dstrubbe

	* [r11198] Simplifying unnecessarily divergent code for complex
	  scaling in exchange. Also, enabling complex scaling (only one
	  line now required) for OEP exchange.

2013-08-30 10:21  jrfsousa

	* [r11199] ./src/grid/
	  
	  * Revert mesh_init.F90 to revision 11179.
	  
	  ./src/frozen/
	  
	  * Reflect changes.

2013-08-30 15:21  joseba

	* [r11200] Corrected the possibility to create partitions bigger
	  than the number of domains

2013-08-30 15:55  dstrubbe

	* [r11201] The complex-scaling tests did not test imaginary parts
	  of any quantities. This seems quite unwise given the point of
	  that formalism. I think there was the intention to test the
	  imaginary part of the total energy in these files, but the
	  testsuite match commands do not work if you give two numbers as
	  reference.

2013-08-30 16:31  dstrubbe

	* [r11202] Fixing a mistake in r11195: wrong argument order to
	  optional_default.

2013-08-30 18:32  xavier

	* [r11203] For performance reasons, the casida_get_rho function
	  accesses directly
	  the blocks of states, instead of using states_get_state.

2013-08-30 19:05  xavier

	* [r11204] Bugfix: Theta should not be used if complex scaling is
	  not enabled.

2013-08-30 19:16  dstrubbe

	* [r11205] Removing apostrophe.

2013-08-30 19:21  dstrubbe

	* [r11206] Better checking of validity of input parameters for
	  BerkeleyGW, and making it possible to avoid calculating diagonal
	  Vxc matrix elements.

2013-08-30 20:06  dstrubbe

	* [r11207] * Making BerkeleyGW test run in parallel.
	  * Another test run for unocc mode. Note that is using the new
	  functionality I added recently, allowing unocc to use a different
	  set of k-points from what was used in 'gs'.

2013-08-30 20:52  dstrubbe

	* [r11208] Making a routine casida_count_pairs to find the number
	  of occupied-unoccupied pairs in Casida. It does not use the
	  casida_t type, in preparation for being called from elsewhere.

2013-08-30 21:43  dstrubbe

	* [r11209] More extensive testing of 1D neon.

2013-08-30 22:36  xavier

	* [r11210] Bugfix: A function had the wrong uppercase name.

2013-08-30 23:45  xavier

	* [r11212] Bugfix: fixed out of bounds access when the number of
	  platforms in the
	  system is larger than the requested number of platforms.

2013-08-31 00:37  dstrubbe

	* [r11214] I prefer this approach to handling theta for poisson, as
	  a follow-up to r11195 and r11204. Theta will be zero unless
	  complex-scaling is being used.

2013-08-31 00:40  dstrubbe

	* [r11215] We don't need to call poisson_init for independent
	  particles. This should settle the test failure for
	  complex_scaling/01-harmonic-oscillator.01-independent.inp.

2013-08-31 01:26  dstrubbe

	* [r11216] Reverting r11215. For periodic systems, we need a
	  Poisson solver for the external potential, as Xavier points out.
	  It doesn't matter for either of the periodic
	  independent-particles tests in the testsuite though: I guess
	  because they are neutral user-defined species.

2013-08-31 01:40  dstrubbe

	* [r11217] Adding Casida test in 1D, to complement the very slow N2
	  test.

2013-08-31 18:05  dstrubbe

	* [r11218] Parameters that allow all states to be converged in the
	  neon test. But the oscillator strengths still differ somewhat
	  between different machines.

2013-08-31 19:08  dstrubbe

	* [r11219] Doing unocc with an orbital-dependent functional seems
	  to be the root of the troubles with the test runs I added for
	  neon: keeping the density fixed doesn't mean all that much in
	  this case. Instead, I will do unocc and casida with LDA for neon.

2013-08-31 19:19  dstrubbe

	* [r11220] Casida should require the exact mesh.

2013-08-31 19:20  dstrubbe

	* [r11221] Finding something that runs unocc and Casida properly in
	  1D seems doomed. Disabling the test for now.

2013-08-31 19:23  dstrubbe

	* [r11222] Setting an appropriate default Poisson solver for 1D
	  complex scaling.

2013-08-31 22:15  dstrubbe

	* [r11223] * Moved routine 'occupied_states' to states_m from
	  excited_states_m for convenience, since it does not relate
	  directly the objects defined in excited_states_m.
	  * Moved casida_count_pairs to states_count_pairs, to make it
	  accessible from a lower level than casida_m.

2013-09-02 17:26  micael

	* [r11224] * More informative error message when not finding a tag
	  in the UPF file format.

2013-09-02 17:29  micael

	* [r11225] * Clarified supported UPF versions in the Species block
	  documentation.

2013-09-02 18:00  acastro

	* [r11228] A couple of lines of the Rashba spin-orbit operator were
	  not very clear.
	  
	  Also, added a test that demonstrates the use of effective atomic
	  units for 2D
	  electron gas quantum dots.

2013-09-03 08:28  acastro

	* [r11229] Some computers seem to have problems with this test
	  using the cg eigensolver
	  (others don't). It probably has to do with different random
	  initial guesses,
	  but in any case it is solved using a different eigensolver.

2013-09-03 20:20  dstrubbe

	* [r11231] Caveat about unocc for orbital-dependent functionals.
	  Have I forgotten any other cases that are orbital-dependent?

2013-09-04 08:35  joseba

	* [r11232] Added the ability to print the minimum execution time of
	  a function in the profiling

2013-09-04 09:49  marques

	* [r11233] Corrected bug in PBEint

2013-09-04 09:59  marques

	* [r11234] Sorry, a 0 in the wrong place... don't know how it got
	  there ;)

2013-09-04 16:39  micael

	* [r11235] Yet another set of missing functionals from libxc.

2013-09-04 19:48  dstrubbe

	* [r11236] Initial implementation of support for q-points (q=k-k')
	  in FFT Poisson solver, for use in calculating exact exchange in
	  periodic systems. This is not yet used.

2013-09-05 01:46  xavier

	* [r11237] X(forces_from_potential) now stores the result in an
	  array, rather
	  than inside the geo object.

2013-09-05 03:40  xavier

	* [r11238] Added a test for the forces in periodic systems.

2013-09-05 03:48  xavier

	* [r11239] Started the implementation of the calculation of the
	  forces by blocks.

2013-09-05 04:52  xavier

	* [r11240] Now forces_calculate receives a hamiltonian argument.

2013-09-05 13:58  xavier

	* [r11241] The gradient required for the forces is now calculated
	  by blocks.

2013-09-05 14:52  xavier

	* [r11242] Geometry optimization honors the StatesPack variable.

2013-09-05 15:42  dstrubbe

	* [r11243] Unused variables.

2013-09-06 06:10  xavier

	* [r11244] The calculation of the gradient of the density, required
	  for the
	  forces, is now done in batch form.

2013-09-06 12:51  xavier

	* [r11245] I forgot to include this file in my last commit.

2013-09-09 09:32  marques

	* [r11246] Added functional gga_x_lv_rpw86

2013-09-09 14:05  marques

	* [r11247] Another functional for the TODO list

2013-09-09 14:53  marques

	* [r11248] N12_SX is a hybrid GGA, not a GGA

2013-09-10 08:26  micael

	* [r11249] * Changed the partitioning of the partition in order to
	  fix the problem that appeared when the number of partitions was
	  larger than the number of points per process. This should also
	  improve the load balancing.

2013-09-10 14:32  micael

	* [r11250] * Bug fixed. An expression was wrong in my previous
	  commit.

2013-09-13 08:56  marques

	* [r11251] Added another reference to PBE0

2013-09-15 01:43  xavier

	* [r11252] Improved the check for the Rashba term.

2013-09-15 01:46  xavier

	* [r11253] Proper check for Rashba.

2013-09-15 02:33  xavier

	* [r11254] * Removed the CPMD implementation, since it is not used.
	  
	  * The MoveIons variable is boolean, but in several tests the
	  value
	  'vel_verlet', defined by CPMD, was given instead of 'yes'.

2013-09-15 02:54  xavier

	* [r11255] Moved the time propagation test to the real_time
	  directory.

2013-09-15 03:28  xavier

	* [r11256] Some modules do not really use states_block_m.

2013-09-15 11:10  acastro

	* [r11257] Bug fix: optimal control with Ehrenfest failed when
	  using more than one
	  atom (still it is not working, the implementation is half way).

2013-09-15 18:50  acastro

	* [r11258] Added a few things that were missing in the optimal
	  control part, causing
	  segfaults with certain run modes.

2013-09-16 10:31  micael

	* [r11259] * A reference was slightly wrong.

2013-09-16 12:29  marques

	* [r11260] Added another GGA kinetic energy

2013-09-16 12:34  marques

	* [r11261] Changed name of functional from gga_k_absr(1,2) to
	  gga_k_absp(1,2)
	  Had forgotten factor of 8 in gga_k_meyer

2013-09-16 20:18  acastro

	* [r11262] Bug fix: the atomic numbers were missing somewhere in
	  the optimal control
	  part.

2013-09-17 17:16  acastro

	* [r11263] Bug fix: there was a hamiltonian initialization missing.

2013-09-18 10:57  acastro

	* [r11264] Optimal control for quantum-classical systems may now
	  use more than one
	  classical particle (the ion-ion interaction was not considered
	  before this).

2013-09-19 01:41  xavier

	* [r11265] Implemented calculation of the forces from the non-local
	  potentials
	  using blocks of states.

2013-09-19 02:12  xavier

	* [r11266] Merged the matrix multiplication in the calculation of
	  the forces.

2013-09-19 02:47  xavier

	* [r11267] The force from the non-local potential is now calculated
	  for all
	  directions at once.

2013-09-19 14:11  xavier

	* [r11268] Fixed the calculation of the forces in parallel, that
	  was broken after
	  my last commits.

2013-09-19 14:13  marques

	* [r11269] Submitted patch by Rolf Wuerdemann implementing
	  CAMY_BLYP

2013-09-19 15:06  marques

	* [r11270] A little cleaning:
	  *) now the names of the attenuation interactions are defined
	  *) little routine that returns the enhancement factors avoiding
	  duplicated code

2013-09-19 19:34  acastro

	* [r11271] Some more dwarf steps towards the implementation of oct
	  for Ehrenfest
	  dynamics.

2013-09-19 21:33  acastro

	* [r11272] Bug fix: my previous commit did not allow for more than
	  one atom.

2013-09-20 04:25  xavier

	* [r11273] Appartently --disable-f90-forall was confused by a loop
	  in one of my
	  commits.

2013-09-20 11:26  marques

	* [r11274] Added exchange functional of Armiento and Kummel that is
	  becoming so popular

2013-09-20 11:49  marques

	* [r11275] Little think I forgot to save before committing...

2013-09-20 15:41  acastro

	* [r11276] One calculation worked only for 1D cases, or for lasers
	  polarized only in the
	  x direction.

2013-09-20 21:02  dstrubbe

	* [r11277] Restoring a test for the oct-xyz-anim utility, since the
	  only one was removed along with CPMD in r11254.

2013-09-20 21:34  dstrubbe

	* [r11278] Fixing problems with r11255: a spurious copy of a file
	  was created, and the filenames were not updated in the test file
	  after the move. Please check whether a test passes when you
	  change it, and pay attention to build failures afterwards.

2013-09-23 08:19  micael

	* [r11279] * XC_GGA_K_ABSR1 and XC_GGA_K_ABSR2 should also be
	  included in the Fortran interface.

2013-09-23 09:36  micael

	* [r11280] * The C part of the Fortran interface for the
	  gga_ak13_get_asymptotic function was missing.
	  * Made the Fortran name of the gga_ak13_get_asymptotic consistent
	  with the C name.

2013-09-25 19:20  dstrubbe

	* [r11281] Reverting mistaken "bugfix" in r11184, and adding
	  clarifying comment.

2013-09-30 15:47  joseba

	* [r11282] With this change the partition is read/write in parallel
	  if MPI2 is available

2013-09-30 18:54  marques

	* [r11283] Let's see if it now compiles in chum

2013-09-30 19:09  marques

	* [r11284] Sorry, there was one line I forgot to delete

2013-10-01 06:49  joseba

	* [r11285] Let's be more conservative and more verbose, to see if
	  it runs in mauchly

2013-10-01 07:51  joseba

	* [r11286] MPI call must be only called if compiled

2013-10-02 10:51  joseba

	* [r11287] More robust way to init par_vec:
	  * Added check-points with MPI_Barrier to sync all the processes
	  * Don't compute if the number of points is equal to 0

2013-10-02 11:23  joseba

	* [r11288] Made an explicit Fortran interface for write_header

2013-10-03 18:19  acastro

	* [r11289] Improvement on the backwards propagation of optimal
	  control runs, when both
	  ions are electrons are propagated.

2013-10-04 07:10  marques

	* [r11290] Changed function into subroutine. Apparently, there is
	  no way to keep all compilers happy when interfacing functions
	  between C and Fortran!

2013-10-04 09:27  joseba

	* [r11291] bugfix to r11282 :
	  - The printing to the screen is there to avoid an optimization
	  (that I really don't undertand why)
	  - A deallocation was done twice
	  - Return value was missing with parallel I/O

2013-10-04 14:38  dstrubbe

	* [r11292] The debug output for finite-difference weights
	  overflowed the format for derivatives 1D test. I made it much
	  larger.

2013-10-04 15:22  acastro

	* [r11293] This allows using soft-Coulomb atoms when doing optimal
	  control for Ehrenfest
	  dynamics.

2013-10-06 14:48  acastro

	* [r11294] Improvement on the optimal control for Ehrenfest
	  dynamics: now it works for
	  arbitrary potentials (not only for soft-Coulomb and harmonic
	  potentials, as
	  before).

2013-10-06 19:25  acastro

	* [r11295] The calculation of a component of the force on the
	  costate variables in
	  optimal control runs only worked in 1D cases.

2013-10-06 19:26  acastro

	* [r11296] My previous commit had a "stop" that should not be
	  there.

2013-10-07 08:47  joseba

	* [r11297] Created a C interface to correct compilation errors with
	  two underscores

2013-10-07 15:50  dstrubbe

	* [r11298] * Enabling format argument to messages_write_str.
	  * Using this to write out max available sizes of parallelization
	  groups in debug mode.

2013-10-08 16:15  joseba

	* [r11299] Count is a reserved word in Fortran

2013-10-08 21:10  dstrubbe

	* [r11301] Making backport.sh work properly for subversion 1.8: it
	  was giving an extra line with "URL::" in the commit message.

2013-10-08 22:10  dstrubbe

	* [r11302] * Minor bugfix to r7250: the sanity check for
	  parallelization gives misleading information when there are
	  slaves, since real_group_sizes is compared to the total number of
	  MPI tasks in the output, whereas the error condition is flagged
	  when mc%group_sizes and MPI tasks do not match.
	  * Typo.

2013-10-09 12:32  marques

	* [r11303] Added revAPBE for the kinetic energy

2013-10-09 13:10  marques

	* [r11304] Added K_APBEINT and K_REVAPBEINT

2013-10-10 10:34  joseba

	* [r11305] Let's see if this solves the optimization problem with
	  gfortran 4.4

2013-10-10 11:15  micael

	* [r11306] * Added atomic densities and corresponding derivatives
	  for H and Li atoms.

2013-10-10 11:36  micael

	* [r11307] Added XC_GGA_K_TFVW.

2013-10-10 12:03  marques

	* [r11308] Started implementing Kxc for the GGAs

2013-10-10 15:03  joseba

	* [r11309] Corrected the partition write with MPI2, the offset has
	  to have the type MPI_OFFSET_KIND and has to skip the header too.
	  MPI_File_close inside an "if" statement to avoid the optimization
	  Corrected the number of print lines with messages_fatal
	  
	  This passes all the tests with gfortran 4.4 in my machine (Ubuntu
	  12.04, x86_64, openmpi), let's hope in tigger too.

2013-10-10 17:29  acastro

	* [r11310] Bug fix: a variable should be initialized to zero.

2013-10-10 18:17  dstrubbe

	* [r11311] Removing useless OutputInterval lines from testsuite
	  input files which do not have Output set anyway. I put
	  RestartWriteInterval instead for a few, which will have some
	  effect.

2013-10-10 18:45  dstrubbe

	* [r11312] Error-handling for exceeding line length in
	  messages_write_logical, since this kind of error seems to be
	  happening for the CL buildslaves on lascar.

2013-10-10 20:38  acastro

	* [r11313] Some error corrections in the backwards propagation for
	  optimal control runs.

2013-10-11 03:41  dstrubbe

	* [r11314] Please don't try to initialize members of types. They
	  often cause
	  errors from valgrind. In this case, we had:
	  
	  Uninitialised value was created by a stack allocation
	  at 0x6A660D: __system_m_MOD_system_init (system.F90:56)

2013-10-11 09:42  marques

	* [r11315] We can now calculate third derivatives for the exhange
	  GGAs. For now only B86 works. Note that most tests are failing at
	  the moment.

2013-10-11 09:44  marques

	* [r11316] This should fix the problem of David.

2013-10-11 09:45  marques

	* [r11317] Sorry, made an error in the prvious commit

2013-10-11 10:01  marques

	* [r11318] Kxc for B88-like functionals

2013-10-11 10:17  helbig

	* [r11319] Added orbital minimization for RDMFT and added RDMFT
	  test

2013-10-11 11:20  marques

	* [r11320] Added Kxc to exchange PBE-like functionals

2013-10-11 11:30  marques

	* [r11321] Added Kxc to X_WC

2013-10-11 12:39  marques

	* [r11322] Added KXC for X_G96, X_RPBE, X_HTBS, X_PW86, and X_PW91

2013-10-11 14:34  joseba

	* [r11323] Created interfaces to MPI_File_read/write and started
	  using them with the partition

2013-10-11 14:37  joseba

	* [r11324] Deleted useless comments

2013-10-11 16:38  joseba

	* [r11325] Getting the size in bytes of the actual vector, instead
	  of assuming a given size

2013-10-11 17:05  dstrubbe

	* [r11326] Error-checking for trying to write too long a line in
	  messages_write_str. Perhaps this is what is happening for the
	  lascar CL slaves?

2013-10-11 20:53  dstrubbe

	* [r11327] Some extra checking in the construction of the mesh, to
	  detect problems relating to MPI2 failures, which have been seen
	  for OpenMPI on MacOS, and for IntelMPI in one case.

2013-10-11 21:20  dstrubbe

	* [r11328] * The RDMFT test recently added was failing on some
	  gfortran slaves with error: Assertion
	  "leading_dimension_is_known(array)" failed in line 446 of file
	  "basic/utils.F90".
	  This was due to the curious way states_rotate was written. By
	  making it a template_routine and thus removing real( ) from the
	  call to lalg_gemm, the leading dimension becomes known.
	  * I noted in the variable reference that TransformStates and
	  friends are complex coefficients, though the imaginary part is
	  ignored for real wavefunctions. I suggest they should just be
	  real in this case instead, for clarity to the user.

2013-10-11 21:28  dstrubbe

	* [r11329] * Fixing initialization of integers with real constants.
	  * Removing unused variable.

2013-10-11 21:30  dstrubbe

	* [r11330] The status argument to MPI routines is supposed to be an
	  array of size MPI_STATUS_SIZE. The code with MPI_Get_Count would
	  not compile when using mpi.mod from MPICH2 without this change.

2013-10-11 21:34  dstrubbe

	* [r11331] Follow-up to previous commit: the declaration of
	  'status' now should be inside #ifdef MPI2. read_count can be too
	  since it is only used in that case. Also, I forgot one
	  MPI_STATUS_SIZE.

2013-10-14 10:33  joseba

	* [r11332] Deleted forgotten duplicated code
	  Uncommented the checks of reads

2013-10-14 10:43  joseba

	* [r11333] Added svn Id to several files

2013-10-14 11:00  acastro

	* [r11334] Correction of some parts of the optimal control code
	  that wrongly assunmed 1D
	  systems.

2013-10-15 13:07  theophilou

	* [r11335] set default number of scf rdmft iterations to 100 and
	  hard copied maximum number of iterations needed for bisection
	  inside rdmft

2013-10-15 17:52  dstrubbe

	* [r11336] * Fixing push/pop's.
	  * Doxygen comments.
	  * Formatting.

2013-10-15 18:33  dstrubbe

	* [r11337] Slightly loosening tolerance so a test can pass on
	  Stampede.

2013-10-15 18:41  dstrubbe

	* [r11338] PUSH/POP's to 'hermite' were 90% of the DebugLevel=2
	  output from
	  finite_systems_3d/13-full_potential_hydrogen.01-gs.inp.

2013-10-15 22:23  dstrubbe

	* [r11339] Suppressing useless \n character in build log in OpenCL.

2013-10-16 01:11  dstrubbe

	* [r11340] Missing dependency.

2013-10-16 10:12  acastro

	* [r11341] Bug fix: a couple of lines were swapped.

2013-10-16 14:45  marques

	* [r11342] Bug fixed: a factor of 4 too much in the calculation of
	  Fxc

2013-10-16 21:32  dstrubbe

	* [r11343] You can now use 'mpi.mod' instead of 'mpif.h', thus
	  enabling compile-time checking of interfaces to MPI routines, by
	  passing --enable-mpi_mod to configure. The default remains to use
	  'mpif.h' instead.

2013-10-16 21:54  dstrubbe

	* [r11344] The interfaces in mpi.mod for OpenMPI 1.4 seem to have
	  the file_handle argument of MPI_File_set_atomicity as out or
	  inout, requiring a change in the intent of our calling routines.

2013-10-16 22:36  dstrubbe

	* [r11345] CalculationMode = vib_modes now works for complex
	  wavefunctions.

2013-10-16 23:15  dstrubbe

	* [r11346] Forgot to add this file in previous commit.

2013-10-17 00:30  dstrubbe

	* [r11347] Making a separate routine casida_solve from the
	  subsubroutine casida_work.solve_casida.

2013-10-17 02:33  dstrubbe

	* [r11348] Fix to r11339: we should remove only the last newline,
	  or else later
	  lines of output get truncated.

2013-10-17 07:28  marques

	* [r11349] Added Kxc to GGA_X_AIRY

2013-10-17 09:55  marques

	* [r11350] Added Kxc to AK13

2013-10-17 11:06  marques

	* [r11351] Bug fix: had some lines misplaced, so Fxc and Kxc were
	  badly calculated if (and only if) Vxc was not calculated.

2013-10-17 11:32  theophilou

	* [r11352] Removed vxc for rdmft since it is not used for the
	  moment

2013-10-17 16:12  theophilou

	* [r11353] not calling v_a_xc for RDMFT, this should fix the memory
	  leak

2013-10-17 18:57  acastro

	* [r11354] The possibility of moving the ions was only available
	  for one of the optimal
	  control target types. Started to allow that option for all of
	  them.

2013-10-17 20:12  dstrubbe

	* [r11355] Casida keeps track of the dimensionality of space itself
	  for when 'sb%dim' is not available directly, and
	  CasidaMomentumTransfer is read only to that size, not MAX_DIM.

2013-10-17 21:14  dstrubbe

	* [r11356] A variable was not initialized for independent
	  particles.

2013-10-17 21:40  dstrubbe

	* [r11357] Changes of first element to whole array argument in some
	  MPI calls, to allow compilation with mpi.mod. I checked that in
	  none of these cases does ifort gives a warning about making an
	  array temporary for the call, and they are all fairly small
	  arrays anyway, so this shouldn't be a significant concern.

2013-10-17 22:19  dstrubbe

	* [r11358] Making some routine templated to enable 'casida' runs
	  with complex wavefunctions (although only eps_diff, petersilka,
	  and tamm_dancoff theory levels are actually possible).
	  casida_write is moved into casida_work. casida_write has wider
	  columns for complex output. The code to fix the phase is made
	  general to the complex case. A complex vib_modes density is read,
	  but converted to real for use in forces.
	  Forces are enabled too

2013-10-18 07:33  marques

	* [r11359] Added Kxc to B86, B86_MGC, BAYESIAN, and BPCCAC.

2013-10-18 08:14  marques

	* [r11360] KXC for C08x plus a series of bug corrections.

2013-10-18 18:21  dstrubbe

	* [r11361] Sanity checks in restart.

2013-10-18 21:25  dstrubbe

	* [r11362] * Updating variable reference about complex
	  wavefunctions for CalculationMode = casida.
	  * Adding additional check and comments about complex
	  variational/Casida.
	  * Fixing writing of header for eps_diff, casida, etc. files.

2013-10-18 21:28  dstrubbe

	* [r11363] More robust attempt to catch problems with too-long
	  lines in messages_write_str. The CL slaves have a very long line
	  for -I${share}/opencl due to how it is installed, and so when
	  DebugLevel = 1 and we try to write this, it exceeds the length of
	  the character arrays in messages.

2013-10-19 22:29  dstrubbe

	* [r11364] Solution to the ongoing CL debug info writing error on
	  lascar: the
	  compilation flags string could be quite long, so I am breaking it
	  up
	  into two parts to make it less likely to overflow the messages
	  string.

2013-10-19 23:28  dstrubbe

	* [r11365] oct-casida_spectrum: Using iostat instead of the
	  implicit goto construct with 'end=' in a read statement.

2013-10-20 23:20  dstrubbe

	* [r11366] * oct-casida_spectrum now can detect complex casida
	  output files (the dipole matrix elements are complex) and
	  calculate spectra from them.
	  * Fixing alignment of columns in header for complex casida output
	  files.

2013-10-20 23:25  dstrubbe

	* [r11367] When the KPoints block is used, the code was first
	  initializing the k-points structures for the default KPointsGrid,
	  namely the gamma point, and then reallocating and overwriting the
	  structures for the user-defined k-points. This is confusing and
	  causes a small memory leak. Now we just do one initialization.

2013-10-21 03:19  dstrubbe

	* [r11368] More info about multiple datasets in CalculationMode.

2013-10-21 03:24  dstrubbe

	* [r11369] restart_read_rho did not deallocate an array.

2013-10-21 14:29  acastro

	* [r11370] Eliminated one unused argument passed to a subroutine,
	  and separated one
	  subroutine into two, which will be useful later.

2013-10-21 17:10  dstrubbe

	* [r11371] Improving formatting in variable reference for
	  CalculationMode multi-dataset example.

2013-10-21 20:45  dstrubbe

	* [r11372] * Consolidating the poisson init routines for each
	  dimensionality into 1, since they are identical for FFT kernel
	  except for the soft Coulomb parameter in 1D, and there is no good
	  reason to treat these cases separately. Renaming routine
	  poisson3D_init accordingly to poisson_kernel_init.
	  * Adding a subroutine to return the q-point of the Poisson
	  kernel.
	  * Fixing PUSH/POP's in poisson_fft.

2013-10-21 21:53  dstrubbe

	* [r11373] * Simplifying treatment of time in v_ks_calc by setting
	  time=0 when it is not supplied as an optional argument.
	  * By analogy to ks%calc%total_density, ks%calc%Imtotal_density
	  should be nullified too.

2013-10-22 02:29  dstrubbe

	* [r11374] Renamed solver_3d_inc.F90 in accordance with its current
	  contents.

2013-10-22 09:44  acastro

	* [r11375] Bug fix: a couple of signs were wrong.

2013-10-22 09:49  joseba

	* [r11376] Uppercase one letter

2013-10-22 10:38  joseba

	* [r11377] Separated the reading into the header and the body

2013-10-22 11:33  marques

	* [r11378] Updated reference

2013-10-22 13:29  joseba

	* [r11379] * Moved avobe the new function
	  * Simplified the function of get_info

2013-10-22 23:12  dstrubbe

	* [r11380] Making messages_not_implemented calls for H(F) with
	  k-points at the point of reading TheoryLevel, and broadening the
	  condition in X(exchange_operator): what matters is the number of
	  k-points in the full, not symmetry-reduced, Brillouin zone.

2013-10-23 07:04  joseba

	* [r11381] Corrected a POP_SUB

2013-10-23 10:19  acastro

	* [r11382] Added a new optimal control test for the recently
	  introduced "classical"
	  targets. Also, added to the Makefile.am some files that were
	  previously not
	  taken into account.

2013-10-23 19:03  dstrubbe

	* [r11383] * q-point is now passed to FFT Poisson solver
	  initialization.
	  * New routine to regenerate FFT kernel with a different q-point.

2013-10-23 19:21  dstrubbe

	* [r11384] The eigenvalues and occupations were not being
	  recomputed for MaximumIter = 0.

2013-10-23 19:42  dstrubbe

	* [r11385] Fix to r11371 which made some lines in the example
	  disappear.

2013-10-23 21:13  dstrubbe

	* [r11386] * Critical bugfix to r9961: a calculation with full OEP
	  and spinors was enabled but it was silently doing nothing. Now it
	  is blocked since that is not implemented.
	  * Bugfix: an attempt to block full OEP parallel in states was
	  ineffective since it was placed before initialization of the OEP
	  method.
	  * I am marking OEP with spinors as experimental, since the
	  implementation in r9961 was commented as "a work in progress";
	  moreover it is not in the testsuite, and an example KLI
	  calculation I tried generated NaN's.

2013-10-23 21:49  dstrubbe

	* [r11387] Renaming 'sigma' to 'kk' in states_pair_t, to begin
	  generalizing to k-points rather than just spins.

2013-10-23 22:26  dstrubbe

	* [r11388] One more %sigma -> %kk forgotten in the last commit.

2013-10-24 15:43  dstrubbe

	* [r11389] Correction of use of q-point in FFT Poisson solver: it
	  must come in at the same footing as 'ixx' since it is in reduced
	  coordinates, i.e. between -0.5 and 0.5. This entails a bit of
	  reorganization of the poisson_fft_gg_transform subroutine.

2013-10-24 22:54  dstrubbe

	* [r11392] Reverting r11367: I was accidentally undoing my change
	  in r10912. While that one did cause a small memory leak, I can
	  just deallocate the appropriate things rather than undo it. Now
	  there is a comment explaining too. klattice needs to be nullified
	  so that SAFE_DEALLOCATE_P recognizes it as not yet associated in
	  the call to kpoints_end I added.

2013-10-24 23:06  dstrubbe

	* [r11395] Missing dependency.

2013-10-25 09:18  acastro

	* [r11396] Correction of some misplaced factors, and of some
	  missing occupation factors,
	  which affected some optimal control runs with more than one
	  electron.

2013-10-25 09:48  acastro

	* [r11397] The qoct_tddft_propagator did not allow the possibility
	  of moving the ions.

2013-10-25 15:58  dstrubbe

	* [r11398] Updating fix_testsuite.py from BerkeleyGW r5630 which
	  incorporates various minor improvements and fixes.

2013-10-25 17:15  dstrubbe

	* [r11399] New approach for selecting basis for Casida: rather than
	  listing the single-particle states to be used, we can set an
	  energy window with CasidaKSEnergyWindow and include all
	  transitions with energy difference less than that.

2013-10-25 19:24  dstrubbe

	* [r11400] * Providing format so matrix elements do not have
	  garbage for imaginary part in Casida excitations files when
	  running with complex wavefunctions.
	  * Changing column header from "Spin" to "Spin/k" in preparation
	  for enabling k-points in Casida.

2013-10-27 08:45  acastro

	* [r11401] A couple of procedures (regarding OCT runs) only worked
	  for one-electron
	  systems.

2013-10-27 19:23  dstrubbe

	* [r11402] * Allowing a switch back from a utility to the main
	  executable in a test file.
	  * Using this to add test runs for "kick_spin" to obtain triplets.

2013-10-27 19:54  dstrubbe

	* [r11403] Splitting up calculation and writing parts for cross
	  section tensor.

2013-10-28 20:13  dstrubbe

	* [r11404] Undoing r10016 which set the oscillator strengths to
	  zero for Casida triplets. While this is true for electric-dipole
	  transitions, if we just don't set it to zero, we do get something
	  useful, the spin part of the magnetic-dipole oscillator
	  strengths, which indeed agrees quite well with results from
	  kick_spin in td
	  (http://www.tddft.org/programs/octopus/wiki/index.php/Tutorial:Triplet_Spectra).

2013-10-28 20:45  dstrubbe

	* [r11405] Missing PUSH/POP.

2013-10-28 21:14  dstrubbe

	* [r11406] Removing useless variable.

2013-10-28 21:26  dstrubbe

	* [r11407] Reordering loops from r11244 to avoid optimization
	  problem leading to seg-fault at -O3 on chum_x86_64_intel_test. I
	  suspect this way may be faster anyway since it follows the
	  ordering in grad_psib(idir)%states_linear(ii)%X(psi)(ip) --
	  correct me if I am wrong...

2013-10-28 21:51  dstrubbe

	* [r11408] Secretly, you could use SpinComponents = polarized, even
	  though this did not show up in the variable reference. I made
	  this possibility explicit, and changed a place it was referred to
	  in documenting Occupations block to the more standard version
	  spin_polarized.

2013-10-28 22:26  dstrubbe

	* [r11409] Improving variable reference formatting.

2013-10-29 00:55  dstrubbe

	* [r11410] Unused variables.

2013-10-29 09:06  joseba

	* [r11411] Moved all the MPI I/O logic to the io_binary_f.F90 of
	  the reading. Files are opened and closed there.
	  Added interfaces for the writing of the headers for all the
	  data-types.
	  Simplified accordingly the partition.F90

2013-10-29 11:11  joseba

	* [r11412] * Moved to io_binary_f.F90 the MPI I/O logic of writing.
	  * Simplified accordingly the partition.F90
	  * The writing of the header is decided by the type of the vector
	  * xlocal has to be initialized always

2013-10-29 11:13  joseba

	* [r11413] Reverted accidentally deleted line

2013-10-29 12:07  joseba

	* [r11414] Added the SVN Id to several files

2013-10-29 16:28  askhl

	* [r11415] clean up a bit and add asserts for things we dont want
	  to do presently in arpack. Explicitly set variables to avoid
	  warnings from valgrind. Always set initial residual to 1. Remove
	  some debug output that seems to be at odds with some compilers

2013-10-29 17:11  askhl

	* [r11416] fix calculation of complex-scaled spin-polarized
	  densities. A better way would be to use some abstraction in the
	  long run

2013-10-29 17:28  askhl

	* [r11417] for complex scaling, add function to assign score based
	  on a state's energy for the purposes of occupying them in some
	  order. So far this is not very systematic but we will figure out
	  something better

2013-10-29 17:37  askhl

	* [r11418] call code from cmplxscl

2013-10-29 18:00  askhl

	* [r11419] for complex scaling, add support for assigning
	  occupation with spin polarization

2013-10-29 18:18  dstrubbe

	* [r11420] Typos.

2013-10-29 19:07  askhl

	* [r11421] add code for complex-scaled PBE and for spin-polarized
	  complex-scaled LDA

2013-10-29 20:12  dstrubbe

	* [r11422] Making an error message more informative.

2013-10-29 20:27  dstrubbe

	* [r11423] Let's check that 'variables' and 'inp' exist before
	  creating 'exec/parser.log': sometimes I accidentally run octopus
	  in the wrong directory and then end up creating this file which I
	  need to delete.

2013-10-29 20:58  dstrubbe

	* [r11424] Oops, removing incorrect (and cyclic) dependency.

2013-10-30 02:31  dstrubbe

	* [r11426] A rotation can be applied in oct-casida_spectrum.

2013-10-30 03:47  dstrubbe

	* [r11427] Some compilers object to my ordering of .a files on the
	  link line for oct-casida_spectrum.

2013-10-30 12:17  marques

	* [r11428] Added Kxc to X_AM05

2013-10-30 12:30  marques

	* [r11429] Kxc for DK87_R1 and DK87_R2

2013-10-30 12:58  marques

	* [r11430] Added Kxc for hermand and lg93

2013-10-30 13:32  marques

	* [r11431] Added Kxc to lv_rpw86
	  added missing flags to dk87 (thanks Micael)

2013-10-30 14:41  marques

	* [r11432] Kxc for optx, mpbe, sogga11 and variants

2013-10-30 15:20  marques

	* [r11433] SSB_SW and VMT also have Kxc. I finished all exchange
	  GGA for which Kxc was relatively simple to calculate.

2013-10-30 20:57  dstrubbe

	* [r11434] Fixes for CasidaSpectrumRotationMatrix:
	  * Reading made matrix transposed
	  * Orthogonal matrix definition uses transpose
	  * Warning, not error, if not orthogonal
	  * More reasonable precision for orthogonality check, so one does
	  not need to enter something accurate to 14 digits...

2013-10-30 22:04  dstrubbe

	* [r11435] Bugfixes for the three directions of the spectrum in
	  oct-casida_spectrum; the isotropic average is not affected.
	  * The length units for the x, y, z dipole matrix elements were
	  not considered, so the results were incorrect when using
	  eV_Angstrom units.
	  * The spectrum for x, y, z was mistakenly divided by the
	  dimensionality of space; this is only supposed to be done for the
	  isotropic average.
	  * Better labels for the spectrum.
	  * Corresponding updates to test values.

2013-10-31 15:35  dstrubbe

	* [r11437] Two parsing blocks were not being ended.

2013-10-31 17:04  joseba

	* [r11438] Added the configure for the new ISF library

2013-11-01 18:52  dstrubbe

	* [r11440] Some assertions.

2013-11-01 19:02  dstrubbe

	* [r11441] Adding intent's to blacs interface for numroc, and
	  removing 'implicit none' from each interface, which I don't think
	  is doing anything.

2013-11-01 19:04  dstrubbe

	* [r11442] Marking what is const of arguments in write_iter_low.c.

2013-11-02 01:55  dstrubbe

	* [r11443] All interfaces now have 'implicit none' (at least as far
	  as my Perl script could check). Xavier pointed out that without
	  this the compiler doesn't mind if types are not declared for some
	  arguments.

2013-11-02 17:58  dstrubbe

	* [r11444] Removing unnecessary argument, pointer, and target
	  attributes.

2013-11-02 23:27  dstrubbe

	* [r11445] Unused/useless variables.

2013-11-02 23:36  dstrubbe

	* [r11446] The format in output_tensor was valid only for ndim <=
	  3.

2013-11-02 23:37  dstrubbe

	* [r11447] Memory leak in partition writing.

2013-11-03 00:41  dstrubbe

	* [r11448] Interfaces for varinfo C functions.

2013-11-03 00:52  dstrubbe

	* [r11449] Interfaces for C routines in write_iter.

2013-11-03 10:29  acastro

	* [r11450] With the new interfaces, I think there were a lot of
	  intent(in)'s that should
	  be intent(inout).

2013-11-03 12:05  acastro

	* [r11451] Some code simplification: now one cannot use the
	  oct_tg_velocity target with
	  moving ions, because the same functionality can be obtained with
	  the oct_tg_classical target (actually, the previous
	  implementation of this
	  had a bug).
	  
	  Removed the corresponding test.

2013-11-03 19:03  dstrubbe

	* [r11452] Useless variable.

2013-11-03 19:06  dstrubbe

	* [r11453] Two more interfaces.

2013-11-03 19:27  askhl

	* [r11454] in complex scaling test, refrain from testing eigenvalue
	  of 9th state. Higher states are numerically more sensitive and do
	  not really improve the test

2013-11-03 19:51  dstrubbe

	* [r11455] Interfaces were misspelled and so had no effect. Also, I
	  put them at
	  module scope like other interfaces in the code.

2013-11-04 01:51  dstrubbe

	* [r11456] * Renaming module in checksum_interface to match the
	  filename.
	  * This module was not 'used' in the main place it should have
	  been, namely mesh_init; now it is, and removed from mesh.F90
	  where it is not relevant.

2013-11-04 04:09  dstrubbe

	* [r11457] * Interface for hilbert_index_to_point.
	  * Using interfaces for write_iter in kick, and correcting intent.
	  * Interfaces for block_signals and unblock_signals.

2013-11-04 04:37  dstrubbe

	* [r11458] Unused and useless variables.

2013-11-04 08:50  joseba

	* [r11459] Added additional libraries to the ISF compilation

2013-11-04 09:23  joseba

	* [r11460] Spelling

2013-11-04 13:25  joseba

	* [r11461] Added the include directory of ISF

2013-11-04 18:02  askhl

	* [r11462] calculate polarization only for spin-polarized case,
	  obviously. Made less obvious by the ridiculous tendency of this
	  archaic technology to attribute problems to wrong line numbers
	  even with -O0.

2013-11-05 07:51  joseba

	* [r11463] Removed BLAS and LAPACK lines, following the advice of
	  David
	  
	  Thanks David!

2013-11-05 08:08  joseba

	* [r11464] Added svn Id to several files

2013-11-05 08:13  joseba

	* [r11465] Reverted accidentally changed file

2013-11-05 08:40  joseba

	* [r11466] Added a test for LibISF
	  Removed warnings of deallocations. Actually, nothing is allocated
	  here
	  Less verbose library calls
	  Code make-up

2013-11-05 08:47  joseba

	* [r11467] Forgot to add the svn Id
	  Forgot to mention that now the default is the parallel ISF

2013-11-05 08:59  joseba

	* [r11468] Set also to quiet the other kernel

2013-11-05 11:00  joseba

	* [r11469] More svn Ids
	  Doxygen

2013-11-05 12:45  askhl

	* [r11470] make user-defined charge densities work properly with
	  complex scaling

2013-11-05 14:39  askhl

	* [r11471] new complex scaling test with PBE and stark ionization.
	  Add comments to the other tests to communicate their purpose.

2013-11-05 15:15  marques

	* [r11472] Bug fix. David, can you check if the test is passed now?

2013-11-05 16:14  joseba

	* [r11473] Clearer variable reference of
	  PoissonSolverISFParallelData

2013-11-05 20:01  dstrubbe

	* [r11474] Moving unnecessarily repeated code out of a loop.

2013-11-06 08:03  joseba

	* [r11475] Corrected the description of
	  PoissonSolverISFParallelData following the recomendations of
	  David

2013-11-06 16:31  dstrubbe

	* [r11476] Making 'infrared' part of the vibrations_t object.

2013-11-06 19:48  dstrubbe

	* [r11477] Separating computation of Born charges from infrared.

2013-11-06 20:20  dstrubbe

	* [r11478] Unused or useless variables. Also, hiding one used only
	  for MPI.

2013-11-06 20:44  dstrubbe

	* [r11479] Operations on vib%dyn_matrix were being performed in the
	  opposite order from the usual Fortan convention, which is a bit
	  confusing and slower. Since the matrix is symmetrical, we can
	  just swap all the indices.

2013-11-06 21:23  acastro

	* [r11480] Added a target to manipulate the spin of a system, and
	  added a corresponding
	  test.

2013-11-06 22:05  dstrubbe

	* [r11481] Making an argument const.

2013-11-06 22:23  dstrubbe

	* [r11482] Swapping indices of dynamical matrix in one more place
	  forgotten in r11479.

2013-11-07 12:12  askhl

	* [r11483] simplify. Add assertion

2013-11-07 13:06  marques

	* [r11484] First attempt at Kxc for the GGA correlations. For now,
	  the WI functional is working. This is however a very simple
	  functional with most of the dependencies missing. A lot of work
	  is still left...

2013-11-07 16:26  dstrubbe

	* [r11485] Tightening convergence criteria for vib_modes runs.

2013-11-07 16:46  dstrubbe

	* [r11486] * The dynamic matrix is now written out by row.
	  * Also, when not symmetrizing, the opposite half of the matrix is
	  being copied over than before.

2013-11-07 18:34  dstrubbe

	* [r11487] * Comment on invcm unit.
	  * Reducing duplicated operations in symmetrizing dynamical
	  matrix.

2013-11-07 18:36  dstrubbe

	* [r11488] Disabling the recent optimal control tests until they
	  can be fixed. Leaving so many tests failing makes it likely that
	  new problems will not be noticed...

2013-11-07 19:14  dstrubbe

	* [r11489] * A header for vib_modes/dynamical_matrix is now
	  written, noting the unit.
	  * Message about symmetrizing matrix and discrepancy from
	  symmetry.
	  * Updating query for test matches, and moving to more robust
	  LINEFIELD.

2013-11-07 19:25  dstrubbe

	* [r11490] * The units were wrong for the dynamical matrix. Moving
	  to the appropriate energy/length^2 also puts them in a more
	  convenient range (not 10^9).
	  * Removing now unused variable.

2013-11-07 19:46  dstrubbe

	* [r11491] Breaking up a line made long by macro replacement.

2013-11-07 20:04  dstrubbe

	* [r11492] * More convenient name for variable with file unit for
	  writing dynamical matrix.
	  * Changing single-letter variables.
	  * Removing unused variables.

2013-11-07 20:19  dstrubbe

	* [r11493] * The vibrations module handles its own header-writing.
	  * The file for the dynamical matrix is not left open but is
	  opened and closed when writing occurs. This makes sure the output
	  is not buffered, so if the calculation is interrupted, the
	  results so far are in the file.

2013-11-07 20:24  dstrubbe

	* [r11494] * Moving 'iunit' to local scope of calc_infrared and
	  renaming to be more specific.
	  * Using 'trim' to avoid warning of overflow of string size.

2013-11-07 21:32  dstrubbe

	* [r11495] * Making a separate routine to set linear-response
	  wavefunctions and density to zero.
	  * Using this when starting each mode in phonon calculation, since
	  the previous mode is probably not a good starting point. In
	  particular, starting from the previous mode results allows small
	  numerical differences to accumulate over the whole run. Results
	  should be more reproducible now. They certainly obey symmetry a
	  bit better.
	  * Doxygen comments.

2013-11-07 22:43  dstrubbe

	* [r11496] Linear-response vib_modes now stores calculated elements
	  of the dynamical matrix (and infrared vectors) and reads them on
	  restart, starting with the first mode that was not yet converged.
	  Restarting from an interrupted calculation previously could waste
	  a lot of time on modes already calculated, reading restart
	  wavefunctions and densities, setting up, confirming the results
	  satisfied the Sternheimer equation, writing restart data to disk,
	  and computing the row of the dynamical matrix. Now these things
	  do not have to be done at all.

2013-11-08 12:04  acastro

	* [r11497] Some modifications to make the g95 compiler happy about
	  two tests.

2013-11-08 16:35  dstrubbe

	* [r11498] * Removed 'UseRestartDontSolve' in linear-response
	  vib_modes, for which the proper restart from the saved dynamical
	  matrix I recently implemented is a much better replacement.
	  * Bugfix (regarding performance) to r8180: when I moved to use
	  forces_derivative instead of pert_expectation_value, I
	  accidentally left it inside a loop over modes. As a result,
	  rather than reducing the amount of work a bit, instead it
	  multiplied the work by the number of modes. Now this is fixed.

2013-11-09 04:25  xavier

	* [r11499] Converted a C++ style comment into a C style one.

2013-11-09 14:46  xavier

	* [r11500] Avoided an overflow in the count of operations.

2013-11-09 15:05  xavier

	* [r11501] Hilbert meshes were broken since [11457]. Declaring
	  arrays as
	  arguments of C functions causes problems, I am not sure why. I
	  will
	  add a test soon.

2013-11-10 10:47  acastro

	* [r11503] Removed some unnecessary assertion, and reduced the
	  precision of one test
	  whose result slightly depends on the compiler.

2013-11-10 19:12  xavier

	* [r11504] The allocations of arrays passed to libxc is now done in
	  an
	  independent routine.

2013-11-11 16:15  xavier

	* [r11505] Added some operation counts.

2013-11-11 19:18  askhl

	* [r11506] atomic distance check now only prints a warning instead
	  of giving a fatal error, when the involved species are
	  user-defined potentials and their ilk

2013-11-11 22:01  dstrubbe

	* [r11507] Unused variable, PUSH/POP's.

2013-11-12 10:56  micael

	* [r11508] * Bub fix: the calculation of GGA and MGGA xc potentials
	  was completely wrong due to a misplaced "end if". This bug was
	  introduced in [9729].

2013-11-13 02:39  dstrubbe

	* [r11509] Removing limitation to 16 OpenMP threads, introduced in
	  r3841, which was just for static allocation of arrays.

2013-11-13 04:27  dstrubbe

	* [r11510] Don't recalculate the KS potential if MaximumIter = 0.

2013-11-13 04:39  dstrubbe

	* [r11511] More space for info in error message from SAFE_ALLOCATE
	  and SAFE_DEALLOCATE_A, SAFE_DEALLOCATE_P.

2013-11-13 17:20  joseba

	* [r11512] Added the optional library of LibISF

2013-11-14 04:30  dstrubbe

	* [r11513] Replacing test runs with CalculationMode = one_shot by
	  CalculationMode = gs with MaximumIter = 0. Matches are now from
	  static/info. Such a calculation should not be from FromScratch,
	  in order to restart from the preceding SCF run.

2013-11-14 04:38  dstrubbe

	* [r11514] Enabling test for gga_x_lb. I wonder if the real problem
	  was looking at Correlation instead of Exchange?

2013-11-14 05:44  dstrubbe

	* [r11515] Testing Int[n*v_xc] for each functional. Committed with
	  this perl script, and some manual intervention.
	  
	  {{{
	  while (<>) {
	  if($_ =~ /match ; (.*?)\s*; GREP\(static\/info, '([^']*)
	  =',(.*)/) {
	  $name = $2;
	  printf("match ; %-39s; GREP\(static\/info, '%s =',$3\n", $1 . " "
	  . $name, $name);
	  $name1 = "Int[n*v_xc]";
	  $name2 = "Int\\[n\\*v_xc\\]";
	  printf("match ; %-39s; GREP\(static\/info, '%s =',$3\n", $1 . " "
	  . $name1, $name2);
	  } else {
	  print;
	  }
	  }
	  }}}

2013-11-14 17:50  dstrubbe

	* [r11516] OEP EXX Int[n*v_xc] match for
	  testsuite/functionals/01-xc_1d.oep_exx.inp was failing. Most
	  slaves seem to agree on a value of roughly -769000, though my
	  MacBook had given -676005. However all the results are wrong
	  because the OEP was nowhere near convergence (residual = 1e6 >
	  1e-5 = tol) and the eigenvalues were being written as *******.
	  Setting OEPMixing = 0.001 still does not meet the tolerance but
	  gives a residual around 0.08 which is at least more like
	  convergence than divergence, and may give a more reproducible
	  value for the test match.

2013-11-14 17:58  dstrubbe

	* [r11517] Correcting misleading output from full OEP: it always
	  said "converged" even when it was not.

2013-11-14 18:43  dstrubbe

	* [r11518] Passing the whole states object to v_ks_init and down to
	  xc_oep_init.

2013-11-14 18:50  dstrubbe

	* [r11519] The logic for choosing a linear solver for Sternheimer
	  should apply in general for linear solvers, i.e. also for full
	  OEP.

2013-11-14 19:10  dstrubbe

	* [r11520] Improvement to backport.sh for svn 1.8.

2013-11-14 19:29  dstrubbe

	* [r11521] The 2D PRM test was spin-unpolarized but restarting from
	  spin-polarized Hartree-Fock like the others, i.e. deliberately
	  misunderstanding the restart wavefunctions. We could run
	  spin-polarized (neither Octopus and libxc flag a problem when
	  running spin-polarized), but the reason it was unpolarized was
	  that the PRM 2008 paper says "a spin-polarized extension of the
	  present functional is still missing". Therefore to do a more
	  reasonable calculation, we will do SCF from scratch
	  spin-unpolarized.

2013-11-14 20:28  dstrubbe

	* [r11522] Decommissioning CalculationMode = one_shot. Using gs
	  with MaximumIter = 0 instead has all the functionality of
	  one_shot plus a lot more, without duplicating any of the SCF
	  code.

2013-11-15 01:02  dstrubbe

	* [r11526] Although current DFT was removed in r8079, the variable
	  CurrentDFT remained around to confuse users.

2013-11-15 21:32  dstrubbe

	* [r11528] Bugfix: gga_x_lb with max-dim > 3 caused a segmentation
	  fault. Correcting allocation.

2013-11-15 21:49  dstrubbe

	* [r11529] Removing explicit use of dimension 3 in vxc calculation,
	  which could cause problems when that is not the actual dimension
	  or maximum dimension. Probably not worth backporting since I am
	  not sure whether any calculation you can actually do now would
	  have a problem.

2013-11-15 23:33  dstrubbe

	* [r11530] Comments about variables that cannot use datasets.

2013-11-18 08:59  micael

	* [r11532] * Fixed bug pointed out by Xavier: vtau should be
	  divided by 2 outside the space loop.

2013-11-18 09:46  micael

	* [r11534] * Updated 4.1.x ChangeLog.
	  * Updated packaging info.
	  * Tagged version 4.1.2.

2013-11-18 14:36  umberto

	* [r11535] Extend PESmask to parallelepiped box shapes.

2013-11-18 17:37  micael

	* [r11536] * Some cleaning in the xc_get_vxc routine.

2013-11-19 13:26  joseba

	* [r11537] Updated the reference of the Poisson survey
	  Added a more verbose information about the chosen Poisson solver
	  
	  By Pablo and me

2013-11-19 13:32  joseba

	* [r11538] typo

2013-11-20 16:54  umberto

	* [r11539] * use states_get_state and states_set_states when
	  applying the mask.
	  * we can lift the experimental phase status of the module now.

2013-11-21 11:34  joseba

	* [r11540] Changed from Hartree to Poisson
	  Updated the reference
	  Deleted duplicated information

2013-11-22 09:48  joseba

	* [r11541] Added the possibility to write the output of the td in a
	  different folder. This is aimed to be able to write in the local
	  hard-drives instead of the shared NFS (or similars)

2013-11-22 12:06  marques

	* [r11542] Added variant of PBE0 with mixing=1/3

2013-11-25 14:08  askhl

	* [r11543] complex scaling - remove some text output

2013-11-25 15:30  askhl

	* [r11544] complex scaling: add function to calculate kinetic
	  matrix elements with the purpose of distinguishing continuum
	  states from bound ones or resonances. Function added to
	  energy_calc in order to not have cyclic dependences but maybe it
	  should be elsewhere

2013-11-25 15:32  askhl

	* [r11545] complex scaling: new parameter
	  ComplexScalingLocalizationRadius to help distinguish resonances
	  or bound states from continuum ones

2013-11-25 15:32  askhl

	* [r11546] avoid error when there is less than one electron in
	  complex scaling

2013-11-25 15:44  askhl

	* [r11547] complex scaling: multiple improvements and fixes in PBE.
	  Should now generally work. For now, use a criterion to
	  distinguish bound states/resonances from continuum states which
	  involves the part of the norm outside/inside a certain radius for
	  each state using the new (not very general) parameter
	  ComplexScalingLocalizationRadius. Improve and update tests to
	  work with these changes. (Some new functions in eigensolver.F90
	  should probably be renamed and moved to other modules but it's
	  difficult because of dependency problems. Suggestions are
	  welcome)

2013-11-26 09:28  joseba

	* [r11548] Corrected the error I made in r11541

2013-11-27 22:35  xavier

	* [r11549] Removed some debugging output that shouldn't be there.

2013-11-28 09:03  joseba

	* [r11550] Return the error code found in the reading of the header

2013-11-28 16:53  askhl

	* [r11551] add complex-scaled LB94. Get rid of 'optional'
	  declarations of a few arguments that are really mandatory.

2013-12-03 21:19  dstrubbe

	* [r11552] If you compile in parallel, and then try to run a serial
	  utility on the command line, this will fail for many machines
	  such as a Cray. However we can enable it easily by simply
	  refraining from calling MPI_Init or MPI_Finalize. Then you can
	  run on the command line, which is much more convenient for users
	  than submitting a job just to do oct-center-geom.

2013-12-04 13:44  joseba

	* [r11553] Computed before the allocate the number of points (inner
	  and boundary). Requires to compute twice the same information.
	  partition_get_partition_number has to be called always, even when
	  the number of points is 0; all the processes have to take part in
	  the MPI_Alltoall
	  Deleted unnecessary barrier

2013-12-04 21:44  dstrubbe

	* [r11554] * Identify which restart file could not be opened if
	  there is a problem.
	  * Read restart 'states' file to check that number of spinor
	  dimensions and k-points is consistent with current calculation.

2013-12-04 22:26  dstrubbe

	* [r11555] * Since the berkeleygw test is no longer restarting from
	  the wrong k-point, a more accurate eigenvalue is obtained.
	  * Turning off the preconditioner makes unocc converge much more
	  quickly in this case.

2013-12-04 23:31  dstrubbe

	* [r11556] * Avoiding warning about truncation of string in
	  messages.
	  * Doxygen comments.
	  * Adding () to subroutines without arguments.

2013-12-05 04:03  dstrubbe

	* [r11557] * Setting ifmax for BerkeleyGW output was incorrect for
	  semiconductors.
	  * Off-diagonal exchange matrix elements can now be calculated.
	  * x.dat is tested.

2013-12-05 08:21  joseba

	* [r11558] Trying to make more clear the printed information

2013-12-06 00:56  dstrubbe

	* [r11559] BerkeleyGW output:
	  * The previous treatment was appropriate for VXC but not for RHO.
	  Now a factor is applied outside the routine to VXC so both will
	  be correct.
	  * Commenting out debugging info.

2013-12-09 10:18  umberto

	* [r11560] Averaged density self-interaction correction as
	  described in C. Legrand et al. J. Phys. B 35, 1115 (2002).

2013-12-09 14:16  askhl

	* [r11561] appease precompiler

2013-12-09 19:38  askhl

	* [r11562] fix minor error in complex-scaled lb94 due to
	  differences btw. spin-polarized and unpolarized expressions

2013-12-09 19:40  askhl

	* [r11563] one more parameter, ComplexScalingLocalizedStates, to
	  control occupation of states with complex scaling. Update test to
	  use these parameters

2013-12-09 21:08  dstrubbe

	* [r11564] * Enforcing that test files set 'Enabled' before trying
	  to run anything.
	  * Fixing two small anomalies in the test files: one set an unused
	  tag 'Arch', and another had a mistaken leading '\'.

2013-12-09 21:26  askhl

	* [r11565] adjust complex scaling test parameters

2013-12-09 22:53  dstrubbe

	* [r11566] Simplifying logic about whether enabled in testsuite
	  script.

2013-12-09 23:46  dstrubbe

	* [r11567] * Further comment on how unocc can be used.
	  * More intelligent display of eigenvalues in unocc when only
	  occupied states are present.

2013-12-10 08:35  marques

	* [r11568] Bug found by Søren Smidstrup corrected (abs -> ABS)

2013-12-10 14:16  askhl

	* [r11569] treat special case correctly (complex scaling)

2013-12-10 23:05  dstrubbe

	* [r11570] More info about unocc LCAO.

2013-12-11 00:09  dstrubbe

	* [r11571] The testsuite perl script now rejects unknown commands
	  in the '.test' file, rather than just ignoring them. This can
	  help avoid incorrectly specified commands, which the author might
	  not realize were just ignored.

2013-12-11 00:19  dstrubbe

	* [r11572] * For the purposes of unocc, it is not sufficient to
	  return the number of states read from restart. We need to know
	  which ones. Instead we will return the lowest one which is
	  missing, and do LCAO (or random) for everything above that in
	  unocc.
	  * Restart sets missing wavefunctions' occupations to zero. I am
	  not sure why this behavior makes sense, but anyway it would be
	  good to call states_fermi to be sure we have reasonable
	  occupations in unocc. Fortunately they do not matter for the
	  eigenvalues, but one might wish to know the occupations (when
	  calculating nscf on different k-points) or writing BerkeleyGW
	  output.

2013-12-11 00:43  dstrubbe

	* [r11573] * Clarifying meaning of 'ierr = -1' in restart read
	  routines.
	  * If files cannot be read at all, 'lowest_missing' needs to be 1
	  not the number of states.
	  * More full filename output.
	  * Bugfix: restart_read_rho returned ierr = 0 (success) if nothing
	  could be read.

2013-12-11 05:39  dstrubbe

	* [r11574] Occupations should be set on restart based on whether
	  they are listed in the 'occs' file, not on whether the *.obf file
	  is found.

2013-12-11 13:53  nitsche

	* [r11575] * Fixed a bug in output_hamiltonian. When parallel in
	  states or k-points was active, all nodes wrote the files. This
	  occasionally resulted in corrupted obf files.

2013-12-11 17:51  askhl

	* [r11576] Make sure states are sorted by energy in complex scaling
	  test

2013-12-11 19:33  dstrubbe

	* [r11577] Bugfix to r11574: restart for Sternheimer
	  linear-response was zeroing all the occupations.

2013-12-11 20:29  dstrubbe

	* [r11578] Updating testsuite values slightly given bugfix in
	  libxc, r11568.

2013-12-11 20:30  dstrubbe

	* [r11579] fix_testsuite.py:
	  * Correction of terminology.
	  * Only diff files that exist.

2013-12-12 19:29  askhl

	* [r11580] Implement AD-SIC with complex scaling. Move AD-SIC stuff
	  into separate function.

2013-12-12 20:13  dstrubbe

	* [r11581] Suppressing warnings from gfortran by making complex
	  operator only available in complex version of routines, and
	  adding checks to be sure we do not try to use it with the real
	  version.

2013-12-12 23:23  dstrubbe

	* [r11582] Can now write dipole matrix elements for Bethe-Salpeter
	  of finite system in BerkeleyGW.

2013-12-13 22:01  dstrubbe

	* [r11583] We should catch obsolete variables with a dataset prefix
	  too.

2013-12-14 01:22  dstrubbe

	* [r11584] * Setting error conditions for BerkeleyGW.
	  * This makes it necessary to pass ks, not just xc, to output
	  routines.

2013-12-14 01:26  dstrubbe

	* [r11585] Correcting types and indentation.

2013-12-14 03:50  dstrubbe

	* [r11586] More compact, and presumably more efficient, way of
	  computing oscillator strengths for Casida.

2013-12-14 04:01  dstrubbe

	* [r11587] * Adding default for BerkeleyGW_VmtxelPolarization.
	  * Check that vector norm is nonzero.
	  * Needed to be divided by square root anyway.
	  * Avoid warning about truncation of string in message.

2013-12-14 20:14  dstrubbe

	* [r11588] * Moving RDMFT message to a more appropriate place.
	  * Improving variable documentation.

2013-12-14 22:39  dstrubbe

	* [r11589] What LCAO alternative calls this%nbasis is the same as
	  what the standard LCAO calls this%norbs.

2013-12-16 17:48  acastro

	* [r11590] No reason why one cannot move the ions when using the
	  Crank-Nicolson
	  propagation scheme.

2013-12-17 09:10  joseba

	* [r11591] Added SVN Id to (almost) all the missing files, with svn
	  propset svn:keywords "Id" FILE

2013-12-17 14:42  marques

	* [r11592] Added the functional GGA_X_PBE_MOL. Patch by Susi
	  Lehtola.

2013-12-17 16:27  joseba

	* [r11593] Implemented a utility which reads a binary file and
	  writes the equivalent ---OutputHow defined--- files

2013-12-17 16:44  joseba

	* [r11594] Corrected a name of a file

2013-12-22 10:06  acastro

	* [r11595] Changed the procedure to compute the forces acting on
	  the costate variables
	  when doing optimal control with Ehnrefest dynamics. The previous
	  procedure was
	  faster but led to too high numerical error.

2013-12-22 21:22  acastro

	* [r11596] Moved the sparkit data object inside the propagator data
	  type.

2014-01-05 09:48  dstrubbe

	* [r11597] Typos, PUSH/POP's, formatting.
	  
	  Joseba, don't you want units_output%length**(-1/3) rather than
	  "my_unit"? Also this would still only be correct for the density,
	  not for other quantities (e.g. wavefunction, potential, etc.).

2014-01-06 12:05  dstrubbe

	* [r11598] In unocc mode, we should write the file 'eigenvalues'
	  after every iteration, not just after successful completion, so
	  that if the run is interrupted, we can still see the results so
	  far.

2014-01-08 17:24  joseba

	* [r11600] Added the possibility to subtract a reference value to
	  the files that are being converting
	  This commit belongs mainly to Quim Jornet

2014-01-08 22:42  dstrubbe

	* [r11601] Position matrix elements for BerkeleyGW output.
	  * Fixing bug in matmul usage.
	  * Write ASCII as well as binary file.

2014-01-09 13:57  joseba

	* [r11602] Finally, the SVN number is printed properly,
	  independently in which folder is compiled

2014-01-13 10:47  micael

	* [r11603] * Added the skeleton of a new utility that will compute
	  multipoles in subdomains of the simulation box.
	  * Added a simple module to deal with simple boxes. Some of this
	  is duplicated from the simul_box module. The idea will be to use
	  this to rewrite the simulation box in a more general way later
	  on. For now it will be used by the new utility.

2014-01-13 11:13  micael

	* [r11604] * Renaming the box type parameters in box_m to avoid
	  name clashes with the ones from the simulation box.

2014-01-13 12:05  micael

	* [r11605] * Added new module to deal with a union of boxes.

2014-01-13 16:09  micael

	* [r11606] * Missing dependency.

2014-01-13 17:50  micael

	* [r11607] * It is now possible to compute the integral of a mesh
	  function using a mask.
	  * Added routine to compute local multipoles in a set of domains.

2014-01-14 12:30  joseba

	* [r11608] Deleted the last NxN matrix and done changes accordinly

2014-01-15 16:08  joseba

	* [r11609] Added a MPI_Barrier between two MPI_Alltoallv, as it
	  might produce a deadlock

2014-01-15 16:26  joseba

	* [r11610] Correction to the previous commit; MPI_Barrier is only
	  called in parallel compilation

2014-01-15 17:17  joseba

	* [r11611] vp%ghost computed in a more robust way. Instead of
	  iterating over all the processes, global MPI functions are used
	  instead. It also avoids to get stuck with high number of
	  processes

2014-01-19 12:18  dstrubbe

	* [r11612] Setting svn:ignore for new utilities.

2014-01-19 15:57  dstrubbe

	* [r11613] Removing call to 'init_states' for when LCAO is not
	  done, which set the states to the atomic orbitals. It was added
	  in r7716 by Xavier, and the commit message says it is to make
	  sure the states are initialized before trying to construct the KS
	  potential in case it depends on them. I don't think it
	  accomplishes that task, because it comes right after a call to
	  v_ks_calc and won't influence that, and before the next call to
	  v_ks_calc, the states will all have been initialized either from
	  LCAO or from random wavefunctions. So if it is necessary to
	  initialize the states before calling v_ks_calc, the code needs to
	  be fixed. The call I am removing seems to have no effect other
	  than to take time, which can be enormous when Hermite polynomials
	  are being used as orbitals for jellium, and it is particularly
	  problematic that this happens even when LCAO is turned off by the
	  user. Incidentally, I think the only cases in which the states
	  are necessary for the KS potential is for orbital-dependent
	  functionals, namely hybrids, OEP, Hartree, and Hartree-Fock, so
	  an initialization of the states to the orbitals would only be
	  useful in those cases.

2014-01-19 16:02  dstrubbe

	* [r11614] Adding directories and example files for the CPI and FHI
	  pseudopotential formats. The pseudos I am adding here were
	  generated from the following input file with APE 2.2.0, trying to
	  use analogous parameters to our C.psf.
	  
	  Title = "carbon"
	  CalculationMode = ae + pp
	  Verbose = 40
	  
	  XCFunctional = lda_x + lda_c_pz
	  
	  NuclearCharge = 6
	  
	  %Orbitals
	  1 | 0 | 2
	  2 | 0 | 2
	  2 | 1 | 2
	  3 | 2 | 0
	  %
	  
	  %PPComponents
	  2 | 0 | 1.47 | tm
	  2 | 1 | 1.47 | tm
	  3 | 2 | 1.47 | tm
	  %
	  
	  PPOutputFileFormat = abinit6 + fhi
	  
	  LLocal = 1

2014-01-19 16:07  dstrubbe

	* [r11615] * Adding test runs with the C atom for the CPI and FHI
	  pseudopotential formats. There is a warning that only 2 orbitals
	  are available (instead of at least 4) which seems to indicate a
	  problem with Octopus or APE.
	  * Renaming the input file for C atom to something more
	  descriptive.
	  * Removing unnecessary commented line in input file.

2014-01-19 16:12  dstrubbe

	* [r11616] Forgot to commit this change as part of r11614.

2014-01-19 16:44  dstrubbe

	* [r11617] * Documentation for Species block claimed HGH PP's used
	  only 4 columns but in fact 6 were required, though the last two
	  were not used. Now, only 4 columns are required, in accordance
	  with the documentation.
	  * Reorganized reading Species block rows a bit to allow 4-column
	  PP's like HGH and UPF to be handled more cleanly, and for the
	  extra columns for defaults to be usable for them.
	  * Removed spurious extra columns for Species row for UPF and HGH
	  pseudos from testsuite.
	  * Other little improvements to documentation on Species block.

2014-01-20 17:56  dstrubbe

	* [r11618] Reforming indentation.

2014-01-20 19:21  dstrubbe

	* [r11619] * Bugfix: LCAOAlternative tried to access an array out
	  of bounds in constructing the wavefunctions in real space, if the
	  number of states was greater than the number of orbitals being
	  used (despite the fact the handling of this situation was
	  explicitly considered via randomization of the remaining
	  orbitals).
	  * One of the tests now falls into this category to ensure correct
	  behavior in future. I limited the number of iterations to
	  compensate for the extra time in using a large number of
	  ExtraStates.

2014-01-21 21:53  dstrubbe

	* [r11620] Critical bugfix for 2D-periodic systems: a typo in r9867
	  (by me) resulted in the cutoff radius being set based on the
	  x-direction instead of the z-direction, which is the finite one.

2014-01-22 15:57  joseba

	* [r11621] Added "1:" at the beginning of the SAFE_ALLOCATE. Thus,
	  the profiler is able to compute those matrices

2014-01-23 11:02  joseba

	* [r11622] Bugfix to partition_get_partition_number.
	  Ceiling function could be not precise enough when the mesh points
	  are very large, so double precision is mandatory.
	  For example in a mesh with 25,811,455 and 8 domains, the point
	  19,358,593 (19,358,593/3,226,432 = 6.00000031) have to go to the
	  rank 7 and previously was assiging to 6.
	  np_global = 25,811,455
	  npart = 8
	  remainder = 7
	  nppp = 3,226,431

2014-01-23 11:40  joseba

	* [r11623] Correction to the previous commit: using REAL_PRECISION
	  flags instead of 16

2014-01-23 15:22  micael

	* [r11624] * Fixed bug in pseudopotential initialization: no
	  angular momentum quantum number was assigned for the
	  pseudo-wavefunction when using the cpi and fhi formats. Note that
	  the fix is not ideal, but that part of the code is just a big
	  mess...

2014-01-24 20:20  dstrubbe

	* [r11625] Making explicit an incompatibility with spinors.

2014-01-24 21:16  dstrubbe

	* [r11626] Fixing indentation.

2014-01-24 21:39  dstrubbe

	* [r11627] * Improvements to documentation on ModelMB output.
	  * I see no evidence that the option Output = mmb_den can produce
	  a density, as stated, just density matrices, so I removed
	  references to densities.
	  * Useless lines removed.

2014-01-24 21:58  dstrubbe

	* [r11628] * Improvements to documentation for Output.
	  * Fixing incorrect listing of default for OutputBandsGnuplotMode.
	  * Reclassifying MomentumTransfer as Output not States.
	  * Improving comments.

2014-01-24 22:03  dstrubbe

	* [r11629] * More info on Output = dos.
	  * More comprehensive list of Output options that do not require
	  OutputHow.
	  * More compact way of setting bits for frozen.

2014-01-24 22:10  dstrubbe

	* [r11630] Clarifications to FHI pseudo documentation.

2014-01-24 22:52  dstrubbe

	* [r11631] Unifying some code for CPI and FHI pseudopotentials.

2014-01-24 23:09  dstrubbe

	* [r11632] Little improvements to comment and variable
	  documentation formatting.

2014-01-24 23:26  dstrubbe

	* [r11633] Removing AbsorbingBoundaries input flags from non-td
	  runs, which don't use them anyway.

2014-01-25 21:47  dstrubbe

	* [r11634] Forgot to commit this change too as part of r11588: this
	  message was moved elsewhere.

2014-01-25 23:13  dstrubbe

	* [r11635] Enabling use of LCAO in the standard scheme when there
	  are not enough orbitals for all the states needed, by randomizing
	  the remainder. This was already being done for LCAOAlternative,
	  and can be extremely helpful for unocc mode, rather than just
	  randomizing everything. The randomization is now done jointly for
	  both modes with states_generate_random, rather than with
	  LCAOAlternative's own implementation, thus taking advantage of
	  improvements in reproducible parallelization of the former. Also,
	  orthogonalization is disabled for LCAOAlternative for the time
	  being, as before, pending investigation of whether this is a good
	  idea or not.

2014-01-26 18:25  dstrubbe

	* [r11636] Updating test values for RDMFT in accordance with
	  r11635: since LCAO is now possible for the ground-state
	  Hartree-Fock run rather than just using random orbitals, and the
	  calculation was stopped far from convergence, the results changed
	  significantly.

2014-01-27 04:45  dstrubbe

	* [r11637] Combining X(symmetrizer_apply) and
	  X(symmetrizer_apply_vector), which were mostly the same, to avoid
	  duplication and in preparation for fixing bugs here.

2014-01-27 19:09  dstrubbe

	* [r11638] Bugfix to r11635: when LCAOStart = lcao_none,
	  lcao%alternative was uninitialized but nonetheless was
	  controlling whether the random wavefunctions were orthogonalized,
	  which gave some discrepancies in test results. Now
	  lcao%alternative is initialized regardless, so that
	  orthogonalization will always be done when we have only random
	  wavefunctions. Also, the message about orthogonalizing will only
	  be written when that actually happens.

2014-01-27 21:55  dstrubbe

	* [r11639] Symmetrizer:
	  * Periodic boundary conditions should not be applied in finite
	  directions.
	  * Adding an assertion.
	  * The discrepancy from symmetry is now printed, demonstrating
	  when problems occur with this routine.
	  * Adding comments.

2014-01-27 21:55  dstrubbe

	* [r11640] All tests should be run on octopus_mpi as well as
	  octopus.

2014-01-27 22:49  dstrubbe

	* [r11641] * Critical bugfix to symmetrizer routine: the symmetry
	  operations were applied with respect to an incorrect origin,
	  which was located at the corner of the cell rather than the
	  center. As a result, use of SymmetrizeDensity was incorrect
	  except for certain highly symmetric structures in which the
	  symmetry operations also happened to be correct when adding this
	  translation. This is the case for our silicon and lithium tests.
	  It is emphatically not the case for the sodium chain or any other
	  partially periodic system.
	  * The sodium chain now uses SymmetrizeDensity (without reducing
	  the k-points by symmetry), to check the correct behavior of the
	  symmetrization.

2014-01-27 23:06  dstrubbe

	* [r11642] A large discrepancy in "symmetrizing" the forces is not
	  really significant, because the use of the symmetrizer routine
	  there is quite different than for symmetrizing the density or
	  gradients. The forces are summed over k-points using this
	  routine, which was not the case for the other quantities. As a
	  result, no warning should be written even if the discrepancy is
	  large for forces.

2014-01-28 12:31  jjornet

	* [r11643] Implemented a utility which reads a density file and
	  return the local multipoles for a selected domains.
	  !> Reads a global grid and density and make local domains
	  !%Description
	  !% This variable stores the information about the local boxes
	  !% for each new local domain. Information is read in a block
	  format.
	  !% %LocalDomains
	  !% 'Label' | Shape | rsize %< | Shape dependencies >%
	  !% Label = string with the name of the new local domain.
	  !% Shape = SPHERE, CYLINDER, PARALLELEPIPED, MINIMUM
	  !% Shape dependencies:
	  !% case(SPHERE): | rsize | %<dim origin coordinates>
	  !% case(CYLINDER): | rsize | xsize | %<origin coordinates>
	  !% case(PARALLELEPIPED): | %<lsize> | %<origin coordinates>
	  !% case(MINIMUM): | 'center_list'
	  !% rsize < Radius in input length units
	  !% xsize < the length of the cylinder in the x-direction
	  !% origine coordinates < in input length units separated by | .
	  where is the box centered.
	  !% lsize < half of the length of the parallelepiped in each
	  direction.
	  !% center_list < string containing the list of atoms in xyz file
	  for each domain in the form "2,16-23"
	  !%End

2014-01-28 12:55  joseba

	* [r11644] Added SVN Id to the new files

2014-01-28 14:06  jjornet

	* [r11645]
	  Compilation error fixed: print statement has been removed from
	  local_multipoles.F90 file.

2014-01-28 16:37  dstrubbe

	* [r11646] * Fixing variable name in documentation block: watch
	  your spelling in these places!
	  * Formatting: the variable reference is treated as a paragraph of
	  text, so <tt> tags are needed for the info on variable 'domain'
	  to be at all comprehensible in the web page.
	  * There is a function to produce lines of '#'.

2014-01-28 18:05  dstrubbe

	* [r11647] As pointed out by the valgrind buildslave, when we use
	  MaximumIter = 0 for the functionals tests, we should not write
	  out the convergence info to static/info, because with no SCF
	  iterations we have no idea to what extent (if any) the
	  calculation is converged, and so the numbers written are
	  uninitialized.

2014-01-28 18:14  dstrubbe

	* [r11648] * Octopus is finally ready for a boron nitride test, to
	  make sure things are working for 2D-periodic systems.
	  * 11-silicon_force files were not listed in the Makefile.am.

2014-01-28 19:45  xavier

	* [r11649] Bugfix: the calculation of the density with the fine
	  mesh was not correct.

2014-01-28 20:15  xavier

	* [r11650] Proper fix for UseFineMesh and OpenCL.

2014-01-28 20:58  dstrubbe

	* [r11651] * The list of symmetries is now written in the output.
	  * Added tests for total and reduced number of k-points, space
	  group, and number of symmetries, for periodic systems.
	  * Added tests for total energy components in periodic systems,
	  where they were missing.

2014-01-28 23:06  dstrubbe

	* [r11652] Removing useless tags from input files: there are not 9
	  orbitals available, so it does nothing to set LCAODimension = 9.

2014-01-29 02:15  dstrubbe

	* [r11653] The eigenvalues are supposed to be global, but they are
	  only available locally (in state-kpoint groups) when calculated
	  from expectation values, so they should be all-reduced. This
	  caused a problem in initialization from random wavefunctions, in
	  which case the eigenvalues used to determine occupations and
	  build the density were zero for states not on the root processor.
	  I am surprised it didn't give trouble elsewhere where this
	  routine is used, e.g. from v_ks_calc in td.F90.

2014-01-29 03:38  xavier

	* [r11654] Started converting the sternheimer equation to
	  operations by blocks.

2014-01-29 04:12  xavier

	* [r11655] * The rhs array now contains a block of states.
	  * The convergence indicators are stored in an array and printed
	  after
	  the block is completed.

2014-01-29 04:26  xavier

	* [r11656] Changed the order of the loops, the loop over sigma is
	  now outside of
	  the states loop.

2014-01-29 04:46  xavier

	* [r11657] Split the loop over the states block into several loops,
	  so now
	  operations can be performed by blocks.

2014-01-29 04:52  xavier

	* [r11658] Renamed solve_HXeY to linear_solver_solve_HXeY.

2014-01-29 05:12  xavier

	* [r11659] The convergence indicators of the linear solver are now
	  returned in
	  arguments instead of through the object.

2014-01-29 14:25  adelgado

	* [r11660] New PCM module 'src/pcm.F90' has been added to build the
	  solvent excluded surface and generates the PCM response matrix to
	  be used in solvation calculations (not implemented yet). The
	  'subroutine pcm_init' is called from module 'src/system.F90' to
	  initialize PCM. The new variable 'SolventDielectricConstant' in
	  'subroutine pcm_init' contains the static dielectric constant of
	  the solvent.

2014-01-29 15:09  adelgado

	* [r11661] I forgot to add previously the new module 'src/pcm.F90

2014-01-29 15:31  xavier

	* [r11662] Bugfix: My last commit broke the calculation with a fine
	  mesh in parallel.

2014-01-29 15:32  xavier

	* [r11663] A small correction, Makefile.in files are not kept in
	  the repository.

2014-01-29 16:05  xavier

	* [r11664] Added a batch interface to the linear solver. This
	  interface is now
	  used by the Sternheimer equation.

2014-01-29 16:34  xavier

	* [r11665] * Removed some commented code left in my last commit.
	  * Renamed functions starting with ls_ to linear_solver_.

2014-01-29 16:43  adelgado

	* [r11666] type 'tess_pcm_t' has been assigned the 'public'
	  attribute

2014-01-29 17:05  adelgado

	* [r11667] linking to 'libpcm.a' was enabled to build the
	  'photoelectron_spectrum' utility

2014-01-29 17:07  xavier

	* [r11668] Since the qmr function receive a lot of arguments,
	  having an interface
	  for different calls makes the code more difficult to understand.
	  So I
	  removed the interfaces.

2014-01-29 21:00  dstrubbe

	* [r11669] 'Makefile' should not be in the repository. Only
	  Makefile.am.

2014-01-29 21:38  dstrubbe

	* [r11670] Tightening convergence on BN test to try to get all
	  slaves to pass.

2014-01-29 22:48  dstrubbe

	* [r11671] Making testsuite errors written more prominently.

2014-01-29 22:49  dstrubbe

	* [r11672] A file was missing for installation.

2014-01-29 23:15  dstrubbe

	* [r11673] * Text was accepted as the number zero by the testsuite
	  matches. Now, non-numeric content will be rejected as a failure.
	  * Fixing the situation that prompted this: a wrong line number
	  resulted in the header rather than the first line of a file being
	  read.

2014-01-29 23:23  dstrubbe

	* [r11674] Some changes to PCM to align with our coding style,
	  including Doxygen-style comments. And some FIXME's. Especially
	  regarding the source of the code included here.

2014-01-30 03:51  dstrubbe

	* [r11675] Importing spglib-1.5.2 in preparation for updating. The
	  current version is 0.5.1 I think, from 5 years ago. I proceeded
	  as follows:
	  
	  wget
	  http://sourceforge.net/projects/spglib/files/spglib/spglib-1.5/spglib-1.5.2.tar.gz
	  tar xvzf spglib-1.5.2.tar.gz
	  cd external_libs
	  mkdir spglib-1.5.2
	  cp -r ../spglib-1.5.2/src spglib-1.5.2
	  cp ../spglib-1.5.2/COPYING spglib-1.5.2
	  cp ../spglib-1.5.2/ChangeLog spglib-1.5.2
	  cp ../spglib-1.5.2/example/spglib_f08.f90 spglib-1.5.2/src/
	  svn add spglib-1.5.2

2014-01-30 04:02  xavier

	* [r11676] Made a copy of the qmr dopt linear solver for blocks of
	  states. Still
	  needs a lot of works, but it appears to be working properly.

2014-01-30 05:15  dstrubbe

	* [r11677] Upgrading spglib to 1.5.2.
	  * Removing old directory.
	  * Updating paths.
	  * common-rules.make has to have spglib-1.5.2 in the path for
	  include since we have a Fortran module there now.
	  * Enclosing #include <omp.h> with preprocessor directives, so we
	  can compile without OpenMP too.
	  * Makefile.in not needed.
	  * Adding Makefile.am.
	  * src/Makefile.am need not refer to libtool stuff, and doesn't
	  need to install the headers for spglib.
	  * Using Fortran interface provided with spglib instead of one
	  made in Octopus.
	  * The routine to show symmetry no longer exists, so I write the
	  info by hand.
	  * Some routine names are slightly different.
	  * spglib_get_max_multiplicity no longer exists, so I use
	  spg_get_multiplicity.

2014-01-30 05:32  dstrubbe

	* [r11678] * Setting svn:ignore properties for spglib-1.5.2.
	  * Removing old Fortran interface file.

2014-01-30 09:46  adelgado

	* [r11679] intent attribute added to 'eps' variable in procedure
	  'pcm_matrix'

2014-01-30 11:01  xavier

	* [r11680] Started cleaning the qmr batch version.

2014-01-30 11:15  xavier

	* [r11681] More cleaning and replacing function argument calls with
	  direct calls.
	  As a side effect, I am implementing Sternheimer for spinors.

2014-01-30 11:39  xavier

	* [r11682] Finished removing the use of argument functions from the
	  batch qmr
	  implementation.

2014-01-30 11:57  xavier

	* [r11683] Some cleaning and using named constants for error
	  handling in the batch qmr.

2014-01-30 14:32  xavier

	* [r11684] Bugfix: Restoring a line of code that I inadvertently
	  removed in
	  [11676].

2014-01-30 14:49  joseba

	* [r11685] Deleted unused variable
	  Format compliant with the profiler sintax (huge matrices migh be
	  ignored)
	  More formating

2014-01-30 19:10  xavier

	* [r11686] Removed the uses of F08 'import' to try to make PGI
	  happy.

2014-01-30 19:53  xavier

	* [r11687] Using (/ /) instead of [ ] for array literals. This
	  should fix
	  compilation with PGI.

2014-01-30 20:11  xavier

	* [r11688] Replaced some loops for blas level 1 calls.

2014-01-30 20:17  xavier

	* [r11689] For some reason 100.0 was written as 10.0 squared.

2014-01-30 20:32  xavier

	* [r11690] Still trying to get the PGI "compiler" to build the
	  spglib interface.
	  I have no idea why it is giving an error.

2014-01-30 21:44  dstrubbe

	* [r11691] The troublesome parts of the spglib Fortran interface
	  for the PGI 7 compiler are not being used by Octopus anyway, so I
	  am just commenting them out rather than trying to figure out how
	  to make them work.

2014-01-30 22:33  dstrubbe

	* [r11692] Two changes for things to compile with spglib-1.5.2 on
	  some compilers: pathf90 makes a distinction between character
	  arrays and strings; commenting unneeded 'contains'.

2014-01-30 22:40  dstrubbe

	* [r11693] PCM should be marked experimental.

2014-01-31 08:18  marques

	* [r11694] Bug fix: variable was not given a value. It sj=hould be
	  zero, so I guess that most compilers were actually giving the
	  right number... Thanks David ;)

2014-01-31 10:48  micael

	* [r11695] * Setting the svn:keywords 'Id' property to all the
	  files of the testsuite.

2014-01-31 13:13  micael

	* [r11696] * Bug fix: the kick_spin_and_density perturbation was
	  not applied correctly.
	  * Added a test for the kick_spin_and_density perturbation.

2014-01-31 16:20  joseba

	* [r11698] LCAO alternative is only calculated by the root process
	  and then broadcasted. The size of the input matrices (NxN) is
	  saved in the rest of the processes, being N the number of
	  orbitals.
	  Now it broadcasted the proper eigenvector and eigenvalues.
	  Before, it was broadcasted the hamiltonian matrix, which wasn't
	  used anymore.

2014-01-31 16:21  joseba

	* [r11699] Corrected the indentation

2014-01-31 16:37  dstrubbe

	* [r11700] * Final fix to the compilation trouble with spglib's
	  Fortran interface: we are going back to style of interface we had
	  for the older spglib, without the Fortran 2003 features that were
	  not usable by some of the older compilers. Only the functions we
	  use currently are included in the interface, the array arguments
	  are declared as scalars, the c_int/c_char/c_double types are not
	  used, the strings are character(len=*) again, and the convention
	  that the function names start with 'spglib' is restored.
	  * String conversion between C and Fortran is handled through our
	  macros as in src/basic/oct_f.c.
	  * A check for space group being returned as zero (which is an
	  error code) is added.
	  * Refactored out a subsubroutine to disable symmetries and
	  initialize to the identity only.

2014-01-31 17:17  joseba

	* [r11701] Deallocated matrices as soon as possible. Thus,
	  considerable amount of memory is saved in not root processes
	  Indentation

2014-01-31 18:00  dstrubbe

	* [r11702] * Removing ^M characters at the end of lines in
	  spglib_f08.f90.
	  * Fixing POP_SUB.

2014-01-31 18:50  adelgado

	* [r11703] unconfortable procedure for generating the solute cavity
	  has been removed from 'pcm.F90'

2014-01-31 20:50  dstrubbe

	* [r11704] Adding a missing interface for scalapack routine
	  'infog2l' (used for LCAO), and adding intent's to two other
	  interfaces.

2014-02-01 00:11  dstrubbe

	* [r11705] * Removed local mpi_err variables.
	  * Moved mpi_err from global_m to mpi_m, since it is useful in
	  some places (such as datasets) where global_m is not used,
	  whereas any place with MPI calls should have access to mpi_m.

2014-02-01 03:38  xavier

	* [r11706] Added a batch version of linear_solver_operator.

2014-02-01 04:13  xavier

	* [r11707] * Added a constant factor version of batch_xpay.
	  * Converted some operations to batch mode in the linear solver.

2014-02-01 04:35  xavier

	* [r11708] More operations converted to batch mode.

2014-02-01 05:20  xavier

	* [r11709] I forgot to remove an ALLOCATE line that I had
	  commented. This can
	  cause problems with some compilers.

2014-02-01 16:51  dstrubbe

	* [r11710] After the upgrade to spglib-1.5.2, using gcc 4.4.5 as on
	  lascar gives
	  peculiar results for the symmetries of the 04-silicon test: many
	  of
	  the operations have a fractional translation equal to a lattice
	  vector, or one of the supercell translations, even though those
	  are
	  equivalent to no translation. Since those are removed by our
	  symmetry
	  routine, the number of symmetries is too small. However, I found
	  that
	  slightly changing the lattice constant fixes this, so that is
	  what I
	  am doing for the time being. I am reporting the issue to the
	  developer
	  of spglib.

2014-02-01 20:00  adelgado

	* [r11711] The module 'pcm.F90' has been modified to read the
	  cavity surface used in PCM calculations from an external file
	  previously generated. Useless lines have been removed for
	  consistency. Obviously, we should incorporate our own algorithm
	  to generate this cavity, however, at the present stage is enough
	  to read it from a file. The string variable 'CavityGeometry' has
	  been added.

2014-02-01 20:25  dstrubbe

	* [r11712] Another symmetry test.

2014-02-01 20:31  dstrubbe

	* [r11713] I don't see any reason to give a fatal error for QMR
	  breakdown. The result is simply that it isn't converged. For
	  example, it may still pass the test matches for
	  periodic_system/04-silicon when breakdown occurs.
	  
	  Nonetheless, I think the recent batch-ification of the linear
	  solver may have a problem because we never got QMR breakdown
	  errors before in the tests.

2014-02-01 20:34  dstrubbe

	* [r11714] Setting svn:ignore properties for pcm directory.

2014-02-01 20:59  dstrubbe

	* [r11715] * spglib seems to give better results if the lattice
	  vectors are supplied relative to the longest periodic component.
	  The coordinates are fractional anyway, so the overall scale
	  doesn't matter in principle. With this change, my earlier hack to
	  the lattice constant of the silicon test can be reversed.
	  * Remove integer part of 'fractional' translations that spglib
	  might provide. This would happen for the boron nitride test
	  currently, at least with gcc.
	  * Tests about fractional translations should use the existing
	  function with given precision.

2014-02-02 13:42  xavier

	* [r11716] Bugfix: reverted changes that were causing the breakdown
	  of the qmr
	  solver.

2014-02-02 14:38  xavier

	* [r11717] Fixed the problem with the calculation of the norm by
	  batches.

2014-02-02 17:10  dstrubbe

	* [r11718] * The loops for states_generate_random should run over
	  all states, not just the local ones, which ensures that the same
	  random numbers will be used regardless of states-parallelization.
	  * Removing the 'seed' variable which has no effect if set to 0.
	  There was no seed set for spinors anyway.
	  * Harmonizing the spinor case with the others by initializing
	  eigenvalues to M_ZERO instead of M_HUGE for consistency.

2014-02-02 17:41  dstrubbe

	* [r11719] A testsuite input file was missing from the Makefile.

2014-02-02 17:52  dstrubbe

	* [r11720] Errors should be followed by MPI_Abort, not
	  MPI_Finalize.

2014-02-02 17:53  xavier

	* [r11721] Improved the handling of termination conditions in the
	  linear solver.

2014-02-02 20:19  dstrubbe

	* [r11722] An array was allocated larger than necessary.

2014-02-02 21:10  xavier

	* [r11723] More changes in error handling, to allow simultaneous
	  iteration for
	  different states.

2014-02-02 22:02  xavier

	* [r11724] * More operations done by batchs.
	  * Removed some optional functionality.

2014-02-02 23:09  xavier

	* [r11725] Converted scalar values to arrays, required for
	  operations in batchs.

2014-02-02 23:23  dstrubbe

	* [r11726] Avoiding an array temporary.

2014-02-03 00:42  xavier

	* [r11727] Converted arrays to batch objects.

2014-02-03 02:23  dstrubbe

	* [r11728] The LCAO for this test had been disabled since there
	  were not enough orbitals, but now we can do LCAO with those that
	  are available and randomize the rest, so I am enabling LCAO. This
	  greatly speeds up the Sternheimer run, due presumably to better
	  convergence in the gs run.

2014-02-03 02:42  xavier

	* [r11729] Iterations for several states are now done together in
	  the linear
	  solver.

2014-02-03 03:32  dstrubbe

	* [r11730] * The 'minimal projector' for Sternheimer was projecting
	  out just the state itself from the response. This is not
	  sufficient to avoid divergence: the whole degenerate subspace
	  must be projected out (those components are undefined anyway).
	  This issue is at least partly responsible for the large numbers
	  of warnings about lack of convergence in
	  testsuite/periodic_systems/04-silicon.test, and now the warnings
	  are somewhat reduced, as well as the norm of the response for
	  some degenerate states. Unfortunately, this treatment does not
	  work currently for the unoccupied state since we do not have the
	  whole degenerate subspace there.
	  * The minimal projector is handled by X(lr_orth_vector) too now.

2014-02-03 03:59  dstrubbe

	* [r11731] Making a script executable.

2014-02-03 04:19  dstrubbe

	* [r11732] Bugfix to r11715: the check for the identity translation
	  was using an
	  uninitialized variable.

2014-02-03 04:31  xavier

	* [r11733] Converted some operations in the linear solver into
	  batch mode.

2014-02-03 04:54  dstrubbe

	* [r11734] Turning off the preconditioner in the silicon kdotp test
	  helps hugely with convergence. Not sure why I didn't do this a
	  long time ago...

2014-02-03 18:42  dstrubbe

	* [r11735] Removing commented OCTTargetTransformStates blocks which
	  don't seem usable and confused a user.

2014-02-03 22:37  dstrubbe

	* [r11736] Removing some useless lines in configure.ac.

2014-02-03 23:39  dstrubbe

	* [r11737] Missing files in testsuite Makefile.am.

2014-02-04 00:04  dstrubbe

	* [r11738] states_generate_random will no longer set eigenvalues to
	  zero. It is simpler to do this as needed outside, i.e. in the
	  restart routine when wavefunctions are not found. When we are
	  starting from random wavefunctions instead of (or with) LCAO, the
	  eigenvalues do not need to be set to zero because they are
	  initialized later to expectation values of the Hamiltonian.

2014-02-04 03:56  dstrubbe

	* [r11739] Bugfix to r11572: lowest_missing must only be set if
	  present.

2014-02-04 14:57  joseba

	* [r11740] Corrected a bug created in the commit r11701 ; non root
	  processes have to skip the creation of the hamiltonian. This is
	  only the input matrix for the LAPACK call and they have enough
	  with the result

2014-02-04 17:26  dstrubbe

	* [r11741] Recentering the value of a match for the BN test so all
	  can pass.

2014-02-04 18:22  dstrubbe

	* [r11742] buildbot_query script now reports summary statistics for
	  convenience in updating test files.

2014-02-04 20:58  dstrubbe

	* [r11743] In r11741, I accidentally set the reference value to the
	  average rather than center value which would not necessarily make
	  the match pass.

2014-02-04 21:09  dstrubbe

	* [r11744] * buildbot_query.pl can now take an optional list of
	  local output files on the command line to include in the
	  analysis, to make sure tests are passed on some other machine(s)
	  as well as the buildslaves.
	  * The source of the minimum and maximum values are reported too.
	  * Defence against divide by zero when no matches found.

2014-02-05 00:45  dstrubbe

	* [r11745] The libxc fortran interface did not provide the constant
	  XC_FAMILY_HYB_MGGA.

2014-02-05 00:52  dstrubbe

	* [r11746] Adding XC_FAMILY_HYB_MGGA in some conditions as is
	  necessary for hybrid meta-GGAs to be usable. Not sure if this is
	  sufficient though!

2014-02-05 03:22  dstrubbe

	* [r11747] Caveat for exchange in fully periodic systems:
	  currently, we set the G=0 terms in the exchange potential to
	  zero, but this is only appropriate when there is a zero boundary
	  condition in some direction. The eigenvalues have an overall
	  offset from the correct result, affecting the total energy. The
	  proper solution is Monte Carlo integration of 1/G^2 around G=0.

2014-02-05 04:31  dstrubbe

	* [r11748] Bugfix to r11572: lowest_missing in restart was set only
	  if there was error reading a file, not if it was simply not
	  present.

2014-02-05 04:50  dstrubbe

	* [r11749] Catching problems if you accidentally set the number of
	  states to zero.

2014-02-05 16:39  micael

	* [r11750] * Fixed problem with NLCC and large boxes: the core
	  density is set to zero when evaluating the spline outside the
	  interpolation range.
	  * Removed the mf_put_radial_spline routine as it was not used
	  anymore and because it could be dangerous. Indeed, one should
	  always check if the spline evaluation is done inside or outside
	  the interpolation range, and take some appropriate action if it
	  is outside.

2014-02-06 13:59  jjornet

	* [r11751] Added new features in local_multipoles utility: plot
	  dipole moment in BILD format, compute expected charge of the ions
	  inside box.
	  Added BILD format to plot dipoles for chimera software:
	  <tt>http://plato.cgl.ucsf.edu/chimera/docs/UsersGuide/bild.html
	  </tt>
	  Added the skeleton of a new routine that will check if a point is
	  inside a Bader Volume.

2014-02-06 16:35  joseba

	* [r11752] Corrected the size of the partition matrix. When
	  combined (states+domains) parallelization is used the size of the
	  cube has to be equal to the number of MPI processes of the entire
	  cube, not of the size of the domains
	  Updated a reference
	  Move comments to Doxygen and small styling

2014-02-06 17:51  dstrubbe

	* [r11753] Restoring compatibility with libxc 2.0.2, broken in
	  r11746 by adding use of XC_FAMILY_HYB_MGGA. Now, we check in
	  configure for whether this symbol is available, and if it is not,
	  we define it ourselves. Of course, such a family will never be
	  returned from libxc 2.0.2, but this way is simpler than hiding
	  all possible uses of the constant in preprocessor directives.
	  
	  Fun fact: previously if you asked for a hybrid meta-GGA, you
	  would instead get KS inversion! The family for KS inversion was
	  using the value 64 which is supposed to be for hybrid meta-GGAs.
	  Now I assigned much larger numbers to the families we define
	  ourselves to avoid such a collision.

2014-02-06 22:19  dstrubbe

	* [r11754] LCAO now handles the message about states to be
	  replaced, and writes it for random wavefunctions too.

2014-02-06 22:30  dstrubbe

	* [r11755] Better error-handling for descinit.

2014-02-06 22:37  dstrubbe

	* [r11756] Removing cause of warning about unterminated apostrophe.

2014-02-06 23:03  dstrubbe

	* [r11757] * Bugfix to r11572: if an unocc calculation was done
	  with FromScratch = yes, ExtraStates unset (or 0), and all the
	  occupied states were present, the highest state would be replaced
	  by LCAO or a random wavefunction, rather than being used as is.
	  * Removing unnecessary assertion in LCAO which required st_start
	  to be set as above. Right below the assertion is the code to do
	  the right thing in this case: just return as no LCAO needs to be
	  done. (This was added in r8269; I am not quite sure why it was
	  considered necessary then, but the code has changed a lot since
	  then anyway.)

2014-02-10 03:30  dstrubbe

	* [r11758] Orthogonalizing the random wavefunctions on top of LCAO
	  is definitely helpful for convergence, whether for alternative or
	  standard LCAO, so I am enabling this always. The results for the
	  unconverged test that uses this functionality are now slightly
	  altered.

2014-02-10 19:19  dstrubbe

	* [r11759] Bugfix: for a spin-polarized system, the output of
	  states_write_eigenvalues always showed the error from the first
	  spin for both spins. (The change to the spinor case is purely to
	  look consistent, but actually behaves the same since is == 0.)
	  This bug goes back pretty close to the beginning of time: it was
	  introduced in r393 as part of a bigger bug, and only partially
	  corrected in r434.

2014-02-10 19:35  dstrubbe

	* [r11760] Fix to states_write_eigenvalues: an unnecessary
	  distinction between the periodic and non-periodic case was being
	  made. This was a relic of a time when a periodic calculation
	  (only in the spinor case!) had eigenvalues written relative to
	  the Fermi energy, added r456 and removed r5737. The distinction
	  is now removed, simplifying the code, fixing the very bad
	  formatting in the periodic spinor case, and making the
	  complex-scaling case applies to periodic systems too (since it
	  was unwisely inserted in only one branch).

2014-02-10 22:21  dstrubbe

	* [r11761] * Simplifying states_write_eigenvalues writing of header
	  by adding 'Error' at the end if needed rather than having all the
	  cases duplicated. There is now one fewer space in the non-spinor
	  case before 'Error'; I think this is a price worth paying for
	  simplicity!
	  * Shortened the formats for k-points and errors to reduce leading
	  spaces in their surrounding parentheses, since we know k-points
	  are in (-1, 1) and the error is positive and in scientific
	  notation has only one digit before the decimal place.

2014-02-10 23:34  dstrubbe

	* [r11762] Updating test matches about k-point coordinates in light
	  of format change in r11761, using a command that is less
	  sensitive to the number of spaces.

2014-02-10 23:42  dstrubbe

	* [r11763] Removing unnecessary 'LCAOStart = lcao_none' or 'no' in
	  testsuite runs that could not do LCAO anyway since they do not
	  have pseudopotentials.

2014-02-11 00:04  dstrubbe

	* [r11764] No one has any business calling states_write_eigenvalues
	  with nst > st%nst. There was code to set the occupations to zero
	  in this case. I have replaced it with an assertion to block that
	  case, since st%eigenval will be accessed out of bounds if nst >
	  st%nst.

2014-02-11 00:14  dstrubbe

	* [r11765] Changing name of mysterious variable 'xx' to something
	  more meaningful when it is for a k-weight, especially since 'xx'
	  is used systematically for something entirely different elsewhere
	  in this routine and file.

2014-02-11 02:05  dstrubbe

	* [r11766] Important fix/improvement to unocc mode with LCAO: the
	  wavefunctions should be orthogonalized, which seems to solve the
	  problem of the very first state becoming unconvergeable in unocc.
	  In general, the occupied orbitals calculated in gs, and the LCAO
	  orbitals being added to them, will not be orthogonal, and our
	  eigensolvers and subspace diagonalization seem unable to handle
	  this situation. We were only orthogonalizing when random
	  wavefunctions were involved, but now we will also orthogonalize
	  when adding LCAO to gs states, i.e. whenever we are combining
	  different sets of states. This changes results very slightly from
	  one test.

2014-02-11 02:26  dstrubbe

	* [r11767] A small bugfix: for dimensionality less than 3, the full
	  vector of local magnetic moment was not written out.

2014-02-11 04:25  dstrubbe

	* [r11768] * Moving initializations to more appropriate place, and
	  removing intermediate value.
	  * Removing sum(kweights(:)) which is required to be 1, and
	  removing intermediate assignment to sumq (especially since this
	  is a different meaning than sumq has later).
	  * Removing unused optional argument to smear_fill_occupations.

2014-02-11 05:38  dstrubbe

	* [r11769] Oops, fix to previous commit: sum(kweights) is needed,
	  it can be equal to 1 or 2.

2014-02-11 15:55  joseba

	* [r11770] index is an intrinsic word of Fortran
	  Allocation starting from 1

2014-02-11 16:44  dstrubbe

	* [r11771] Removing extra columns for HGH species definitions in
	  testsuite. The ones in 03-magnetic serve only to produce a
	  pointless warning about the spacing being inconsistent with the
	  recommendation (i.e. the 5th column set here).

2014-02-11 17:03  joseba

	* [r11772] Excluded *_inc.F90 file from the parser of Doxygen
	  because are included from the preprocessor and because,
	  otherwise, the execution of Doxygen crashes

2014-02-11 21:12  dstrubbe

	* [r11773] RDMFT does not need its own version of el_per_state.

2014-02-11 22:15  dstrubbe

	* [r11774] el_per_state should be an integer, since it only takes
	  on the values 1 or 2. Otherwise, we are passing up opportunities
	  to use more accurate integer arithmetic.

2014-02-11 22:25  dstrubbe

	* [r11775] If st_start is present but equal to 1, i.e. we are
	  replacing all states with LCAO in unocc, then there is no need to
	  orthogonalize, as the diagonalization will already be producing
	  orthogonal states.

2014-02-12 00:07  dstrubbe

	* [r11776] Removing unused and uninitialized component
	  st%d%nik_axis.

2014-02-12 01:00  dstrubbe

	* [r11777] The smear and st%d objects now know the number of
	  k-points in the full zone, which can be used to treat k-weights
	  as integers.

2014-02-12 01:01  dstrubbe

	* [r11778] Forgot this file in last commit.

2014-02-12 04:16  dstrubbe

	* [r11779] Caveat about 'semiconducting' smearing and Sternheimer:
	  we have such a general view of semiconducting smearing that it
	  can include a metallic system, in which case it will give the
	  wrong answer.

2014-02-12 14:21  joseba

	* [r11780] Added the header to pcm.F90 and also added the SVN Id
	  Ignored the temporal file of Doxygen

2014-02-12 15:15  joseba

	* [r11781] Properly commited the previous one

2014-02-12 15:41  dstrubbe

	* [r11782] Updating paths that no longer existed, in Doxyfile.

2014-02-12 16:27  joseba

	* [r11783] Deleted useless "../" from the memory profiling output

2014-02-12 16:31  dstrubbe

	* [r11784] * smear now knows the number of spins, and uses this to
	  compute the maximum capacity for electrons in the states, rather
	  than summing the k-weights. This allows that maximum capacity to
	  be an integer.
	  * Using 'tol' variable in place of its numeric value in a couple
	  of places.

2014-02-12 20:40  dstrubbe

	* [r11785] * Bugfix to r9383, restoring ability to run with
	  SCFinLCAO. In that commit, lcao_init_orbitals was refactored out
	  of lcao_wf, requiring an extra call to that routine as added in
	  r9787. However, since the states are used to store the orbitals,
	  and are then overwritten by the states from diagonalization, we
	  must repeat lcao_init_orbitals for every iteration. Moreover,
	  since some arrays are allocated in lcao_init_orbitals, and only
	  deallocated in lcao_end (which also deallocates other things), we
	  must completely initialize and destroy the LCAO object for each
	  iteration. Obviously this is quite inefficient and can be
	  improved, but at least it works again.
	  * Adding a test to ensure SCFinLCAO continues to work.

2014-02-12 20:47  micael

	* [r11786] The matrix containing the LCAO eigenvectors is not
	  gathered in all nodes anymore when running in parallel. Instead,
	  a loop over batches of states is done, and only the eigenvectors
	  needed by the current batch are gathered. This allows to save a
	  considerable amount of memory when running calculations with a
	  very large number of states.
	  
	  Note that the case where ScaLAPACK is used is still treated the
	  old way.

2014-02-12 20:50  dstrubbe

	* [r11787] For SCFinLCAO, the errors for each state are unknown (or
	  zero, depending on your perspective). As a result, ConvEigenError
	  is not meaningful, and warnings about state convergence should
	  not be written.

2014-02-13 01:54  dstrubbe

	* [r11788] * Semiconducting smearing now uses integer arithmetic
	  for occupations, which avoids problems of precision when adding
	  occupations of many states and many k-points, and sometimes
	  resulted in ef_occ exceeding 1.
	  * The weights, for this purpose, are handled as fractions.
	  Therefore, the weights are now required to be rational numbers so
	  that a denominator can be found. It is hard to imagine when you
	  would want irrational numbers as weights, so I don't think this
	  should pose a problem.
	  * Added some assertions for semiconducting smearing.

2014-02-13 04:28  dstrubbe

	* [r11789] Adding test for SCFinLCAO with LCAOAlternative.

2014-02-13 04:30  dstrubbe

	* [r11790] Moving allocations and deallocations so LCAO does not
	  have to be completed initialized and ended for each iteration
	  with SCFinLCAO.

2014-02-13 11:37  micael

	* [r11791] * Added some MPI_Debug calls in vec_init.
	  * A call to MPI_Alltoall was made using the same array as
	  receiving and sending buffer, so that sometimes mpich would
	  complain about it.

2014-02-13 14:21  micael

	* [r11792] * Improved memory profiling by adding the starting index
	  when allocating several arrays.

2014-02-13 16:16  micael

	* [r11793] * Bug fix: there is no point in having a scheme to save
	  memory if you don't deallocate the arrays you want to get rid
	  of...

2014-02-13 16:33  micael

	* [r11794] * Making sure that we only attempt to deallocate
	  allocated arrays.

2014-02-13 16:35  micael

	* [r11795] * Changing the way the distributed partition checks the
	  process in which the information about a point is stored, such
	  that only integer arithmetic is used. This should make the
	  routine more robust.

2014-02-13 17:37  dstrubbe

	* [r11796] Following on r11792, adding start indices to
	  SAFE_ALLOCATE statements. There must be some way we can make the
	  code not compile if this isn't done. I fixed everything (outside
	  of the frozen directory) that I could find via the query
	  
	  grep -R 'SAFE_ALLOCATE(' src/* | grep -v '(1:' | grep -v '(0:' |
	  grep '))'
	  
	  which does turn up many statements that are ok too of course.
	  Most of the ones I changed are size 1, in which case the
	  profiling would still be ok I think, but it helps for checking
	  automatically to make these statements conform too.

2014-02-13 17:54  dstrubbe

	* [r11797] Renaming 'full_nik' to 'nik_factor', and not basing it
	  on 'nik_axis'. In the case of BerkeleyGW output, we need to set
	  nik_axis in a way that is different from nik_factor, so we need
	  different variables. Also, the concept of a 'full zone' is not
	  necessarily meaningful for an arbitrary set of k-points as for a
	  bandstructure.

2014-02-13 20:38  dstrubbe

	* [r11798] Neither st%d nor the kpoints type now keeps track of the
	  nik_factor for semiconducting smearing k-weights. Rather it is
	  calculated by a routine called from smearing only in the
	  semiconducting case, so its condition of rational weights only
	  applies in that case.

2014-02-13 21:20  dstrubbe

	* [r11799] Forgot to remove these allocations in r11790 when moving
	  them elsewhere.

2014-02-13 21:34  dstrubbe

	* [r11800] Fixes for test
	  finite_systems_3d/14-fullerene_packed.test: parallel in states
	  with ScaLAPACK, the array 'levec' was being accessed out of
	  bounds. Also, in two other places, we can allocate an array
	  smaller or do fewer iterations in a loop. And, fixed a typo.

2014-02-13 21:37  dstrubbe

	* [r11801] Adding assertions to block calculations with some
	  subspace diagonalization and orthogonalization algorithms that do
	  not work with StatesPack. I noticed this because if you run
	  14-fullerene_packed parallel in states, it crashes in
	  orthogonalization, and if you run 10-fullerene with StatesPack it
	  crashes in subspace diagonalization.

2014-02-13 22:00  dstrubbe

	* [r11802] Removing unneeded arguments and routine.

2014-02-14 11:15  joseba

	* [r11803] Finished the execution in a more ordered way, when a
	  arbitrary partition size is used. This allows, for instance, to
	  have the profiling output of the execution

2014-02-14 16:32  dstrubbe

	* [r11804] The Fermi energy is now written from
	  states_write_eigenvalues, which makes it show up in a few more
	  places where it is useful, and now has a unit appended.

2014-02-17 10:19  marques

	* [r11805] Patch from Susi Lehtola that implements
	  XC_HYB_MGGA_XC_REVTPSSH and XC_HYB_MGGA_XC_TPSSH.

2014-02-17 10:52  marques

	* [r11806] Small correction of reference
	  Now mgga_xc_revtpssh_init used revtpss correlation

2014-02-17 13:17  marques

	* [r11807] Solves the bug that Susi Lehtola reported for the
	  c_tpss.

2014-02-17 17:47  dstrubbe

	* [r11809] * Fix to r11557: ifmax was the same for all k-points and
	  spins for semiconducting smearing, but in fact the occupations
	  are not necessarily the same over k-points and spins. The problem
	  in ifmax for semiconductors before was the the Fermi energy is
	  set to the top of the valence band, so comparing directly against
	  that may or may not include those bands. But if we use a
	  tolerance it works.
	  * Commenting out non-implemented option about real BerkeleyGW
	  output.

2014-02-18 00:05  dstrubbe

	* [r11810] Bugfix: the units for Output = current were wrong. This
	  is the second (and hopefully last) bugfix to those units, after
	  r10168...

2014-02-18 12:15  marques

	* [r11811] Added functional gga_x_q2d

2014-02-18 13:13  micael

	* [r11812] * Tagging Libxc version 2.0.3.

2014-02-19 10:13  marques

	* [r11813] Fixed a couple of unitialized variables found by Jussi
	  Lehtola

2014-02-19 16:14  marques

	* [r11814] Added the correlation part of the gga q2d. I have some
	  doubts about this as there is at least one clear mistake in the
	  paper
	  started adding terms for kxc in the ggas. Still most of the terms
	  are missing.

2014-02-24 15:13  micael

	* [r11816] Patch from Susi Lehtola to use correct version of
	  several functions when SINGLE_PRECISION is in use.

2014-02-24 15:15  micael

	* [r11817] Another patch from Susi Lehtola: mgga_x_2d_prhg07.c uses
	  long double arithmetic, so one should use long double functions.

2014-02-25 20:18  dstrubbe

	* [r11818] * Fixing small memory leaks in io_binary.c, flagged in
	  part by cppcheck.
	  * Typo.
	  * Useless initialization of 'fd'.

2014-02-25 20:24  dstrubbe

	* [r11819] Useless declarations and initializations.

2014-02-25 20:42  dstrubbe

	* [r11820] Minor memory leaks.

2014-02-25 21:03  dstrubbe

	* [r11821] Fixing more small memory leaks.

2014-02-25 21:18  dstrubbe

	* [r11822] Error code from GSL function was being ignored.

2014-02-26 15:18  joseba

	* [r11823] Corrected the variable documentation

2014-02-26 16:15  lehtola

	* [r11824] Fix SMP build.

2014-02-26 16:19  lehtola

	* [r11825] Added xc-info tool.

2014-02-26 16:21  lehtola

	* [r11826] Add support for hybrid mgga functionals in xc-get_data.

2014-02-26 17:28  lehtola

	* [r11827] Rewrite xc-info and libxcf90 dependencies.

2014-02-26 19:13  lehtola

	* [r11828] Multiple precisions of Lambert W function.

2014-02-26 19:47  lehtola

	* [r11829] Reduce scope of some internal functions to fix
	  --enable-single.

2014-02-26 20:19  lehtola

	* [r11830] More fixes to --enable-single.

2014-02-26 20:26  lehtola

	* [r11831] Last fixes to --enable-single.

2014-02-26 20:36  lehtola

	* [r11832] If single precision enabled, double precision modules
	  still need to be installed.

2014-02-26 20:48  dstrubbe

	* [r11833] * Mention the number of iterations to be done in initial
	  info from td.
	  * Short-circuit further initializations when all requested
	  iterations have been done, to avoid unnecessary and
	  time-consuming steps.

2014-02-26 20:50  lehtola

	* [r11834] Simplify Makefile by pulling out common declaration per
	  David Strubbe's proposal.

2014-02-27 07:27  lehtola

	* [r11835] Added missing argument to fprintf.

2014-02-27 08:25  lehtola

	* [r11836] Changed some fabs() to ABS().

2014-02-27 08:47  lehtola

	* [r11837] Forgot to modify function declarations for Bessel
	  functions.

2014-02-27 13:35  lehtola

	* [r11838] Remove one unused variable and fix initialization of
	  PBEmol exchange.

2014-02-27 19:51  adelgado

	* [r11839] PCM changes are being propagated to do ground state
	  calculations.

2014-02-28 21:51  dstrubbe

	* [r11840] Monkhorst-Pack grid: Clearer (and corrected) citations
	  in variable reference instead of just a comment.

2014-02-28 22:17  dstrubbe

	* [r11841] Removing long-unused code about root solvers, especially
	  since the variable RootSolver suggests there are many options to
	  choose from, but in fact there are only two (and one only applies
	  for real and the other only for complex, apparently).

2014-02-28 22:23  dstrubbe

	* [r11842] Doxygen comments.

2014-02-28 22:30  dstrubbe

	* [r11843] Removing unnecessary real/complex versions of ODE solver
	  routines.

2014-02-28 23:20  lehtola

	* [r11844] Fix bug in xc_config.h

2014-02-28 23:32  lehtola

	* [r11845] Use double precision if necessary in expint_e1.

2014-03-01 10:44  lehtola

	* [r11846] Add MCY functionals to TODO.

2014-03-01 10:46  lehtola

	* [r11847] Rewritten test routines. Still need updated reference
	  data. Reasonable tolerances should be also determined.

2014-03-01 11:47  lehtola

	* [r11848] Add lda reference files to avoid compile errors.

2014-03-01 13:22  lehtola

	* [r11849] Use similar output precision to numerical precision in
	  xc-regression.

2014-03-01 18:32  dstrubbe

	* [r11850] Unused routines.

2014-03-01 18:38  dstrubbe

	* [r11851] Removing unused routine which results in two unused
	  variables in the reference.

2014-03-01 18:48  dstrubbe

	* [r11852] Classifying Math variables.

2014-03-01 18:59  dstrubbe

	* [r11853] Unnecessarily templated routine.

2014-03-01 19:20  dstrubbe

	* [r11854] Sparskit type keeps track of whether it is real or
	  complex.

2014-03-01 19:29  dstrubbe

	* [r11855] Unnecessarily templated routine.

2014-03-01 21:56  dstrubbe

	* [r11856] Bugfix: the linear-response ELF with complex
	  wavefunctions was wrong because one intermediate variable was
	  declared real instead of complex.

2014-03-01 22:09  dstrubbe

	* [r11857] * Fixing warning about type conversion by writing part
	  that is only for complex without X( ) template.
	  * Removing routine X(lr_calc_2np1) which was never used as far as
	  I can tell, and was not completed. It was added in r5356.
	  * Making type conversion explicit in kdotp calculation to avoid
	  warning.

2014-03-01 22:38  dstrubbe

	* [r11858] Cleaning up and commenting-out some debugging stuff.

2014-03-04 08:52  lehtola

	* [r11859] Macroize call to erfc in gga_x_wpbeh.

2014-03-11 17:07  dstrubbe

	* [r11860] svn:ignore for .a files, not ignored by default for some
	  older svn versions.

2014-03-11 17:19  dstrubbe

	* [r11861] frozen would not compile with ifort 11.1, giving an
	  error that names such as XC_POLARIZED were not defined in the
	  module whose use-list mentioned them. I removed the use-lists
	  involving such things, to just use the module publicly.

2014-03-11 17:40  adelgado

	* [r11862] Most of the suggestions made by David to commit 11839
	  were implemented. More details as follows,
	  
	  1- pcm/pcm.F90: A new type 'pcm_t' that handles all PCM variables
	  has been designed. The subroutines
	  'v_electrons_cav', 'v_nuclei_cav' and 'pcm_pot_rs' were moved to
	  'pcm/pcm.F90'. All PCM variables
	  are initialized by subroutine 'pcm_init'.
	  
	  2- system/system.F90: Call to subroutine "pcm_init' from there
	  was removed. Now it is called from subroutine
	  'hamiltonian_init'. Parsing solvation variables was moved back to
	  subroutine 'pcm_init'.
	  
	  3- hamiltonian/epot.F90: The fields 'ep%v_pcm_n(:)' and
	  'ep%v_pcm_e(:)' were removed from the 'epot_t' type.
	  Subroutines related to PCM calculations are now encapsulated in
	  'pcm/pcm.F90'.
	  
	  4- hamiltonian/hamiltonian.F90: The new field 'pcm' of type
	  'pcm_t' is now accesible through variables of
	  type 'hamiltonian_t'. PCM contributions to the KS hamiltonian
	  were added consistently
	  in subroutine 'hamiltonian_update' in terms of 'hm%pcm%v_e_rs(:)'
	  and "hm%pcm%v_n_rs(:)'.
	  SAFE_DEALLOCATE's of PCM variables was incorporated in subroutine
	  'hamiltonian_end'.
	  
	  5- system/v_ks.F90: The procedure to calculate the Hartree
	  potential at the tesserae representative points
	  was encapsulated in the subroutine 'v_electrons_cav', implemented
	  in 'pcm/pcm.F90'.

2014-03-11 18:17  adelgado

	* [r11863]

2014-03-11 18:29  adelgado

	* [r11864] Defining 'sphere_t' and 'tess_t' to avoid compilation
	  errors with pgi

2014-03-11 19:32  dstrubbe

	* [r11865] svn:ignore properties for new libxc executables.

2014-03-11 19:56  lehtola

	* [r11866] Fix icc warning caused by freeing uninitialized
	  variable.

2014-03-11 21:38  dstrubbe

	* [r11867] * More info about doing nscf with unocc.
	  * Removing warning about unterminated '.

2014-03-12 00:12  dstrubbe

	* [r11868] More regular format for outputting info on states
	  blocks.

2014-03-12 16:43  adelgado

	* [r11869] call to subroutine 'pcm_init' was moved to
	  'hamiltonian_init'. PCM real-space potential due to nuclei is
	  generated inside 'hamiltonian_epot_generate'. This ensures that
	  both, PCM potential due to nuclei and electrons enter properly in
	  'hamiltonian_update'. subroutine 'pcm_end' in pcm/pcm.F90
	  deallocates PCM variables. Comments were changed properly
	  followwing
	  http://www.tddft.org/programs/octopus/wiki/index.php/Developers:Doxygen_documentation.

2014-03-12 18:15  adelgado

	* [r11870] Fix: The total polarization charges are only printed if
	  PCM is enable.

2014-03-12 19:35  dstrubbe

	* [r11871] Commented out incorrect parsing of CalculationMode which
	  is breaking all the tests. Alain, please run the testsuite to be
	  sure this sort of thing doesn't happen. (Also, this variable
	  shouldn't be parsed by pcm_init anyway.)

2014-03-12 19:43  dstrubbe

	* [r11872] * Call to restart_read can now specify a label to be
	  used in identifying what sort of restart info is being read. This
	  is helpful particularly for td runs which load various kinds of
	  info which is not clearly identified. Added label in a few
	  places.
	  * Removing unused variable 'dir'.

2014-03-13 03:16  dstrubbe

	* [r11873] Fix to r11872 which was making a test fail.

2014-03-13 17:11  dstrubbe

	* [r11874] More sensitive test for validity of periodic dipole
	  calculation, which also avoids compiler crash for latest ifort.

2014-03-13 18:27  dstrubbe

	* [r11875] * Making type cast explicit.
	  * Typo.
	  * Unused variable.

2014-03-13 18:43  dstrubbe

	* [r11876] Fix to problem flagged by cppcheck: Common realloc
	  mistake: 'symbuf' nulled but not freed upon failure. Explanation:
	  "If realloc fails, then the original memory allocation exists,
	  but is leaked as it is no longer referred to by [symbuf]. So you
	  need to keep a handle on the original allocation until you have
	  verified that the new allocation is valid."
	  (http://www.mantidproject.org/How_to_fix_CppCheck_Errors)

2014-03-14 02:26  dstrubbe

	* [r11877] When loading restart info, the time it was written is
	  now output. This may help catch cases where the restart info is
	  in fact older than expected (i.e. a recent run wrote no restart
	  info).

2014-03-14 18:49  dstrubbe

	* [r11878] Corrections to 'Usage' messages from utilities:
	  misspellings, lacking end-line characters.

2014-03-14 20:25  dstrubbe

	* [r11879] Removing meaningless code.

2014-03-14 20:41  dstrubbe

	* [r11880] * Adding parentheses to subroutine calls that lack them.
	  * Removing duplicative calls to parse ExperimentalFeatures in
	  some utilities, since this is covered in messages_init already.

2014-03-14 20:43  dstrubbe

	* [r11881] One more call without parentheses.

2014-03-14 21:52  dstrubbe

	* [r11882] * Removed peculiar handling of datasets in
	  oct-photoelectron_spectrum. It makes no sense to me and seems
	  wrong. It was added in r8585 by Umberto.
	  * Doxygen comment.

2014-03-14 21:58  dstrubbe

	* [r11883] PUSH/POP's.

2014-03-15 22:13  dstrubbe

	* [r11884] parser_init is now included in messages_init, since it
	  is required for that routine to work, and is always called right
	  before it; for consistency, parser_end is now included also in
	  messages_end.

2014-03-15 22:30  dstrubbe

	* [r11885] Removing usage of datasets and calculation mode from
	  oct-convert which seems inappropriate.

2014-03-16 18:10  dstrubbe

	* [r11886] Avoiding warning about some states not being converged
	  in a test.

2014-03-17 00:55  dstrubbe

	* [r11887] Adjusting types to reduce warnings from gfortran 4.8,
	  and slightly reduce number of operations in complex version.

2014-03-17 14:22  joseba

	* [r11888] Do not output the malloc.prc ISF profiling file with the
	  new ISF, which can be quite large file. But if you want still
	  have it you just have to define output_level to 1 (light) or 2
	  (full).

2014-03-18 15:58  dstrubbe

	* [r11889] Missing space.

2014-03-18 21:18  dstrubbe

	* [r11894] * not_implemented message for oscillator strength case.
	  * Doxygen comments.

2014-03-20 09:52  lehtola

	* [r11896] Fix single precision preprocessor directives. #if
	  clauses shouldn't be used as the macro is not defined in double
	  precision mode.

2014-03-20 10:10  lehtola

	* [r11898] This should fix the SMP build error.

2014-03-20 10:20  lehtola

	* [r11899] xc-info should first be linked to -lxc and then to -lm.

2014-03-20 16:35  dstrubbe

	* [r11903] Caveat about a test.

2014-03-20 16:44  dstrubbe

	* [r11904] Turning off preconditioner for silicon test. Sometimes
	  not all states could be converged by the eigensolver, but this
	  helps get full convergence.

2014-03-20 20:09  dstrubbe

	* [r11905] Bugfix: if running with NLCC and dimensionality less
	  than max-dim (e.g. the NLCC test in the testsuite, with
	  max-dim=4), a call to periodic_copy_position could make the
	  assignment to center go outside the array bounds.

2014-03-20 20:11  dstrubbe

	* [r11906] TestGroups was not updated when this test file was moved
	  to a different directory.

2014-03-20 20:40  dstrubbe

	* [r11907] Bugfix: if we have the wrong k-points in the restart
	  directory, and 'exact' is set, we should not only write a
	  warning, but also stop.

2014-03-21 09:12  micael

	* [r11908] * Updated Libxc AUTHORS file.

2014-03-21 09:40  micael

	* [r11909] * The contents of the testsuite/inputs directory was
	  missing from the distribution.

2014-03-21 10:31  micael

	* [r11910] * Removed the automatic Libxc Changelog update when
	  creating the tarball.

2014-03-21 11:12  micael

	* [r11911] * Tagging Libxc version 2.1.0.

2014-03-21 11:30  micael

	* [r11913] * Bug fix: libxc soname was not set in trunk nor in the
	  2.2.x branch.

2014-03-21 11:45  micael

	* [r11914] * Tagging Libxc version 2.2.0.

2014-03-21 13:32  micael

	* [r11915] * Some filenames in the testsuite were too long, such
	  that they were not included in the tarball. I just renamed the
	  files, but another possible solution would be to change the
	  default tar format used by automake.

2014-03-21 13:56  micael

	* [r11916] * Forgot to change the filenames in the test file.

2014-03-21 15:36  micael

	* [r11917] Some files were not deleted when doing make clean in
	  spglib.

2014-03-23 09:26  lehtola

	* [r11918] Need module dependency for single precision as well.

2014-03-23 09:29  lehtola

	* [r11919] Initialize variables to zero in worker routines,
	  removing 183 compiler warnings.

2014-03-23 18:55  acastro

	* [r11920] Remved one unnecessary line that was there only for
	  debugging purposes.

2014-03-24 08:42  lehtola

	* [r11921] Revert initialization in gga work routines.

2014-03-24 08:44  lehtola

	* [r11922] LDA initialization was in the wrong place.

2014-03-25 15:31  lehtola

	* [r11923] XC(functional_get_number) now allows also for xc_
	  prefix.

2014-03-27 11:12  lehtola

	* [r11924] Don't need malloc in get_functional_number.

2014-03-27 13:31  joseba

	* [r11925] Regarding to commit r11885 the calculation mode is not
	  needed, but datasets is mandatory to properly run. Reverted it.
	  Doxygen comments for the poisson input and output

2014-03-27 19:39  dstrubbe

	* [r11926] * Implemented calculation of dielectric tensor when
	  k-points are reduced by symmetry.
	  * Added test run using this for silicon.
	  * Added check that symmetrizer was initialized properly.
	  * Added comments on array bounds.

2014-03-27 20:04  dstrubbe

	* [r11927] Fixing this warning:
	  
	  libtool: compile: cc -DHAVE_CONFIG_H -I. -I.. -fast -c
	  functionals.c -o functionals.o
	  PGC-W-0095-Type cast required for this conversion (functionals.c:
	  44)
	  PGC-W-0095-Type cast required for this conversion (functionals.c:
	  46)
	  PGC/x86-64 Linux 13.6-0: compilation completed with warnings

2014-03-27 20:10  lehtola

	* [r11928] Don't need a typecast, just use correct pointer type.

2014-03-27 20:18  dstrubbe

	* [r11929] Formatting, removing line with no effect (writing to
	  message(1) without later call to messages_info etc.), removing
	  debugging line with "print*".

2014-03-27 20:59  dstrubbe

	* [r11930] Fixing some issues pointed out by 'use warnings' in Perl
	  regression script.
	  
	  Unquoted string "stderr" may clash with future reserved word at
	  ../oct-run_regression_test.pl line 250.
	  Unquoted string "stderr" may clash with future reserved word at
	  ../oct-run_regression_test.pl line 466.
	  Unquoted string "stderr" may clash with future reserved word at
	  ../oct-run_regression_test.pl line 467.
	  Unquoted string "stderr" may clash with future reserved word at
	  ../oct-run_regression_test.pl line 468.
	  Parentheses missing around "my" list at
	  ../oct-run_regression_test.pl line 477.
	  Scalar value @_[0] better written as $_[0] at
	  ../oct-run_regression_test.pl line 478.
	  Unquoted string "stderr" may clash with future reserved word at
	  ../oct-run_regression_test.pl line 537.

2014-03-27 21:33  dstrubbe

	* [r11931] symmetrize_tensor now operates in-place, which should
	  also solve the compilation failure for max-dim=4.

2014-03-27 21:53  dstrubbe

	* [r11932] Follow-up fix to r11930: it looked like a set of 5
	  variables were being declared "my" but in fact only the first
	  was; adding the parentheses made them all "my", however that was
	  wrong in the case of $name which was used outside that function.
	  Now the name of each match appears in the testsuite output again.

2014-03-27 22:33  dstrubbe

	* [r11933] * 'use warnings' said various variables obtained from
	  the environment were used uninitialized if they were not set
	  there. Via a little function, we now check if they are set, and
	  if not explicitly make them "".
	  * Grammar fix.

2014-03-28 00:02  acastro

	* [r11934] Added one progress bar.

2014-03-28 01:48  dstrubbe

	* [r11935] Fixing array out of bounds for max-dim=4.

2014-03-28 11:06  joseba

	* [r11936] Moved io_function_convert (io_function.F90) to
	  convert_low (convert.F90) to be able to compute the potential
	  from the density (through the Poisson solver)
	  Added also a progress bar

2014-03-28 15:41  dstrubbe

	* [r11937] Fixing PUSH/POP's.

2014-03-28 15:56  dstrubbe

	* [r11938] * Marking utilities experimental.
	  * Removing large number of unused variables.
	  * Other minor corrections.

2014-03-28 15:59  dstrubbe

	* [r11939] The testsuite Perl script now checks that the correct
	  number of arguments have been supplied to its matching functions.

2014-03-28 16:13  dstrubbe

	* [r11940] Fixing these warnings in the Perl testsuite script:
	  
	  main::find_executables() called too early to check prototype at
	  ../oct-run_regression_test.pl line 187.
	  main::run_match_new() called too early to check prototype at
	  ../oct-run_regression_test.pl line 395.
	  main::print_hline() called too early to check prototype at
	  ../oct-run_regression_test.pl line 397.
	  main::print_hline() called too early to check prototype at
	  ../oct-run_regression_test.pl line 400.
	  Use of uninitialized value $options in split at
	  ../oct-run_regression_test.pl line 446, <TESTSUITE> line 5.

2014-03-28 17:08  dstrubbe

	* [r11941] * Fixing warnings like this:
	  Use of uninitialized value $par[3] in multiplication (*) at
	  ../oct-run_regression_test.pl line 521, <TESTSUITE> line 20.
	  * Removing lines about option -d, which has been "ignored for the
	  moment" since r2423 (8 years ago). Basically this option's
	  functionality is obtained via the environment variables
	  TEMPDIRPATH.

2014-03-28 17:41  dstrubbe

	* [r11942] * Decommissioning option -i to testsuite script, which
	  has not made sense (or actually done what it says) since r1890,
	  when separate input files came into use for the testsuite.
	  * Removing forgotten comment about -d.

2014-03-28 18:24  dstrubbe

	* [r11943] * Fixing warnings like this:
	  Use of uninitialized value $color_start{"blue"} in concatenation
	  (.) or string at ./oct-run_regression_test.pl line 226,
	  <TESTSUITE> line 4.
	  Name "main::opt_l" used only once: possible typo at
	  ../oct-run_regression_test.pl line 412.
	  Name "main::opt_h" used only once: possible typo at
	  ../oct-run_regression_test.pl line 134.
	  * Enabling warnings, since I have gotten rid of all the once I
	  see on my machine.

2014-03-28 20:46  dstrubbe

	* [r11944] Bugfixes to kdotp effective masses:
	  * Attempt to use symmetry failed because an uninitialized value
	  was just assigned to itself. As a result, the tensors were always
	  zero below the diagonal, and the inverses were quite wrong.
	  * An off-diagonal element is now tested.
	  * The temp array for reductions in parallel was allocated to the
	  wrong size.
	  
	  * More explicit call with keyword.
	  * Comment on proper size of argument.
	  * No need to accumulate into eff_mass_inv when it is definitely
	  zero to start with.

2014-03-28 21:45  dstrubbe

	* [r11945] The TestGroups file does not seem to serve much purpose,
	  and is not up-to-date anyway.

2014-03-28 23:16  dstrubbe

	* [r11946] * Born charges can now be computed properly when
	  k-points are reduced by symmetry.
	  * X(forces_born_charges) now calculates the whole tensor at once,
	  which is simpler for the symmetrization.

2014-03-29 19:03  dstrubbe

	* [r11947] Removing writing of 'clean.sh' script in testsuite run.
	  It was added in r1899, but has not been maintained since then and
	  thus its list of things to delete has only a mild resemblance to
	  those created by the code (which indeed one cannot be sure of
	  without parsing the input file). Also it does not seem to
	  accomplish anything that FromScratch = yes wouldn't suffice for.

2014-03-30 00:12  dstrubbe

	* [r11948] * Removing useless things about calc_mode and datasets
	  from test.F90.
	  * Calling datasets_init with 1 rather than some unrelated integer
	  in test and convert.

2014-03-30 03:19  dstrubbe

	* [r11949] Removing unnecessary module usages.

2014-03-30 03:22  dstrubbe

	* [r11950] Restoring calc_mode_init and calc_mode_end to oct-test,
	  mistakenly removed in r11948 which broke the parallel tests.

2014-03-30 17:20  dstrubbe

	* [r11951] Alphabetizing modules.

2014-03-30 17:51  dstrubbe

	* [r11952] Removing the build-stamp file from the testsuite runs,
	  which does not seem particularly useful. It was added in r1140
	  (without comment).

2014-03-30 20:00  dstrubbe

	* [r11956] Check Born charges discrepancy in another test too.

2014-03-30 21:04  dstrubbe

	* [r11958] * The Born charge discrepancy is now written per atom,
	  for better comparability between systems.
	  * Updating this for the Si test. The finite H2O test already had
	  these values, accidentally committed before the change in the
	  code.

2014-03-30 23:23  dstrubbe

	* [r11959] Decommissioning the "mail report" functionality of
	  oct-run_testsuite.sh. It seems to have been a pre-buildbot
	  approach to running the testsuite (c.f. r1142, r1180, r1254), and
	  isn't particularly useful any longer.

2014-03-31 02:40  dstrubbe

	* [r11960] This change allows xc-info to link with the clang
	  compiler.

2014-03-31 02:58  dstrubbe

	* [r11961] More checks on Born charge discrepancies.

2014-03-31 02:59  dstrubbe

	* [r11962] Testing Born charge discrepancies, and finite-difference
	  hyperpolarizabilities.

2014-03-31 16:26  dstrubbe

	* [r11965] * Fixing label for a test match.
	  * Asking for better convergence and updating test values, in the
	  hope that more build slaves will pass on this.

2014-03-31 17:32  lehtola

	* [r11966] Forgot to put in declarations for {,rev}TPSSh
	  set_params.

2014-03-31 21:16  dstrubbe

	* [r11967] The testsuite now does runs for 2nd-order k.p wfns.

2014-03-31 22:02  dstrubbe

	* [r11968] * Updating copyright info.
	  * More sophisticated error-handling when match commands fail.

2014-03-31 22:33  dstrubbe

	* [r11969] Missing file in Makefile.am for testsuite file
	  installation.

2014-03-31 23:00  dstrubbe

	* [r11970] oct-run_testsuite.sh -q ("query") option did nothing due
	  to failure to get the following string.

2014-04-01 09:41  jjornet

	* [r11971] - src/utils/local_multipoles.F90: optional Bader Domains
	  has been included. Subroutine bader_union_inside has been added.
	  "print*" statements has been removed.
	  - src/grid/mesh_function_inc.F90: X(mf_local_multipoles): new
	  optional variable inside2
	  changes done to deal with Bader domains.
	  - src/ions/box.F90 : all parts related with Bader domains have
	  been removed and placed to local_multipoles.F90
	  - src/ions/box_union.F90: new functions box_union_get_nboxes and
	  box_union_get_center have been added.
	  - src/ions/simul_box.F90: BADER parameter has been removed.
	  

2014-04-01 14:08  jjornet

	* [r11972] Minor esthetic changes ( some comments and not used
	  doxygen marks have been removed )

2014-04-01 14:52  joseba

	* [r11973] Made some functions PURE
	  Changed real*8 to FLOAT
	  Small indentations

2014-04-01 16:12  dstrubbe

	* [r11974] Removing use of 'pipefail' in script, which is only
	  available in Bash version 3, and not in Dash which is the default
	  shell on the Ubuntu machines. Better solution pending...

2014-04-01 16:18  dstrubbe

	* [r11975] Missing files in Makefile.

2014-04-01 16:33  dstrubbe

	* [r11976] * Fixing mistaken variable sections and *names*. Getting
	  the latter correct is of huge importance for the variable
	  reference to be usable!
	  * Removing unused variable.
	  * Some FIXME's.
	  * Commenting out fragment of variable definition lest it be
	  incorportated into variable reference.
	  * Typo in warning message.

2014-04-01 18:43  dstrubbe

	* [r11977] * Unused variables.
	  * Proper call for experimental feature.

2014-04-01 20:39  dstrubbe

	* [r11978] More realistic precisions for finite-difference
	  hyperpolarizabilities.

2014-04-01 20:42  dstrubbe

	* [r11979] * Updating shell number for testsuite run, in
	  buildbot_query.pl, in light of using static installation of libxc
	  now.
	  * If a match command failed (i.e. no number was returned), it was
	  treated as a zero, resulting in an incorrect summary. Now, it
	  will be treated as match not found instead.

2014-04-02 13:23  joseba

	* [r11980] Small changes:
	  * Tabs
	  * Deleted unused lines
	  * Change a variable name
	  * Made more robus the iteration of the convert utility over
	  folders

2014-04-02 16:23  jjornet

	* [r11981] * FIXME's have been fixed.
	  * Fragment of variable definition has been uncommented to be able
	  to use Bader variable on the input file.

2014-04-02 19:43  dstrubbe

	* [r11982] Adjusting reference values and tolerance for
	  finite-difference hyperpolarizability values so tests can pass.

2014-04-02 21:07  dstrubbe

	* [r11983] Bugfix: some MPI calls gave incorrect arguments, as
	  detected by the MPI module of OpenMPI 1.7 which apparently
	  includes some more interfaces than earlier versions.

2014-04-02 21:16  dstrubbe

	* [r11984] Removing build-stamp stuff (again) after accidentally
	  restoring it in conflict resolution in r11959.

2014-04-02 21:25  dstrubbe

	* [r11985] Fixing compilation in serial.

2014-04-02 21:50  dstrubbe

	* [r11986] Removing mysterious line 'echo="echo"'. I don't see what
	  effect it would have, and things seem same after I take it away.
	  It was present at the creation of this file in r1142, without
	  comment on this particular line.

2014-04-02 21:55  dstrubbe

	* [r11987] In dry-run mode, do not write the summary of tests
	  passed, failed, and skipped, since of course no tests were run.

2014-04-02 22:10  dstrubbe

	* [r11988] Updating comments after libxc releases.

2014-04-02 22:41  dstrubbe

	* [r11989] Neater way of specifying spacing for periodic test.

2014-04-02 22:53  dstrubbe

	* [r11990] Better error-handling with -f for testsuite Perl script.

2014-04-03 14:23  jjornet

	* [r11991] * Variable references have been removed.
	  * BADER parameter has been set to 512 to avoid conflict.

2014-04-03 18:23  dstrubbe

	* [r11992] * Bugfix: zread_parallel did not deallocate an array.
	  * io_binary_f now uses SAFE_ALLOCATE and SAFE_DEALLOCATE_A,
	  adding 'use profiling_m.'
	  * The strategy used in zread_parallel is now employed in
	  zread_binary also, to enable reading of real files as complex.
	  This enables
	  testsuite/linear_response/02-h2o_pol_lr.03_h2o_dyn_pol_cmplx.inp
	  to use the restart densities from the previous run
	  02-h2o_pol_lr.02_h2o_dyn_pol.inp, which helps convergence and
	  avoids the warning on some machines 'Linear solver failed to
	  converge all states.'

2014-04-03 18:34  dstrubbe

	* [r11993] * Doxygen comment.
	  * Code simplification.

2014-04-03 19:02  dstrubbe

	* [r11994] Simplification of kick_init by using ispin intead of
	  nspin.

2014-04-03 21:29  dstrubbe

	* [r11995] * kick_init now receives periodic dimensions as an
	  argument, for detection of incompatibilities.
	  * TDPolarization* variables should only be read when kick is not
	  user-defined or multipoles, since they are not used with those
	  types.
	  * Added comment and checks that kicks cannot be applied in
	  periodic directions (since they depend explicitly on "r").

2014-04-03 21:45  dstrubbe

	* [r11996] Suppressing compilation warnings from utilities:
	  * Explicit conversion to integer.
	  * Unused variable.
	  * Bugfix: complex*4 was used instead of complex*8.
	  * Using our standard constant for 4.

2014-04-04 21:02  dstrubbe

	* [r11997] * Fixing r11987, which accidentally deactivated the
	  summary for all testsuite runs: I accidentally did not put $ in
	  front of $dry_run, and mistakenly thought it was supposed to be
	  "yes" or "no" like other variables here, but in fact it was
	  supposed to be "yes" or unset. Now, it is "yes" or "no", for
	  consistency.
	  * Dependence on "$verbose" removed, which is not set elsewhere.
	  Not sure if this was a mistake (in original version, r1142), or
	  originally supposed to come from the environment. Doesn't seem
	  particularly useful to me anyway.

2014-04-04 21:08  dstrubbe

	* [r11998] Suppressing compiler warnings by making type conversions
	  explicit.
	  
	  What is the reason to make local_potential a real*4 though? Seems
	  odd. This was introduced by Xavier in r4915.

2014-04-04 21:27  dstrubbe

	* [r11999] * Caveat: The way sum rule is calculated is appropriate
	  only for kick_density, not for kick_spin and
	  kick_spin_and_density. (e.g. it gives zero typically for
	  kick_spin)
	  * Unused variable.

2014-04-04 22:48  dstrubbe

	* [r12000] Obviously I should not have left 'stop' in r11998.

2014-04-05 20:59  dstrubbe

	* [r12001] Recentering and increasing tolerance for beta zxy match
	  so nvidia slave can pass.

2014-04-07 06:54  micael

	* [r12002] Removed all Libxc sources.
	  
	  Note that the new Libxc repository can be found at the following
	  address: http://www.tddft.org/svn/libxc

2014-04-07 10:20  joseba

	* [r12003] * Added the possibility to iterate over different
	  folders
	  * Closed and deallocated arrays, which weren't
	  * Formatting

2014-04-07 16:46  dstrubbe

	* [r12004] * Unused variable in serial.
	  * Comments.

2014-04-07 19:16  dstrubbe

	* [r12005] Consolidating repetitious code for the case omega=0 and
	  otherwise.

2014-04-07 20:31  dstrubbe

	* [r12006] * Simplifying calls to calculate Born charges, between
	  branches for nsigma = 1 and 2.
	  * Removing comment to use 'nsigma' for 2nd order, since this is
	  done now.

2014-04-07 21:50  dstrubbe

	* [r12007] Very minor bugfix: for hyperpolarizability in periodic
	  system, the post_orthogonalize was using ifactor * eta as the
	  imaginary part of the frequencies for the orthogonalization, when
	  in fact it should be eta. But it would only apply with smearing
	  which isn't allowed with kdotp anyway since it implies there is
	  no gap.

2014-04-07 22:13  dstrubbe

	* [r12008] Fixing -m option for testsuite Perl script (do matches
	  in already run working directory): $workdir is set to current
	  directory, some header info and copying and moving files is
	  suppressed, as is writing matches.sh and the log files.
	  $return_value must be set to zero or the matches would be
	  skipped.

2014-04-07 22:56  dstrubbe

	* [r12009] Simplifying em_resp by introducing variables 'frequency'
	  and 'frequency_eta'.

2014-04-08 15:17  joseba

	* [r12010] Corrected r12003 and now properly does iterations.
	  * Checks if the input folder is finished by an '/' and adds it if
	  needed.
	  * Deleted various information output
	  * Made optional a writing of extra files
	  * Deleted unused inp variable
	  * Created at the very beggining the results "local.multipoles"
	  folder
	  * Indentation
	  * Added a progress bar

2014-04-08 15:44  dstrubbe

	* [r12011] * Unused variables (including hiding MPI-only ones).
	  * Explicit type conversions (integer*8 -> integer*4).
	  * Unused argument 'mesh'.

2014-04-08 16:43  dstrubbe

	* [r12012] Decommissioning matches.sh from testsuite Perl script:
	  it is duplicative of the main testsuite functionality, less
	  flexible because it requires use of a bash command for matches
	  that can be used in that script too, and the same can be done via
	  the (recommissioned) -m option to the Perl script.

2014-04-08 18:26  dstrubbe

	* [r12013] Unused variable.

2014-04-08 19:51  dstrubbe

	* [r12014] * Fixing non-standard read statements, which are ok in
	  some compilers but with gfortran give "Fortran runtime error:
	  Constant string in input format".
	  * Correction to documentation for TDKickFunction: weights were
	  not mentioned.
	  * Error-checking for reading and using kick (to avoid segfault
	  for kick%pol_dir == 0).
	  * Fix to output from oct-propagation_spectrum.

2014-04-09 15:35  dstrubbe

	* [r12015] * Caveats about GaugeVectorField for non-periodic
	  systems (I am not sure to what extent this is supposed to work,
	  and at any rate I doubt it has been tested), and when using
	  symmetry (in my test, I am not convinced oct-dielectric_function
	  gave the right answer even when using SymmetryBreakDir).
	  * Doxygen comments.

2014-04-09 22:01  dstrubbe

	* [r12016] Fix to r12015: the warning and symmetry check should
	  only occur if a GaugeVectorField was actually set.

2014-04-09 22:34  dstrubbe

	* [r12017] Reverting part of r11554: "Identify which restart file
	  could not be opened if there is a problem." The output is too
	  verbose, given how unusual it is that the files 'states', 'wfns',
	  or 'occs' would be missing for a reason other than that there is
	  no restart info at all.

2014-04-09 23:03  dstrubbe

	* [r12018] Refactoring em_resp to avoid so many calls with
	  real/complex versions: now three templated internal procedures
	  handle these switches.

2014-04-09 23:07  dstrubbe

	* [r12019] * More fixes to -m mode of Perl testsuite script,
	  following up on r12008:
	  ** The relevant input file needs to be written for the output to
	  make sense.
	  ** The matches need to be run in the archived directories, or
	  else they just operate on the results of the final run.
	  * A matches.sh script is written again (it was removed in
	  r12012), but now it does not attempt to duplicate the match
	  commands, but rather just gives the necessary command to this
	  script to run with -m.

2014-04-09 23:27  dstrubbe

	* [r12020] Re-assigning return codes from the testsuite: 255 will
	  now be for internal error, and 254 will be for tests skipped. The
	  reason is that "die" in Perl uses 255 as a fallback error code
	  (http://perldoc.perl.org/functions/die.html) and thus can cause
	  internal errors to be classifed as a skip by the shell script. To
	  control the error code when there is an internal error, we will
	  now use a little function and exit instead of die. Perl doc
	  (above) recommends: "the value of the exit code used by die can
	  be non-predictable, so should not be relied upon, other than to
	  be non-zero."

2014-04-10 14:18  joseba

	* [r12021] A more robust approach for the MPI_Cart_create as it
	  expects to have a "periodic" array of size "ndims" (or mc%n_index
	  in our case).
	  I am not sure that this fixes the error that David reported, but
	  at least corrects one appearing in my computer.

2014-04-10 15:17  dstrubbe

	* [r12022] Restoring compilation in serial.

2014-04-10 15:21  dstrubbe

	* [r12023] Improvement to documentation.

2014-04-10 15:27  dstrubbe

	* [r12024] Fixing some PUSH/POP's.

2014-04-10 19:05  dstrubbe

	* [r12025] * Bugfix: in kdotp, restart_look_and_read needs to be
	  before allocations involving st%nst, or else there can be an
	  inconsistency and arrays out of bounds if ExtraStates is not the
	  same between the input file and the one used for the gs run.
	  * Improvements to documentation.
	  * Check on validity of em_resp with kdotp with smearing.

2014-04-10 20:53  dstrubbe

	* [r12026] Wiser order for array indices of kdotp_vars%lr, which
	  avoids out-of-order array sections being passed which can cause
	  copying into temporary arrays.

2014-04-10 22:59  dstrubbe

	* [r12027] The kdotp calculation can be much faster if the occupied
	  subspace is projected out, but we need the whole kdotp response
	  wavefunction for 2nd-order calculations. Therefore, the occupied
	  subspace will be explicitly constructed when this option is
	  chosen.

2014-04-11 16:06  adelgado

	* [r12028] Solute-solvent electrostatic interaction term is added
	  to the total energy of the system by using PCM.
	  
	  - pcm/pcm.F90: subroutine 'v_electrons_cav_li' was coded to
	  calculate the Hartree potential at the tesserae representative
	  points by means of a trilinear interpolation. function
	  'pcm_classic_energy' is added to calculate nuclei-solvent
	  interaction energy.
	  
	  - hamiltonian/energy.F90: variables 'int_e_pcm' and 'int_n_pcm'
	  were added to 'energy_t' to strore the electrons-solvent and
	  nuclei-solvent interaction energies, respectively.
	  
	  - system/v_ks.F90: Now the subroutine 'v_electrons_cav_li' is
	  used to evaluate the Hartree pot at the tesserae. The energy term
	  'int_e_pcm' is calculated just after calculated the PCM field in
	  real-space.
	  
	  - system/energy_calc.F90: The term 'int_n_pcm' is computed by
	  using the function 'pcm_classic_energy'. For the case
	  'hm%theory_level=KOHN_SHAM_DFT' the PCM contributions to the
	  total energy have been added. The quantities 'int_e_pcm',
	  'int_n_pcm' are reported in the 'static/info' file.

2014-04-11 19:41  dstrubbe

	* [r12029] * Unused variable.
	  * character variable was too small for output of io_workpath.
	  * Misspelled function name.

2014-04-11 20:25  dstrubbe

	* [r12030] * Fixing problem in having the sum-over-state loops of
	  r12027: I was not taking into account the anti-Hermiticity of the
	  kdotp perturbation.
	  * Removing now-unused argument.

2014-04-12 16:32  dstrubbe

	* [r12031] Fixing error message which referred to long-ago renamed
	  file.

2014-04-13 18:06  dstrubbe

	* [r12032] It is perverse for Perl to call the shell to in turn
	  call Perl on the testsuite matches. The only justification for
	  this seems to have been to enable its use with matches.sh. Now,
	  we will just do it directly in Perl, filtering out the number
	  from the text returned by the match.

2014-04-13 19:23  dstrubbe

	* [r12033] * Marking 'frozen' as experimental.
	  * Commenting out variable blocks in frozen, since the code they
	  are is unreachable as far as I can tell, so having these show up
	  in the variable reference is not helpful.

2014-04-13 19:56  dstrubbe

	* [r12034] * Renaming module, file, contained routines, and
	  enumerated parameters: 'xyz_file' -> 'read_coords'. Because it is
	  not just about XYZ files, but also about PDB files, and the
	  Coordinates block (not a file).
	  * Renaming component 'file_type' to 'source', since it can
	  indicate that the coordinates came from a block and not a file.
	  * Removing unnecessary module usage of xyz_file_m from
	  poisson.F90.

2014-04-13 20:03  dstrubbe

	* [r12035] * Moving the variable reference blocks for
	  Coordinates-related things to where they are actually parsed.
	  * Breaking up long comment line.

2014-04-13 21:02  dstrubbe

	* [r12036] * Coordinates may now be read in XSF format. Currently,
	  the periodicity and lattice vectors are ignored.
	  * Check on validity of number of atoms in XYZ file.

2014-04-13 21:23  adelgado

	* [r12037] * pcm/pcm.F90: 'pcm_classic_energy' renamed as
	  'pcm_classical_energy'.
	  * system/energy_calc.F90: Solute-solvent interaction energy only
	  printed if 'hm%pcm%run_pcm=true'
	  * hamiltonian/hamiltonian.F90: 'Solvation' is parsed now in
	  'hamiltonian_init' and not inside subroutine 'pcm_init'.

2014-04-14 07:41  adelgado

	* [r12038]

2014-04-14 08:55  adelgado

	* [r12039] * fixing compilation errors of 12037. with ifort I did
	  not have any problem since the preprocessor seems to respect
	  fortran commented lines.

2014-04-14 19:20  dstrubbe

	* [r12040] Clarification to variable reference: OutputInterval
	  controls Output not TDOutput.

2014-04-14 23:29  dstrubbe

	* [r12041] The periodicity and lattice vectors read from XSF can
	  now be used, instead of the ones from the input file.

2014-04-15 00:32  askhl

	* [r12042] grammar

2014-04-15 00:52  dstrubbe

	* [r12043] * Bugfix: the ReducedCoordinates block would be
	  incorrectly rescaled if Units(Input) = eV_Angstrom was set.
	  * The lattice vectors from an XSF file are now rescaled according
	  to the input units.
	  * Updating documentation about XSFCoordinates.

2014-04-15 12:04  adelgado

	* [r12044] * changing to 'inout' the intent attribute of pcm in
	  subroutine 'pcm_init'.

2014-04-15 17:03  adelgado

	* [r12045] * pcm/pcm.F90: radii for Na and Cl have been added in
	  'pcm_init'

2014-04-15 18:03  dstrubbe

	* [r12046] An animated XSF file can now be used for coordinates
	  input, specifying which step should be used.

2014-04-15 19:56  dstrubbe

	* [r12047] I am setting the default for SymmetrizeDensity to false
	  always (rather than true when k-points are reduced by symmetry),
	  and marking it experimental. I found critical problems with it
	  earlier, in that it was using an incorrect origin, and still
	  resulting discrepancies can be suspiciously large even at SCF
	  convergence, and the case of partially periodic systems has not
	  been fully considered. I am turning on SymmetrizeDensity
	  explicitly for the tests where it was being used, so the results
	  remain the same.

2014-04-16 08:16  joseba

	* [r12048] Added a test for the oct-convert utility. In principle
	  it works fine, but I had to disable the progress bar (makes it
	  fail only when running in the testsuite).
	  Added checks for the folder and filename

2014-04-16 08:55  adelgado

	* [r12049] * Moving back the parse of 'Solvation' from subroutine
	  'hamiltonian_init' to 'pcm_init'.

2014-04-16 14:15  joseba

	* [r12050] Added possibility to profile the oct-local_multipoles
	  utility

2014-04-16 19:46  dstrubbe

	* [r12051] * Making KdotPOccupiedSolutionMethod work correctly in
	  the presence of ExtraStates.
	  * Caveat about this option with smearing.

2014-04-16 21:24  dstrubbe

	* [r12052] * Disabling oct-convert test since matches are not
	  uniquely defined.
	  * Fixing $Id$.
	  * Removing comment mistakenly copied.
	  * Added request to add gs matches.

2014-04-16 23:32  dstrubbe

	* [r12053] Adding routine to calculate eigenvalues of electric
	  perturbation in periodic system, according to single-point Berry
	  phase.

2014-04-16 23:41  dstrubbe

	* [r12054] Fixing test failures after r12047 which turned off
	  SymmetrizeDensity: the BN test had eigenvalue 10 at k-point 4
	  sometimes be degenerate with #9 and sometimes not. With density
	  symmetrization, the SCF from LCAO seems to have reproducibly
	  failed to find the lowest states at that k-point, whereas without
	  density symmetrization, sometimes it resulted in the correct
	  states and sometimes not. I noticed also another respect in which
	  the result (before and after r12047) was qualitatively incorrect:
	  the gap at Gamma was very small, only 0.3 eV or so (i.e. perhaps
	  the system was metallic), whereas it should be at least several
	  eV. To fix these things, I reduced the spacing slightly, which
	  seems to fix both of them; hopefully all the buildslaves agree.

2014-04-16 23:42  dstrubbe

	* [r12055] Comment in variable reference was backward.

2014-04-17 01:26  dstrubbe

	* [r12056] Using the derivative of the eigenvalues for solving the
	  second-order Sternheimer equation.

2014-04-17 03:15  dstrubbe

	* [r12057] * Fixing bound mismatch in assignment between np and
	  np_part array sizes.
	  * kdotp perturbation has only one sigma.

2014-04-17 16:56  dstrubbe

	* [r12058] Setting svn:keywords on two files that lacked it, and so
	  just had $Id$ without substitution in the header.

2014-04-17 17:13  dstrubbe

	* [r12059] * Using approximate em_resp eigenvalue derivatives in
	  beta calculation too.
	  * Clarifications to documentation for em_resp with kdotp.

2014-04-18 01:40  xavier

	* [r12060] Added an option to enforce the sum of the internal
	  forces to be zero.

2014-04-19 18:15  dstrubbe

	* [r12061] * Necessary (but not sufficient) change to allow use of
	  linear-response ELF: the optional argument of sigma 2 needs to be
	  supplied only when the arrays were allocated to that size.
	  * Formatting.
	  * Doxygen comments.

2014-04-19 21:23  dstrubbe

	* [r12062] Using equality of mixed partial derivatives to reduce
	  computation and memory usage for kdotp and em_resp.

2014-04-20 02:53  dstrubbe

	* [r12063] true_compiler.sh:
	  * Adding understanding of CC (C++) compiler wrapper.
	  * Organizing a bit more.
	  * Returns "unknown" if it cannot figure it out. This is relevant
	  for the compiler wrappers on the newest Crays which do not
	  support "-show" unfortunately.

2014-04-20 04:19  dstrubbe

	* [r12064] * Fix to previous commit: resulted in "(unknown)" rather
	  than blank if not an MPI or Cray compiler wrapper.
	  * Use "printf" rather than "echo -n", since "echo -n" does not
	  work for default shell on BSD (including Mac OS) and man page
	  advises using more portable "printf".

2014-04-21 18:33  dstrubbe

	* [r12065] Reducing memory usage for periodic hyperpolarizability
	  calculation: we don't need all the second-order kdotp
	  wavefunctions in memory, just one at a time.

2014-04-21 21:12  dstrubbe

	* [r12066] * There is no need to solve the 2nd-order Sternheimer
	  equation (for d/dk, d/dE) in the occupied subspace, and then we
	  do not need to post-orthogonalize either.
	  * Clarification to variable reference for EMOccupiedResponse.

2014-04-22 08:16  joseba

	* [r12067] Changes to the test of the convert utility. Following
	  the David suggestions, density is checked

2014-04-22 08:33  joseba

	* [r12068] Added simple check to the GS run of the oct-convert
	  utility.
	  Few comments
	  Added "Id" to test files

2014-04-22 15:33  joseba

	* [r12069] Skip the progress bar if the given length is 0
	  Then, activated the progress bar in the convert utility.
	  Properly managed the filenames if the files are iterating. Still,
	  only 10 character long filenames are valid.
	  A little bit of more documentation
	  Disabled a filename extension check if it is shorter than 4
	  character, as it is impossible to have it.

2014-04-22 22:42  dstrubbe

	* [r12070] * For the <1|1|1> term, post-orthogonalize is not
	  necessary, but for <1|1> it is (i.e. em_vars%lr), so I put it
	  back. The operation on kdotp_em_lr2 could be removed though.
	  * The sternheimer solver routine now can add in the occupied
	  response by sum over states, and this is now used for kdotp
	  (instead of the stand-alone routine I added recently) and em_resp
	  when being provided for the second-order Sternheimer equation.
	  (An option to do it by Sternheimer itself still remains.)
	  NOTE: This commit changes results for periodic beta slightly
	  (e.g. for water test): previously, there could be contamination
	  of degenerate states in the response, but now they are completely
	  removed.
	  * Removed FIXME which was fixed already.

2014-04-23 06:20  dstrubbe

	* [r12071] Undoing r12070 as it pertains to kdotp: it is wrong for
	  KdotPOccupiedSolutionMethod = sum_over_states, for reasons I
	  cannot yet determine.

2014-04-23 15:02  joseba

	* [r12072] Moved down the printing of the "Experimental Feature".
	  Otherwise, g95 complains about "Fortran runtime error: Unattached
	  unit"

2014-04-23 15:05  joseba

	* [r12073] Reverted accidentally changed file

2014-04-23 20:50  alejandro

	* [r12074] FIRE minimizer for geometry optimization. This
	  implementation works without GSL.
	  It is marked as "Experimental", but works fine with all the
	  examples of the tutorial.

2014-04-23 22:11  alejandro

	* [r12075] Fix to previous commit. Use of "lalg_nrm2" rather than
	  "norm2".

2014-04-24 02:58  xavier

	* [r12076] Added default values to the documentation of the GO
	  variables.

2014-04-24 03:01  xavier

	* [r12077] Missing build dependency.

2014-04-24 12:01  xavier

	* [r12078] Small change to make GOCenter = yes to work with the
	  FIRE minimizer.

2014-04-25 13:28  xavier

	* [r12079] Now the geometry optimization creates a log file with
	  the parameters
	  for each iteration. Useful to evaluate and improve the
	  optimizers.

2014-04-28 20:40  dstrubbe

	* [r12080] Recentering Total energy match for BN (after change to
	  SymmetrizeDensity) so that the match passes. It recently failed
	  with a very small discrepancy on hbar.

2014-04-30 14:39  adelgado

	* [r12081] * In 'pcm/pcm.F90' the signs of potential used to
	  calculate the PCM polarization charges have been properly
	  defined. I have also introduced a new variable 'SmearingFactor',
	  which is stored in 'pcm%gaussian_width', to change the width of
	  the Gaussian functions smearing the density of polarization
	  charges in the tesserae representative points. This new variable
	  is passed to the subroutine 'pcm_pot_rs' that generates the PCM
	  fields in real space. The set of actual arguments of the latter
	  subroutine in the calling subprograms in
	  'hamiltonian/hamiltonian.F90' and 'system/v_ks.F90' has been
	  updated.
	  
	  * In 'system/energy_calc.F90' the calculation of
	  'hm%energy%int_n_pcm' was moved, so that this quantity is also
	  computed during time propagation if 'hm%pcm%run_pcm=.true.'.

2014-05-01 11:00  micael

	* [r12082] * It is now possible to set OuputInterval = 0. In that
	  case no output will be written.
	  * Removed the OutputDuringSCF variable, as one can now use
	  OuputInterval to switch the output on/off.

2014-05-01 12:58  acastro

	* [r12083] The optimal control code was calling "conjugate
	  gradients" something that was
	  not cg: the BFGS algorithm implemented in the GSL library. Now
	  one can use
	  both.

2014-05-02 01:38  dstrubbe

	* [r12084] * Typos.
	  * Moving explanations to body rather than default.
	  * Fixing indentation (it should always be two spaces).
	  * Fixing call to messages_obsolete_variable added recently: it
	  was duplicating a call for OutputEvery already present, whereas
	  OutputDuringSCF did not have such a call.

2014-05-02 14:36  askhl

	* [r12085] Add FEAST eigensolver library to optional external
	  dependencies. Add interface to non-Hermitian FEAST eigensolver,
	  which depends on the development version of the FEAST library.
	  Work very much in progress. So far this will only work in serial.
	  Change grid_t parameter to intent(in) in the linear solvers so as
	  to avoid propagating a lot of inout permissions in the
	  eigensolvers. Add input parameters to specify eigenvalue search
	  contours for use with FEAST. Add input parameter to help sorting
	  states with complex scaling. Minor changes to output with complex
	  scaling regarding ordering of states.

2014-05-05 12:20  micael

	* [r12086] As far as I can see, there is no need for the
	  xc_ks_inversion module to use the mix module.

2014-05-06 12:47  micael

	* [r12087] Started to implement the restart of the mixing: added
	  routines to read and write the mixing data.
	  This required some tweaks to the mix_t structure and moving the
	  mix module to the scf directory.

2014-05-06 13:48  micael

	* [r12088] * Bug fixed in FEAST m4.

2014-05-06 15:24  dstrubbe

	* [r12089] Removing irrelevant comments, and usage of $1 and $2, in
	  feast.m4: $1 and $2 mean execute things that were passed as
	  arguments to this routine. Since there are no arguments when it
	  is called from configure.ac, they shouldn't be here.

2014-05-06 18:02  dstrubbe

	* [r12090] * Removing unneeded module usages (if it compiles
	  without it, it isn't necessary).
	  * Fixing unterminated apostrophe cpp warnings.
	  * Note about use of 'print'.

2014-05-07 11:57  jjornet

	* [r12091] * New variable type local_domain_t.
	  * Reodering subroutines to prepare new module for writing local
	  properties.

2014-05-07 15:17  joseba

	* [r12092] Forbid LIBISF Poisson solver with task parallelization
	  and k-points parallelization, which don't work and, also, made
	  changes accordingly.
	  Add documentation.

2014-05-07 17:49  alejandro

	* [r12093] Changed de default value of GOStep variable in the FIRE
	  minimizer.
	  Corrected the values of masses used in the FIRE minimizer.
	  Added a test for the FIRE minimizer.

2014-05-07 18:18  alejandro

	* [r12094] Added the 23-go-na2.03-fire.inp file.

2014-05-08 14:48  micael

	* [r12095] Improving encapsulation:
	  * There is no need to keep a pointer to the whole simul_box
	  structure in index_t if we only need to know if the box shape is
	  an hyprecube.
	  * Similarly, no need to sistematically pass the dimension to the
	  index routines when we can just store it in index_t.

2014-05-08 16:47  jjornet

	* [r12096] * Added new local_write_m. It makes easier and
	  compatible to write local properties.
	  * Now local%inside variable is set on the main program.

2014-05-08 18:42  alejandro

	* [r12097] Added a reference to the FIRE algorithm.

2014-05-08 18:57  dstrubbe

	* [r12098] * PUSH/POP's.
	  * Formatting.
	  * Typo.

2014-05-08 21:20  dstrubbe

	* [r12099] Fixing POP_SUB from previous commit.

2014-05-08 22:07  dstrubbe

	* [r12100] Fixing distcheck failures: r12096 created two new
	  sections (presumably accidentally) in the variable reference, and
	  one new subsection. Please try to be systematic, and not
	  proliferate sections too much. In particular, the top-level
	  sections need to be mentioned in doc/html/vars/Makefile.am to
	  work. I moved these variables to Utilities::oct-local_multipoles
	  since that is the only thing that seems to use them for now.

2014-05-08 22:14  dstrubbe

	* [r12101] * Typo.
	  * More specific message for 'experimental' since calculating
	  Bader volumes elsewhere is not experimental.

2014-05-09 08:45  joseba

	* [r12102] Added more documentation about Poisson solvers and
	  forbid also more not working combinations

2014-05-09 09:18  micael

	* [r12103] Removed PUSH/POP from a routine that is called too
	  often.

2014-05-09 13:15  micael

	* [r12104] * Renamed several routines that write/read information
	  to the restart folder so that all follow the same convention:
	  this_dump/load.
	  * Moved mesh_subset_indices and index_valid from mesh_m to
	  index_m.
	  * Renamed restart_read_lxyz to mesh_check_dump_compatibility, as
	  the previous name was very misleading, and moved it to mesh_m.
	  

2014-05-09 14:26  joseba

	* [r12105] Changed a variable name
	  Doxygen comments
	  Added () to a subroutine call

2014-05-09 14:52  micael

	* [r12106] Bug fixed: the index in ob grid needs to know if the box
	  is an hypercube.

2014-05-09 14:56  micael

	* [r12107] Added new grid_dump routine.

2014-05-10 10:21  micael

	* [r12108] Systematizing further the grid dump/load. This should
	  also fix the current teststuite failures with the open boundaries
	  tests. As a side effect it breaks the backward compatibility of
	  the "mesh" restart file. Nevertheless, as far as I could
	  determine, this file is only read with open boundaries and frozen
	  density, which are not widely used features.

2014-05-10 10:57  micael

	* [r12109] Forgot to commit this file in r12108.

2014-05-10 12:10  micael

	* [r12110] Bug fix: one PUSH_SUB should be a POP_SUB instead.

2014-05-12 10:45  jjornet

	* [r12111] * call io_mkdir('local.multipoles') has been removed.
	  Now results are written on local.general folder.

2014-05-12 16:32  dstrubbe

	* [r12112] * Bugfix: appropriate unit was not being used for some
	  output from
	  static_pol.
	  * Removing unnecessary target attributes.
	  * Formatting.

2014-05-12 16:34  dstrubbe

	* [r12113] * Some compilers insist that the 'l' format specifier be
	  followed by a
	  number, so I changed it to 'l1'.
	  * Explanation of why 'aa' appears to be used unset in
	  subarray_inc.F90.
	  * Removing unused global save variable for RDMFT.

2014-05-12 16:39  dstrubbe

	* [r12114] Unused or useless variables.

2014-05-12 16:43  dstrubbe

	* [r12115] * Unnecessary target attributes.
	  * Unused variables.
	  * Note about local_write.F90.

2014-05-12 16:57  dstrubbe

	* [r12116] * Adding Sternheimer prefixes to documentation.
	  * Changing prefix for Van der Waals mode to something more
	  logical, and making a variable name explicit.

2014-05-12 17:11  dstrubbe

	* [r12117] * Adding interfaces for finite symmetry routines.
	  * Renaming an argument to something more meaningful.

2014-05-12 18:05  dstrubbe

	* [r12118] * More reasonable intent's for function subroutine
	  argument of loct_numerical_derivative.
	  * Using the interface (which was otherwise unused) for calls to
	  oct_numerical_derivative.

2014-05-13 09:35  jjornet

	* [r12119] * Filename changed to write on the correct folder.

2014-05-13 10:50  askhl

	* [r12120] for complex-scaled DFT, set initial Hartree and XC
	  potentials to zero since the initial density/orbitals are not
	  correctly complex-scaled and thus would yield a weird initial
	  spectrum

2014-05-13 12:01  joseba

	* [r12121] Initialize all the parallel communicators, even if they
	  are not used, i.e. have only one process. This is important for
	  the MPI IO, as all the processes of one communicator must call
	  the IO functions.

2014-05-14 08:03  jjornet

	* [r12122] * Removing unused and repeated variable lmax.

2014-05-15 15:30  dstrubbe

	* [r12123] Unused variables and arguments.

2014-05-18 14:27  xavier

	* [r12124] The pseudopotential phases are only required for
	  periodic systems.

2014-05-18 14:44  xavier

	* [r12125] Added the variable IonsConstantVelocity, this makes ions
	  not to feel
	  the forces and keep their initial velocities.

2014-05-18 14:57  xavier

	* [r12126] Renamed xcs%functl to xcs%functional.

2014-05-18 18:47  micael

	* [r12127] * Implemented the restart of the density and mixing
	  during the SCF cycle. For the moment it is disabled, as there are
	  still some more testing needed before starting to update the
	  results from the testsuite.
	  * Divided the restart module in two. One will keep the general
	  information and routines, the second one keeps the states
	  specific routines. There is still some work to be done regarding
	  this in order to make the restart more flexible.
	  * Now the writing of the density is not done automatically at the
	  same time as the writing of the states.
	  * Moved and changed the name of several routines for greater
	  consistency.

2014-05-18 19:20  xavier

	* [r12128] Reduced the maximum blocksize of the 3D derivatives
	  test, to reduce
	  memory consumption of the testsuite.

2014-05-19 09:33  micael

	* [r12129] * Corrected wrong PUSH_SUB.

2014-05-19 20:32  dstrubbe

	* [r12130] Bugfix to r12032: we should only use the value $1 from
	  the regular expression if the search was successful; otherwise $1
	  will confusingly provide the value of an argument passed to this
	  function.

2014-05-20 15:28  dstrubbe

	* [r12131] * Unused variables.
	  * PUSH/POP's.
	  * Formatting.

2014-05-20 16:37  dstrubbe

	* [r12132] * Structure components should be pointers not
	  allocatable.
	  * Flagging another problem with local_write.F90.

2014-05-20 16:46  dstrubbe

	* [r12133] Deactivating local_write_m for the time being since it
	  makes g95 crash on compilation; does not seem
	  usable for its intended purposes in its current location in
	  src/util;
	  and seems unnecessarily duplicative of src/td/td_write.F90.

2014-05-21 09:33  joseba

	* [r12134] The meshes of ob_grid have to be initialized, mainly
	  because of MPI IO, which will use those values. Probably is not
	  the best place to do so

2014-05-21 14:01  jjornet

	* [r12135] * corrected integer cast to the actual machine
	  precission

2014-05-21 16:06  dstrubbe

	* [r12136] Newlines at the end of files.

2014-05-22 10:35  joseba

	* [r12137] Reading of the files is done with MPI 2 IO if available.
	  The purpose of this change is to check if in other machine works
	  (through buildbot).
	  And also, to be able to measure the performance, compared with
	  the old approach (work to be done by myself).

2014-05-22 15:27  jjornet

	* [r12138] * Activating local_write_m . Error compilation on lascar
	  (g95) has been fixed changing variable declaration.
	  * New condition to update local domains.

2014-05-26 15:42  joseba

	* [r12139] Added rt library to the check of the new ISF, as it
	  needs.
	  Handled in a better way the libraries of the new ISF; i.e. in
	  common-rules.make, instead of in the m4

2014-05-26 16:12  joseba

	* [r12140] I think those lines are mandatory, when is not found

2014-05-27 08:14  joseba

	* [r12141] Changed the order of other_LIBS, as ISF depends on
	  LAPACK. I'd say that the core libs should go last anyway

2014-05-27 09:38  micael

	* [r12142] Implemented new restart framework. This is intended to
	  correct several problems that occurred in the code and to prevent
	  similar problems to occur in the future. These include, among
	  others:
	  * Mesh functions being read without taking into account that the
	  mesh might have changed (this happened in the loading of the KS
	  potential of previous TD iterations)
	  * Having restart information obtained with two different meshes
	  stored in the same folder.
	  * Having concurrent incompatible access from two different parts
	  of the code to the same restart directory.
	  * Incorrectly using tmpdir instead of restart_dir and vice versa
	  (in fact, these two variables have been deleted in this commit)
	  * Reading or writing restart information outside the restart
	  directories.
	  
	  This new scheme implies that a restart object must always be used
	  to access the content of a restart directory. This object takes
	  care of making several checks, in particular the ones concerning
	  the mesh compatibility. Unfortunately there are still a couple of
	  places that partially bypasses this framework, namely in the PES
	  and open boundaries modules.
	  
	  Some of the code is still crude and improvements are needed, like
	  the parallel writing/reading of files which is still not
	  completely transparent and consistent, but the basic features are
	  there.
	  
	  Note that all the routines for loading and dumping the grid
	  information, including the partition, have been kept outside this
	  new framework, although they are used by it. The reason behind
	  this is that I will soon make some more changes to the restart
	  module that are going to make it quite Octopus specific, while I
	  would like to keep the grid stuff as generic as possible.
	  
	  
	  Other changes:
	  * io_mkdir now has an option to create parent directories if
	  needed.
	  * Some formatting in the PES modules (please note that variables
	  and routines names must all be lower-case, as per Octopus coding
	  style)
	  * Changed the names of some routines to improve consistency.
	  * There are three new input options (MeshPartitionRead,
	  MeshPartitionWrite, and MeshPartitionDir) that replace
	  MeshPartitionFromScratch. This makes it possible to read/write
	  the partition from/to a directory whose name is not "restart" and
	  to suppress the writing of the partition.
	  * The mesh fingerprint is now required when reading the content
	  of a restart directory. Furthermore, the content of the mesh
	  fingerprint file has changed slighly to make it easier to deal
	  with the case that the box shape is an hypercube. At the moment
	  these two changes break the backward compatibility of the
	  restart, but I will try to have the code working properly with
	  previous restart files in a subsequent commit.

2014-05-27 09:44  micael

	* [r12143] * Reverted unintended changes from previous commit.

2014-05-27 11:02  micael

	* [r12144] * Updating the local multipoles so that they work with
	  the new restart.

2014-05-27 15:03  micael

	* [r12145] It seems the use of the inquire intrinsic with
	  directories is not standard Fortran, so we will use a C function
	  instead.

2014-05-27 15:09  micael

	* [r12146] Reverting unintended change.

2014-05-27 17:16  dstrubbe

	* [r12147] * Some typos and formatting.
	  * Fixing a doxygen tag.
	  * Making error message in 'static_pol' match the others.
	  * Warning shouldn't start with 'Info:'.
	  * Missing 'messages_fatal' after putting message in message(1)

2014-05-27 18:09  dstrubbe

	* [r12148] A digit of the GPL zipcode was accidentally deleted in
	  r12142.

2014-05-27 21:13  dstrubbe

	* [r12149] Fixing indentation.

2014-05-28 08:45  micael

	* [r12150] Making sure that we do not try to close files that were
	  not opened.

2014-05-28 10:54  micael

	* [r12151] Removed spurious attempt to close a file.

2014-05-28 12:15  joseba

	* [r12152] A variable was not initialized. So added a err parameter
	  to the mix_dump subroutine
	  Changed an error message

2014-05-28 12:29  micael

	* [r12153] * restart_write_function should call io_function_output
	  specifying the mpi group.
	  * Removed debug print.

2014-05-29 07:50  joseba

	* [r12154] Added deallocations of the partitions at the end of
	  execution

2014-05-29 09:20  joseba

	* [r12155] Only finalize the partition when domain parallelization
	  is used

2014-05-29 10:29  joseba

	* [r12156] Added a subroutine to set arbitrarily the iteration
	  number
	  Some doxygen comments

2014-05-29 14:26  micael

	* [r12157] Reverting part of r12153.

2014-05-30 12:25  micael

	* [r12158] Introduced new input variable RestartOptions, which
	  replaces TmpDir and RestartDir.
	  
	  The idea is that, instead of selecting a global directory to be
	  used for writing and another one for reading, one can now select
	  a different restart directory that is going to be used both for
	  writing and reading for each restart data type. Using the same
	  directory for reading and writing seems more appropriate, as
	  there are several parts of the code that already required that. I
	  have defined all the restart data types that I could think of,
	  but it is likely that some new ones would be useful in some parts
	  of the code, so feel free to introduce new ones. In this context,
	  a restart data type is a set of restart information that is to be
	  used in a specific part of the code. For example, the simplest
	  and most obvious case is the ground-state restart required by
	  many run modes. Other examples are less obvious, like the
	  ground-state used to compute the populations and td_occup options
	  of the TDOutput variable, as one could want to project the TD
	  states over a ground-state that is different from the
	  ground-state used to start the TD calculation.
	  
	  All the run modes should nevertheless behave exactly as before,
	  with the only exception of CalculationMode=unocc. In that case,
	  if FromScratch = yes, the restart information is read from the
	  restart directory defined by the restart_gs option, while if
	  FromScratch = no, it is read from the restart directory defined
	  by the restart_unocc option. This allows to leave unchanged the
	  behaviour of this run mode when it is the second of two datasets,
	  being the first one a ground-state calculation.

2014-05-30 15:20  micael

	* [r12159] * It is now possible to set some flags in the
	  RestartOptions block in order to select which parts of the
	  restart information should be used. At the moment, only the
	  density and mixing flags are implemented for an SCF calculation.
	  * Name of mixing functions to be read was incorrect.
	  * Mixing now takes into account if the writting/reading of the
	  restart should be skipped.

2014-05-30 19:30  dstrubbe

	* [r12160] * Typos.
	  * Clarifying default of LocalMagneticMomentsSphereRadius, and
	  making it be used in td_write.F90 too.

2014-05-31 15:42  acastro

	* [r12161] The sparskit linear solver used a stopping criterion
	  that was in my opinion
	  not a good choice: it depended on the initial residual produced
	  by the initial
	  guess. So for example calling the solver with a solution provided
	  by a
	  previous call did not exit immediately, but rather attempted to
	  get solution
	  several orders of magnitude better.
	  
	  I change it here to a stopping scheme that does not depend on the
	  initial
	  guess.

2014-06-01 19:01  acastro

	* [r12162] New propagator: 4th order implicit Gauss-Legendre
	  Runge-Kutta. For a given
	  time step, it is perhaps the most precise of the methods that we
	  have right
	  now, but is also slower (part of the reason for the slowness may
	  be due to
	  clumsy programming and lack of pre-conditioning for the linear
	  solvers). However, for long time propagations where accuracy is
	  important, it
	  may be useful (and specially for QOCT runs, for which the
	  propagations can be
	  specially challenging). And it will be good to have it for
	  comparison
	  purposes, since it is a "classical" propagator that appears in
	  textbooks.
	  
	  It needs the sparskit library. Also, seems to work well only for
	  some of the
	  linear solvers (gmres in particular), and not others.

2014-06-01 19:36  acastro

	* [r12163] Eliminated the previously committed code when sparskit
	  is not present.

2014-06-02 14:50  joseba

	* [r12164] Changed the tests of the reading of the mixing to be
	  able to work in parallel.
	  Forced the failure if the mixing information is not properly
	  read, otherwise it gets stuck in parallel without any
	  information.
	  
	  Added SVN Id to fft_inc.F90 file

2014-06-02 16:26  jjornet

	* [r12165] * read_from_default_file becomes public to enable new
	  read of atomic radii in local_multipoles.
	  * Variable names used by oct-local_multipoles changed to
	  homogenize section. All variable names start by LD.
	  * Some bugs on writting multipoles files have been fixed.

2014-06-02 16:37  acastro

	* [r12166] I had not included in the RK4 propagator the possibility
	  of using an
	  inhomogeneous term. Now it is included, which permits to use this
	  propagator
	  for QOCT runs with moving nuclei (although now only with
	  independent
	  electrons).

2014-06-03 08:12  jjornet

	* [r12167] * Fixed the units error.
	  * New option to write the trajectories into multiple xyz files.

2014-06-03 13:38  joseba

	* [r12168] Deleted too verbose output and shown only in debug_mode

2014-06-03 14:25  micael

	* [r12169] * Reverted some of the changes from r12087.
	  * When restarting the mixing, we actually need to know how many
	  SCF iterations have been done in total, not just during the
	  current calculation.

2014-06-03 14:59  micael

	* [r12170] This file was missing from the previous commit.

2014-06-03 15:32  dstrubbe

	* [r12171] Clarifying documentation.

2014-06-03 15:34  dstrubbe

	* [r12172] The check for atoms being too close only worked for
	  finite systems. Now it is done after the simulation box is
	  defined, and takes into account periodic boundary conditions.

2014-06-03 20:55  acastro

	* [r12173] And now I add the 2nd order implicit Runge-Kutta, a.k.a.
	  trapezoidal rule,
	  which in fact reduces to Crank-Nicolson for linear problems.
	  Since we do not
	  really have a linear problem when doing TDDFT, it is slightly
	  different to CN.

2014-06-03 21:21  dstrubbe

	* [r12174] Restart now checks that the k-points being read are
	  indeed the needed ones, and if not doesn't use the restart info
	  for that k-point. An exception is made for the open-boundaries
	  code in which the k-points are always set to zero internally and
	  thus will never match.

2014-06-05 16:08  dstrubbe

	* [r12175] Fixing PUSH/POP.

2014-06-05 19:08  dstrubbe

	* [r12176] Testing another output.

2014-06-05 19:30  dstrubbe

	* [r12177] Just as for finite-difference electric response, it is
	  good to clear the mixing between SCF runs on different physical
	  systems. This makes the result more reproducible by avoiding
	  accumulation of numerical noise, and probably will make the
	  finite-difference vib_modes test pass again (after r12169).

2014-06-06 09:07  micael

	* [r12178] Making sure we only try to close a file it was
	  successfully opened.

2014-06-06 14:04  micael

	* [r12179] * Added routines to dump/load the Hartre+XC potential.
	  * It is now possible to use a saved Hartre+XC potential to
	  restart the SCF cycle.

2014-06-06 14:50  micael

	* [r12180] Expanded finite_systems_3d/06-restart so that the new
	  SCF restart features are tested.

2014-06-06 14:52  micael

	* [r12181] Forgot an important note in my previous commit.

2014-06-06 15:42  dstrubbe

	* [r12182] Let's not bother the user with listing all possible
	  error conditions, let's just say what went wrong in this
	  particular case.

2014-06-07 14:58  acastro

	* [r12183] Chenged the way in which the application of the
	  QOCT-exchange operator is
	  done.

2014-06-07 16:24  acastro

	* [r12184] Added the QOCT-exchange operator to the RK2 propagator,
	  so that it can be used
	  for QOCT-TDDFT runs.

2014-06-08 11:32  acastro

	* [r12185] The RK2 did not allow for the presence of an
	  inhomogeneous term in the
	  equation of motion. Now it does.

2014-06-09 18:07  dstrubbe

	* [r12186] Repairing restart for finite-differences em_resp: the
	  directory name was accidentally changed to em_resp instead of
	  em_resp_fd in r12158, and the dumping of the states for the
	  different fields were accidentally all overwriting one another
	  except for the yz+ one.

2014-06-11 12:54  micael

	* [r12187] Bug fix: a variable (kdotp_vars%eta) was being used
	  uninitialized.

2014-06-11 14:12  micael

	* [r12188] In states_look, the number of states, the states
	  dimension, and the number of kpoints are now read from the
	  "states" restart file.

2014-06-11 15:08  joseba

	* [r12189] Forbid to select the LibISF Poisson solver if not
	  compiled. Sorry for not doing it before.

2014-06-11 16:03  dstrubbe

	* [r12190] Fixing typo and clarifying error message.

2014-06-11 16:07  micael

	* [r12191] * iopar_read is now able to read more than one line at a
	  time.
	  * Added iopar_find_line function.

2014-06-11 16:10  dstrubbe

	* [r12192] Fixing text of error message.

2014-06-12 13:57  micael

	* [r12193] * All the grid related dump/load routines are now fully
	  MPI aware.
	  * Most of the possible errors in the grid related dump/load
	  routines are now taken into account.
	  * Errors in the grid related dump/load routines are no longer
	  fatal: an error code is always returned to the parent routine.
	  * Removed some unused variables.
	  * Changed some routine names to improve consistency.

2014-06-12 16:21  dstrubbe

	* [r12194] Recentering and tightening up tolerances for vib modes.

2014-06-13 14:23  joseba

	* [r12195] Added time stamp to the starting and ending points of
	  reading and writing. This is useful for large systems

2014-06-13 16:26  micael

	* [r12196] * Improved error handling in all the dump/load routines:
	  - it is always up to the parent routines to decide if the errors
	  are fatal or not.
	  - all possible errors are checked.
	  - the code tries to read/write as much as possible, even if an
	  error occured.
	  * Failure to dump is not a fatal error any more (I might have
	  missed a couple of places that call messages_fatal instead of
	  messages_warning though).
	  * The dump/load routines now only print that they
	  started/finished in debug mode. The states_load and states_dump
	  are an exception, as they can be very time-consuming and
	  therefore one wants to know what the code is doing.
	  * dump/load routines now systematically check the result of
	  restart_skip.
	  * Moved a couple of routines and changed some names to improve
	  consistency.

2014-06-14 09:20  micael

	* [r12197] Corrected a couple of PUSH/POP statements.

2014-06-14 09:45  micael

	* [r12198] * Added some warning messages when the code fails to
	  dump the states.
	  * Changed some fatal errors to simple warnings when the code
	  fails to dump the states.

2014-06-14 10:16  micael

	* [r12199] The states were declared as intent(inout) in
	  states_dump, but as far as I can see (and gfortran agrees)
	  intent(in) is enough.

2014-06-14 13:16  micael

	* [r12200] Moved the TD restart stuff to its own routines.

2014-06-16 21:48  dstrubbe

	* [r12201] Check and advice on dealing with Occupations block,
	  preventing an array access out of bounds.

2014-06-17 20:31  dstrubbe

	* [r12202] Unused variables.

2014-06-18 15:40  dstrubbe

	* [r12203] Cleaning up mess in documentation. Be sure to look at
	  the result on the website
	  (http://www.tddft.org/programs/octopus/doc/generated/html/vars.php?page=sections)
	  to check that things look OK after writing these blocks.

2014-06-20 15:25  micael

	* [r12204] More restart:
	  * New restart_write and restart_read routines to write and read
	  to restart files.
	  * Different combinations of errors in the dump/load routines will
	  now produce different and unique error codes. This feature is not
	  actually used, but structuring the routines this way might become
	  handy when implementing a decent error handling system.
	  * Improved error messages related to the restart, making them
	  more consistent throughout the code and removing some duplicated
	  information. In particular, dump/load routines will usually give
	  a warning when some error occur, but will not say if the
	  read/write failed, as that is a job for the parent routine, as
	  those are the ones that know if the error is fatal or not, or if
	  it should be silent or not.

2014-06-21 17:11  micael

	* [r12205] * Added routines to write in binary format arrays of
	  restart data that are not a mesh function.
	  * Renamed the restart_write_function and restart_read_function
	  routines to restart_write_mesh_function and
	  restart_read_mesh_function to make it clear that these apply only
	  to functions discretized on the mesh.
	  * Fixed serious bug in PES mask restart that seems to be present
	  for a long time: when the mask cube was not parallel in domains,
	  all the nodes would write the mask functions to the same file,
	  which could result in a file with wrong data. Now the writing and
	  reading of these functions is done using the new
	  restart_write_binary and restart_read_binary routines, which
	  properly take care of deciding which node is going to write to
	  the disk.

2014-06-23 14:13  umberto

	* [r12206] * apparently now messages_init() has to precede
	  io_init() in order to avoid spectacular crashes.
	  * missing "/" in "td.general". This is part of a change I have
	  overlooked since the new restart module has been introduced that
	  makes the PES restart incompatible with previous versions. I will
	  try to fix it in another commit.
	  
	  

2014-06-23 16:19  dstrubbe

	* [r12207] Typos.

2014-06-24 02:54  dstrubbe

	* [r12208] The pointers added to hamiltonian_t in r12183 needed to
	  be nullified, or hamiltonian_remove_oct_exchange could cause a
	  segmentation fault with SAFE_DEALLOCATE_P, as was happening on
	  the tigger buildslave.

2014-06-25 15:29  dstrubbe

	* [r12209] Adding emacs syntax-highlighting block.

2014-06-25 16:01  dstrubbe

	* [r12210] Undoing fatal error added for unocc in r12204 which was
	  causing the BerkeleyGW test to fail: we do not need the occupied
	  states in general, just the density.

2014-06-25 19:25  dstrubbe

	* [r12211] Bugfix to r12204: states_load returned ierr = 0 in a
	  case where nothing could be read, but that error code was taken
	  to mean everything was read successfully by the calling routines.
	  Instead we will return ierr = -1. Also, restored explanation of
	  what variable the numbers in the comments are referring to.

2014-06-25 19:37  dstrubbe

	* [r12212] * We do not need to signal an error if there are the
	  wrong number of k-points, since from r12174 we are checking that
	  k-points match. We will still give a warning if there are too few
	  k-points, which means inevitably some k-points will not match.
	  * The k-weights should NOT be read on restart because that makes
	  them silently overwrite the ones already generated, and they may
	  will be different since they are not unique in any sense.

2014-06-25 19:57  dstrubbe

	* [r12213] * PARPACK should be listed first on link line, since it
	  depends on ARPACK.
	  * Missing space.

2014-06-25 20:50  dstrubbe

	* [r12214] Moving ScaLAPACK and BLACS libraries to precede PARPACK
	  and ARPACK on the link line. Somehow, when the order was swapped
	  in r12141, this started problems on the tigger buildslave. For
	  example, 10-fullerene.01-gs.inp resulted in
	  {{{
	  ** Warning:
	  ** LCAO alternative implementation is under development.
	  ** It might not work or produce wrong results.
	  
	  [tigger:865] *** An error occurred in MPI_Allreduce
	  [tigger:865] *** on communicator MPI_COMM_WORLD
	  [tigger:865] *** MPI_ERR_OP: invalid reduce operation
	  [tigger:865] *** MPI_ERRORS_ARE_FATAL (your MPI job will now
	  abort)
	  }}}
	  I think the reason is related to the fact that PARPACK can use
	  BLACS for communication, and perhaps to this bug report
	  discussion:
	  http://mailinglists.scilab.org/Compiling-linking-with-PARPACK-td4024371.html.
	  I actually saw problems with PARPACK occurring on Hopper (a Cray)
	  which may be related to this issue as well.

2014-06-25 22:11  dstrubbe

	* [r12215] * restart_end should not be called in unocc before
	  trying to load density, unless another restart will be
	  initialized.
	  * unocc now refrains from trying again to reload wavefunctions
	  from the same directory, if restart_gs and restart_unocc are the
	  same.
	  * This is enabled by a new function in restart_m that tells
	  whether the directories are the same.
	  * Removing unnecessary message about not being able to load all
	  wavefunctions, since the restart routines already say so.
	  * Typo in variable reference info.

2014-06-26 18:14  dstrubbe

	* [r12216] Adding a test for unocc with spinors, which seems to be
	  working now.

2014-06-26 19:23  dstrubbe

	* [r12217] Unused and useless variables, and a FIXME about use of
	  LAPACK
	  interface/wrapper.

2014-06-26 19:37  dstrubbe

	* [r12218] svn $Id$ and emacs syntax highlighting block.

2014-06-26 20:05  dstrubbe

	* [r12219] Unused variables.

2014-06-26 20:26  dstrubbe

	* [r12220] Adding PUSH/POP's, and making assertions come after 'if
	  n < 1 return' conditions.a

2014-06-26 21:40  dstrubbe

	* [r12221] The idea of being orbital-dependent only applies to DFT,
	  not to independent particles. This should solve valgrind warnings
	  about an uninitialized value being access by this call for runs
	  such as finite_systems_1d/01-hydrogen.01-ground_state.inp.

2014-06-26 22:06  dstrubbe

	* [r12222] Making sure kick%function_mode gets initialized always
	  in kick_init to
	  avoid valgrind warnings from runs without a kick, e.g.
	  finite_systems_1d/02-neon_mpi.03-td_calc-kli_par_states.inp, when
	  calling kick_write. Also, moving nullifications to common earlier
	  place.

2014-06-27 07:56  joseba

	* [r12223] Corrected POP_SUB

2014-06-27 08:24  jjornet

	* [r12224] * GOStep default value for Fire methos is read in time
	  units (default 50. a.u of time).
	  * Write optimization.log file in output units.

2014-06-27 10:31  joseba

	* [r12225] Debug out was missing

2014-06-27 15:23  dstrubbe

	* [r12226] unocc with spinors seems to be working now, and is being
	  checked in the testsuite, so I am removing its being experimental
	  and the warning.

2014-06-27 15:44  dstrubbe

	* [r12227] Clarifying 'help' strings for configure about the
	  distinction between a prefix and the actual library.

2014-06-27 16:17  dstrubbe

	* [r12228] * Clarifying message about unocc with orbital-dependent
	  functional.
	  * Clarifying error message about failing to read occupied states
	  to note why they were required.

2014-06-27 16:35  dstrubbe

	* [r12229] * Removed message from unocc about starting 'from
	  scratch' if cannot read orbitals from RESTART_UNOCC: reading
	  orbitals from gs is not the same as starting from scratch if the
	  gs restart contains unoccupied orbitals, e.g. from ExtraStates.
	  * Moving message about building density from wavefunctions to
	  where it actually happens, since there were still possible
	  intervening error conditions.

2014-06-27 18:11  dstrubbe

	* [r12230] I forgot to check the error condition before writing an
	  error in r12228.

2014-06-27 18:30  dstrubbe

	* [r12231] Bugfix to r12229: I accidentally changed the conditions
	  about when there would be an attempt to read from RESTART_GS,
	  which could lead to an erroneous call to restart_end and a
	  segmentation fault on the mistaken deallocation. I restored the
	  logic.

2014-06-27 20:22  dstrubbe

	* [r12232] restart_open now can take an option to silence its
	  warning. This is now used in Casida to avoid getting numerous
	  warnings about missing files even when fromScratch was set. This
	  is related to the unusual way restart works in Casida, in which
	  the different parts of the calculation work off the restart from
	  previous parts, and thus fromScratch only is supposed to mean
	  that the first one won't read saved data.

2014-06-27 21:53  dstrubbe

	* [r12233] * valgrind was complaining about usage of uninitialized
	  functl(ixc)%flags when the functional was none, e.g. for
	  correlation when running with just an exchange functional, as in
	  testsuite/functionals. Therefore, we will cycle when family is
	  none in the loop.
	  * Just in case, set flags to zero when family is none.
	  * Removing meaningless lines about 'ii' which is not used, and
	  then reset by the loop following.

2014-06-28 19:04  acastro

	* [r12234] Added a test for the oct-harmonic-spectrum utility.

2014-06-28 19:55  acastro

	* [r12235] Reduced the precision threshold for this test.

2014-06-29 16:31  micael

	* [r12236] Bug fix: the checksum was not read in index_load.

2014-06-30 17:17  micael

	* [r12237] Restart of open-boundaries memory coefficients is now
	  completely handled by the restart module.

2014-06-30 19:01  acastro

	* [r12238] Some troubles when using max_dim larger than 3,
	  triggered by my previous
	  commit.

2014-06-30 21:03  micael

	* [r12239] Fixed format descriptor.

2014-06-30 21:16  micael

	* [r12240] Correct some more format descriptors.

2014-07-02 04:39  dstrubbe

	* [r12241] For unocc, the density should always be read from gs
	  restart, whereas unocc restart is just for states. This should
	  fix the periodic_systems/03-sodium_chain test that was failing.

2014-07-07 16:39  dstrubbe

	* [r12242] Clarifying info messages for LCAO or random
	  wavefunctions in unocc: these are not necessarily "replacing"
	  states, but might be just providing an initial guess where there
	  was nothing before.

2014-07-07 19:13  dstrubbe

	* [r12243] Bugfix: variables were not being initialized in
	  states_load if skip was set, leading to compiler-dependent
	  behavior and failure with PGI on the unocc run of
	  periodic_systems/03-sodium_chain.01-gs.inp.

2014-07-07 20:00  dstrubbe

	* [r12244] Show error code when Cholesky fails, and mention other
	  possible reasons.

2014-07-07 20:15  dstrubbe

	* [r12245] Made a subsubroutine for cholesky_serial, in accordance
	  with the treatment of the other options.

2014-07-08 18:54  dstrubbe

	* [r12246] Improving still-faulty logic for restart in unocc: we
	  try to read from gs unless reading unocc succeeded, or the
	  directories are the same. Previously with FromScratch=false, it
	  would not try to read gs, even if unocc reading failed.

2014-07-08 19:01  dstrubbe

	* [r12247] Fixing more flawed logic in unocc: if lowest_missing is
	  set appropriately, there is no need to check ierr > 0. For
	  clarity, I swapped the if-condition, and added comments.

2014-07-09 02:06  dstrubbe

	* [r12248] Typo.

2014-07-09 02:30  dstrubbe

	* [r12249] hm should be initialized before passing it to
	  sternheimer_init, or else a strange error about a bad
	  (uninitialized) occupation at the Fermi level could result.

2014-07-09 02:34  dstrubbe

	* [r12250] If running unocc parallel in k-points, there could be a
	  problem from the values of lowest_missing only being correct for
	  local k-points. Now it is reduced over all, and the judgment
	  about whether any occupied are missing is made consistently over
	  all k-points.

2014-07-09 15:24  dstrubbe

	* [r12251] More appropriate types to avoid warnings of type
	  conversion.

2014-07-09 20:42  dstrubbe

	* [r12252] Fixing valgrind warnings from KS inversion:
	  * states_exec_init needs to be called before states_allocate_wfns
	  to
	  ensure that st%d%packed is initialized.
	  * The whole mpi_grp, not just mpi_grp%comm, needs to be
	  initialized.

2014-07-09 20:51  dstrubbe

	* [r12253] Intent's, PUSH/POP's, and formatting.

2014-07-09 21:19  dstrubbe

	* [r12254] Unnecessary uses of states_null, which is included in
	  states_init and states_copy.

2014-07-09 22:16  acastro

	* [r12255] The inhomogeneous term was not handled properly in the
	  RK2 propagation
	  scheme. Also, there was a bug in the update of the xc term for
	  backwards
	  propagations.

2014-07-09 22:39  acastro

	* [r12256] I modified those two files by mistake in the previous
	  commit. Reverting to
	  previous version.

2014-07-10 16:04  dstrubbe

	* [r12257] * Increasing the precision with which infrared
	  intensities are written. The value in the vib_modes test was
	  exactly reproducible to all 5 digits, so it seems worth writing a
	  few more.
	  * Re-centering and widening tolerances a little in vib_modes test
	  so that lascar_x86_64_gfortran_cl_nvidia_test can pass.

2014-07-10 20:04  dstrubbe

	* [r12258] * Using GREPFIELD instead of LINE for more robust
	  matches.
	  * The match labelled 'LUMO+6' was actually LUMO+5.

2014-07-11 15:48  dstrubbe

	* [r12259] A more distinguishing title for a test.

2014-07-14 14:02  joseba

	* [r12260] Corrected some deallocations, still missing some.
	  Deleted unused variable

2014-07-14 14:13  jjornet

	* [r12261] *Use restart routines to read files.
	  *Fix error with output units.

2014-07-14 14:38  joseba

	* [r12262] Correcting my previous commit, LibISF functions have to
	  be only called when compiled
	  Changing a optional argument to an always assigned variable

2014-07-14 20:18  dstrubbe

	* [r12263] Fixing formatting.

2014-07-14 20:35  dstrubbe

	* [r12264] Widening tolerance a bit to allow test to pass on
	  Stampede.

2014-07-14 20:45  dstrubbe

	* [r12265] Unused variables.

2014-07-14 21:08  dstrubbe

	* [r12266] Reverting accidentally committed change in r12264.

2014-07-14 22:51  dstrubbe

	* [r12267] * For restart in a vib_modes calculation, node 0 should
	  read and distribute to the others.
	  * Only close the unit if it was opened.
	  * Removing unused argument fromScratch (since r12142).

2014-07-14 23:40  dstrubbe

	* [r12268] * Bugfix: calling restart_read with lines in r12224
	  broke restart for vib_modes, because the lines could be
	  arbitrarily long. Instead, we will use a separate line for each
	  entry in the dynamical matrix, and another line for infrared.
	  * Adding a test for vib_modes restart.

2014-07-15 16:12  dstrubbe

	* [r12269] * Fixing vib_modes restart in parallel: it was hanging
	  because I made routines containing MPI calls be called only from
	  proc 0.
	  * Since restart_read broadcasts the data, the MPI_Bcast lines
	  were unnecessary.

2014-07-15 16:14  dstrubbe

	* [r12270] SPARSKIT's m4 should not have the hardcoded path
	  /usr/lib which is only appropriate for some systems, and could
	  perversely remain in the link line even if it doesn't exist on
	  the machine, if -lskit worked by itself. We will test just
	  -lskit.

2014-07-15 16:16  dstrubbe

	* [r12271] * If the BLACS linking test failed in configure, the
	  tested value of LIBS_BLACS remained, and could cause an error
	  when eventually linking the executable. It needs to be cleared.
	  * More orthodox capitalization for BLACS and ScaLAPACK.

2014-07-15 16:21  dstrubbe

	* [r12272] * Delete vib_modes restart file if it could not be
	  opened.
	  * More precisely, if unit /= 0 means the file couldn't be opened,
	  but it might exist nonetheless.

2014-07-15 19:37  acastro

	* [r12273] Improved the accuracy of two operations in the
	  tdfunctions module: the
	  interpolation, and the integration to get dot products. This
	  slightly changes
	  the values of a few optimal control tests.

2014-07-15 19:53  dstrubbe

	* [r12274] MPI_Barrier needs comm not just mpi_grp.

2014-07-15 19:55  dstrubbe

	* [r12275] Missing dependency.

2014-07-15 20:19  dstrubbe

	* [r12276] * Missing deallocation.
	  * Formatting.
	  * Argument ordering.
	  * Restored assertion that appeared to have been accidentally
	  disabled
	  in r7182.

2014-07-15 21:05  dstrubbe

	* [r12277] * Fixing rank mismatch for call to hypercube_x_to_i,
	  which somehow
	  does not affect results in the test for ModelMB.
	  * PUSH/POP's.
	  * Formatting.
	  * Removing explicit array bounds for one argument. For argument
	  'nr'
	  it causes an error I do not understand though, so I am leaving it
	  alone.

2014-07-16 14:45  dstrubbe

	* [r12278] g95 says: Error: PRIVATE attribute at (1) is not allowed
	  in a TYPE definition.

2014-07-16 19:25  dstrubbe

	* [r12279] Reverting r12273 which broke the optimal control tests
	  with gfortran, due to an array out of bounds. Alberto, please
	  check.

2014-07-16 19:41  dstrubbe

	* [r12280] Template functionality is removed from the testsuite
	  script. I don't think it adds much value and I suspect no one is
	  using it, since you can just copy from another test.

2014-07-16 19:57  dstrubbe

	* [r12281] * Memory leaks with FHI pseudopotentials: pointers to
	  types were being deallocated, without ending the type first.
	  * Doxygen comments.
	  * Adding and correcting PUSH/POP's.

2014-07-16 20:58  dstrubbe

	* [r12282] Memory leak in unocc with spinors: st%spin was allocated
	  and zeroed when it was in fact already allocated.

2014-07-16 20:58  dstrubbe

	* [r12283] Removing routine states_resize_unocc which is no longer
	  used.

2014-07-16 22:17  dstrubbe

	* [r12284] Two memory leaks in casida.

2014-07-16 22:18  acastro

	* [r12285] I put back 12273, now without the out-of-bounds bug.

2014-07-16 23:02  dstrubbe

	* [r12286] Memory leak for SPARSKIT propagators: the tdsk object
	  was not deallocated. Also, it was not nullified in the beginning.
	  Made calls to sparskit_solver_end more consolidated too.

2014-07-17 16:20  dstrubbe

	* [r12287] Fixing PUSH/POP.

2014-07-18 15:21  joseba

	* [r12288] Added debug calls to MPI_Alltoalls

2014-07-18 16:36  acastro

	* [r12289] Eliminated some memory leaks.

2014-07-18 17:13  dstrubbe

	* [r12290] * Adding module usage, that hopefully will restore
	  compilation on mauchly with intel.
	  * Fixing mismatch MPI debug calls.

2014-07-19 11:42  acastro

	* [r12291] Some re-structuring of the propagators module, to make
	  it a bit more clear.

2014-07-20 15:55  acastro

	* [r12292] Several typos in the push_sb/pop_sub calls.

2014-07-20 18:47  micael

	* [r12293] Split restart_cd into two routines: restart_open_dir and
	  restart_close_dir. restart_open_dir returns an error code instead
	  of dying when the subdirectory does not exist.

2014-07-20 19:06  micael

	* [r12294] The restart of the gauge field is now handled by the
	  restart module and it is written in binary format, as some
	  numerical differences could be found when restarting from the
	  ascii file. Incidentally I had to slighly change the order of the
	  initialization of the gauge field which seems to have fixed a bug
	  in the calculation of the energy of the first td iteration.

2014-07-21 16:10  dstrubbe

	* [r12295] Correcting POP_SUB.

2014-07-21 16:14  dstrubbe

	* [r12296] * Bugfix: it should not be an error to fail to read
	  restart response wavefunctions for vib_modes.
	  * restart_open_dir does not need to write a warning if it cannot
	  open the directory, because the calling routines write their own
	  messages.

2014-07-21 17:26  dstrubbe

	* [r12297] Unused argument.

2014-07-23 15:58  dstrubbe

	* [r12298] unocc now supports OutputInterval.

2014-07-23 16:15  acastro

	* [r12299] Some subroutines were receiving unallocated pointer
	  arrays (related to
	  the use or not of complex xc potentials), which is probably legal
	  but
	  valgrind complained.

2014-07-23 16:21  dstrubbe

	* [r12300] * More canonical handling of message for functionality
	  not implemented.
	  * Better wording of variable description.
	  * Clarification to subroutine comment.

2014-07-23 16:49  dstrubbe

	* [r12301] * Some explicit type conversions.
	  * One variable 'dd' was real when it ought to be complex.
	  * Formatting.
	  * Doxygen comment.

2014-07-23 16:54  dstrubbe

	* [r12302] * integer was being assigned 1.0 instead of 1.
	  * Doxygen comment.
	  * Unused variable.

2014-07-23 17:01  dstrubbe

	* [r12303] The routine 'states_degeneracy_matrix' is not used
	  currently. But it was uselessly writing its output to restart,
	  even though it is just output that is not used for restarting.

2014-07-23 17:06  dstrubbe

	* [r12304] Removing useless routine, probably left behind when
	  X(states_rotate) was created.

2014-07-23 19:25  dstrubbe

	* [r12305] Added an interface for expmm.

2014-07-23 19:32  dstrubbe

	* [r12306] * Unused variables.
	  * Useless variable in pes_rc, presumably added by mistake
	  (r7095).

2014-07-23 20:08  dstrubbe

	* [r12307] Minor bugfix: with DebugLevel > 1, hypercube would crash
	  on attempt to
	  write mesh_partition via unallocated array.

2014-07-23 20:32  dstrubbe

	* [r12308] * Do not write progress bar for eigensolvers in debug
	  mode, because it
	  will be disrupted by debug info being written.
	  * Useless variable.

2014-07-23 20:48  dstrubbe

	* [r12309] * Useless variables.
	  * Typos.
	  * Formatting.

2014-07-23 20:51  dstrubbe

	* [r12310] Setting svn:keywords so that $Id$ gets replaced
	  automatically. For
	  future reference the command is:
	  
	  svn propset svn:keywords 'Id' src/td/propagator_rk_inc.F90

2014-07-23 21:19  dstrubbe

	* [r12311] Memory leak for Model MB output in parallel: there was a
	  cycle if not
	  proc 0, which circumvented the deallocations at the bottom of the
	  loop.

2014-07-24 17:20  dstrubbe

	* [r12312] * Making some variables used for ETSF_IO output only be
	  defined when that is linked, to suppress warnings.
	  * Fixing Doxygen comment.
	  * Formatting.

2014-07-24 17:21  dstrubbe

	* [r12313] Unused arguments and variables.

2014-07-24 17:45  dstrubbe

	* [r12314] * Useless variable.
	  * Unused arguments.

2014-07-24 17:49  dstrubbe

	* [r12315] * Unused argument.
	  * Unused variables.
	  * Some comments for ARPACK.

2014-07-25 00:59  dstrubbe

	* [r12316] Bugfix: ETSF_IO output in parallel was prone to
	  occasional failures to open files from NetCDF. This was due to
	  all processes attempting to open and write at the same time, and
	  resulting interference with one another. Now, only processor 0
	  opens and writes, though some of the routines have to be called
	  from all processors in order for the information to be properly
	  gathered over domains.
	  
	  Sample error:
	  {{{
	  ***
	  *** ETSF I/O ERROR
	  ***
	  *** Backtrace : etsf_io_low_open_modify()
	  *** Action performed : input/output open file for writing
	  *** Target (name) : static//density-etsf.nc
	  *** Target (id) : -1
	  *** Error message : NetCDF: Unknown file format
	  *** Error id : -51
	  ***
	  }}}

2014-07-25 01:13  dstrubbe

	* [r12317] * Caveats about ETSF_IO output.
	  * Removing duplicated lines from BerkeleyGW routines.

2014-07-25 20:14  dstrubbe

	* [r12318] Recentering and tightening tolerances for vib_modes in
	  casida test. I don't think there is a problem anymore.

2014-07-28 18:04  dstrubbe

	* [r12319] Adding a test run for Casida restart.

2014-07-28 20:02  dstrubbe

	* [r12320] Restart from Casida kernel, like from lr_hmat1 files,
	  will state how much was read.

2014-07-28 21:02  dstrubbe

	* [r12321] Removing PUSH_SUB's from two functions called too
	  frequently.

2014-07-29 15:47  dstrubbe

	* [r12322] Enhancement to fix_testsuite.py: it now uses the name of
	  a match in finding the appropriate one to replace, making it more
	  robust against (for example) incompleteness in the output file.

2014-07-30 04:20  dstrubbe

	* [r12323] smear%integral_occs was not necessarily initialized, and
	  then was used by Sternheimer to decide whether to perform
	  pre-orthogonalization. With mpich and gcc on my Mac, I found that
	  the test linear_response/05-polarizability.02-sternheimer.inp had
	  a deadlock because one processor was trying to pre-orthogonalize
	  and communicate with the other which didn't call that routine.
	  The solution: add condition for fixed occupations in
	  sternheimer_init, and for good measure, make sure integral_occs
	  is always initialized.

2014-07-30 16:15  dstrubbe

	* [r12324] Forgot to add some new files to the Makefile for
	  installation.

2014-07-30 18:53  dstrubbe

	* [r12325] * We can do a more useful 'dry run' in the testsuite by
	  not merely showing what the shell script would execute, but
	  actually calling the Perl script too and asking it to do a dry
	  run.
	  * The command line should still be constructed even if mpiexec
	  cannot be found for a parallel test, since it shouldn't be
	  necessary to set that for a dry run.
	  * In case mpiexec is blank, we will just set it to "mpiexec" for
	  reasonable dry-run output.
	  * The log should not be copied in dry-run mode, even if -l option
	  is passed, since there is no log.

2014-07-30 20:43  dstrubbe

	* [r12326] Bugfix to r12337: reading the open-boundaries memory
	  coefficients for restart did not take into account the
	  possibility that the file would not exist. This led to the code
	  hanging in iopar_read with g95 on my Mac (though not the
	  buildslaves for some reason).

2014-07-31 16:02  dstrubbe

	* [r12327] Unused module.

2014-07-31 16:14  dstrubbe

	* [r12328] * Bugfix to oct-convert: the restart objects were not
	  ended. This would surely cause trouble when using the "subtract
	  file" functionality in which case there would be an attempt to
	  initialize an already active object.
	  * Some FIXME comments on oct-convert and oct-local_multipoles.

2014-07-31 16:29  dstrubbe

	* [r12329] * If mesh and sb optional arguments are not supplied to
	  restart_init, this lack is stored in a variable, and handling
	  mesh functions with that restart object will be blocked, to be
	  sure incompatible meshes will be detected.
	  * oct-convert must supply the mesh and sb arguments since it
	  handles mesh functions.
	  * Casida should not supply the mesh and sb arguments since its
	  restart data is not mesh functions.
	  * Ensuring that sb is only present if mesh is, because it won't
	  be used otherwise.

2014-07-31 16:37  dstrubbe

	* [r12330] Avoiding a preprocessor warning about unterminated "

2014-07-31 16:40  dstrubbe

	* [r12331] Typo.

2014-07-31 17:54  dstrubbe

	* [r12332] Since a mesh object contains a pointer to sb, and sb
	  should never passed to restart_init without mesh being passed, we
	  can just remove the sb optional argument and use mesh%sb.

2014-07-31 18:43  dstrubbe

	* [r12333] Useless variable.

2014-08-01 16:20  dstrubbe

	* [r12334] Typos.

2014-08-01 17:16  dstrubbe

	* [r12335] Using the built-in "i" symbol of the parser rather than
	  a self-defined one, for open-boundaries tests.

2014-08-01 19:22  dstrubbe

	* [r12336] * Missing test file (disabled anyway) from Makefile.
	  * Formatting.

2014-08-01 19:26  dstrubbe

	* [r12337] * For dry run, testsuite Perl script will just use dummy
	  value "octopus" rather than worry about whether executable are
	  present, serial/parallel, or compiled with needed options.
	  * For dry run, testsuite shell script should write a summary
	  after all. There can indeed be failures if test files contained
	  erroneous constructs, or input files were missing. And the
	  cleanup part should definitely be done.

2014-08-01 19:28  dstrubbe

	* [r12338] * New target 'make check-dryrun' which does the full
	  testsuite with the -n option.
	  * If SKIP_CHECK is set, the tests are not ignored but rather done
	  as a dry-run. The distcheck buildslave will be doing this now,
	  and will detect test input files missing from Makefile.am, which
	  has been a common mistake.
	  * Refactored common lines from 'make check' and 'make
	  check-full'.

2014-08-01 21:12  dstrubbe

	* [r12339] Make the testsuite matches script be executable, like
	  the decommissioned one.

2014-08-04 17:54  dstrubbe

	* [r12340] A message when using the -p option for the testsuite
	  Perl script.

2014-08-04 20:39  dstrubbe

	* [r12341] Unnecessary settings of RestartWriteInterval to the
	  default, in input files for photoelectron tests.

2014-08-04 21:14  dstrubbe

	* [r12342] Removing extra_states from calc_mode object, which was
	  added in r9046 and never used for anything.

2014-08-05 00:24  dstrubbe

	* [r12343] * Refactoring the mostly common code from the
	  Xread_parallel and Xwrite_parallel routines.
	  * These read routines would crash on checking 'read_count' if
	  they could not open the requested file, rather than simply
	  signaling this to the calling routine via ierr. Now, the status
	  after the attempt to open is checked and the routine does not try
	  to operate on the file if it could not be opened, avoiding the
	  errors.
	  * Added errors if these routines are called without MPI2.
	  * Added interface for get_info_binary, a C function.
	  * Removed numerous unused variables.
	  * Removed useless initialization of 'type' in io_binary_get_info,
	  which is immediately overwritten by the call afterward anyway.

2014-08-05 00:28  dstrubbe

	* [r12344] MPI_Barrier was not hidden in ifdef's in the last
	  commit. But, actually I think it is probably not necessary
	  anyway. It was present previously for most but not all the
	  write_parallel routines (the integer*8 one lacked it) and none of
	  the read ones.

2014-08-05 02:04  dstrubbe

	* [r12345] Fixing compilation failure with pgi and g95: the sizeof
	  must be converted to integer*8 explicitly. I am still not sure
	  how portable this code is though: I believe sizeof is supposed to
	  be either integer*4 or integer*8 depending on whether the
	  compilation is 32-bit or 64-bit, in which case this should work
	  regardless, but in principle Octopus supports compilers which
	  don't even have sizeof at all, in which case I am not sure what
	  should be done.

2014-08-05 02:08  dstrubbe

	* [r12346] Unneeded variables and arguments.

2014-08-05 15:07  dstrubbe

	* [r12347] * Bugfix to recipe mode: each node printed the recipe
	  independently. Now only root does, making it safe to run the
	  recipe in a massively parallel manner. I changed io_dump_file to
	  only write from root.
	  * Periods.
	  * Bringing pulpo.F90 into line with our coding standards:
	  global.h, implicit none, PUSH/POP, and lower-case identifiers.

2014-08-05 15:13  dstrubbe

	* [r12348] Recipe improvements.

2014-08-05 15:24  dstrubbe

	* [r12349] Unneeded module usages.

2014-08-05 15:58  dstrubbe

	* [r12350] Doubling up single-letter variables.

2014-08-05 21:57  dstrubbe

	* [r12351] The random number generation for choosing a recipe was
	  highly flawed. I got the same recipe always on my MacBook.
	  Instead we will use the GSL routines, with seed chosen from
	  /dev/random or the time. Also I added a caveat in case some
	  required C routines are not available.

2014-08-06 09:07  acastro

	* [r12352] Added a test for most propagators (some of them were
	  untested).

2014-08-06 09:17  acastro

	* [r12353] Wrong file names.

2014-08-06 09:45  joseba

	* [r12354] Integrated convert test with the other outputs tests.
	  Updated the values accordingly and deleted the independent tests
	  consequently

2014-08-06 10:11  acastro

	* [r12355] Some cleaning of the propagators module.

2014-08-06 15:57  dstrubbe

	* [r12356] Making the coordinates in the convert test the same as
	  the preceding gs run. They are not actually used anyway.

2014-08-06 18:34  dstrubbe

	* [r12357] Malformed $Id$ strings.

2014-08-06 18:39  dstrubbe

	* [r12358] A test for the recipe mode :)

2014-08-06 18:49  dstrubbe

	* [r12359] Grepping for '\$Id\$' I found these files lacking the
	  svn:keywords property. I fixed them with "svn propset
	  svn:keywords 'Id'" on each file.

2014-08-06 18:56  dstrubbe

	* [r12360] More missing keywords settings.

2014-08-06 19:40  dstrubbe

	* [r12361] Removing the Poisson SETE solver, which is complicating
	  our maintenance of the rest of the code. The SETE code appears
	  unfinished and is a mess, and is not being tested. The removal
	  includes 'complex_boundaries' in simul_box which appears to have
	  been introduced in r7433 purely for SETE.

2014-08-06 20:39  dstrubbe

	* [r12362] Bugfix to r12361: more of a logical condition should
	  have been removed, causing test failure for
	  finite_systems_3d/01-carbon_atom.test.

2014-08-06 20:57  dstrubbe

	* [r12363] poisson_energy was only used by SETE.

2014-08-06 21:00  dstrubbe

	* [r12364] Arguments and variables unused without SETE.

2014-08-06 21:01  dstrubbe

	* [r12365] * Removed explicit array arguments bounds.
	  * Changing INTEGER to integer.
	  * Formatting.
	  * emacs syntax-highlighting block.

2014-08-06 21:04  dstrubbe

	* [r12366] Unused arguments.

2014-08-06 21:09  dstrubbe

	* [r12367] Removing the SLATEC library, which was only needed for
	  Poisson SETE solver.

2014-08-06 21:18  dstrubbe

	* [r12368] Unused variables and arguments.

2014-08-06 21:25  dstrubbe

	* [r12369] Updating license info for spglib, which is BSD not GPL
	  in the newer releases.

2014-08-07 02:36  dstrubbe

	* [r12370] * Assertion for a troublesome routine that is causing
	  occasional runtime errors in the testsuite. Possibly this will be
	  triggered.
	  * Passing arrays instead of just first indices to MPI_Allreduce
	  in that routine, which is how we are mostly doing it. Shouldn't
	  make a difference.
	  * Separators.

2014-08-07 10:45  acastro

	* [r12371] o Removed several complex to real conversions in the
	  tdfunction_m module,
	  which is designed to have only-real functions.
	  
	  o Changed a "$Id $" string to "$Id$".

2014-08-07 15:22  dstrubbe

	* [r12372] Removed some unnecessary tags from input files for
	  complex scaling.

2014-08-07 15:23  dstrubbe

	* [r12373] * Unterminated apostrophe warning.
	  * Explicit conversion to int.

2014-08-07 15:53  dstrubbe

	* [r12374] Unnecessary code duplication for complex-scaling in
	  mf_multipoles.

2014-08-07 18:21  dstrubbe

	* [r12375] Bugfix: an assignment was being made to uninitialized
	  indices ip and ist.

2014-08-07 18:28  dstrubbe

	* [r12376] Removing geometry from poisson_init, which was only
	  needed for SETE.

2014-08-07 18:35  dstrubbe

	* [r12377] * Unnecessary code duplication for mf_local_multipoles.
	  Please do not copy code; there is almost always a better way.
	  * Unused argument 'domains'.

2014-08-07 18:52  acastro

	* [r12378] Removed 01-etrs.test and 02-aetrs.test, and renamed
	  19-propagators.test to
	  01-propagators.test.

2014-08-07 19:05  dstrubbe

	* [r12379] Bugfix: orbitals for non-atomic species in 3D were
	  computed using an uninitialized variable r2. Fortunately the
	  affected routine was only used for LCAO alternative.

2014-08-07 19:43  dstrubbe

	* [r12380] Fortran interface for C routine write_header.

2014-08-07 21:13  dstrubbe

	* [r12381] More consolidated approach for initialization of
	  non-atomic species orbitals, rather than all these select case
	  statements which led to the bug in r12379.

2014-08-07 21:24  dstrubbe

	* [r12382] Bugfix to r12379: wrong loop was being cycled. This
	  caused a GSL interpolation runtime error in
	  28-carbon_big_box.test.

2014-08-07 22:19  acastro

	* [r12383] Separated, in 01-propagators.test, the propagators that
	  need sparskit from the
	  ones that don't.

2014-08-08 07:48  acastro

	* [r12384] Added a couple of files that where missing, and removed
	  one redundant test.

2014-08-08 16:40  acastro

	* [r12385] o The 04-etrs_single test was trying to use deleted
	  files.
	  
	  o Bug fix in the RK2 method. It was only caught by two of the
	  slaves.

2014-08-09 07:47  acastro

	* [r12386] The caetrs propagator required some specific exception
	  that complicated the
	  code a little bit.

2014-08-11 18:58  dstrubbe

	* [r12387] In some cases, if a restart directory was missing, this
	  would not be caught and would result in an assertion failure
	  (.not. restart%skip) in restart_open via states_look_and_load.
	  Now, restart_init returns an error code, so the code can refrain
	  from trying to load data, and a reasonable error message can be
	  provided if the restart data is required. An error code is
	  returned for mesh mismatch too. Currently there are no error
	  conditions for RESTART_DUMP, only for RESTART_LOAD.

2014-08-12 13:37  joseba

	* [r12388] Corrected a typo in a inp variable

2014-08-12 14:17  joseba

	* [r12389] For mesh_partition_dump, the error treatment is done in
	  the highest level, so:
	  - I created a more informative output in mesh_init
	  - I deleted intermediate unused warnings from mesh_partition

2014-08-12 14:34  joseba

	* [r12390] Continuation of the previous commit. Now, with
	  mesh_load.

2014-08-12 15:53  dstrubbe

	* [r12391] Removing unnecessary variables from io_binary routines.

2014-08-12 16:11  dstrubbe

	* [r12392] Templating some of the io_binary_f routines, with the
	  aid of new defined macros for real/complex/integer.

2014-08-12 18:28  dstrubbe

	* [r12393] Templating write_parallel routines, and trying to
	  comment out PUSH/POP's better so they do not break compilation
	  when long lines are not accepted.

2014-08-12 18:36  dstrubbe

	* [r12394] io_binary does not need its own MPI type macro. Using
	  our usual R_MPITYPE works fine. MPI_REAL8 and
	  MPI_DOUBLE_PRECISION appear equivalent for our purposes.

2014-08-12 18:59  dstrubbe

	* [r12395] Removing unnecessary initializations of 'ierr' in
	  io_binary routines. It is being passed to routines that set it
	  always and do not use any value input.

2014-08-12 19:18  dstrubbe

	* [r12396] Assertions in io_binary that do not depend on the type
	  can be moved to the underlying C routines to reduce duplication.

2014-08-12 20:27  dstrubbe

	* [r12397] * Templating Xread_binary and Xread_parallel routines,
	  with helper subroutines to handle the case of reading real into
	  complex.
	  * zread_binary will give the debug message when real is found,
	  like zread_parallel.
	  * Removing assertions from non-templated io_binary routines that
	  are now in C.

2014-08-12 20:51  dstrubbe

	* [r12398] * Removing unused io_binary interfaces and routines (for
	  s, c, l types that are never used in the code).
	  * Adding io_binary interfaces for some new routines that we have
	  from templating now, but did not before.

2014-08-13 04:11  dstrubbe

	* [r12399] Adding io_binary_f_inc.F90 to Makefile properly.

2014-08-14 13:03  dstrubbe

	* [r12400] Using macro with known size instead of sizeof, since
	  sizeof is not required to be available from Fortran.

2014-08-14 13:08  dstrubbe

	* [r12401] The same check used in X(write_parallel) for MPI I/O can
	  be used for X(read_parallel) too, to further ensure the integrity
	  of the restart files.

2014-08-14 13:24  dstrubbe

	* [r12402] Removing comments no longer needed.

2014-08-19 18:17  dstrubbe

	* [r12403] Using more conventional line continuations and
	  indentation.

2014-08-19 18:50  dstrubbe

	* [r12404] Removing confusing and unhelpful variants of the
	  read_csv routine. Only dread_csv is actually implemented, so it
	  is a bad idea to have non-functional other variants ("some ugly
	  stub functions just to satisfy the linker"), and wrapped into an
	  interface. This was added in r6862, presumably by false analogy
	  to the io_binary routines. The only place such a routine is used
	  now gives an error if it is attempted for other than real
	  numbers.

2014-08-19 18:54  dstrubbe

	* [r12405] * io_csv routines should always set ierr.
	  * io_csv Fortran wrappers should not set ierr.
	  * Unnecessary temporary variable in dcsv_read.
	  * Some documentation on species_from_file and UserDefinedStates.

2014-08-20 11:03  umberto

	* [r12406] Pseudopotential phases are required also when a uniform
	  vector potential is applied.
	  This should fix a bug (introduced in r12124) when using
	  "TDExternalFields" with "vector_potential".

2014-08-20 11:10  umberto

	* [r12407] Added support for IBM parallel environment in the
	  testsuite.

2014-08-20 14:27  joseba

	* [r12408] Renamed a variable

2014-08-20 19:05  acastro

	* [r12409] Added the "usual" explicit RK4 propagator.

2014-08-20 19:54  acastro

	* [r12410] Removed some number 2 that I added accidentally in the
	  last commit.

2014-08-22 19:12  acastro

	* [r12411] Added the ionic movement to the explicit RK4 propagator.
	  The movement of the
	  ions is also handled with the RK4 scheme, instead of with the
	  velocity-verlet,
	  in order to preserve fourth order accuracy.

2014-08-23 15:03  xavier

	* [r12412] Medium change: Replaced use of individual scal
	  operations for
	  batch_scal.

2014-08-23 15:55  xavier

	* [r12413] Medium change: batch calls for nrm2.

2014-08-23 23:54  xavier

	* [r12414] Medium change: More operations converted to batch
	  versions in the
	  linear solver.

2014-08-24 16:01  xavier

	* [r12415] Medium change: Batch_get_state/set_state is used to
	  store the states
	  in case of exceptions.

2014-08-24 18:19  xavier

	* [r12416] Medium change: Fixes a problem with batch indexes that
	  was making a
	  test fail after my previous commit.

2014-08-24 18:44  xavier

	* [r12417] Medium change: More operations in the linear solver
	  converted to batch
	  format.

2014-08-24 21:58  xavier

	* [r12418] Medium change: More operations in the linear solver
	  converted to batch
	  format.

2014-08-24 22:34  xavier

	* [r12419] Nedium change: Now the linear solver receives packed
	  batches from Sterheimer.

2014-08-25 13:27  umberto

	* [r12420] Simple output in VTK legacy format. This is mainly
	  intended for visualization with Paraview.
	  For the moment only for real quantities. For some reason the
	  center of the coordinates is offset.

2014-08-25 16:23  umberto

	* [r12421] Reverted changes introduced in r12205 where an alleged
	  writing race-condition was fixed.
	  It introduced instead a bug preventing the correct writing of
	  restart files with parallelization over states was employed.

2014-08-25 17:47  xavier

	* [r12422] Small change: Solving the linear equation in packed form
	  apparently
	  causes problems for OpenCL and MPI runs. So I am reverting this
	  change
	  until I solve the problem.

2014-08-26 07:38  xavier

	* [r12423] Small change: Bugfix in the OpenCL implementation of
	  batch_axpy_const.

2014-08-26 08:20  xavier

	* [r12424] Small change: The restrict qualifier was missing from
	  some pointer arguments.

2014-08-26 09:54  joseba

	* [r12425] Enabled to be run convert with MPI parallelisation

2014-08-26 12:03  joseba

	* [r12426] Added a tool to create the Fourier transform of various
	  densities

2014-08-26 14:25  xavier

	* [r12427] Small change: Bugfix in OpenCL axpy for real values.

2014-08-26 14:34  joseba

	* [r12428] Corrected Doxygen comments

2014-08-26 17:01  umberto

	* [r12429] Fixed VTK origin.

2014-08-26 17:07  umberto

	* [r12430] Fix units of mass in atomic units.

2014-08-26 17:10  umberto

	* [r12431] oct-photoelectron spectrum utility now can save data in
	  vtk format.

2014-08-27 02:33  xavier

	* [r12432] Medium change: Improved OpenCL parallelization of nrm2.

2014-08-27 02:51  xavier

	* [r12433] Small change: Profiling region for the batch linear
	  solver.

2014-08-27 13:55  joseba

	* [r12434] Added the Fortran mode for emacs

2014-08-27 14:01  umberto

	* [r12435] Reverted back mass form atomic units to atomic mass
	  units + comment.

2014-08-27 14:24  umberto

	* [r12436] Removed double comment (already present at the beginning
	  of the file). No reason to comment twice.

2014-08-27 14:40  xavier

	* [r12437] Small change: Fixed non-OpenCL compilation.

2014-08-27 16:11  alejandro

	* [r12438] A small bug fix on the FIRE algorithm, and on the
	  writing of the optimization.log file.

2014-08-27 16:43  umberto

	* [r12439] Set atomic mass units as particular unit to read atoms
	  masses. This way the in/out mass factors are consistent with
	  atomic units.

2014-08-27 16:48  umberto

	* [r12440] Reverted to sqrt(units_out%energy) for momentum units.

2014-08-27 23:41  xavier

	* [r12441] Medium change: The application of the perturbation is
	  done using the
	  batch version of pert_apply.

2014-08-28 00:47  xavier

	* [r12442] Medium change: Another operation done in batch mode.

2014-08-28 10:36  umberto

	* [r12443] Better oct-photoelectron-spectrum spectrum output and
	  messages.

2014-08-28 11:08  umberto

	* [r12444] Use optional_default.

2014-08-28 12:31  umberto

	* [r12445] Machine independent logical to integer conversion.

2014-08-29 18:01  acastro

	* [r12446] Added the propagation of the OCT co-state to the
	  explicit RK4 propagator.

2014-08-29 18:59  acastro

	* [r12447] Moved the location of a file to avoid the problem with
	  the compilation
	  triggered by my previous commit.

2014-08-29 22:16  dstrubbe

	* [r12448] * Fixing PUSH_SUB with wrong name from r12420.
	  * ASSERT(present(geo)) in io_function_output_global is to be sure
	  that geo is not used when it isn't present. Since VTK does not
	  use geo, it doesn't need the assertion; since OpenSCAD does use
	  geo, it should have the assertion.

2014-09-01 06:53  umberto

	* [r12449] See if this fixes obscure compilation error on chum_pgi.

2014-09-01 10:38  umberto

	* [r12450] Second attempt at fixing pgi compilation on chum.

2014-09-01 11:41  umberto

	* [r12451] Third (and hopefully last) attempt.

2014-09-02 08:32  joseba

	* [r12452] Doxygen comments

2014-09-02 08:47  joseba

	* [r12453] Deleting an assert that is no longer needed.
	  Renaming of various input parameters of convert utility.
	  Restarts are not initiliazed with the mesh, there is no need for
	  that.
	  The subtract utility is working back again.

2014-09-02 09:57  joseba

	* [r12454] Delete the 'obf' extension if present in the subtract
	  file.

2014-09-02 13:03  jjornet

	* [r12455] Added missing mask argument.

2014-09-02 13:15  jjornet

	* [r12456] - Use more standard routines instead of write
	  statements.
	  - Some format changes
	  - Use species_get_density routine in add_dens subroutine.
	  - Deleted useless parts.

2014-09-02 13:18  jjornet

	* [r12457] - Fixed typo in TODO comment.

2014-09-02 14:09  jjornet

	* [r12458] - Added functionalities to get the densities and
	  potentials from local domains.

2014-09-02 15:04  jjornet

	* [r12459] - Write restart information using
	  drestart_write_mesh_function.
	  - Local write enables to output local energies.

2014-09-02 20:09  xavier

	* [r12460] Medium change: Batch implementation of pert_apply for
	  electric fields.

2014-09-02 20:35  xavier

	* [r12461] Small change: There is no need to set the orbitals to
	  zero before
	  applying the perturbation.

2014-09-02 21:33  xavier

	* [r12462] Small change: Renamed a function and added a comment to
	  make the code
	  clearer.

2014-09-03 08:59  umberto

	* [r12463] Changed the mass factor for eV/A units according to
	  David suggestion from eV/C^2 (ok for high-energy physics) to the
	  more appropriate hbar^2/(eV*A^2) (consistent with eV/A).

2014-09-03 09:23  umberto

	* [r12464] Consistent formula abbreviations.

2014-09-03 15:41  dstrubbe

	* [r12465] Correction to unit name.

2014-09-03 18:50  dstrubbe

	* [r12466] Suppressing some warnings from io_binary routines: only
	  MPI2 routines themselves need be in the ifdef's. Fixing an
	  intent. Making intent(out) variables be always set.

2014-09-03 19:13  dstrubbe

	* [r12467] Removing interface that was used only for a single call,
	  and resolved the different routines through an unused argument,
	  which is ugly.

2014-09-03 20:18  dstrubbe

	* [r12468] Clarifying message.

2014-09-03 20:47  xavier

	* [r12469] Small change: Fix the bug that was causing a deadlock in
	  some MPI
	  buildbots. The issue seems to be some weird interaction between
	  MPI
	  and the compiler that we don't understand very well. It is fixed
	  by
	  passing the full array to MPI instead of the first element.

2014-09-03 20:53  dstrubbe

	* [r12470] Avoid possible error about use of non-associated pointer
	  in recipe mode.

2014-09-04 00:25  xavier

	* [r12471] Small change: Added detection of FMA3 instructions to
	  the configure
	  script.

2014-09-04 01:01  xavier

	* [r12472] Medium change: Support for fma3 instructions.

2014-09-04 13:06  jjornet

	* [r12473] - Print header and date in local_multipoles utility.
	  - Forall statements changed to a conventional do loop.

2014-09-04 15:28  dstrubbe

	* [r12474] * Lengthening string for units abbreviation, given
	  recent lengthening of some.
	  * Doxygen comment.

2014-09-04 15:46  dstrubbe

	* [r12475] Unused variables.

2014-09-04 16:10  dstrubbe

	* [r12476] I think this fixes the warnings about incompatibilities
	  between const and non-const pointers from spglib. If the
	  buildslaves all like it, I'll submit it to the author of spglib.

2014-09-04 16:52  xavier

	* [r12477] Small change: Changed the check for FMA3 to the AVX
	  instruction
	  version, to see if this fixes the problem with a buildbot.

2014-09-04 17:03  dstrubbe

	* [r12478] Reverting r12476: it does not fix the warnings about
	  const and non-const pointers in spglib. It does not seem possible
	  to use const pointers where SPGCONST appears:
	  http://c-faq.com/ansi/constmismatch.html.

2014-09-04 17:21  dstrubbe

	* [r12479] We should not use const double [][] for passing to
	  spglib routines, since they do not use that type due to its
	  problematic nature in C.

2014-09-04 21:48  dstrubbe

	* [r12480] Changing a test to the long run, since the valgrind
	  builder cannot finish it and always times out.

2014-09-04 22:16  dstrubbe

	* [r12481] Making a td test use an unoccupied state, since it has
	  it ready from a previous unocc run, and I am not sure we have a
	  test like that yet. We need to set par_domains since TDOutput =
	  td_occup + populations is not compatible with par_states.

2014-09-04 22:25  dstrubbe

	* [r12482] * Caveat about incompatibility of states_look_and_load
	  with states parallelization.
	  * Doxygen comment.

2014-09-06 09:12  jjornet

	* [r12483] · Changed forall statement.

2014-09-08 14:08  joseba

	* [r12484] Added an auxiliary string function

2014-09-08 14:28  joseba

	* [r12485] Moved the variable "OutputDir" to output.F90 file. Thus,
	  this variable is evaluated only once, decreasing also the
	  attempts to create the directory to one.
	  Changed the default value to "output".
	  Both TD and GS output is done in this folder.

2014-09-08 16:20  dstrubbe

	* [r12486] Error messages about opening files can write with
	  messages_fatal rather than to stderr and then separately writing
	  'io_open' with messages_fatal. Also, let's give the error code.

2014-09-09 09:32  joseba

	* [r12487] Corrected test error. Output directory is not a tmp
	  directory. Changed the test accordingly.
	  Improved the variable documentation of "OutputDir"

2014-09-09 12:27  joseba

	* [r12488] Small correction of a variable

2014-09-10 15:07  joseba

	* [r12489] Corrected the convert transform functionality
	  Added the possibility to output to any format the result of the
	  convert transform
	  Deleted unused variables

2014-09-10 15:16  dstrubbe

	* [r12490] Write the actual k-point index (not the one including
	  spin) for periodic spin-polarized systems.

2014-09-10 16:50  dstrubbe

	* [r12491] * Bugfix: the reported entropy and -TS were minus the
	  appropriate values (for smearing, though fixed occupations were
	  correct), and hence the free energy was wrong. Thanks for Chen
	  Huang for this bug report. This bug is a collaboration between me
	  and Miguel: in r4231 he implemented entropy, but was labeled
	  'entropy' was in fact -S, and used in place of -TS. I added the
	  factor of T and did not notice that the 'entropy' was -S not S.
	  Now, smear_calc_entropy indeed returns S as one would expect.
	  * Added more testsuite matches for free energy and entropy.
	  * There were no tests for the Fermi energy!

2014-09-10 19:35  dstrubbe

	* [r12492] Removing unused periodic table. It was added in r2526,
	  and include with 'use' in r2550, but still never actually used in
	  the code.

2014-09-11 15:02  dstrubbe

	* [r12493] Unused arguments and variables.

2014-09-11 20:26  dstrubbe

	* [r12494] The silicon force test is quite lengthy, and is making
	  the valgrind
	  builder time out. I think 1 SCF iteration should be enough to
	  test the
	  force calculation properly, and greatly shorten the test time.

2014-09-15 07:34  joseba

	* [r12495] Encapsulated output directory into the output object.
	  Removed public "outputdir" variable.
	  Changed the default value of the variable to "OutputIterDir" and
	  the default value to "output_iter".
	  Changed the tests, because of this new folder.
	  Small improvements in the documentations.

2014-09-15 12:04  adelgado

	* [r12496] * 'td/td_write': 'subroutine td_write_energy' now prints
	  the electrostatic molecule-solvent interaction energy at each
	  time step in the td energy file.

2014-09-16 13:23  joseba

	* [r12497] Reverted the assert I deleted in r12453
	  Therefore, in convert utility the restart is initialized with the
	  mesh and, now, only once.

2014-09-18 01:31  dstrubbe

	* [r12498] Moving a test with many steps to long-run, because it is
	  timing out the valgrind builder.

2014-09-26 17:29  dstrubbe

	* [r12499] The routine grylmr now computes the gradient of the Ylm
	  only if grylm is provided as an optional argument. Only one of
	  the several places the routines is called is actually trying to
	  use that output.

2014-09-26 18:22  dstrubbe

	* [r12500] Some formatting, and removing explict array bounds for
	  module procedure.

2014-09-26 18:25  dstrubbe

	* [r12501] * Correction to previous commit: the lower bound of the
	  array arguments must still be specified.
	  * Proper punctuation.

2014-09-26 19:00  dstrubbe

	* [r12502] More testing of dipole moment in periodic systems.

2014-09-26 19:03  dstrubbe

	* [r12503] Refactored the construction of the matrix from the
	  evaluation of the determinant for the Berry phase dipole moment,
	  for later use in another context.

2014-09-26 19:49  dstrubbe

	* [r12504] Disabling check for FMA3 since it is not working
	  correctly.

2014-09-26 19:55  dstrubbe

	* [r12505] Clarifying documentation on ylm routines.

2014-09-26 20:38  dstrubbe

	* [r12506] Caveats about magnetic fields and periodic systems.

2014-09-26 20:53  dstrubbe

	* [r12507] Correction to previous commit: logic and documentation
	  for 3D, 1D-periodic case was backwards.

2014-09-26 21:00  dstrubbe

	* [r12508] * Bugfix: Hermite-polynomial orbitals in a periodic
	  system were not correct, because they ignored the loop over
	  periodic copies. For example, for full-potential H, the LCAO
	  eigenvalue was very different if the atom was placed in the
	  center or edge of the box; now it is the same.
	  * Moved repeated identical pointing, allocation, nullification,
	  and deallocation outside a loop, to improve performance.

2014-09-26 21:11  dstrubbe

	* [r12509] * Bugfix: Hermite-polynomial orbitals for
	  LCAOAlternative in a periodic system were not correct, because
	  they ignored the loop over periodic copies.
	  * Comment on derivative for Hermite polynomials.

2014-09-26 21:45  dstrubbe

	* [r12510] Clarifications about default Spacing.

2014-09-27 17:47  dstrubbe

	* [r12511] Fix to enable use of periodic copy routines in fewer
	  than 3D, at least in some cases (now happening after r12508).

2014-09-27 17:50  dstrubbe

	* [r12512] Reclassifying variable CurrentThroughPlane as Output not
	  States.

2014-09-27 22:51  dstrubbe

	* [r12513] Tests for xyz and xsf output in periodic systems.

2014-09-28 14:43  dstrubbe

	* [r12514] Fixing PUSH_SUB.

2014-10-01 22:39  dstrubbe

	* [r12515] Commenting out lines which appear to be debugging output
	  which was temporary but forgotten.

2014-10-01 22:48  dstrubbe

	* [r12516] Bugfix: error messages for CurrentThroughPlane are sent
	  to unit 1, whatever that may be, rather than written to
	  message(1) as appropriate for the following call to
	  messages_fatal(1).

2014-10-01 22:51  dstrubbe

	* [r12517] Making variable OutputInterval refer to OutputIterDir.

2014-10-01 23:14  dstrubbe

	* [r12518] * Bugfix: the directory to contain the file
	  'current-flow' from CurrentThroughPlane was not created
	  beforehand, so the code would crash at that point if it did not
	  already exist.
	  * Clarifications to documentation on CurrentThroughPlane.
	  * Adding CurrentThroughPlane as one of the kinds of output that
	  does not require OutputHow to be set.

2014-10-02 17:14  dstrubbe

	* [r12519] Correcting 'specie' to 'species' in utilities.

2014-10-02 20:11  dstrubbe

	* [r12520] * Clarifications to documentation on
	  CurrentThroughPlane.
	  * Block use for other than 1D, 2D, and 3D.
	  * Removing some lines of a testsuite input file, which would have
	  made it fail with the bug corrected in r12518.

2014-10-02 21:17  dstrubbe

	* [r12521] Avoiding divide-by-zero or assertion failure resulting
	  from an empty grid.

2014-10-02 22:21  dstrubbe

	* [r12522] Beginning generalization of periodic_copy routines to
	  arbitrary dimensions: changing some array sizes to MAX_DIM,
	  documenting size of icell. Also moving nullification into only
	  the condition when it won't get allocated.

2014-10-03 01:52  dstrubbe

	* [r12523] Previous commit caused trouble for dim=4, in use of
	  'product'. Now that is performed only over the relevant
	  dimensions, and stored as a member of the data type.

2014-10-03 02:32  dstrubbe

	* [r12524] Fix to the fix: a finite system has 1 periodic copy, not
	  0.

2014-10-03 03:17  dstrubbe

	* [r12525] Generalization of periodic_copy routines to arbitrary
	  number of dimensions. New algorithm gives identical icell array
	  in 1D, 2D, and 3D, but works in higher ones too.

2014-10-03 16:54  dstrubbe

	* [r12526] Renamed solids -> periodic_copy, to better describe its
	  contents and fit the name of the routines in it.

2014-10-03 18:44  dstrubbe

	* [r12527] Fixing C prototypes to avoid this warning from icc:
	  "old-style parameter list (anachronism)"

2014-10-03 19:07  dstrubbe

	* [r12528] * Explicit casts in liboct_parser to avoid icc warnings
	  like: conversion from "int" to "char" may lose significant bits.
	  * Using unique variable names in liboct_parser to avoid icc
	  warnings: declaration hides variable "c".

2014-10-03 19:35  dstrubbe

	* [r12529] We are unnecessary complicating our link lines by
	  passing the -I flags for Fortran modules, which are not used by
	  the linker. They are only needed for compiling the Fortran source
	  files. AM_FCFLAGS is part of the link line automatically with
	  autotools, but included by hand in the compile line, so I renamed
	  it to FCFLAGS_MODS to put in the compile line, and these things
	  no longer appear in the link line.

2014-10-07 18:47  dstrubbe

	* [r12530] Error message referred specifically to gs but might be
	  called from
	  other CalculationModes.

2014-10-08 16:51  dstrubbe

	* [r12531] For LCAODebug, the Hamiltonian, overlap, and orbital
	  basis files should be closed before the diagonalization, to make
	  sure they get written fully in case there is a crash in the
	  diagonalization part.

2014-10-08 16:53  dstrubbe

	* [r12532] Interfaces for Laguerre polynomials from GSL.

2014-10-08 17:06  dstrubbe

	* [r12533] Removed unnecessary usages of species_pot_m.

2014-10-08 18:22  dstrubbe

	* [r12534] Removing unused routine.

2014-10-08 20:55  dstrubbe

	* [r12535] Bugfix: wrong type for complex single-precision LCAO
	  buffer. This meant that the imaginary part was being discarded. I
	  think the only case in which this would cause problems would be
	  LCAO for spinors. (Due to r9383.)

2014-10-08 21:32  dstrubbe

	* [r12536] Formatting mistake in variable reference.

2014-10-09 20:19  dstrubbe

	* [r12537] Make the option NoPoisson to PoissonSolver match the
	  constant POISSON_NULL and lead to proper output label.

2014-10-09 20:38  dstrubbe

	* [r12538] Added option to use complex spherical harmonics in LCAO
	  (standard approach, not alternative, for now) instead of the real
	  ones we always have been using, in the case that complex
	  wavefunctions are being used.
	  This option, with ForceComplex, is now used in a test.

2014-10-10 19:04  dstrubbe

	* [r12539] A cull of unused arguments and variables.

2014-10-10 20:31  dstrubbe

	* [r12540] * LCAODebug is now implemented for LCAOAlternative, when
	  not parallel in states.
	  * lcao_orbitals is written, for both implementations, at the very
	  beginning.
	  * The loops that assign values to hamiltonian and overlap
	  matrices for LCAOAlternative, not parallel in states, now only
	  handle the upper triangle.

2014-10-10 20:49  dstrubbe

	* [r12541] * Hiding variables used only for LCAODebug.
	  * Optimizing lcao_get_orbital a bit: a temporary array is needed
	  only when we are using complex states but real Ylms.

2014-10-13 14:45  dstrubbe

	* [r12542] Marking complex-scaling with OpenCL as not implemented,
	  since it fails
	  the tests with array out of bounds or segmentation fault.

2014-10-13 19:53  dstrubbe

	* [r12543] Wrappers for evaluating splines into complex arrays.

2014-10-13 21:04  dstrubbe

	* [r12544] Unused module-scope variable.

2014-10-13 21:16  dstrubbe

	* [r12545] * LCAODebug now writes out the orbital functions as
	  well.
	  * Removed unnecessary module usage of output_m.

2014-10-14 00:02  dstrubbe

	* [r12546] * Bugfix: submesh_dotp_matrix in the complex version did
	  not take the complex conjugate. This is at least one reason why
	  LCAO alternative did not work for spinors.
	  * Correcting PUSH/POP's that had a space instead of an
	  underscore.

2014-10-14 00:40  dstrubbe

	* [r12547] * Implemented complex Ylms in alternative LCAO.
	  * Made a test use this feature.
	  * Set lcao%complex_ylms = .false. when states are real, just in
	  case.

2014-10-14 02:24  dstrubbe

	* [r12548] In case a test file does not contain 'Test' (e.g.
	  because it isn't even a real test file), the testsuite Perl
	  script would write a header with its uninitialized $name and say
	  it couldn't find an appropriate executable. Now, it gives an
	  error earlier saying there was no 'Test' tag.

2014-10-14 17:30  dstrubbe

	* [r12549] Bugfix: If unocc used a different mesh from gs (e.g. due
	  to a
	  different states block size), then the wavefunctions and mesh
	  file in
	  the restart directory would be for the unocc mesh, but the old
	  density
	  from gs would remain with the old mesh, and attempt to restart
	  from
	  this would give an inoccrect result due to misinterpretation of
	  the
	  density file. This was causing a test failure for
	  linear_response/01-casida.test
	  on lascar_x86_64_gfortran_cl_nvidia_test, because with OpenCL
	  different states block sizes were indeed used, but not without
	  OpenCL.
	  The solution is to rewrite the density if the mesh changed (or if
	  the
	  density was not present).

2014-10-14 17:43  dstrubbe

	* [r12550] Using new function restart_has_map in a few more places.

2014-10-14 18:37  dstrubbe

	* [r12551] * LCAO (standard) for spec_full_gaussian,
	  spec_full_delta, spec_jelli, and spec_point now uses hydrogenic
	  orbitals rather than rectangular harmonic oscillator
	  wavefunctions. This is much better for the H atom tests (though
	  not necessarily for jellium) and is more consistent with the
	  approach for pseudopotentials: use the known analytic form for
	  the isolated species.
	  * Number of orbitals available for such species is the previous
	  value, plus enough to make a full angular-momentum shell. (Of
	  course, there is really no maximum!)
	  * Small tweaks to tests that will use this new feature.
	  * Removed commented line no longer needed.

2014-10-14 19:49  dstrubbe

	* [r12552] * Removing separate treatment of spec_point, which is
	  just a special case of spec_jelli with radius = 0.5 a.u. (not
	  clearly stated in variable reference anyway). 'spec_point' is now
	  a synonym for 'spec_jelli', and the column with the radius is
	  optional and has default value 0.5.
	  * spec_point now has spec%Z_val = spec%Z rather than 0 as before,
	  which doesn't make any sense to me, and would make that the
	  number of available orbitals was always zero, which is unhelpful.
	  * Renamed 'nn' to more meaningful 'ncols'.

2014-10-14 23:53  dstrubbe

	* [r12553] * Unused argument.
	  * Comment on routine which is not called, but looks like it
	  probably should be (spectrum_hsfunction_ar_end).

2014-10-15 00:05  xavier

	* [r12554] Medium change: Added a new module, gauge_field_force,
	  that contains the function gauge_field_get_force. This change
	  will allow this function use hamiltonian_m.

2014-10-15 00:54  dstrubbe

	* [r12555] Blocking inappropriate calls to submesh_batch routines.

2014-10-15 01:50  dstrubbe

	* [r12556] Implemented hydrogenic orbitals for alternative LCAO,
	  and documented splines in pseudopotentials a little.

2014-10-15 15:49  dstrubbe

	* [r12557] * Adding missing space to message about fingerprint.
	  * Comment about problem with cutoff for LCAO with nonlocal
	  functional.
	  * Consolidated cases for PSPIO and other pseudos.
	  * Number of orbitals is now written for non-pseudo species too.
	  * Fixed default listing for KdotPOccupiedSolutionMethod.

2014-10-15 16:07  dstrubbe

	* [r12558] Renamed submesh_init_sphere -> submesh_init, to make
	  clear that this is the routine that initializes the submesh
	  object, not some part or flavor of it.

2014-10-15 16:13  dstrubbe

	* [r12559] Passing around just space%dim for species_init rather
	  than the whole object, since in some place we may have access
	  only to that value (equal to sb%dim) rather than to a space_t
	  object.

2014-10-15 16:22  dstrubbe

	* [r12560] Some slaves are failing this test after introduction of
	  hydrogenic orbitals for LCAO: allowing more eigensolver
	  iterations should fix it.

2014-10-17 19:07  dstrubbe

	* [r12561] Caveat about LCAOAlternative in periodic system.

2014-10-17 19:41  dstrubbe

	* [r12562] Moving pcm.F90 to src/hamiltonian and removing src/pcm.
	  Since there is only one file there isn't much justification for a
	  whole directory. If there become many PCM files in the future, it
	  can be recreated.

2014-10-17 20:44  xavier

	* [r12563] Small change: There is no need to call every combination
	  of optional arguments. A non-present optional argument can be
	  safely passed as an optional argument in a call.

2014-10-17 21:06  xavier

	* [r12564] Small change: Added the option of applying the
	  Hamiltonian without setting the boundary conditions.

2014-10-18 23:40  dstrubbe

	* [r12565] Sternheimer for periodic systems is no longer
	  experimental. Any concerns have been fixed years ago as far as I
	  know.

2014-10-20 17:42  dstrubbe

	* [r12566] Since pseudopotentials are only meaningful in 3D,
	  removed useless use of MAX_DIM in a few places for projectors.

2014-10-20 18:45  xavier

	* [r12567] Medium change: Implemented an alternative calculation of
	  the current
	  for the time-dependent propagation that requires the application
	  of
	  the Hamiltonian instead of the gradient.

2014-10-20 23:56  dstrubbe

	* [r12568] Vectorizing rkb_projector_init, and removing some
	  unnecessary intermediate variables.

2014-10-21 01:35  dstrubbe

	* [r12569] * species_nl_projector now uses sm%x(:, 0) instead of
	  calculating r.
	  * spline_eval_vec is used.

2014-10-21 18:05  xavier

	* [r12570] Small change: changed the order of a member in the
	  poisson_t object to avoid an internal compiler error (ICE) in the
	  IBM compiler.

2014-10-21 18:26  xavier

	* [r12571] Small change: another member reorder, to make the IBM
	  compiler happy.

2014-10-21 18:28  xavier

	* [r12572] Small change: Another fix for the IBM compiker, this one
	  is our fault. Fortran and C functions should not have the same
	  name, otherwise they can conflict in case the Fortran compiler
	  does not add any decorations.

2014-10-21 22:59  xavier

	* [r12573] Small change: Fixed compilation of io_binary.c broken in
	  a previous commit.

2014-10-23 00:59  xavier

	* [r12574] Medium change: Support for Blue Gene/Q vectorial
	  instructions.

2014-10-23 01:39  dstrubbe

	* [r12575] * The spin-orbit tests were failing on tigger due to
	  confusion between np and np_part of submesh in a vector
	  assignment. With bounds it works.
	  * Removed unused variables.

2014-10-23 16:37  dstrubbe

	* [r12576] Unused variables.

2014-10-23 17:53  xavier

	* [r12577] Bugfix: The random_seed() function used to select the
	  recipe uses /dev/random, which may block the read if there is not
	  enough entropy. This happens in the Blue Gene/Q. I am switching
	  the code to use /dev/urandom that does not block.

2014-10-23 22:57  dstrubbe

	* [r12578] Renaming variables in accordance with usage elsewhere in
	  the code: iorb counts a total number of orbitals; ii is the
	  principal quantum number in a particular species.

2014-10-24 18:03  dstrubbe

	* [r12579] * species_get_orbital routines now take i, l, m quantum
	  numbers instead of the orbital index. This allows asking for
	  orbitals other than the ones set up for LCAO.
	  * species_get_iwf_radius takes i quantum number instead of the
	  orbital index, since that is the only one it depends on (and not
	  even that for harmonic-oscillator orbitals).
	  * Assertions check that the principal quantum number is in the
	  available range for pseudopotentials.
	  * A little more documentation.

2014-10-24 23:45  xavier

	* [r12580] Small change: OpenMP parallelization and operation count
	  for the
	  application of the phase in periodic systems.

2014-10-24 23:46  xavier

	* [r12581] Small change: Improvement of the vectorization for the
	  Blue Gene/Q.

2014-10-25 00:41  xavier

	* [r12582] Bugfix: The header of the files generated by the
	  dielectric function utility should be a comment.

2014-10-25 02:21  xavier

	* [r12583] Small change: More openmp parallelization.

2014-10-26 16:07  xavier

	* [r12584] Small change: OpenMP parallelization of the projector
	  code.

2014-10-27 03:07  xavier

	* [r12585] Medium changes:
	  - OpenMP parallelization of batch_get_state.
	  - New function batch_mul that multiplies a batch by the contents
	  of an array.

2014-10-27 03:12  xavier

	* [r12586] Medium change: the calculation of the current using the
	  Hamiltonian is done in batch mode.

2014-10-27 17:36  dstrubbe

	* [r12587] Create the temporary directory path for testsuite if it
	  does not exist.

2014-10-27 18:20  xavier

	* [r12588] Small change: Trying to make the intel compiler happy to
	  avoid a segmentation fault with OpenMP.

2014-10-27 21:14  dstrubbe

	* [r12589] * Round up when choosing number of orbitals to
	  initialize for non-pseudo species, and always give at least 5.
	  * Message about number of orbitals in species_init should obey
	  'print_info' variable.
	  * New routine to initialize a delta species by hand.
	  * Documentation and formatting.

2014-10-28 01:03  xavier

	* [r12590] Small change: Apparently the Intel compiler has problems
	  with foralls inside OpenMP regions. Modified some code to avoid
	  the problem.

2014-10-28 01:28  xavier

	* [r12591] Medium change: When a test execution fails, print the
	  last 20 lines of output to the terminal.

2014-10-28 18:26  xavier

	* [r12592] Medium change: The calculation of the current, when
	  required, is now
	  done in the calculation of the Kohn-Sham potential (as it is done
	  for
	  the density).

2014-10-28 18:32  xavier

	* [r12593] Small change: Minor improvements to my last commit:
	  - PUSH_SUB/POP_SUB.
	  - Removed unused variable.

2014-10-28 18:38  xavier

	* [r12594] Small change: Removed the wrong factors from the
	  calculation of the current.

2014-10-28 23:10  xavier

	* [r12595] Medium change: The "force" of the vector potential is
	  calculated from the current stored in st.

2014-10-28 23:23  xavier

	* [r12596] Medimum changes:
	  - gauge_field_get_force now can take less arguments.
	  - The gauge_field_force_m module is no longer needed.

2014-10-28 23:36  xavier

	* [r12597] Medium change: Removed the XCTailCorrection feature, I
	  think this has never been used and it is not tested.

2014-10-29 01:01  xavier

	* [r12598] Small change: Removed unnecessary variable.

2014-10-29 17:56  xavier

	* [r12599] Bugfix: Check that the phase is allocated before using
	  it in the calculation of the current.

2014-10-29 22:27  xavier

	* [r12600] Small change: Simplified an openmp region to make the
	  Intel compiler happy. This might solve the problem with the
	  mauchly ifort openmp buildbot.

2014-10-29 22:31  xavier

	* [r12601] Small change: The RDMFT test is to long for make check.
	  Now is part of the long-run tests.

2014-10-30 14:21  joseba

	* [r12602] Trying to solve the error with the partitions, following
	  David's recommendations:
	  - Changed the reduce to include the result in all the processes
	  - Deallocated matrices that they weren't

2014-10-30 14:59  micael

	* [r12603] Added the possibility to calculate the power spectrum of
	  the dipole moment to the oct-propagation_spectrum utility.

2014-10-30 15:01  joseba

	* [r12604] Added a temporary variable to suppress valgrind error:
	  "Source and destination overlap in memcpy"
	  

2014-10-30 15:25  micael

	* [r12605] One file was missing from the tarball.

2014-10-30 16:20  xavier

	* [r12606] Small change: More OpenMP changes for the Intel
	  compiler.

2014-10-30 23:49  xavier

	* [r12607] Bugfixes:
	  - The indexes for the phase array were wrong when k-point
	  parallelization is used.
	  - The gradient should be calculated even when there are no phases
	  to apply.

2014-10-31 17:52  dstrubbe

	* [r12608] Removing some PUSH/POP's from routines called too
	  frequently (at least by open boundaries runs).

2014-10-31 17:58  dstrubbe

	* [r12609] Restart routines should not call MPI_Bcast or
	  MPI_Barrier when we have MPI but are running with only one
	  process, or there may be 'invalid communicator' errors.

2014-11-04 09:25  adelgado

	* [r12610] - 'hamiltonian/pcm.F90': New subroutine
	  ('pcm_elect_energy') to calculate the solute-solvent
	  electrostatic interaction energy was added, obsolete subroutines
	  were deleted. The subroutine 'pcm_pot_rs' was modified to
	  generate also the standard PCM field in terms of point charges
	  when the variable 'SmearingFactor=0'. The default is
	  'SmearingFactor=1' to regularize possible Coulomb singularities
	  at grid points infinitesimally close to the tesserae
	  representative points.
	  
	  - 'system/energy_calc.F90': the subroutine 'pcm_elect_energy' is
	  called to calculate the interaction energy. Independent
	  contribution to the interaction energy are printed to 'pcm_info'
	  file. The total energy was defined accordingly to
	  'pcm_elect_energy'.
	  
	  - 'system/v_ks.F90': The term 'hm%energy%pcm_corr' entering the
	  final expression for the total energy is evaluated. The
	  estimation of the total electronic molecule's charge in terms of
	  the apparent charges is defined with the proper sign.
	  
	  - 'hamiltonian/energy.F90': new variables are defined inside
	  'energy_t' to store the independent contributions to the
	  electrostatic interaction energy.
	  
	  - 'hamiltonian/hamiltonian.F90': The estimation of the total
	  nuclear molecule's charge in terms of the apparent charges is
	  defined with the proper sign.
	  
	  - 'td/td_write.F90': The time-dependent electrostatic interaction
	  energy is computed in terms of the individual contributions as
	  defined in 'energy_t'.

2014-11-04 09:42  adelgado

	* [r12611] - 'hamiltonian/pcm.F90': using 'io_open' to assign a
	  file unit for 'pcm_matrix_gamess.out'.

2014-11-05 16:49  dstrubbe

	* [r12612] Clarifications about TDDeltaStrengthMode.

2014-11-05 17:56  adelgado

	* [r12613] - 'hamiltonian/pcm.F90': The distances between the
	  tesserae and the grid points used to generate the PCM potential
	  in real-space are calculated only once and stored in the array
	  'sr_dist'. The latter allows to avoid calling subroutine 'mesh_r'
	  each time 'v_pcm' is generated saving a significant amount of
	  time.

2014-11-07 19:23  xavier

	* [r12614] Medium change: Added a variable to control how the
	  current is calculated. This is mostly for development.

2014-11-10 16:30  dstrubbe

	* [r12615] Unused variables and arguments.

2014-11-11 08:37  joseba

	* [r12616] If the LibISF solver is used, the cube%fft object is not
	  defined, so an auxiliary function is needed to check the FFT
	  library.

2014-11-11 13:30  joseba

	* [r12617] First step to correct states parallelization with
	  LibISF:
	  all the functions of LibISF must be defined above cube and its
	  functions

2014-11-11 22:47  dstrubbe

	* [r12618] Recentering and slightly loosening tolerance on a test,
	  since it recently failed on hbar (with discrepancy 0.0202).

2014-11-12 01:34  xavier

	* [r12619] Implemented the TDOutput of the total current.

2014-11-12 01:43  xavier

	* [r12620] Fixed compilation problem in my last commit.

2014-11-14 22:31  xavier

	* [r12621] Added some experimental ways of calculating the current
	  density.

2014-11-14 22:44  xavier

	* [r12622] Moved the qshep module to the src/math directory, since,
	  if I am not
	  mistaken, this interface is not part of qshep but was written by
	  Alberto.

2014-11-14 22:52  xavier

	* [r12623] Adapted the qshep interface to Octopus name conventions.

2014-11-14 22:57  xavier

	* [r12624] Fixed a name colision between variables and functions in
	  a previous commit.

2014-11-16 00:32  dstrubbe

	* [r12625] * Clarifying documentation.
	  * Adding PUSH/POP's.
	  * Enforcing experimental nature of options.

2014-11-16 00:38  dstrubbe

	* [r12626] Enforcing some more Octopus conventions in
	  src/math/qshep.F90.

2014-11-16 01:21  dstrubbe

	* [r12627] PUSH/POP and svn:keywords for qshep module.

2014-11-16 02:28  dstrubbe

	* [r12628] Mistaken PUSH/POP.

2014-11-16 18:34  dstrubbe

	* [r12629] SAFE_ALLOCATE and SAFE_DEALLOCATE for qshep module.

2014-11-17 18:55  xavier

	* [r12630] Replaced use of mesh%vol_pp(1) by mesh%volume_element.

2014-11-20 23:05  dstrubbe

	* [r12631] More assertions to track down the bug causing occasional
	  crashes in partition_get_np_local.

2014-11-22 16:12  adelgado

	* [r12632] - The independent contributions to the solute-solvent
	  electrostatic ineraction are printed in the file
	  'pcm/pcm_info.out'. This can be pretty useful to check PCM
	  results and its stability during ground state and TD
	  calculations. I have changed the format to make the file
	  compatible with gnuplot.

2014-11-23 21:51  adelgado

	* [r12633] - Now the electronic and nuclear charges of the
	  molecule, calculated from the total polarization charges, are
	  printed in pcm_info file when the total energy is calculated.

2014-11-24 16:40  joseba

	* [r12634] Added an allocation of a dummy argument. Otherwise, it
	  might crash.

2014-11-24 17:36  dstrubbe

	* [r12635] More info on Sternheimer convergence criteria.

2014-11-25 09:14  joseba

	* [r12636] With this change, combined parallelization of domains
	  and states, and also independent parallelization work with LibISF
	  Poisson solver.
	  
	  Note: still failing PFFT solver with only states parallelization.

2014-11-26 10:57  joseba

	* [r12637] Ensure that it is a parallel execution to run the
	  parallel version of LibISF

2014-11-27 13:23  joseba

	* [r12638] Indentation

2014-12-04 09:02  joseba

	* [r12639] Added the error call, forgotten or mistakenly deleted

2014-12-04 10:08  joseba

	* [r12640] mesh_cube_parallel_map is initialized only once with
	  LibISF and always if the cube is parallel.
	  Assigned the MPI group to LibISF before it is initialized

2014-12-04 10:14  joseba

	* [r12641] With this change parallelization in states should work
	  with PFFT and LibISF Poisson solvers

2014-12-05 11:07  joseba

	* [r12642] Ensured that the domain parallelization is initialized
	  to access the vp structure in Convert Transform utility
	  Deleted unused variables

2014-12-05 14:32  joseba

	* [r12643] Added profiling regions to the in principle most time
	  consuming parts in Convert Transform

2014-12-06 10:58  joseba

	* [r12644] Implemented a much more efficient approach for the
	  Convert FFT transform utility. With this change 'ConvertReadSize'
	  can be choosen, to select how many points will be read at once

2014-12-08 17:12  dstrubbe

	* [r12645] Adding a forgotten call to messages_fatal, and typos.

2014-12-09 00:35  xavier

	* [r12646] Added an object to perform interpolations.

2014-12-09 19:47  xavier

	* [r12647] Renamed the frozen specific interpolation routines to
	  interpolation_frozen.

2014-12-09 19:59  xavier

	* [r12648] Improvements in the interface of the interpolation
	  object.

2014-12-09 20:18  dstrubbe

	* [r12649] * It makes more sense to write "mesh_r" output into a
	  file called "mesh_r" instead of just "r", and in the static
	  directory not the exec directory.
	  * Two other small improvements to documentation.

2014-12-09 21:11  dstrubbe

	* [r12650] Output = mesh_r is now handled in the output module, not
	  in system_init where it surprisingly was located.

2014-12-10 19:06  dstrubbe

	* [r12651] More assertions, and DebugLevel = 1, for trying to find
	  the bug in the partitioning.

2014-12-11 00:01  xavier

	* [r12652] I will not need this interpolation routines. Since
	  they have not being tested enough I prefer to remove them.

2014-12-11 00:02  xavier

	* [r12653] Implemented an efficient scheme for interpolation on the
	  grid. For the
	  moment it only supports 3D using trilinear interpolation, but
	  "extension" to 2D and 1D should be fairly simple.

2014-12-11 08:04  joseba

	* [r12654] Added Id svn property with "svn propset svn:keywords
	  'Id' [file]" to the newly created files

2014-12-12 22:47  xavier

	* [r12655] Small change: FLOAT literals instead of integer ones.

2014-12-16 01:27  xavier

	* [r12656] There is no need to stop the calculation if the restart
	  cannot be
	  read, just start from scratch.

2014-12-16 02:54  xavier

	* [r12657] - Implemented interpolation for 1d and 2d, and fix a bug
	  in 3d interpolation.
	  - Implemented a TestMode in oct-test for the interpolation
	  routines.

2014-12-16 07:02  xavier

	* [r12658] Implemented a regression test for the mesh
	  interpolation.

2014-12-16 18:54  xavier

	* [r12659] - Modified the operation order for 2d interpolation.
	  - Added a check for domain parallelization that is not supported
	  for the moment.

2014-12-19 14:30  theophilou

	* [r12660] Change rdmft tests, change rdmft initial orbitals,
	  cleaning up

2014-12-19 15:20  theophilou

	* [r12661] Change Makefile.am to include new rdmft test, setting
	  loop variable to integer

2014-12-19 19:04  dstrubbe

	* [r12662] Typos and PUSH/POPs.

2014-12-23 11:36  theophilou

	* [r12663] getting rid of psi2 type states in scf_rdmft not needed,
	  change the maximum number of multid_minimize in rdmft_occ, change
	  print statement

2014-12-24 09:00  theophilou

	* [r12664] correcting order of indices of array st%dpsi in
	  scf_rdmft, change default energy convergence for rdmft, change
	  print statements

2014-12-29 19:28  xavier

	* [r12665] Removed single quotes from a comment (variable
	  documentation).

2015-01-06 20:15  dstrubbe

	* [r12666] r12664 changed a variable default for RDMFT without
	  updating the documentation. Removed redundant default
	  specifications from variable descriptions.

2015-01-06 20:25  dstrubbe

	* [r12667] Simplifying code for exponential in RDMFT.

2015-01-06 21:50  dstrubbe

	* [r12668] Comment typos.

2015-01-06 22:02  dstrubbe

	* [r12669] A change of intent is needed for MPI_File_close to be
	  accepted by the MPI module of OpenMPI 1.7.5.

2015-01-06 22:29  dstrubbe

	* [r12670] * Minor bugfix: for other than 3D, the infrared
	  intensity last column should divide by the number of dimensions,
	  not just 3.
	  * Removing unnecessary temporary variable 'factor'.
	  * Consolidating applications of sqrt for vibrations_norm_factor.

2015-01-07 10:11  micael

	* [r12671] Fixed missing exponent in the documentation of gaussian
	  TD functions.

2015-01-07 10:15  micael

	* [r12672] * ADSIC with spin was not correct: the correction should
	  be calculated from a fully polarized density.
	  * Marked ADSIC not implemented with non-collinear spin.

2015-01-07 10:31  micael

	* [r12673] * Implemented ADSIC fxc correction. At the moment it
	  only works for the spin-unpolarized case.

2015-01-07 16:55  dstrubbe

	* [r12674] Organizing ComplexScaling variables into a subsection in
	  the variable reference.

2015-01-07 18:40  dstrubbe

	* [r12675] A more informative error message.

2015-01-07 19:15  dstrubbe

	* [r12676] Caveat on symmetries and finite-difference vibrational
	  modes.

2015-01-07 19:18  dstrubbe

	* [r12677] When we are not reducing k-points by symmetries, we
	  should still initialize the arrays for symmetry operations per
	  k-point.

2015-01-07 21:30  dstrubbe

	* [r12678] * Inserting a minus sign in the second-order k.p
	  perturbation for consistency, so that it is now the second
	  derivative with respect to (ik) not just k, like we do in first
	  order.
	  * Some comments.

2015-01-08 15:10  jjornet

	* [r12679] · Bug fixed when writing the transition densities using
	  MPI environment.

2015-01-08 17:46  dstrubbe

	* [r12680] * Adding output of transition densities to Casida test,
	  to check for problem just corrected by Quim.
	  * Correcting and amplifying documentation on
	  CasidaTransitionDensities.

2015-01-08 21:04  dstrubbe

	* [r12681] More compact formulation of finite-system ion-ion
	  contribution to dynamical matrix.

2015-01-13 19:09  dstrubbe

	* [r12682] Calls to restart_init to load data from a previous
	  calculation in a different directory should be following by
	  checking the error status, or else if the directory doesn't
	  exist, the call to restart_open_dir will cause an assertion
	  failure (.not. restart%skip).

2015-01-13 19:58  dstrubbe

	* [r12683] Removed useless variables.

2015-01-14 17:47  dstrubbe

	* [r12684] Suppressing warnings about possible use of uninitialized
	  variables.

2015-01-14 18:42  dstrubbe

	* [r12685] Fix to potential bug: variable 'found' was not
	  initialized, and so error message might not be triggered even
	  when the search failed.

2015-01-14 18:54  dstrubbe

	* [r12686] * _end subroutines should have the argument be
	  intent(inout).
	  * Error message for not-implemented interpolation case, and
	  suppressing warning about result not being initialized.
	  * Unused variable.

2015-01-15 16:01  dstrubbe

	* [r12687] More detailed checking of batch allocation status.

2015-01-15 21:52  dstrubbe

	* [r12688] Adding calls to messages_experimental for propagators
	  which the variable documentation says are experimental.

2015-01-15 22:03  dstrubbe

	* [r12689] Indentation, and emacs syntax highlighting blocks.

2015-01-19 16:20  joseba

	* [r12690] Made a read or write of a file not to crash the
	  execution. Two useful
	  examples:
	  
	  1.- Reading can happen that a restart/td has been created, but
	  nothing
	  written. When trying to restart there, without this change fails.
	  
	  2.- Writing can fail due to a I/O error, which can be solved the
	  next
	  time a restart is going to be saved.

2015-01-19 22:41  dstrubbe

	* [r12691] Making sure a variable is initialized, and that if none
	  of the cases in a select matches an error occurs.

2015-01-20 18:02  dstrubbe

	* [r12692] * Documentation.
	  * Removing unnecessary variable.

2015-01-20 18:14  dstrubbe

	* [r12693] * Bugfix: CasidaHermitianConjugate could give incorrect
	  results (normal mode) or a segmentation fault (for triplet or
	  forces), due to writing the wrong variable in a line. Now it is
	  corrected.
	  * Removed meaningless 'else' line.

2015-01-20 18:34  dstrubbe

	* [r12694] Let's write a warning if unusable parallelization
	  strategies are specified.

2015-01-20 19:23  dstrubbe

	* [r12695] * Disabling k-point parallelization for Casida. This
	  could be implemented, but hasn't been, and will cause a
	  segmentation fault.
	  * Creating new routine to unset a parallelization strategy.

2015-01-20 19:52  dstrubbe

	* [r12696] Refactoring Casida a bit to pave the way for
	  implementation of fractional occupations.

2015-01-20 22:44  xavier

	* [r12697] Two functions that do not really need to receive a
	  grid_t object.

2015-01-20 22:44  xavier

	* [r12698] Missing change in my last commit.

2015-01-20 22:47  xavier

	* [r12699] * Added an output_end function.
	  
	  * The current output now uses the new current calculator. This
	  means now
	  it will include corrections due to pseudopotentials.

2015-01-20 22:52  dstrubbe

	* [r12700] Implementation of Casida with occupations. Works for
	  integer occupations, not yet tested with partial occupations.

2015-01-21 16:56  dstrubbe

	* [r12701] * Capitalization.
	  * PUSH/POP.
	  * _end routine should have intent(inout).

2015-01-21 20:48  dstrubbe

	* [r12702] * Species representing all-electron atoms should
	  definitely be included in the Ewald sums too.
	  * Testing for equality of FLOAT's is not recommended.

2015-01-22 14:57  theophilou

	* [r12703] Change default convergence energy, default number of
	  iterations for multidimensional minimization, print statements

2015-01-22 15:19  joseba

	* [r12704] Enabled the emacs mode (a line was missing)

2015-01-22 15:24  joseba

	* [r12705] More files: Enabled the emacs mode (a line was missing)

2015-01-22 18:07  dstrubbe

	* [r12706] Correcting sign for expectation value of electric field
	  on states.

2015-01-22 18:26  dstrubbe

	* [r12707] Removing assertion to allow Biot-Savart test to pass,
	  after use of new current routine in r12699. Xavier, please
	  confirm whether spin is actually implemented (correctly) or not.

2015-01-23 12:17  dstrubbe

	* [r12708] Unused variables.

2015-01-23 12:35  dstrubbe

	* [r12709] * Removed 'target' attribute from an argument which is
	  not pointed at.
	  * Standard formatting of argument declarations.

2015-01-23 17:21  dstrubbe

	* [r12710] Bugfix: wrong spin-index in Casida. Could have affected
	  spin-polarized calculations in which the two spins were not
	  equivalent. Introduced in r11387.

2015-01-23 17:40  dstrubbe

	* [r12711] Clearer variable names in Casida.

2015-01-25 11:01  joseba

	* [r12712] Make sure that the vprev files are only written once

2015-01-25 14:48  jrfsousa

	* [r12713] json.F90:
	  
	  Adding new public procedures foremost json_copy and json_hash

2015-01-25 15:19  jrfsousa

	* [r12714] oct_f.c:
	  
	  Adds support for dirname, basename and realpath.
	  
	  loct.F90:
	  
	  Adds the procedures loct_dirname, loct_basename and
	  loct_realpath.
	  
	  path.F90:
	  
	  New module for improved path handling.
	  
	  Makefile.am:
	  
	  Reflects the changes to the building step.

2015-01-25 21:04  acastro

	* [r12715] Added a new routine to compute derivatives numerically,
	  the "Ridders" algorithm. It is more precise that the one
	  that is implemented in the GSL library.

2015-01-25 21:09  dstrubbe

	* [r12716] Setting svn:keywords on new file.

2015-01-25 21:17  acastro

	* [r12717] Corrected a bug that affected the "gstransformation"
	  target
	  for many-electron sysmtes.
	  
	  Removed a single ' character in a comment, that may be a
	  problem for some compilers.

2015-01-25 21:31  acastro

	* [r12718] Bug fix: the expl_runge_kutta4 propagator was not
	  working
	  properly when going backwards and using an imaginary absorbing
	  potential.

2015-01-25 22:03  jrfsousa

	* [r12719] symmetries.F90:
	  
	  Added SPEC_FROZEN species to the non-spherically symmetric
	  species list.
	  
	  Added a short circuit logic step to the loop.

2015-01-25 22:05  jrfsousa

	* [r12720] species.F90:
	  
	  Added species type to json input/output

2015-01-26 17:11  dstrubbe

	* [r12721] Updating reference values, and reducing precision, for
	  RDMFT in light of r12703.

2015-01-26 17:16  dstrubbe

	* [r12722] Documentation file for testsuite.

2015-01-26 17:16  dstrubbe

	* [r12723] Typos.

2015-01-26 22:33  dstrubbe

	* [r12724] Removing command-line option from testsuite script, to
	  run in parallel. It did nothing. (It was added in r2338, and
	  superseded some time later when the Programs tag was added to the
	  test files, which now controls whether octopus or octopus_mpi is
	  run.)

2015-01-26 22:35  dstrubbe

	* [r12725] Set svn:keywords on file.

2015-01-27 11:31  joseba

	* [r12726] Adaption of the API to the new bigDFT 1.7.6

2015-01-27 13:38  micael

	* [r12727] ., configure.ac: Branching current trunk for the
	  upcoming release.

2015-01-30 21:26  dstrubbe

	* [r12791] src/system/current.F90: Backport of 12733 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12733 | xavier | 2015-01-27 12:25:15 -0500 (Tue, 27 Jan 2015) |
	  3 lines
	  
	  Fixed calculation of the current for spin polarized calculations.
	  
	  
	  ------------------------------------------------------------------------

2015-02-04 16:50  dstrubbe

	* [r12819] src/system/eigensolver.F90: Backport of 12799 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12799 | dstrubbe | 2015-01-30 18:17:55 -0500 (Fri, 30 Jan 2015)
	  | 3 lines
	  
	  * Earlier and clearer error-handling when trying to use ARPACK or
	  FEAST eigensolver when these libraries were not linked.
	  Otherwise, you would just get the listing of the variable
	  reference, which is pretty confusing since Eigensolver = arpack
	  and feast are listed there.
	  * Removing commented includes.
	  
	  ------------------------------------------------------------------------

2015-02-06 21:55  dstrubbe

	* [r12871] src/main/main.F90: Backport of 12870 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12870 | dstrubbe | 2015-02-06 16:53:20 -0500 (Fri, 06 Feb 2015)
	  | 2 lines
	  
	  Removing non-existent CalculationMode = td_transport from
	  documentation. This was merged into the open systems code in
	  2008!
	  
	  ------------------------------------------------------------------------

2015-02-07 01:12  xavier

	* [r12881] src/td/pes_mask.F90: Backport of [12880]: Parsed
	  variables were not converted to the proper
	  units.

2015-02-07 20:35  dstrubbe

	* [r12896] src/ions/symmetries.F90: Backport of 12879 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12879 | dstrubbe | 2015-02-06 19:24:00 -0500 (Fri, 06 Feb 2015)
	  | 2 lines
	  
	  If symmetry-finding with spglib fails, write the coordinates, to
	  help diagnose the problem.
	  
	  ------------------------------------------------------------------------

2015-02-09 17:23  dstrubbe

	* [r12917] src/grid/partition.F90: Backport of 12832 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12832 | joseba | 2015-02-05 05:47:24 -0500 (Thu, 05 Feb 2015) |
	  3 lines
	  
	  Added a initialization of the part_global matrix for the
	  processes that don't read the partition without MPI2. Still
	  working to guess what happens with the partition error.
	  
	  
	  ------------------------------------------------------------------------

2015-02-09 17:25  dstrubbe

	* [r12918] src/grid/partition.F90: Backport of 12905 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12905 | dstrubbe | 2015-02-08 14:32:24 -0500 (Sun, 08 Feb 2015)
	  | 2 lines
	  
	  Bugfix: An overzealous assertion in r12651 breaks parallelism in
	  domains with MPI1. (Do we not have any MPI1 builders...?)
	  
	  ------------------------------------------------------------------------

2015-02-09 17:26  dstrubbe

	* [r12919] src/sternheimer/kdotp.F90: Backport of 12830 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12830 | dstrubbe | 2015-02-04 22:00:57 -0500 (Wed, 04 Feb 2015)
	  | 2 lines
	  
	  Bugfix: wrong indices in 2nd-order kdotp wavefunction
	  calculation, as pointed out by Irina.
	  
	  ------------------------------------------------------------------------

2015-02-09 17:29  dstrubbe

	* [r12920] src/grid/mesh_partition.F90: Backport of 12916 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12916 | dstrubbe | 2015-02-09 12:17:08 -0500 (Mon, 09 Feb 2015)
	  | 2 lines
	  
	  Bugfix: Printing the partition (as from DebugLevel >=1) failed if
	  compiled with --max-dim=4 or larger due to nadequate format
	  statements.
	  
	  ------------------------------------------------------------------------

2015-02-09 17:39  dstrubbe

	* [r12921] configure.ac, src/system/output_etsf_inc.F90,
	  testsuite/periodic_systems/09-etsf_io.test: Backport of 12909 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12909 | dstrubbe | 2015-02-08 22:59:29 -0500 (Sun, 08 Feb 2015)
	  | 2 lines
	  
	  The ETSF_IO test was failing with a small size discrepancy
	  because of the change in the code name for this version in
	  r12845, which is written into the file via PACKAGE_STRING. I have
	  updated the values and added comments about this surprising fact.
	  
	  ------------------------------------------------------------------------
	  
	  With an adaptation to the size of the string '5.0.x' instead of
	  'tetricus'.

2015-02-09 19:06  dstrubbe

	* [r12923] src/math/math.F90: Backport of 12824 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12824 | dstrubbe | 2015-02-04 17:00:17 -0500 (Wed, 04 Feb 2015)
	  | 2 lines
	  
	  Suppressing warning about unterminated apostrophe.
	  
	  ------------------------------------------------------------------------

2015-02-09 19:06  dstrubbe

	* [r12924] testsuite/oct-run_testsuite.sh.in: Backport of 12922 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12922 | dstrubbe | 2015-02-09 14:05:58 -0500 (Mon, 09 Feb 2015)
	  | 2 lines
	  
	  Bugfix: the -g and -q options for giving a comma-separated list
	  of test groups worked only for one or two groups, but not more.
	  Making a sed command act globally solves the problem.
	  
	  ------------------------------------------------------------------------

2015-02-10 07:29  micael

	* [r12933] m4/isf.m4: Backport of 12731 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12731 | joseba | 2015-01-27 17:54:35 +0100 (Tue, 27 Jan 2015) |
	  3 lines
	  
	  Updated the documentation to the change of the ISF version from
	  BigDFT
	  
	  
	  ------------------------------------------------------------------------

2015-02-10 15:14  dstrubbe

	* [r12936] src/basic/profiling.F90: Backport of 12925 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12925 | dstrubbe | 2015-02-09 15:02:29 -0500 (Mon, 09 Feb 2015)
	  | 2 lines
	  
	  Bugfix: a race condition in creating a directory could make
	  ProfilingMode = prof_memory_full in parallel crash with failure
	  to open a file. The debugging tools themselves need debugging...
	  
	  ------------------------------------------------------------------------

2015-02-10 15:16  dstrubbe

	* [r12937] scripts/oct-check_deallocs: Backport of 12932 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12932 | dstrubbe | 2015-02-09 23:17:44 -0500 (Mon, 09 Feb 2015)
	  | 6 lines
	  
	  Bugfixes to old script oct-check_deallocs from Miguel (r5332):
	  * The filename needs to be removed from the variable name, or
	  deallocations in a different file from the allocation are not
	  counted.
	  * The $alloc and $dealloc should be initialized to zero for each
	  key, or else the final summary just says blank instead of zero if
	  a variable was never allocated or never deallocated.
	  * List a variable only under allocs not deallocated or the
	  reverse, but not both.
	  * Added a bit of documentation.
	  
	  ------------------------------------------------------------------------

2015-02-10 15:24  dstrubbe

	* [r12939] src/basic/oct_f.c: Backport of 12793 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12793 | dstrubbe | 2015-01-30 16:59:01 -0500 (Fri, 30 Jan 2015)
	  | 16 lines
	  
	  Fixing these warnings from clang C compiler, due to r12714:
	  {{{
	  oct_f.c:179:6: warning: implicit declaration of function
	  'dirname' is invalid in C99 [-Wimplicit-function-declaration]
	  dn=dirname(fn);
	  ^
	  oct_f.c:179:5: warning: incompatible integer to pointer
	  conversion assigning to 'char *' from 'int';
	  dn=dirname(fn);
	  ^~~~~~~~~~~~
	  oct_f.c:194:6: warning: implicit declaration of function
	  'basename' is invalid in C99 [-Wimplicit-function-declaration]
	  bn=basename(fn);
	  ^
	  oct_f.c:194:5: warning: incompatible integer to pointer
	  conversion assigning to 'char *' from 'int';
	  bn=basename(fn);
	  ^~~~~~~~~~~~~
	  }}}
	  
	  ------------------------------------------------------------------------

2015-02-10 15:55  dstrubbe

	* [r12941] src/basic/profiling.F90: Backport of 12928 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12928 | xavier | 2015-02-09 17:02:55 -0500 (Mon, 09 Feb 2015) |
	  3 lines
	  
	  Fixed compilation in serial.
	  
	  
	  ------------------------------------------------------------------------

2015-02-11 09:35  joseba

	* [r12954] m4/isf.m4: Backport of 12935 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12935 | joseba | 2015-02-10 15:40:09 +0100 (ar., 10 ots 2015) |
	  3 lines
	  
	  libwrappers libflib and libyaml are necessary to compile the
	  external new ISF
	  
	  
	  ------------------------------------------------------------------------

2015-02-11 22:16  dstrubbe

	* [r12965] src/grid/mesh_partition.F90,
	  src/hamiltonian/hamiltonian_base.F90,
	  src/system/eigen_cg_inc.F90: Backport of 12942 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12942 | dstrubbe | 2015-02-10 10:56:17 -0500 (Tue, 10 Feb 2015)
	  | 2 lines
	  
	  Fixing some memory leaks, identified via ProfilingMode =
	  prof_memory_full and oct-check_deallocs.
	  
	  ------------------------------------------------------------------------

2015-02-11 22:17  dstrubbe

	* [r12966] src/poisson/poisson_isf.F90, src/scf/lcao_inc.F90,
	  src/system/forces_inc.F90: Backport of 12949 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12949 | dstrubbe | 2015-02-10 22:02:12 -0500 (Tue, 10 Feb 2015)
	  | 3 lines
	  
	  * Memory leaks in LCAO alternative and GGA forces.
	  * Somehow one allocation in ISF was not using SAFE_ALLOCATE.
	  
	  ------------------------------------------------------------------------

2015-02-12 04:26  dstrubbe

	* [r12972] src/grid/io_function_inc.F90,
	  src/td/propagator_vksold_inc.F90: Backport of 12962 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12962 | dstrubbe | 2015-02-11 16:06:09 -0500 (Wed, 11 Feb 2015)
	  | 4 lines
	  
	  Bugfix:
	  * If you try to read a non-existent .obf file in
	  io_function_input_global, it will crash with an assertion failure
	  np > 0 at a lower level, rather than returning a sensible error
	  code.
	  * When trying to read vprev files, a warning should be written if
	  they do not exist.
	  
	  ------------------------------------------------------------------------

2015-02-12 18:47  dstrubbe

	* [r12987] src/main/main.F90: Backport of 12978 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12978 | dstrubbe | 2015-02-12 11:58:17 -0500 (Thu, 12 Feb 2015)
	  | 2 lines
	  
	  Clarification: the variable ReportMemory is used only for SCF,
	  not for other kinds of runs.
	  
	  ------------------------------------------------------------------------

2015-02-17 11:18  micael

	* [r13040] Makefile.am, testsuite/Makefile.am: Backport of 13025 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13025 | micael | 2015-02-16 13:11:41 +0100 (Mon, 16 Feb 2015) |
	  2 lines
	  
	  New Makefile targets check-long and check-short, that run the
	  long and short tests respectively. make check now runs all the
	  tests, not just the short ones.
	  
	  ------------------------------------------------------------------------

2015-02-17 15:10  micael

	* [r13043] share/Makefile.am, testsuite/Makefile.am: Backport of
	  13042 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13042 | micael | 2015-02-17 16:06:47 +0100 (Tue, 17 Feb 2015) |
	  2 lines
	  
	  Corrected references to check-full and added
	  check-short/check-long targets in a couple of Makefiles.
	  
	  ------------------------------------------------------------------------

2015-02-17 15:40  micael

	* [r13045] share/PP/CPI/Makefile.am, share/PP/FHI/Makefile.am,
	  share/PP/HGH/Makefile.am, share/PP/Makefile.am,
	  share/PP/PSF/Makefile.am, share/PP/UPF/Makefile.am,
	  share/opencl/Makefile.am: Backport of 13044 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13044 | micael | 2015-02-17 16:38:53 +0100 (Tue, 17 Feb 2015) |
	  2 lines
	  
	  Changing remaining check-full to check-short/check-long.
	  
	  ------------------------------------------------------------------------

2015-02-17 18:11  xavier

	* [r13049] Makefile.am: Backport of 13047 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13047 | xavier | 2015-02-17 09:09:19 -0800 (Tue, 17 Feb 2015) |
	  6 lines
	  
	  This fixes the missing datafiles issue with make check-short when
	  called from the scratch. The trick is that we `make check` in all
	  the other subdirs before running `make check-short` in
	  testsuite/.
	  
	  
	  
	  ------------------------------------------------------------------------

2015-02-18 00:13  dstrubbe

	* [r13061] src/states/states.F90: Backport of 12950 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12950 | dstrubbe | 2015-02-10 23:06:01 -0500 (Tue, 10 Feb 2015)
	  | 2 lines
	  
	  Assertion to guard against the problem Carlo reported, in which
	  we try to use ScaLAPACK with an incompatible parallelization
	  layout.
	  
	  ------------------------------------------------------------------------

2015-02-18 00:16  dstrubbe

	* [r13062] src/main/unocc.F90: Backport of 13011 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13011 | dstrubbe | 2015-02-13 12:57:36 -0500 (Fri, 13 Feb 2015)
	  | 2 lines
	  
	  Minor bugfixes for unocc: the restart must be from an identical
	  mesh, which was not enforced; the variable lowest_missing could
	  be uninitialized and thus avoid triggering the proper error about
	  there being no restart info.
	  
	  ------------------------------------------------------------------------
	  
	  Backport of 13012 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13012 | dstrubbe | 2015-02-13 12:59:13 -0500 (Fri, 13 Feb 2015)
	  | 2 lines
	  
	  Mistaken use of float instead of integer in last commit.
	  
	  ------------------------------------------------------------------------

2015-02-18 00:17  dstrubbe

	* [r13063] src/scf/lcao_inc.F90: Backport of 13020 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13020 | dstrubbe | 2015-02-13 14:37:19 -0500 (Fri, 13 Feb 2015)
	  | 2 lines
	  
	  Bugfix: progress bars for generating wavefunctions in alternative
	  LCAO were quite wrong. In particular, the use of
	  'st%group%block_end-st%group%block_end' was presumably a typo. I
	  converted the serial one to count states not blocks. The bug is
	  from r11786.
	  
	  ------------------------------------------------------------------------

2015-02-18 00:18  dstrubbe

	* [r13064] src/grid/io_function_inc.F90: Backport of 13051 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13051 | dstrubbe | 2015-02-17 16:51:06 -0500 (Tue, 17 Feb 2015)
	  | 2 lines
	  
	  Bugfix: do not call MPI_Bcast and MPI_Barrier in
	  io_function_output unless the communicator is valid. This was
	  causing a runtime error for the KS inversion test when attempting
	  to output the potential, using comm = 0. Of course, the ultimate
	  cause is the fact that comm = 0, which should not be the case.
	  
	  ------------------------------------------------------------------------

2015-02-18 21:43  dstrubbe

	* [r13094] src/states/states_restart.F90: Backport of 13065 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13065 | dstrubbe | 2015-02-17 20:17:02 -0500 (Tue, 17 Feb 2015)
	  | 2 lines
	  
	  Bugfix: the progress bar for reading states started one too high.
	  
	  ------------------------------------------------------------------------

2015-02-18 21:44  dstrubbe

	* [r13095] src/species/ps.F90: Backport of 13067 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13067 | dstrubbe | 2015-02-17 20:38:25 -0500 (Tue, 17 Feb 2015)
	  | 2 lines
	  
	  Bugfix: ps_debug tried to write ps%k whether it was initialized
	  or not. It seems to be only used for HGH pseudos. This caused
	  real_time/06-caetrs.03-kick-tp1.inp to fail with valgrind.
	  
	  ------------------------------------------------------------------------

2015-02-18 21:46  dstrubbe

	* [r13096] src/states/states_restart.F90, src/td/td_write.F90:
	  Backport of 13068 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13068 | dstrubbe | 2015-02-17 20:44:02 -0500 (Tue, 17 Feb 2015)
	  | 6 lines
	  
	  * Bugfix: states_load did not set enough of the internal
	  variables of the states_t object appropriately. In particular,
	  st%lnst remained what it was and became inconsistent with the
	  rest. This was noticeable in finite_systems_1d/09-morse.03-td.inp
	  having my new warning about the progress bar, which used st%lnst
	  to decide the upper limit:
	  {{{
	  Internal warning: progress_bar called with actual 7 > max 1
	  }}}
	  * Removed superfluous initialization in td_write: states_look
	  already does this.
	  
	  ------------------------------------------------------------------------

2015-02-18 21:50  dstrubbe

	* [r13097] src/grid/par_vec.F90, src/grid/partition.F90: Backport
	  of 13069 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13069 | dstrubbe | 2015-02-17 22:45:08 -0500 (Tue, 17 Feb 2015)
	  | 2 lines
	  
	  Bugfix: there was a small memory leak in setting up the
	  partition. The array local_tmp was allocated within
	  partition_get_local, but not deallocated anywhere. I have fixed
	  this by getting rid of the array entirely, since it was an
	  unnecessary intermediate.
	  
	  ------------------------------------------------------------------------

2015-02-18 21:51  dstrubbe

	* [r13098] src/scf/lcao_inc.F90: Backport of 13072 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13072 | dstrubbe | 2015-02-17 23:51:55 -0500 (Tue, 17 Feb 2015)
	  | 2 lines
	  
	  Bugfix: the alternative LCAO without scalapack, in parallel,
	  would access arrays out of bounds when generating wavefunctions
	  if the number of states was greater than the number of orbitals,
	  because it assumed these numbers were equal. From r11786.
	  
	  ------------------------------------------------------------------------

2015-02-19 16:19  dstrubbe

	* [r13103] src/system/xc_ks_inversion.F90: Backport of 13080 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13080 | dstrubbe | 2015-02-18 11:15:04 -0500 (Wed, 18 Feb 2015)
	  | 2 lines
	  
	  Let's keep all the KS inversion variables in the same section.
	  
	  ------------------------------------------------------------------------

2015-02-19 16:21  dstrubbe

	* [r13104] src/basic/multicomm.F90, src/basic/unit_system.F90,
	  src/grid/double_grid.F90, src/grid/grid.F90,
	  src/grid/mesh_partition.F90, src/hamiltonian/epot.F90,
	  src/ions/ion_dynamics.F90, src/ions/kpoints.F90,
	  src/ions/simul_box.F90, src/main/geom_opt.F90, src/scf/lcao.F90,
	  src/states/restart.F90, src/states/states.F90,
	  src/system/eigensolver.F90, src/system/xc_oep.F90,
	  src/td/td_init_inc.F90: Backport of 13084 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13084 | dstrubbe | 2015-02-18 14:03:38 -0500 (Wed, 18 Feb 2015)
	  | 2 lines
	  
	  Corrections and clarifications to variable reference. Made sure
	  the Default field was set where it could be simply stated, and
	  removed redundant comments about the default in the Description
	  field. The default was listed incorrectly for a few of these
	  variables, and for a few a numeric value rather than the
	  appropriate option was listed, which is meaningless to the user.
	  Tried to describe the algorithm used to assign nodes by default
	  for ParallelizationGroupRanks.
	  
	  ------------------------------------------------------------------------

2015-02-19 16:25  dstrubbe

	* [r13105] src/basic/varinfo.F90, src/basic/varinfo_low.c: Backport
	  of 13089 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13089 | dstrubbe | 2015-02-18 15:03:34 -0500 (Wed, 18 Feb 2015)
	  | 2 lines
	  
	  The variable info-writing routines now print the Default field
	  too. This information is thus now available from oct-help and
	  from the input_error routine.
	  
	  ------------------------------------------------------------------------

2015-02-19 16:25  dstrubbe

	* [r13106] share/util/Makefile.am, share/util/inp: Backport of
	  13099 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13099 | dstrubbe | 2015-02-18 20:35:34 -0500 (Wed, 18 Feb 2015)
	  | 2 lines
	  
	  Removing an ancient input file in the share directory. It
	  certainly will not work anymore, and I cannot figure out why it
	  was ever present. It was added in r659, but with a comment that
	  suggested it was moved from somewhere else (though it is not
	  clear from where).
	  
	  ------------------------------------------------------------------------

2015-02-19 16:29  dstrubbe

	* [r13107] src/td/pes_mask_out_inc.F90: Backport of 13046 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13046 | umberto | 2015-02-17 10:49:01 -0500 (Tue, 17 Feb 2015) |
	  3 lines
	  
	  Fixed a race condition when writing PES restart files with domain
	  parallelization. This should remove the long standing builbot
	  error on chum (sorry about that) with 02-restart.test in the
	  photoelectron testuisuite.
	  
	  
	  ------------------------------------------------------------------------

2015-02-19 17:08  dstrubbe

	* [r13110] src/frozen/Makefile.am: Backport of r13109: missing
	  dependency for frozen.

2015-02-19 17:26  xavier

	* [r13114] src/hamiltonian/species_pot.F90: Backport of 13081 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13081 | xavier | 2015-02-18 08:16:38 -0800 (Wed, 18 Feb 2015) |
	  3 lines
	  
	  Fixed the initialization of the density when the pseudo has no
	  orbitals.
	  
	  
	  ------------------------------------------------------------------------

2015-02-19 17:39  xavier

	* [r13115] src/scf/lcao.F90: Backport of 13083 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13083 | xavier | 2015-02-18 09:06:35 -0800 (Wed, 18 Feb 2015) |
	  3 lines
	  
	  The LCAO is not done when there are no orbitals.
	  
	  
	  ------------------------------------------------------------------------

2015-02-22 18:36  dstrubbe

	* [r13149] src/main/unocc.F90, src/scf/scf.F90,
	  src/states/states_io.F90: Backport of 13108 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13108 | dstrubbe | 2015-02-19 11:42:34 -0500 (Thu, 19 Feb 2015)
	  | 6 lines
	  
	  * Bugfix: The file 'total-dos-efermi.dat' was being written only
	  if the bands file was being written (i.e. when nk > 1), even
	  though it is supposed to be used with the DOS files. Now it is
	  written if and only if the DOS is written, from the same routine.
	  * A header is written for 'total-dos.dat' like for the other DOS
	  files.
	  * The energy units are written in the bands and DOS file headers.
	  * Bugfix: 'maxdos' was computed summing the k-weights and
	  multiplying by the number of states. The sum of the k-weights is
	  enforced to be 1 regardless, so that sum is useless. And it did
	  not take into account the spin degeneracy. Now it does.
	  * When writing the Fermi energy files, 'states_fermi' was
	  uselessly called again, even though the Fermi energy must already
	  have been computed. This call is now removed.
	  
	  ------------------------------------------------------------------------

2015-02-22 18:45  dstrubbe

	* [r13150] src/scf/lcao_inc.F90: Backport of 13119 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13119 | dstrubbe | 2015-02-19 16:04:23 -0500 (Thu, 19 Feb 2015)
	  | 2 lines
	  
	  Bugfix: alternative LCAO with spin-polarization or k-points would
	  attempt to use deallocated arrays. 4 arrays were allocated before
	  the spin and k-point loops, but deallocated within them.
	  
	  ------------------------------------------------------------------------

2015-02-22 20:37  dstrubbe

	* [r13153] src/scf/scf.F90: Backport of 13121 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13121 | dstrubbe | 2015-02-19 17:17:13 -0500 (Thu, 19 Feb 2015)
	  | 2 lines
	  
	  Minor bugfix: If SCFinLCAO was stopped before convergence,
	  lcao_end was not called.
	  
	  ------------------------------------------------------------------------

2015-02-22 20:38  dstrubbe

	* [r13154] external_libs/metis-5.1/BUILD.txt,
	  external_libs/metis-5.1/Changelog,
	  external_libs/metis-5.1/GKlib/BUILD.txt,
	  external_libs/metis-5.1/GKlib/conf,
	  external_libs/metis-5.1/GKlib/test,
	  external_libs/metis-5.1/Install.txt,
	  external_libs/metis-5.1/manual: Backport of 13132 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13132 | dstrubbe | 2015-02-20 11:36:09 -0500 (Fri, 20 Feb 2015)
	  | 2 lines
	  
	  Removing unnecessary files from the Metis 5.1 directory. In
	  particular, the Install.txt and BUILD.txt files are misleading
	  because they refer to how to use Metis' own Cmake build system,
	  and not the one we have substituted for Octopus.
	  
	  ------------------------------------------------------------------------

2015-02-23 23:19  dstrubbe

	* [r13168] m4/metis.m4: Backport of 13146 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13146 | dstrubbe | 2015-02-22 13:13:39 -0500 (Sun, 22 Feb 2015)
	  | 2 lines
	  
	  There is no point in checking for METIS or compiling the internal
	  one when we are not using MPI, since it is only used for domain
	  parallelization.
	  
	  ------------------------------------------------------------------------

2015-02-23 23:20  dstrubbe

	* [r13169] src/ions/xyz_adjust.F90: Backport of 13159 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13159 | dstrubbe | 2015-02-23 12:51:56 -0500 (Mon, 23 Feb 2015)
	  | 2 lines
	  
	  Bugfix: use of uninitialized data when max-dim=4 could cause
	  floating point exception in oct-center-geom. This was happening
	  on the babbage gnu serial slave -- but only if the share path was
	  set in a particular way, strangely.
	  
	  ------------------------------------------------------------------------

2015-02-23 23:20  dstrubbe

	* [r13170] src/ions/xyz_adjust.F90: Backport of 13162 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13162 | dstrubbe | 2015-02-23 13:36:23 -0500 (Mon, 23 Feb 2015)
	  | 2 lines
	  
	  Follow up to r13159: apparently there was an arithmetic exception
	  here too. This might fix it.
	  
	  ------------------------------------------------------------------------

2015-02-24 12:38  micael

	* [r13174] src/td/spectrum.F90, src/utils/dielectric_function.F90,
	  src/utils/harmonic_spectrum.F90,
	  src/utils/propagation_spectrum.F90,
	  src/utils/rotatory_strength.F90, src/utils/vibrational.F90,
	  testsuite/periodic_systems/05-lithium.test,
	  testsuite/real_time/09-angular_momentum.test,
	  testsuite/real_time/12-absorption.test,
	  testsuite/real_time/13-absorption-spin.test,
	  testsuite/real_time/17-absorption-spin_symmetry.test: Backport of
	  13172 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13172 | micael | 2015-02-24 10:19:47 +0100 (Tue, 24 Feb 2015) |
	  5 lines
	  
	  * Fixed bug in polynomial damping: the total time was off by one
	  time-step. This introduced some very small changes in the values
	  of the spectra.
	  * Fixed bug in fourier transform: the start time for the
	  calculation of the integral was not properly taken into account.
	  * Simplified the signal_damp routine, renamed the kick_time
	  argument to t0 in order to make it consistent with the other
	  routines, and removed the unused window option.
	  * Renamed spec_t to spectrum_t.
	  
	  ------------------------------------------------------------------------

2015-02-24 12:38  micael

	* [r13175] testsuite/real_time/14-absorption-spinors.test: Backport
	  of 13173 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13173 | micael | 2015-02-24 10:55:23 +0100 (Tue, 24 Feb 2015) |
	  2 lines
	  
	  Missing file from previous commit.
	  
	  ------------------------------------------------------------------------

2015-02-24 23:40  dstrubbe

	* [r13189] src/scf/scf.F90, src/system/output.F90: Backport of
	  13120 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13120 | dstrubbe | 2015-02-19 16:24:43 -0500 (Thu, 19 Feb 2015)
	  | 6 lines
	  
	  * Bugfix: the needed directory was not written before outputting
	  DOS. Now it is done generally in the output_all routine, and I
	  removed two places it was done only for particular types of
	  output.
	  * The logic for creating outp%iter_dir considered an impossible
	  condition: it first made sure it ended on a slash, then checked
	  whether it was an empty string. But in fact, it appears to be
	  impossible to enter an empty string with our parser! If you pass
	  "", you get """. So, if you want the current directory, you must
	  enter "."
	  * Clarifying variable documentation.
	  * Changing the default for OutputInterval to be 0, not 50. In
	  light of r12082, this is the way to keep output per iteration
	  turned off by default, since we usually do not want it.
	  * Do not create the OutputIterDir unless we are doing output per
	  iteration.
	  
	  ------------------------------------------------------------------------
	  Backport of 13122 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13122 | dstrubbe | 2015-02-19 19:06:58 -0500 (Thu, 19 Feb 2015)
	  | 3 lines
	  
	  * Fix to r13120: putting default for OutputInterval back to 50.
	  Changing it broke some td tests. This needs to be done more
	  carefully.
	  * More clarification to documentation.
	  
	  ------------------------------------------------------------------------
	  Backport of 13147 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13147 | xavier | 2015-02-22 13:29:50 -0500 (Sun, 22 Feb 2015) |
	  3 lines
	  
	  Bugfix: a string variable was not always initialized.
	  
	  
	  ------------------------------------------------------------------------
	  Backport of 13148 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13148 | xavier | 2015-02-22 13:31:37 -0500 (Sun, 22 Feb 2015) |
	  2 lines
	  
	  No need to try to output something if there is nothing to output.
	  
	  ------------------------------------------------------------------------

2015-02-24 23:45  dstrubbe

	* [r13190] src/sternheimer/kdotp.F90: Backport of 13156 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13156 | irina | 2015-02-23 09:55:59 -0500 (Mon, 23 Feb 2015) | 1
	  line
	  
	  Added perturbation with direction 2 for second-order kdotp
	  ------------------------------------------------------------------------

2015-02-24 23:47  dstrubbe

	* [r13191] src/utils/casida_spectrum.F90: Backport of 13165 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13165 | dstrubbe | 2015-02-23 15:57:28 -0500 (Mon, 23 Feb 2015)
	  | 2 lines
	  
	  Fully initializing matrix, hopefully solves arithmetic exception
	  for max-dim=4 on babbage gnu serial.
	  
	  ------------------------------------------------------------------------

2015-02-24 23:48  dstrubbe

	* [r13192] src/math/metis.F90, src/math/metis_f.c: Backport of
	  13166 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13166 | dstrubbe | 2015-02-23 17:03:17 -0500 (Mon, 23 Feb 2015)
	  | 3 lines
	  
	  * We cannot use external METIS unless it was compiled in single
	  precision, given the Fortran types we pass to it. This was
	  checked nowhere, which is worrying.
	  * Correcting funny characters in comments.
	  
	  ------------------------------------------------------------------------

2015-02-24 23:48  dstrubbe

	* [r13193] src/utils/casida_spectrum.F90: Backport of 13177 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13177 | dstrubbe | 2015-02-24 11:28:49 -0500 (Tue, 24 Feb 2015)
	  | 2 lines
	  
	  Bugfix: operate only on relevant spatial dimensions, not up to
	  MAX_DIM, in oct-casida_spectrum. This should solve the arithmetic
	  exception on babbage gnu serial.
	  
	  ------------------------------------------------------------------------

2015-02-25 01:47  dstrubbe

	* [r13194] m4/metis.m4, m4/parmetis.m4: Backport of 13179 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13179 | dstrubbe | 2015-02-24 11:39:30 -0500 (Tue, 24 Feb 2015)
	  | 3 lines
	  
	  * The METIS m4 script was defective in most respects. I rewrote
	  it.
	  * --with-metis and --with-parmetis are replaced with
	  --with-metis-prefix and --with-parmetis-prefix in accordance with
	  the configure argument for our other m4 scripts.
	  
	  ------------------------------------------------------------------------

2015-02-25 01:48  dstrubbe

	* [r13195] m4/dune.m4, m4/dune_check_lib.m4, m4/metis.m4,
	  m4/parmetis.m4, src/common-rules.make: Backport of 13180 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13180 | dstrubbe | 2015-02-24 12:56:47 -0500 (Tue, 24 Feb 2015)
	  | 3 lines
	  
	  * Bugfix: the ParMETIS m4 script was completely wrong (rather
	  than mostly wrong like the METIS one). I doubt anyone has ever
	  checked it since it does not define any variable used in our
	  build system. Please, don't commit an m4 script without trying
	  it.
	  * Removed useless m4 stuff included from other code. parmetis.m4
	  was unnecessarily using some macros it defined.
	  
	  ------------------------------------------------------------------------

2015-02-25 01:48  dstrubbe

	* [r13196] m4/libxc.m4, m4/netcdf.m4: Backport of 13181 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13181 | dstrubbe | 2015-02-24 13:14:04 -0500 (Tue, 24 Feb 2015)
	  | 2 lines
	  
	  Bugfix: use appropriate module inclusion flag for Fortran, in
	  case it is not -I.
	  
	  ------------------------------------------------------------------------

2015-02-25 01:48  dstrubbe

	* [r13197] m4/metis.m4, m4/parmetis.m4, src/common-rules.make:
	  Backport of 13182 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13182 | dstrubbe | 2015-02-24 13:30:43 -0500 (Tue, 24 Feb 2015)
	  | 3 lines
	  
	  * More canonical names for Make variables in metis and parmetis
	  m4.
	  * Just one disable message for ParMETIS at a time.
	  
	  ------------------------------------------------------------------------

2015-02-25 01:48  dstrubbe

	* [r13198] m4/metis.m4, m4/parmetis.m4: Backport of 13188 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13188 | dstrubbe | 2015-02-24 17:41:36 -0500 (Tue, 24 Feb 2015)
	  | 4 lines
	  
	  * metis and parmetis m4 now respond to environment variables.
	  * The prefix was mistakenly set by default to /usr/include
	  instead of /usr.
	  * Make sure variables are set to blank and still substituted if
	  the library is not going to be used.
	  
	  ------------------------------------------------------------------------

2015-02-26 17:06  dstrubbe

	* [r13216] testsuite/buildbot_query.pl: Backport of 12988 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r12988 | dstrubbe | 2015-02-12 14:04:47 -0500 (Thu, 12 Feb 2015)
	  | 2 lines
	  
	  Updating buildbot_query.pl for BuildBot 0.8.8 which has './' in
	  front of builder URLs now.
	  
	  ------------------------------------------------------------------------

2015-02-26 17:06  dstrubbe

	* [r13217] testsuite/buildbot_query.pl: Backport of 13200 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13200 | dstrubbe | 2015-02-25 10:55:35 -0500 (Wed, 25 Feb 2015)
	  | 2 lines
	  
	  Updating buildbot_query.pl for our current BuildBot set up, since
	  the former custom shell_2 was replaced by a built-in configure.
	  
	  ------------------------------------------------------------------------

2015-02-26 17:07  dstrubbe

	* [r13218] src/system/output.F90: Backport of 13203 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13203 | dstrubbe | 2015-02-25 16:14:20 -0500 (Wed, 25 Feb 2015)
	  | 2 lines
	  
	  A cube was not being ended for BerkeleyGW output.
	  
	  ------------------------------------------------------------------------

2015-02-26 21:20  dstrubbe

	* [r13225] m4/metis.m4: Backport of 13204 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13204 | dstrubbe | 2015-02-25 16:46:36 -0500 (Wed, 25 Feb 2015)
	  | 2 lines
	  
	  metis m4: the lib and include parts of the paths should always be
	  set, even if the header cannot be found, so that the script
	  reports correctly where it looked.
	  
	  ------------------------------------------------------------------------

2015-02-26 21:20  dstrubbe

	* [r13226] src/scf/lcao_inc.F90: Backport of 13205 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13205 | dstrubbe | 2015-02-25 18:43:49 -0500 (Wed, 25 Feb 2015)
	  | 2 lines
	  
	  Bugfix: the alternative LCAO in parallel without scalapack with
	  complex states could cause a segmentation fault, invalid memory
	  reference, malloc error, etc. due to an incorrect type in an
	  MPI_Bcast for the eigenvalues. This was the case for
	  finite_systems_3d/17-scfinlcao_alt.01-gs.inp. Bug dates to
	  r11698.
	  
	  ------------------------------------------------------------------------

2015-02-26 21:21  dstrubbe

	* [r13227] src/species/species.F90: Backport of 13224 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13224 | dstrubbe | 2015-02-26 14:38:48 -0500 (Thu, 26 Feb 2015)
	  | 2 lines
	  
	  Bugfix: when using RKB projectors (as for spin-orbit
	  pseudopotentials), there could be an access of an array out of
	  bounds, in parallel, when calling spline_eval_vec, if the submesh
	  had no points in a particular domain in the partition. This
	  happened in
	  testsuite/finite_systems_3d/07-spin_orbit_coupling.02-rkb.inp and
	  07-spin_orbit_coupling_full.02-rkb.inp, in the partition due to
	  ParMETIS (but not the one due to METIS, curiously). The solution
	  is to refrain from calling spline_eval_vec in this situation.
	  
	  ------------------------------------------------------------------------

2015-03-01 03:39  dstrubbe

	* [r13248] m4/zdotc.m4: Backport of 13228 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13228 | dstrubbe | 2015-02-26 18:00:05 -0500 (Thu, 26 Feb 2015)
	  | 2 lines
	  
	  Replacing complex*16 with more modern complex(8) in m4 script.
	  
	  ------------------------------------------------------------------------

2015-03-01 03:39  dstrubbe

	* [r13249] src/math/scalapack.F90: Backport of 13230 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13230 | dstrubbe | 2015-02-26 18:23:24 -0500 (Thu, 26 Feb 2015)
	  | 2 lines
	  
	  Replacing deprecated complex*16 with complex(8).
	  
	  ------------------------------------------------------------------------

2015-03-01 03:40  dstrubbe

	* [r13250] configure.ac, doc/Makefile.am, doc/pdf: Backport of
	  13237 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13237 | micael | 2015-02-27 10:21:36 -0500 (Fri, 27 Feb 2015) |
	  2 lines
	  
	  Removed old doc/pdf directory that was never updated and seemed
	  to contain only garbage.
	  
	  ------------------------------------------------------------------------

2015-03-01 03:40  dstrubbe

	* [r13251] doc/Makefile.am, doc/img: Backport of 13239 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13239 | dstrubbe | 2015-02-27 12:28:11 -0500 (Fri, 27 Feb 2015)
	  | 2 lines
	  
	  Removing doc/img directory. These images were used in creating
	  the PDF documentation from .texi files, which were removed in
	  r2664. I uploaded to the wiki the only one of these img files of
	  interest, the "octosex" one, in a better version that I found in
	  a cached version of the manual for version 1.4 on our website.
	  http://www.tddft.org/programs/octopus/wiki/index.php/File:Octosex.jpg
	  
	  ------------------------------------------------------------------------

2015-03-01 03:40  dstrubbe

	* [r13252] src/system/output_modelmb_inc.F90,
	  testsuite/finite_systems_2d/07-modelmb.test: Backport of 13241 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13241 | dstrubbe | 2015-02-27 16:35:25 -0500 (Fri, 27 Feb 2015)
	  | 2 lines
	  
	  ModelMB output should be to a subdirectory, not to a concatenated
	  directory name.
	  
	  ------------------------------------------------------------------------

2015-03-03 00:49  dstrubbe

	* [r13266] src/math/fft_inc.F90: Backport of 13264 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13264 | joseba | 2015-03-02 03:27:31 -0600 (Mon, 02 Mar 2015) |
	  3 lines
	  
	  Added back accidentally removed variable assignment reported by
	  David
	  
	  
	  ------------------------------------------------------------------------

2015-03-03 00:49  dstrubbe

	* [r13267] src/states/density.F90: Backport of 13265 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13265 | umberto | 2015-03-02 06:04:39 -0600 (Mon, 02 Mar 2015) |
	  2 lines
	  
	  * BugFix: The total charge was not correctly set when running
	  with TDFreezeOrbitals causing octopus to exit with an error about
	  insufficient number of states when calculating the fermi energy.
	  * BugFix: Memory leak. A local wavefunction was not deallocated
	  after use.
	  ------------------------------------------------------------------------

2015-03-18 14:57  joseba

	* [r13384] src/grid/io_function_inc.F90: Backport of 13272 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13272 | joseba | 2015-03-03 17:33:38 +0100 (ar., 03 mar 2015) |
	  3 lines
	  
	  Fix to correct the compilation with preprocessed forall
	  
	  
	  ------------------------------------------------------------------------

2015-03-18 14:58  joseba

	* [r13385] src/hamiltonian/hamiltonian.F90,
	  src/main/casida_inc.F90, src/sternheimer/em_resp_calc_inc.F90,
	  src/system/output_berkeleygw_inc.F90: Backport of 13277 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13277 | joseba | 2015-03-04 11:23:48 +0100 (az., 04 mar 2015) |
	  4 lines
	  
	  More fixes to correct the compilation with preprocessed forall.
	  Split line with & don't work with the preprocessor.
	  
	  
	  ------------------------------------------------------------------------

2015-03-18 15:11  dstrubbe

	* [r13386] src/sternheimer/em_resp.F90, src/sternheimer/kdotp.F90:
	  Backport of 13377 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13377 | dstrubbe | 2015-03-17 19:12:02 -0400 (Tue, 17 Mar 2015)
	  | 2 lines
	  
	  Minor bugfix: use of ForceComplex with em_resp or kdotp could
	  cause a crash, since mixing would be chosen real anyway.
	  
	  ------------------------------------------------------------------------

2015-03-18 15:12  dstrubbe

	* [r13387] src/system/linear_solver_inc.F90: Backport of 13378 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13378 | dstrubbe | 2015-03-17 19:24:02 -0400 (Tue, 17 Mar 2015)
	  | 2 lines
	  
	  Bugfix: for smearing with Sternheimer, with complex
	  wavefunctions. The imaginary part of the projections on the
	  left-hand side of the equation were mistakenly being discarded.
	  Fortunately, I don't think many, or any, calculations in this
	  category were being done.
	  
	  ------------------------------------------------------------------------

2015-03-18 15:13  dstrubbe

	* [r13388] testsuite/buildbot_query.pl: Backport of 13274 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13274 | dstrubbe | 2015-03-03 13:55:37 -0500 (Tue, 03 Mar 2015)
	  | 2 lines
	  
	  Copyright/author info and svn ID.
	  
	  ------------------------------------------------------------------------

2015-03-18 15:14  dstrubbe

	* [r13389] src/basic/io_binary.c, src/basic/io_binary_f.F90,
	  src/grid/io_function_inc.F90, src/grid/partition.F90,
	  src/states/restart_inc.F90: Backport of 13279 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13279 | joseba | 2015-03-04 11:04:15 -0500 (Wed, 04 Mar 2015) |
	  5 lines
	  
	  Workaround to a bug: if the size of the partition is not
	  adequate, it is not read and it is recalculated. Even if the
	  problem with the writing still exists, it is not creating a crash
	  in future runs.
	  
	  To make this possible, change in get_info_binary to be able to
	  get the real size of the file.
	  
	  
	  ------------------------------------------------------------------------

2015-03-19 15:09  dstrubbe

	* [r13409] testsuite/oct-run_regression_test.pl: Bugfix in 5.0.x
	  (analogous to r13406) to testsuite Options support: a test would
	  be run if the executable's options string contained the string of
	  the required Option, even if that was just a substring of a real
	  option. This made a test fail on a slave that had PNFFT but not
	  NFFT; the test was not skipped so the run stopped with an error
	  message about the lack of NFFT. (A simple backport would not work
	  since the code in question was changed a lot in trunk.)

2015-03-19 15:19  dstrubbe

	* [r13410] src/system/xc_ks_inversion.F90: Backport of part of
	  r13163: adding a check for negative density before taking a
	  square root in KS inversion.

2015-03-19 15:50  dstrubbe

	* [r13411] testsuite/oct-run_regression_test.pl,
	  testsuite/oct-run_testsuite.sh.in: Backport of r13357: Bugfix:
	  Since [10909] the parallel testsuite was no longer parallel. To
	  fix this, instead of capturing the return code, the information
	  about the number of failures or other conditions is printed to
	  the standard output, where it is parsed by oct-run_testsuite.sh.
	  
	  Also one error message converted to die255 that was forgotten
	  earlier.

2015-03-20 15:21  dstrubbe

	* [r13434] src/grid/cube_function.F90,
	  src/hamiltonian/hamiltonian.F90, src/ions/geometry.F90,
	  src/poisson/poisson_isf.F90, src/states/states.F90: Backport of
	  13396 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13396 | dstrubbe | 2015-03-18 15:10:57 -0400 (Wed, 18 Mar 2015)
	  | 2 lines
	  
	  Improvements to comments and documentation. Mainly "associated
	  with" not "associated to".
	  
	  ------------------------------------------------------------------------

2015-03-20 15:23  dstrubbe

	* [r13435] build/var2html.pl: Backport of 13397 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13397 | dstrubbe | 2015-03-18 17:12:32 -0400 (Wed, 18 Mar 2015)
	  | 2 lines
	  
	  Using MathJax to render <math> </math> tags with LaTeX in
	  variable descriptions
	  (http://docs.mathjax.org/en/latest/start.html). I also added
	  UTF-8 encoding so special characters such as accented letters
	  come out properly. Using the inline mode for now, since many uses
	  of <math> are just for single symbols not whole equations, though
	  we could use both depending on context.
	  
	  ------------------------------------------------------------------------

2015-03-20 15:34  dstrubbe

	* [r13436] src/scf/lcao.F90, src/scf/scf.F90,
	  src/system/eigen_arpack.F90, src/system/eigen_feast.F90: Backport
	  of 13398 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13398 | dstrubbe | 2015-03-18 17:30:01 -0400 (Wed, 18 Mar 2015)
	  | 2 lines
	  
	  Some minor improvements to documentation, mostly regarding
	  <math>.
	  
	  ------------------------------------------------------------------------

2015-03-20 15:36  dstrubbe

	* [r13437] src/poisson/poisson.F90, src/td/pes_mask.F90: Backport
	  of 13407 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13407 | dstrubbe | 2015-03-18 21:30:43 -0400 (Wed, 18 Mar 2015)
	  | 2 lines
	  
	  Cleaning up some error messages.
	  
	  ------------------------------------------------------------------------

2015-03-20 15:42  dstrubbe

	* [r13438] src/basic/unit_system.F90, src/hamiltonian/kick.F90,
	  src/system/eigen_arpack.F90: Backport of 13414 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13414 | dstrubbe | 2015-03-19 12:22:57 -0400 (Thu, 19 Mar 2015)
	  | 2 lines
	  
	  Better math and HTML in variable reference.
	  
	  ------------------------------------------------------------------------

2015-03-20 15:51  dstrubbe

	* [r13439] src/system/output.F90: Backport of 13417 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13417 | dstrubbe | 2015-03-19 14:15:21 -0400 (Thu, 19 Mar 2015)
	  | 2 lines
	  
	  Do not create the output_iter directory unless it is going to be
	  used.
	  
	  ------------------------------------------------------------------------

2015-03-20 16:03  dstrubbe

	* [r13441] src/td/td_init_inc.F90: Backport of 13420 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13420 | dstrubbe | 2015-03-19 17:26:42 -0400 (Thu, 19 Mar 2015)
	  | 3 lines
	  
	  * Correction to documentation: Car-Parrinello was removed 18
	  months ago, but not from the variable reference.
	  * More grammatical error message.
	  
	  ------------------------------------------------------------------------

2015-03-20 16:04  dstrubbe

	* [r13442] src/td/td.F90, src/td/td_init_inc.F90: Backport of 13421
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13421 | dstrubbe | 2015-03-19 17:45:03 -0400 (Thu, 19 Mar 2015)
	  | 2 lines
	  
	  Bugfix: Moving scf_init for Born-Oppenheimer after
	  states_allocate_wfns, since that is the order in which they occur
	  for ground-state calculations and it is therefore assumed to be
	  the case in some calls from scf_init. Specifically, the check for
	  whether there is more than one block per node for lobpcg in
	  eigensolver_init needs to be after blocks were set up in
	  states_allocate_wfns, or else it may erroneously block the
	  calculation (or mistakenly allow it).
	  
	  ------------------------------------------------------------------------

2015-03-20 16:07  dstrubbe

	* [r13443] src/grid/mesh_init.F90, src/grid/nl_operator.F90,
	  src/scf/scf.F90, src/td/spectrum.F90, src/utils/vibrational.F90:
	  Backport of 13422 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13422 | dstrubbe | 2015-03-19 18:14:14 -0400 (Thu, 19 Mar 2015)
	  | 4 lines
	  
	  Variable reference:
	  * Fixing some unnecesssary mentions of simple defaults in the
	  description, adding missing Default fields, and removing Default
	  fields that stated unconditionally a value that is in fact on
	  sometimes the default.
	  * Using <math> in one place.
	  
	  ------------------------------------------------------------------------

2015-03-20 16:10  dstrubbe

	* [r13444] src/states/states.F90,
	  testsuite/real_time/10-bomd.02-td.inp: Backport of 13423 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13423 | dstrubbe | 2015-03-19 19:09:00 -0400 (Thu, 19 Mar 2015)
	  | 5 lines
	  
	  * Allow Born-Oppenheimer calculation with ScaLAPACK by adding a
	  variable to request ScaLAPACK layout by hand.
	  * Tell the user to set this when trying to use ScaLAPACK and the
	  layout was not used.
	  * Guard against crashes when trying to use ScaLAPACK with task
	  parallelization.
	  * Use par_states in first part of BO test to check this behavior
	  (as originally reported by Carlo and Stefano). -- Note that the
	  restart fails in this case: this needs to be fixed too.
	  
	  ------------------------------------------------------------------------

2015-03-20 16:11  dstrubbe

	* [r13445] testsuite/real_time/10-bomd.02-td.inp: Backport of 13425
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13425 | dstrubbe | 2015-03-19 21:13:30 -0400 (Thu, 19 Mar 2015)
	  | 2 lines
	  
	  This test needs ExperimentalFeatures now. Also, it doesn't work
	  when scalapack isn't available, I need to deal with this too.
	  
	  ------------------------------------------------------------------------

2015-03-20 16:11  dstrubbe

	* [r13446] testsuite/real_time/10-bomd.test: Backport of 13428 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13428 | dstrubbe | 2015-03-19 22:37:41 -0400 (Thu, 19 Mar 2015)
	  | 2 lines
	  
	  Making BO test run only with scalapack if using MPI.
	  
	  ------------------------------------------------------------------------

2015-03-20 17:00  dstrubbe

	* [r13450] src/scf/scf.F90, src/system/output.F90,
	  testsuite/finite_systems_3d/05-output.01-gs.inp: Backport of
	  13424 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13424 | dstrubbe | 2015-03-19 19:48:54 -0400 (Thu, 19 Mar 2015)
	  | 2 lines
	  
	  Resurrecting OutputDuringSCF (removed r12082): this allows us to
	  have output occurring during the iterations by default for TD but
	  not for SCF, without introducing explicitly calc-mode-dependent
	  code. You can still turn off output with OutputInterval = 0.
	  
	  ------------------------------------------------------------------------

2015-03-20 17:50  dstrubbe

	* [r13455] testsuite/real_time/10-bomd.test: Fix to r13446: I
	  backported the new testsuite syntax, without adapting to the old
	  style in the branch, which made the test fail without scalapack.

2015-03-20 18:12  dstrubbe

	* [r13457] testsuite/oct-run_regression_test.pl: Fix needed only in
	  5.0.x: The testsuite script should be a little more discerning,
	  and only skip a line with Programs or Options if it conforms to
	  the proper syntax for this line (i.e. including the colon).
	  Otherwise it should be rejected as containing an unknown tag, as
	  in the case of finding "Options_MPI" from new syntax in trunk.
	  Also, the "enabled" variable should be initialized.

2015-03-22 20:47  dstrubbe

	* [r13471] src/main/test.F90: Backport of 13448 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13448 | dstrubbe | 2015-03-20 12:47:53 -0400 (Fri, 20 Mar 2015)
	  | 3 lines
	  
	  * Clarifying documentation for TestType.
	  * The interpolation test now respects the value of TestType.
	  
	  ------------------------------------------------------------------------

2015-03-22 20:48  dstrubbe

	* [r13472] testsuite/oct-run_regression_test.pl: Backport of 13456
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13456 | dstrubbe | 2015-03-20 14:01:45 -0400 (Fri, 20 Mar 2015)
	  | 2 lines
	  
	  The testsuite script should be a little more discerning, and only
	  skip a line with TestGroups if it conforms to the proper syntax
	  for this line (i.e. including the colon). Otherwise it should be
	  rejected as containing an unknown tag.
	  
	  ------------------------------------------------------------------------

2015-03-22 20:51  dstrubbe

	* [r13473] testsuite/README: Backport of part of r13458: Putting
	  Options before Programs in testsuite documentation, since it
	  applies to following declarations of Programs.

2015-03-22 20:52  dstrubbe

	* [r13474] src/system/subspace.F90: Backport of 13459 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13459 | dstrubbe | 2015-03-20 17:19:08 -0400 (Fri, 20 Mar 2015)
	  | 2 lines
	  
	  Some use of only_root_writes, to help ensure that messages
	  actually get written to the console.
	  
	  ------------------------------------------------------------------------

2015-03-22 20:56  dstrubbe

	* [r13475] src/poisson/poisson.F90: Backport of 13464 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13464 | dstrubbe | 2015-03-21 18:01:28 -0400 (Sat, 21 Mar 2015)
	  | 4 lines
	  
	  * Improvements to Poisson solver documentation and output.
	  * We no longer write a reference in the output for Poisson, in
	  conformity with the style in the rest of the code.
	  * Bugfix: the wrong variable was being used in checking whether
	  we had a valid option to PoissonFFTKernel.
	  
	  ------------------------------------------------------------------------

2015-03-22 21:03  dstrubbe

	* [r13476] src/main/unocc.F90, src/scf/scf.F90,
	  src/system/eigensolver.F90,
	  testsuite/finite_systems_3d/20-eigensolver.05-evolution.inp:
	  Backport of 13465 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13465 | dstrubbe | 2015-03-21 18:18:55 -0400 (Sat, 21 Mar 2015)
	  | 5 lines
	  
	  * Note and warning regarding RMMDIIS for unocc.
	  * Reference for single-point Berry's phase.
	  * Marking imaginary-time evolution eigensolver experimental, in
	  accordance with the documentation.
	  * Making arpack eigensolver experimental.
	  
	  ------------------------------------------------------------------------

2015-03-22 21:37  dstrubbe

	* [r13477] testsuite/oct-run_regression_test.pl,
	  testsuite/oct-run_testsuite.sh.in: Backport of 13419 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13419 | dstrubbe | 2015-03-19 15:47:49 -0400 (Thu, 19 Mar 2015)
	  | 3 lines
	  
	  * Removing some extra blank lines and redundant output from the
	  testsuite scripts. 'Starting test run...' is implied from
	  'Executing: ...', and 'Finished test run.' is implied from
	  'Elapsed time...' and 'Execution : ...'.
	  * Only leave the new 'Status:' line at the end of the log output
	  if it indicated failures or an error. It seems natural to be able
	  to search for 'fail' and only find problems in the runs.
	  
	  ------------------------------------------------------------------------

2015-03-23 14:38  dstrubbe

	* [r13483] build/var2html.pl: Backport of 13478 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13478 | dstrubbe | 2015-03-22 18:06:54 -0400 (Sun, 22 Mar 2015)
	  | 2 lines
	  
	  Bugfix: the HTML variable documentation did not contain the
	  Default if it was 0, due to faulty Perl logic that considered 0
	  equivalently to "".
	  
	  ------------------------------------------------------------------------

2015-03-23 14:49  dstrubbe

	* [r13484] build/var2html.pl, src/scf/rdmft.F90: Backport of 13479
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13479 | dstrubbe | 2015-03-22 18:23:09 -0400 (Sun, 22 Mar 2015)
	  | 3 lines
	  
	  * Some validity checking of variable reference.
	  * Fixing a problem found.
	  
	  ------------------------------------------------------------------------

2015-03-23 21:27  xavier

	* [r13494] configure.ac: Backport of 13481 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13481 | xavier | 2015-03-22 23:36:48 -0700 (Sun, 22 Mar 2015) |
	  4 lines
	  
	  The configure script can now detect clblas, the open sourced
	  version
	  of clamdblas (that is now deprecated).
	  
	  Backport of 13487 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13487 | xavier | 2015-03-23 09:49:50 -0700 (Mon, 23 Mar 2015) |
	  6 lines
	  
	  * clFFT, the open sourced version of clAmdFft, can now be
	  detected by
	  the configure script.
	  
	  * Changed the description in the configure to match the new
	  libraries.

2015-03-23 21:34  xavier

	* [r13495] src/ions/symmetries.F90: Backport of 13467 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13467 | xavier | 2015-03-21 21:58:56 -0700 (Sat, 21 Mar 2015) |
	  9 lines
	  
	  Bugfix: Octopus check for integer translations was using
	  M_EPSILON
	  precision. With gcc 4.9, in my machine at least, spglib produces
	  slightly different results, that caused the detection of integer
	  transitions to fail for silicon.
	  
	  Now the precision for the detection is 'symprec', the value
	  passed to
	  spglib.
	  
	  
	  ------------------------------------------------------------------------

2015-03-23 22:54  dstrubbe

	* [r13498] src/basic/profiling.F90: Fix needed only in 5.0.x:
	  improper use of mpi_world instead of mpi_world%comm.

2015-03-24 14:34  dstrubbe

	* [r13507] src/poisson/poisson.F90: Backport of 13482 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13482 | joseba | 2015-03-23 04:34:15 -0400 (Mon, 23 Mar 2015) |
	  3 lines
	  
	  Corrected the ISF version we are using in documentation.
	  
	  
	  ------------------------------------------------------------------------

2015-03-24 14:35  dstrubbe

	* [r13508] m4/libxc.m4: Backport of 13486 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13486 | dstrubbe | 2015-03-23 12:25:53 -0400 (Mon, 23 Mar 2015)
	  | 2 lines
	  
	  Bugfix: libxc m4 should not use prefix variable if it is not set,
	  or else it tries linking with meaningless paths like -L/lib.
	  
	  ------------------------------------------------------------------------

2015-03-24 14:51  dstrubbe

	* [r13509] src/species/species.F90: Backport of 13488 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13488 | dstrubbe | 2015-03-23 13:42:31 -0400 (Mon, 23 Mar 2015)
	  | 2 lines
	  
	  Better math and formatting in Species block.
	  
	  ------------------------------------------------------------------------

2015-03-24 15:05  dstrubbe

	* [r13511] testsuite/components/01-derivatives_1d.test: Backport of
	  13510 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13510 | dstrubbe | 2015-03-24 11:01:21 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Temporarily loosening tolerance on 1D derivatives test to shut up
	  erlo builders. This should still be looked into further.
	  
	  ------------------------------------------------------------------------

2015-03-24 15:24  dstrubbe

	* [r13513] src/hamiltonian/kick.F90, src/hamiltonian/lasers.F90,
	  src/ions/geometry.F90, src/ions/read_coords.F90: Backport of
	  13489 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13489 | dstrubbe | 2015-03-23 13:47:58 -0400 (Mon, 23 Mar 2015)
	  | 2 lines
	  
	  Better math and formatting in variable reference.
	  
	  ------------------------------------------------------------------------

2015-03-24 15:25  dstrubbe

	* [r13514] src/math/tdfunction.F90,
	  src/opt_control/controlfunction.F90, src/system/exponential.F90:
	  Backport of 13490 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13490 | dstrubbe | 2015-03-23 13:50:22 -0400 (Mon, 23 Mar 2015)
	  | 2 lines
	  
	  Better math and formatting in variable reference.
	  
	  ------------------------------------------------------------------------

2015-03-24 15:34  dstrubbe

	* [r13515] src/td/pes_mask.F90, src/td/propagator.F90,
	  src/td/td.F90, src/td/td_write.F90, src/td/tdpsf.F90: Backport of
	  13491 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13491 | dstrubbe | 2015-03-23 14:11:08 -0400 (Mon, 23 Mar 2015)
	  | 3 lines
	  
	  * Better math and formatting in variable reference.
	  * Removed some debugging output for PES.
	  
	  ------------------------------------------------------------------------

2015-03-24 16:12  dstrubbe

	* [r13516] doc/Makefile.am, doc/update.el: Backport of r13493 and
	  r13504: removing update.el, which was needed only for long-ago
	  removed texi documentation.

2015-03-24 16:23  dstrubbe

	* [r13518] src/basic/opencl.F90, src/main/geom_opt.F90,
	  src/main/main.F90, src/system/xc_ks_inversion.F90: Backport of
	  13496 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13496 | dstrubbe | 2015-03-23 18:39:39 -0400 (Mon, 23 Mar 2015)
	  | 3 lines
	  
	  * Fixing default for OpenCLDevice documentation.
	  * Better math and formatting in variable reference.
	  
	  ------------------------------------------------------------------------

2015-03-24 16:49  dstrubbe

	* [r13520] src/poisson/poisson.F90, src/poisson/poisson_fmm.F90,
	  src/poisson/poisson_init_direct_inc.F90,
	  src/poisson/poisson_libisf.F90: Backport of 13497 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13497 | dstrubbe | 2015-03-23 18:53:01 -0400 (Mon, 23 Mar 2015)
	  | 5 lines
	  
	  Improvements to documentation and output about Poisson solvers.
	  In particular:
	  * The documentation in one place falsely stated that
	  PoissonSolverISFParallelData = no was required for k-points. In
	  fact, this is only required for k-point parallelization.
	  * Corrected formulae a little for FMM.
	  * Do not permit users to try the non-implemented cases of
	  periodic systems with ISF or LibISF.
	  
	  ------------------------------------------------------------------------

2015-03-24 16:50  dstrubbe

	* [r13522] src/poisson/poisson_init_direct_inc.F90: Backport of
	  13521 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13521 | dstrubbe | 2015-03-24 12:50:01 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Fix to incorrect HTML tag in variable reference, from r13497.
	  
	  ------------------------------------------------------------------------

2015-03-24 16:52  dstrubbe

	* [r13523] src/basic/multicomm.F90: Backport of 13499 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13499 | xavier | 2015-03-23 19:22:49 -0400 (Mon, 23 Mar 2015) |
	  3 lines
	  
	  Bugfix: A message was printing a line it did not generate.
	  
	  
	  ------------------------------------------------------------------------

2015-03-24 16:53  dstrubbe

	* [r13524] src/hamiltonian/born_charges.F90,
	  src/hamiltonian/scf_tol.F90, src/main/casida.F90,
	  src/sternheimer/em_resp.F90, src/system/linear_solver.F90,
	  src/system/pert.F90: Backport of 13500 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13500 | dstrubbe | 2015-03-23 19:22:51 -0400 (Mon, 23 Mar 2015)
	  | 2 lines
	  
	  Variable reference math.
	  
	  ------------------------------------------------------------------------

2015-03-24 16:56  dstrubbe

	* [r13525] src/ions/kpoints.F90: Backport of 13501 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13501 | xavier | 2015-03-23 20:35:40 -0400 (Mon, 23 Mar 2015) |
	  4 lines
	  
	  The variable KPointsUseTimeReversal does not have a single
	  default
	  value.
	  
	  
	  ------------------------------------------------------------------------

2015-03-24 16:59  dstrubbe

	* [r13526] m4/pfft.m4: Backport of 13503 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13503 | dstrubbe | 2015-03-23 20:52:25 -0400 (Mon, 23 Mar 2015)
	  | 2 lines
	  
	  Simplifying redundant check in pfft m4. This also works around
	  the bizarre situation that with certain compiler flags (e.g. -O2
	  but not -O0) zuse is willing to link the pfft test program
	  without actually having the library -lpfft present on the link
	  line.
	  
	  ------------------------------------------------------------------------

2015-03-24 18:08  dstrubbe

	* [r13529] src/system/current.F90: Backport of 13502 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13502 | xavier | 2015-03-23 20:46:02 -0400 (Mon, 23 Mar 2015) |
	  4 lines
	  
	  * Bugfix: The current should be always symmetrized when the
	  k-point grid is reduced by symmetries.
	  * No warning should be printed in the symmetrization of the
	  current.
	  
	  
	  ------------------------------------------------------------------------

2015-03-24 19:18  xavier

	* [r13532] src/grid/batch_ops_inc.F90, src/system/current.F90,
	  testsuite/periodic_systems/05-lithium.test: Backport of a bugfix,
	  the bugfix of the bugfix, and the bugfix of the bugfix of the
	  bugfix:
	  
	  Backport of 13460 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13460 | xavier | 2015-03-20 19:49:27 -0700 (Fri, 20 Mar 2015) |
	  7 lines
	  
	  Bugfix: The current is now calculated using the Hamiltonian
	  method.
	  This avoids a sign problem in the non-local correction term used
	  in
	  the gradient_corrected method, that is now experimental. The
	  Hamiltonian method is also faster, despite the 4 Hamiltonian
	  applications required per calculation. A test was updated.
	  
	  
	  
	  Backport of 13480 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13480 | xavier | 2015-03-22 20:58:13 -0700 (Sun, 22 Mar 2015) |
	  6 lines
	  
	  Bugfix: The calculation of the current using the Hamiltonian
	  required
	  a routine not implemented in OpenCL, this caused the test to
	  fail. I
	  have implemented the routine (reusing the code from the
	  application of
	  the local potential).
	  
	  
	  
	  Backport of 13485 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13485 | dstrubbe | 2015-03-23 07:55:18 -0700 (Mon, 23 Mar 2015)
	  | 2 lines
	  
	  Restoring non-OpenCL compilation after r13480.

2015-03-24 19:38  dstrubbe

	* [r13535] src/system/current.F90: Ironically, r13532 still
	  requires a small bugfix (due to merging) in the 5.0.x branch.

2015-03-25 15:42  dstrubbe

	* [r13554] src/grid/io_function.F90, src/main/static_pol.F90,
	  src/states/cmplxscl.F90, src/states/states_io.F90,
	  src/sternheimer/phonons_lr.F90: Backport of 13531 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13531 | dstrubbe | 2015-03-24 15:05:26 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Variable reference: URL links, math, other little improvements.
	  
	  ------------------------------------------------------------------------

2015-03-25 15:49  dstrubbe

	* [r13556] src/system/exponential.F90, src/system/output.F90,
	  src/system/output_me.F90, src/td/td_init_inc.F90: Backport of
	  13533 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13533 | dstrubbe | 2015-03-24 15:26:48 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Variable reference: math, URL links, formatting, typo.
	  
	  ------------------------------------------------------------------------

2015-03-25 20:12  dstrubbe

	* [r13561] src/system/current.F90: Backport of 13534 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13534 | dstrubbe | 2015-03-24 15:36:57 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Documentation bugfix to r13460. Make sure to keep it in sync with
	  the code!
	  
	  ------------------------------------------------------------------------

2015-03-25 20:17  dstrubbe

	* [r13562] src/hamiltonian/epot.F90, src/hamiltonian/lasers.F90,
	  src/hamiltonian/pcm.F90, src/xc/functionals.F90: Backport of
	  13536 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13536 | dstrubbe | 2015-03-24 15:48:52 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Variable reference: math, formatting, typo, redundant mention of
	  default.
	  
	  ------------------------------------------------------------------------

2015-03-25 21:57  dstrubbe

	* [r13568] src/hamiltonian/species_pot.F90: Backport of 13538 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13538 | xavier | 2015-03-24 18:41:11 -0400 (Tue, 24 Mar 2015) |
	  4 lines
	  
	  Bugfix: The printed displacement of the atom for
	  species_full_delta was not
	  correct when parallel in domains.
	  
	  
	  ------------------------------------------------------------------------

2015-03-25 22:22  dstrubbe

	* [r13569] src/opt_control/initst.F90,
	  src/opt_control/opt_control_iter.F90, src/opt_control/target.F90,
	  src/opt_control/target_density_inc.F90,
	  src/opt_control/target_hhg_inc.F90,
	  src/opt_control/target_spin_inc.F90,
	  src/opt_control/target_velocity_inc.F90: Backport of 13540 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13540 | dstrubbe | 2015-03-24 18:58:17 -0400 (Tue, 24 Mar 2015)
	  | 3 lines
	  
	  Variable reference: math, fixed defaults, standardized
	  'experimental' notes, formatting, documented OCTTargetSpin,
	  corrected statements.
	  * Improved error messages.
	  
	  ------------------------------------------------------------------------

2015-03-25 22:33  dstrubbe

	* [r13570] src/basic/messages.F90, src/hamiltonian/hamiltonian.F90,
	  src/xc/xc.F90: Backport of 13542 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13542 | dstrubbe | 2015-03-24 19:05:09 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Variable reference: URL links, formatting, math, making
	  subsection for XCDensityCorrection variables, removed redundant
	  comments about default.
	  
	  ------------------------------------------------------------------------

2015-03-25 22:38  dstrubbe

	* [r13571] src/grid/curvilinear.F90, src/grid/derivatives.F90,
	  src/ions/kpoints.F90, src/ions/read_coords.F90,
	  src/ions/simul_box.F90, src/math/fft.F90,
	  src/poisson/poisson.F90: Backport of 13543 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13543 | dstrubbe | 2015-03-24 19:45:13 -0400 (Tue, 24 Mar 2015)
	  | 3 lines
	  
	  * Variable reference: formatting, math, correction to formula for
	  stencil_star_plus in DerivativesOrder, removed redundant comments
	  on defaults, URL links.
	  * Improving output with hyphens.
	  
	  ------------------------------------------------------------------------

2015-03-25 22:41  dstrubbe

	* [r13572] build/octopus.spec.in: Backport of 13545 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13545 | dstrubbe | 2015-03-24 20:09:58 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Removing references to obsolete documentation files from Octopus
	  Debian packaging file. Does anyone know if this works anymore? It
	  would be nice if we did have a package available.
	  
	  ------------------------------------------------------------------------

2015-03-25 23:12  dstrubbe

	* [r13573] src/xc/xc.F90: Backport of 13546 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13546 | dstrubbe | 2015-03-24 21:00:54 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Correcting default for XCKernel.
	  
	  ------------------------------------------------------------------------

2015-03-25 23:21  dstrubbe

	* [r13574] src/xc/functionals.F90: Backport of 13547 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13547 | dstrubbe | 2015-03-24 21:08:35 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Proper calls of messages_experimental for complex-scaling
	  functionals.
	  
	  ------------------------------------------------------------------------

2015-03-25 23:33  dstrubbe

	* [r13575] build/mk_functionals_list.pl,
	  src/xc/functionals_list.F90: Backport of 13548 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13548 | dstrubbe | 2015-03-24 21:17:02 -0400 (Tue, 24 Mar 2015)
	  | 6 lines
	  
	  mk_functionals_list.pl:
	  * Making it usable in the modern era when libxc is a separate
	  library.
	  * Improved snippet of variable reference.
	  * Adding the extra functionals that have been added
	  functionals_list.F90 and forgotten to be added here.
	  * Updating functionals_list.F90 according: as in r9942, using
	  libxc 2.0.1 and removing the screened-exchange hybrids.
	  
	  ------------------------------------------------------------------------

2015-03-25 23:41  dstrubbe

	* [r13576] src/hamiltonian/pcm.F90, src/hamiltonian/scf_tol.F90,
	  src/ions/geometry.F90, src/poisson/poisson_fmm.F90,
	  src/scf/scf.F90, src/states/cmplxscl.F90,
	  src/system/eigen_arpack.F90, src/system/v_ks.F90,
	  src/xc/functionals.F90: Backport of 13549 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13549 | dstrubbe | 2015-03-24 21:29:24 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Variable reference: math fixes, formatting, standard placement of
	  'experimental', nicer-looking \varepsilon instead of \epsilon,
	  URL link, formatting, nicer math.
	  
	  ------------------------------------------------------------------------

2015-03-25 23:44  dstrubbe

	* [r13577] src/system/v_ks.F90: Backport of 13550 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13550 | dstrubbe | 2015-03-24 21:37:21 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Variable reference: More standard declaration of experimental.
	  
	  ------------------------------------------------------------------------

2015-03-25 23:45  dstrubbe

	* [r13578] src/basic/profiling.F90: Backport of 13551 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13551 | dstrubbe | 2015-03-24 23:47:06 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Inlining profile_end into the single place it is called. For some
	  reason, with openmp on my Mac, a run with prof_memory_full got
	  stuck with apparently endless calls to profile_end at the
	  conclusion of the run. With this version, it behaves normally.
	  
	  ------------------------------------------------------------------------

2015-03-25 23:46  dstrubbe

	* [r13579] src/grid/mesh_init.F90: Backport of 13552 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13552 | dstrubbe | 2015-03-24 23:50:13 -0400 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Clarifying message about MeshPartitionVirtualSize.
	  
	  ------------------------------------------------------------------------

2015-03-26 18:01  dstrubbe

	* [r13588] share/util/oct-display_partitions,
	  src/basic/unit_system.F90, src/system/eigen_arpack_inc.F90:
	  Backport of 13563 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13563 | dstrubbe | 2015-03-25 16:28:58 -0400 (Wed, 25 Mar 2015)
	  | 2 lines
	  
	  Fixing trigraphs (???) which cause warnings from cpp, and comment
	  with XML-like tags that cause warning from Doxygen.
	  
	  ------------------------------------------------------------------------

2015-03-26 18:02  dstrubbe

	* [r13589] doc/doxygen/Doxyfile: Backport of 13517 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13517 | dstrubbe | 2015-03-24 12:16:30 -0400 (Tue, 24 Mar 2015)
	  | 3 lines
	  
	  * Updating Doxyfile for Doxygen version 1.8.6 via 'doxygen -u'.
	  * Clearing field DOT_FONTNAME according to advice produced by
	  running doxygen.
	  
	  ------------------------------------------------------------------------

2015-03-26 18:02  dstrubbe

	* [r13590] doc/doxygen/Doxyfile,
	  doc/doxygen/create_documentation.sh: Backport of 13528 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13528 | dstrubbe | 2015-03-24 13:14:31 -0400 (Tue, 24 Mar 2015)
	  | 6 lines
	  
	  Necessary but not sufficient changes for doxygen to work:
	  * Added include path
	  * Simpler and more portable way of setting directory
	  * Some notes
	  * Show standard output and especially standard error from running
	  Doxygen
	  
	  ------------------------------------------------------------------------

2015-03-26 18:03  dstrubbe

	* [r13591] doc/doxygen/Doxyfile,
	  doc/doxygen/create_documentation.sh: Backport of 13564 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13564 | dstrubbe | 2015-03-25 16:37:17 -0400 (Wed, 25 Mar 2015)
	  | 2 lines
	  
	  Doxygen: script creates necessary files, need cpp -E in Doxyfile,
	  some FIXME's.
	  
	  ------------------------------------------------------------------------

2015-03-26 18:04  dstrubbe

	* [r13592] doc/doxygen/create_documentation.sh: Backport of 13566
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13566 | dstrubbe | 2015-03-25 17:26:52 -0400 (Wed, 25 Mar 2015)
	  | 2 lines
	  
	  Fixing directories for configuring for Doxygen, and removing use
	  of uninitialized variable '$folder'.
	  
	  ------------------------------------------------------------------------

2015-03-26 18:15  dstrubbe

	* [r13593] src/xc/xc.F90: Backport of 13580 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13580 | dstrubbe | 2015-03-25 20:15:52 -0400 (Wed, 25 Mar 2015)
	  | 3 lines
	  
	  * Variable reference: math corrections, clarification for
	  XCKernel.
	  * Typo in comment.
	  
	  ------------------------------------------------------------------------

2015-03-27 16:29  dstrubbe

	* [r13607] src/frozen/functional.F90, src/xc/functionals.F90,
	  src/xc/xc.F90: Backport of 13594 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13594 | dstrubbe | 2015-03-26 14:57:22 -0400 (Thu, 26 Mar 2015)
	  | 5 lines
	  
	  * Removing references to LCA current functionals, whose support
	  was removedin r8079 from Octopus, and r8077 from libxc (although
	  xc.h still defines XC_FAMILY_LCA). The only remnant is an error
	  message saying they are not implemented, if you somehow manage to
	  pass it in with XCFunctional even though it isn't defined by
	  libxc.
	  * Removed variable MGGAimplementation/xcs%mgga_implementation.
	  This was added in r3550 but any use of it was gone as of r4685.
	  * Bugfix: XCUseGaugeIndependentKED should apply to hybrid
	  meta-GGA's as much as to meta-GGA's.
	  * src/frozen/interface_xc.F90 has no business attempting to list
	  the contents of the libxc Fortran module, and should certainly
	  not refer to XC_FAMILY_LCA.
	  
	  ------------------------------------------------------------------------

2015-03-27 16:30  dstrubbe

	* [r13608] src/basic/openscad.F90, src/grid/io_function.F90,
	  src/grid/io_function_inc.F90: Backport of 13598 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13598 | dstrubbe | 2015-03-26 20:50:37 -0400 (Thu, 26 Mar 2015)
	  | 5 lines
	  
	  OpenSCAD output:
	  * Updated from 'triangles' to 'faces', as advised by OpenSCAD
	  when rendering.
	  * Corrected comment in OutputHow: not just geometry, also fields,
	  are now supported.
	  * Removed debugging output.
	  
	  ------------------------------------------------------------------------

2015-03-27 16:46  dstrubbe

	* [r13609] src/xc/vxc_inc.F90: Backport of 13599 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13599 | dstrubbe | 2015-03-26 20:57:48 -0400 (Thu, 26 Mar 2015)
	  | 3 lines
	  
	  * Bugfix: some operations for GGA and meta-GGA were not being
	  performed for their hybrids equivalents. This makes some changes
	  in Int[n*v_xc] in the hybrid one-shot tests, perhaps also to
	  other quantities in self-consistent calculations.
	  * A FIXME comment about functionals lacking XC_FLAGS_EXC: apart
	  from LB94, there is also LB94 modified, BJ06, TB09, and RPP09. We
	  are even using TB09 in the testsuite...
	  
	  ------------------------------------------------------------------------

2015-03-27 16:49  dstrubbe

	* [r13610] src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_inc.F90, src/scf/scf.F90,
	  src/system/v_ks.F90: Backport of 13601 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13601 | dstrubbe | 2015-03-27 00:41:37 -0400 (Fri, 27 Mar 2015)
	  | 2 lines
	  
	  Bugfix: some operations for meta-GGAs were not being carried out
	  for hybrid meta-GGAs. I think they are working now.
	  
	  ------------------------------------------------------------------------

2015-03-28 16:13  dstrubbe

	* [r13626] src/basic/io_binary_f_inc.F90: Backport of 13603 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13603 | dstrubbe | 2015-03-27 01:02:43 -0400 (Fri, 27 Mar 2015)
	  | 2 lines
	  
	  Bugfix: X(read_parallel) for MPI2 restart called MPI read
	  routines even if the attempt to open the file had failed, giving
	  as error message confusing comments about having read a negative
	  number of elements.
	  
	  ------------------------------------------------------------------------
	  Backport of 13604 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13604 | dstrubbe | 2015-03-27 10:34:49 -0400 (Fri, 27 Mar 2015)
	  | 2 lines
	  
	  Fixed version of r13603, which made all attempts to read complex
	  wavefunctions fail.
	  
	  ------------------------------------------------------------------------

2015-03-28 16:14  dstrubbe

	* [r13627] src/common-rules.make: Backport of 13605 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13605 | dstrubbe | 2015-03-27 11:32:11 -0400 (Fri, 27 Mar 2015)
	  | 2 lines
	  
	  Moving FCFLAGS_LIBXC to be first on the compilation line, which
	  can help avoid interference from another incompatible libxc
	  installation in another include path occurring earlier on the
	  compilation line. This has been a common problem with libxc.
	  
	  ------------------------------------------------------------------------

2015-03-28 16:18  dstrubbe

	* [r13628] src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/pcm.F90, src/system/energy_calc.F90: Backport of
	  13611 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13611 | dstrubbe | 2015-03-27 13:15:36 -0400 (Fri, 27 Mar 2015)
	  | 2 lines
	  
	  PCM total energy is only implemented for DFT.
	  
	  ------------------------------------------------------------------------
	  Backport of 13614 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13614 | dstrubbe | 2015-03-27 15:41:42 -0400 (Fri, 27 Mar 2015)
	  | 2 lines
	  
	  Oops, r13611 blocked all non-DFT calculations, not just use of
	  PCM in such calculations.
	  
	  ------------------------------------------------------------------------

2015-03-28 16:26  dstrubbe

	* [r13629] build/mk_functionals_list.pl, src/xc/functionals.F90,
	  src/xc/functionals_list.F90: Backport of 13615 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13615 | dstrubbe | 2015-03-27 16:26:47 -0400 (Fri, 27 Mar 2015)
	  | 4 lines
	  
	  * Identify which XCFunctionals options are not from libxc.
	  * Documenting undocumented variables that are parameters for
	  functionals.
	  * Inserted various FIXME's about defining the functionals
	  properly.
	  
	  ------------------------------------------------------------------------

2015-03-28 16:35  dstrubbe

	* [r13630] src/ions/xyz_adjust.F90, src/utils/convert.F90,
	  src/utils/local_multipoles.F90, src/utils/local_write.F90:
	  Backport of 13616 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13616 | dstrubbe | 2015-03-27 18:49:42 -0400 (Fri, 27 Mar 2015)
	  | 2 lines
	  
	  Improvements to variable reference for utilities. Commented out
	  unused variable ConvertStart.
	  
	  ------------------------------------------------------------------------
	  Backport of 13618 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13618 | dstrubbe | 2015-03-27 20:09:01 -0400 (Fri, 27 Mar 2015)
	  | 4 lines
	  
	  * Fix to r13616: the variable I commented was not unused.
	  * Explained defaults.
	  * Changed outp%how /= 1 to 0. I don't see any reason that
	  C_OUTPUT_AXIS_X would be a special value, so it seems more likely
	  that the code was trying to test whether OutputHow was set.
	  
	  ------------------------------------------------------------------------

2015-03-28 16:36  dstrubbe

	* [r13631] m4/zdotc.m4: Backport of 13619 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13619 | dstrubbe | 2015-03-27 20:23:37 -0400 (Fri, 27 Mar 2015)
	  | 2 lines
	  
	  Proper precision in zdotc macro to avoid compiler warnings.
	  
	  ------------------------------------------------------------------------

2015-03-28 16:41  dstrubbe

	* [r13632] src/xc/xc.F90: Backport of 13624 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13624 | dstrubbe | 2015-03-27 23:34:41 -0400 (Fri, 27 Mar 2015)
	  | 3 lines
	  
	  * Added call to messages_obsolete_variable for
	  MGGAimplementation, that should have been added in r13594 (in
	  case any unfortunate users were trying to use this meaningless
	  variable anyway...)
	  * Restored call to messages_obsolete_variable that I accidentally
	  deleted in that same commit.
	  
	  ------------------------------------------------------------------------

2015-03-29 16:50  dstrubbe

	* [r13651] src/opt_control/target_classical_inc.F90: Backport of
	  13625 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13625 | acastro | 2015-03-28 06:20:21 -0400 (Sat, 28 Mar 2015) |
	  3 lines
	  
	  Documentation of three variables.
	  
	  
	  ------------------------------------------------------------------------

2015-03-29 16:52  dstrubbe

	* [r13652] scripts/backport.sh: Backport of 13633 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13633 | dstrubbe | 2015-03-28 12:43:15 -0400 (Sat, 28 Mar 2015)
	  | 2 lines
	  
	  backport.sh can now apply multiple revisions at a time, to
	  concurrently apply bugfixes to a revision and maintain stability
	  in branch. (e.g. r13626)
	  
	  ------------------------------------------------------------------------

2015-03-29 17:27  micael

	* [r13653] src/hamiltonian/hamiltonian.F90, src/scf/scf.F90:
	  Backport of 13647 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13647 | micael | 2015-03-29 12:10:23 +0200 (Sun, 29 Mar 2015) |
	  2 lines
	  
	  Fixing compilation with libxc 2.0. In that case,
	  XC_FAMILY_HYB_MGGA is defined in the xc_functl_m module.
	  
	  ------------------------------------------------------------------------

2015-03-30 14:39  dstrubbe

	* [r13670] src/poisson/poisson_init_direct_inc.F90: Backport of
	  13654 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13654 | dstrubbe | 2015-03-29 14:41:25 -0400 (Sun, 29 Mar 2015)
	  | 2 lines
	  
	  Fixing typo, caught by Xavier's new warning for undocumented
	  variables.
	  
	  ------------------------------------------------------------------------

2015-03-30 14:45  dstrubbe

	* [r13671] testsuite/Makefile.am, testsuite/README: Backport of
	  13655 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13655 | dstrubbe | 2015-03-29 16:29:41 -0400 (Sun, 29 Mar 2015)
	  | 2 lines
	  
	  testsuite make clean now respects TEMPDIRPATH. Added some
	  explanations.
	  
	  ------------------------------------------------------------------------
	  Backport of 13666 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13666 | dstrubbe | 2015-03-29 22:41:45 -0400 (Sun, 29 Mar 2015)
	  | 2 lines
	  
	  Fix to r13655: use proper syntax for variables that are supposed
	  to be handled by Bash, not Make.
	  
	  ------------------------------------------------------------------------

2015-03-30 14:45  dstrubbe

	* [r13672] src/basic/profiling.F90, src/grid/cube.F90: Backport of
	  13657 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13657 | dstrubbe | 2015-03-29 16:51:18 -0400 (Sun, 29 Mar 2015)
	  | 2 lines
	  
	  Fixing incorrect types listed for two input variables.
	  
	  ------------------------------------------------------------------------

2015-03-30 14:49  dstrubbe

	* [r13673] src/scf/scf.F90: Backport of 13659 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13659 | dstrubbe | 2015-03-29 18:24:00 -0400 (Sun, 29 Mar 2015)
	  | 2 lines
	  
	  Bugfix to r13601: I accidentally changed the default for MixField
	  for mGGA's and not for hybrid mGGA's by adding XC_FAMILY_GGA
	  twice.
	  
	  ------------------------------------------------------------------------

2015-03-30 14:49  dstrubbe

	* [r13674] src/states/states.F90: Backport of 13660 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13660 | dstrubbe | 2015-03-29 18:37:53 -0400 (Sun, 29 Mar 2015)
	  | 3 lines
	  
	  * Avoiding passing unattainable states block size to mesh_init,
	  when it is larger than the number of states. This otherwise leads
	  to sub-optimal mesh block size.
	  * Removing useless ASSERT which comes after a section that would
	  call messages_fatal in the same case.
	  
	  ------------------------------------------------------------------------

2015-03-30 14:54  dstrubbe

	* [r13675] src/xc/functionals.F90: Backport of 13661 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13661 | dstrubbe | 2015-03-29 19:33:24 -0400 (Sun, 29 Mar 2015)
	  | 2 lines
	  
	  Making variable LB94_modified a logical is more logical, even if
	  we need to pass an integer to libxc in C.
	  
	  ------------------------------------------------------------------------

2015-03-30 14:57  dstrubbe

	* [r13676] src/ions/simul_box.F90,
	  testsuite/periodic_systems/01-free_electrons.01-ground_state.inp,
	  testsuite/periodic_systems/01-free_electrons.02-unocc.inp,
	  testsuite/periodic_systems/02-cosine_potential.01-ground_state.inp,
	  testsuite/periodic_systems/02-cosine_potential.02-unocc.inp:
	  Backport of 13662 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13662 | dstrubbe | 2015-03-29 19:34:26 -0400 (Sun, 29 Mar 2015)
	  | 2 lines
	  
	  De-activating variable BoxOffset, which does not work at all: if
	  you use it, your molecule is definitely considered outside of the
	  box.
	  
	  ------------------------------------------------------------------------
	  Backport of 13663 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13663 | dstrubbe | 2015-03-29 20:04:58 -0400 (Sun, 29 Mar 2015)
	  | 2 lines
	  
	  Removing BoxOffset from a few test files.
	  
	  ------------------------------------------------------------------------

2015-03-30 15:02  dstrubbe

	* [r13677] src/grid/io_function.F90, src/grid/io_function_inc.F90:
	  Backport of 13667 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13667 | dstrubbe | 2015-03-29 23:31:03 -0400 (Sun, 29 Mar 2015)
	  | 6 lines
	  
	  Bugfixes for OutputHow = boundary_points:
	  * array for global gather was not enlarged.
	  * would crash with assertion failure when trying to output
	  quantity defined without the boundary points
	  * binary and openscad did not respect this option, but can easily
	  be made to do so, unlike the cube-based types.
	  * Documentation now mentions caveats.
	  
	  ------------------------------------------------------------------------

2015-03-30 15:20  xavier

	* [r13680] src/hamiltonian/projector_inc.F90: Backport of 13644 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13644 | xavier | 2015-03-28 20:05:36 -0700 (Sat, 28 Mar 2015) |
	  5 lines
	  
	  Bugfix: change [13539] broke the application of pseudopotentials
	  with
	  multiple threads, I am not sure why. For the moment I am
	  disabling OpenMP in the
	  offending section.
	  
	  
	  ------------------------------------------------------------------------

2015-03-31 15:30  dstrubbe

	* [r13692] build/mk_functionals_list.pl, src/xc/functionals.F90,
	  src/xc/functionals_list.F90: Backport of 13684 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13684 | dstrubbe | 2015-03-30 14:09:36 -0400 (Mon, 30 Mar 2015)
	  | 4 lines
	  
	  * Detecting and blocking use of kinetic-energy functionals from
	  libxc.
	  * Commenting on kinetic-energy functionals, half-Hartree
	  exchange, and libxc version in documentation.
	  * Updating functionals_list.F90 from libxc 2.0.3 which spells
	  Claudio's name correctly.
	  
	  ------------------------------------------------------------------------

2015-03-31 15:33  dstrubbe

	* [r13693] src/ions/ion_dynamics.F90: Backport of 13686 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13686 | dstrubbe | 2015-03-30 17:23:46 -0400 (Mon, 30 Mar 2015)
	  | 3 lines
	  
	  * Improving documentation on Velocities variables.
	  * Documenting the undocumented XSFVelocities and PDBVelocities
	  possible formats.
	  
	  ------------------------------------------------------------------------

2015-03-31 15:43  dstrubbe

	* [r13694] src/hamiltonian/epot.F90, src/ions/read_coords.F90:
	  Backport of 13687 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13687 | dstrubbe | 2015-03-30 17:26:42 -0400 (Mon, 30 Mar 2015)
	  | 5 lines
	  
	  * Correcting documenting for PDBCoordinates, and documenting
	  PDBClassical.
	  * There are no longer attempts to read classical atoms from other
	  formats than PDB, since the others would be rejected anyway.
	  * Some cross-referencing of variables.
	  * Noting that classical atoms are not implemented in periodic
	  systems (this was enforced only by an assertion previously).
	  
	  ------------------------------------------------------------------------

2015-04-03 03:08  dstrubbe

	* [r13718] Makefile.am, build/octopus.spec.in, debian/info:
	  Backport of 13691 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13691 | dstrubbe | 2015-03-31 11:29:58 -0400 (Tue, 31 Mar 2015)
	  | 2 lines
	  
	  Removing obsolete references in Debian files to octopus.info file
	  (removed r2664) and to the idea of building separately in
	  parallel and serial for utilities.
	  
	  ------------------------------------------------------------------------
	  Backport of 13696 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13696 | dstrubbe | 2015-03-31 12:19:10 -0400 (Tue, 31 Mar 2015)
	  | 2 lines
	  
	  Removed debian/info from Makefile too, so the distcheck can work.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:15  dstrubbe

	* [r13787] src/xc/functionals.F90, src/xc/vxc_inc.F90,
	  testsuite/functionals/03-xc.test: Backport of 13708 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13708 | dstrubbe | 2015-04-02 12:13:35 -0700 (Thu, 02 Apr 2015)
	  | 4 lines
	  
	  * Removed Levy-Perdew estimation of the energy for LB94
	  functional which lacks XC_FLAGS_EXC in libxc, according to
	  Miguel's advice, since this is only valid for exchange and is a
	  bad and ill-defined estimate for a Vxc which is not the
	  derivative of an energy functional. The exchange will just be
	  written as zero in this case now. (Notes: Levy-Perdew is still
	  used for the XCDensityCorrection; complex-scaled LB94 seems to
	  use the LDA exchange energy.)
	  * A warning is written for functionals without energy available.
	  * An error message and assertion ensure that the specified
	  functional has Vxc available. I think all of them do in libxc
	  currently, but just to be sure for the future.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:19  dstrubbe

	* [r13788] src/xc/fxc_inc.F90, src/xc/kxc_inc.F90: Backport of
	  13709 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13709 | dstrubbe | 2015-04-02 12:23:30 -0700 (Thu, 02 Apr 2015)
	  | 2 lines
	  
	  Error messages to ensure that fxc and kxc routines are not called
	  for functionals that lack these functional derivatives. Not even
	  all LDA functionals have these in libxc trunk, though most do;
	  older versions may not, and when we add GGA functionals there are
	  many more possible gaps to watch out for.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:23  dstrubbe

	* [r13789] src/grid/mesh_partition.F90: Backport of 13710 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13710 | dstrubbe | 2015-04-02 12:42:53 -0700 (Thu, 02 Apr 2015)
	  | 2 lines
	  
	  Removing spurious line in variable reference.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:25  dstrubbe

	* [r13790] src/grid/mesh_partition.F90, src/grid/par_vec.F90:
	  Backport of 13711 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13711 | dstrubbe | 2015-04-02 12:55:49 -0700 (Thu, 02 Apr 2015)
	  | 4 lines
	  
	  Fixes for debug mesh_partition output:
	  * Use 6 digits not 3. Using more than 1000 domains is definitely
	  something that happens.
	  * Name the partition with the boundary more clearly.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:40  dstrubbe

	* [r13791] doc/html/varsRightFrame.html: Backport of 13712 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13712 | dstrubbe | 2015-04-02 14:10:26 -0700 (Thu, 02 Apr 2015)
	  | 2 lines
	  
	  Typo in main page of variable reference.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:48  dstrubbe

	* [r13792] configure.ac, doc/html/varsRightFrame.html,
	  doc/html/varsRightFrame.html.in, m4/octopus_compilation_info.m4:
	  Backport of 13713 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13713 | dstrubbe | 2015-04-02 14:48:24 -0700 (Thu, 02 Apr 2015)
	  | 2 lines
	  
	  The current version and svn revision are now inserted into the
	  opening page of the variable reference.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:51  dstrubbe

	* [r13793] doc/html: Backport of 13714 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13714 | dstrubbe | 2015-04-02 16:46:59 -0700 (Thu, 02 Apr 2015)
	  | 2 lines
	  
	  Updating svn:ignore: removing junk that should not be there, and
	  adding newly autogenerated file varsRightFrame.html.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:55  dstrubbe

	* [r13794] src/utils/local_multipoles.F90, src/xc/functionals.F90:
	  Backport of 13715 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13715 | dstrubbe | 2015-04-02 16:48:04 -0700 (Thu, 02 Apr 2015)
	  | 2 lines
	  
	  Fixing issues warned about by cpp, and removed a FIXME that is
	  fixed.
	  
	  ------------------------------------------------------------------------

2015-04-08 20:58  dstrubbe

	* [r13795] doc/doxygen/Doxyfile,
	  doc/doxygen/create_documentation.sh: Backport of 13717 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13717 | dstrubbe | 2015-04-02 20:05:23 -0700 (Thu, 02 Apr 2015)
	  | 5 lines
	  
	  * Exclude src/frozen from doxygen since it contains #error
	  directives that block preprocessing.
	  * -DHAVE defines are handled by an artificially constructed
	  config_F90.h that defines everything possible, so as much of the
	  code as possible is activated. As a result, use of 'configure' is
	  not needed.
	  * Make dummy headers mpi.h and fcs_config.h to avoid errors from
	  them not being found, in case MPI or FMM are not present on the
	  machine.
	  * Remove 'sed -i' which doesn't work on BSD/OSX.
	  
	  ------------------------------------------------------------------------

2015-04-08 22:25  dstrubbe

	* [r13796] src/opt_control/controlfunction.F90,
	  src/opt_control/opt_control_global.F90,
	  src/opt_control/target.F90,
	  src/opt_control/target_tdlocal_inc.F90,
	  testsuite/optimal_control/08-velocities.02-oct.inp: Backport of
	  13720 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13720 | acastro | 2015-04-03 04:15:03 -0700 (Fri, 03 Apr 2015) |
	  7 lines
	  
	  Documentation of three undocumented variables (OCTEta, OCTDelta,
	  and OCTTdTarget).
	  
	  Also, declared experimental some of the QOCT targets.
	  
	  
	  
	  ------------------------------------------------------------------------

2015-04-08 22:30  dstrubbe

	* [r13797] src/opt_control/opt_control_global.F90,
	  src/opt_control/target_tdlocal_inc.F90: Backport of 13723 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13723 | dstrubbe | 2015-04-03 11:21:46 -0700 (Fri, 03 Apr 2015)
	  | 2 lines
	  
	  Typos.
	  
	  ------------------------------------------------------------------------

2015-04-08 22:36  dstrubbe

	* [r13798] build/var2html.pl: Backport of 13752 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13752 | dstrubbe | 2015-04-06 14:06:14 -0700 (Mon, 06 Apr 2015)
	  | 4 lines
	  
	  var2html.pl:
	  * Removing parsing of long-unused option -s, and the unused
	  variable set by it.
	  * Clearer error-handling.
	  
	  ------------------------------------------------------------------------

2015-04-08 22:44  dstrubbe

	* [r13799] src/basic/oct_f.c, src/basic/recipes.c,
	  src/basic/signals.c, src/species/ps.F90,
	  src/species/ps_pspio_inc.F90: Backport of 13753 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13753 | dstrubbe | 2015-04-06 14:09:37 -0700 (Mon, 06 Apr 2015)
	  | 2 lines
	  
	  For consistency, let's use "#ifdef" or "#if defined" everywhere
	  rather than just "#if" as was being done in a few places: i.e.,
	  test whether the symbol is defined, not whether it is defined and
	  set to 1.
	  
	  ------------------------------------------------------------------------

2015-04-08 23:22  dstrubbe

	* [r13802] src/hamiltonian/kb_projector_inc.F90,
	  src/hamiltonian/projector_inc.F90: Backport of 13539 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13539 | dstrubbe | 2015-03-24 15:50:43 -0700 (Tue, 24 Mar 2015)
	  | 2 lines
	  
	  Bugfix: insidious, and remarkable that it has not been noticed
	  giving trouble before, since it could give wrong answers and even
	  memory corruption. There was a mismatch of sizes passed to
	  X(project_bra) and X(project_ket) in X(kb_project) and
	  X(project_psi_batch), and MPI reductions done on only a subset of
	  the vector. The problem seems more acute for spinors. The MPI
	  issue probably only matters when the domain edge passes very near
	  an atom. This bug appears to have been introduced in r3971. It
	  causes errors from the MPI Reduction on the zuse buildslave for
	  these tests: linear_response 01-casida, 02-h2o_pol_lr,
	  04-vibrational; periodic_systems 04-silicon, 06-h2o_pol_lr,
	  11-silicon_force. These all seem to relate to calculation of
	  forces.
	  
	  ------------------------------------------------------------------------

2015-04-08 23:31  dstrubbe

	* [r13803] src/hamiltonian/hgh_projector.F90,
	  src/hamiltonian/hgh_projector_inc.F90,
	  src/hamiltonian/kb_projector_inc.F90,
	  src/hamiltonian/projector_inc.F90,
	  src/hamiltonian/rkb_projector.F90: Backport of 13756 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13756 | dstrubbe | 2015-04-06 14:51:10 -0700 (Mon, 06 Apr 2015)
	  | 2 lines
	  
	  Bugfix follow-up to r13539: there I fixed array shape mismatches
	  for kb projectors. A similar problem existed for RKB and HGH
	  projectors. Now they all conform properly, by re-ordering uvpsi
	  to have spinor dimension first, and making uvpsi have only two
	  indices not three for HGH. This also makes that the array
	  sections passed from projector_inc are actually contiguous, and
	  probably will allow OpenMP to be re-enabled there (r13644).
	  
	  ------------------------------------------------------------------------

2015-04-09 00:02  dstrubbe

	* [r13804] testsuite/oct-run_regression_test.pl: Backport of 13757
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13757 | dstrubbe | 2015-04-06 14:52:25 -0700 (Mon, 06 Apr 2015)
	  | 3 lines
	  
	  * Identifying errors more clearly in testsuite.
	  * Check on reference values, not just extracted values.
	  
	  ------------------------------------------------------------------------

2015-04-09 00:23  dstrubbe

	* [r13808] external_libs/metis-5.1/GKlib/GKlib.h,
	  external_libs/metis-5.1/GKlib/b64.c,
	  external_libs/metis-5.1/GKlib/blas.c,
	  external_libs/metis-5.1/GKlib/csr.c,
	  external_libs/metis-5.1/GKlib/error.c,
	  external_libs/metis-5.1/GKlib/evaluate.c,
	  external_libs/metis-5.1/GKlib/fkvkselect.c,
	  external_libs/metis-5.1/GKlib/fs.c,
	  external_libs/metis-5.1/GKlib/gk_arch.h,
	  external_libs/metis-5.1/GKlib/gk_defs.h,
	  external_libs/metis-5.1/GKlib/gk_externs.h,
	  external_libs/metis-5.1/GKlib/gk_getopt.h,
	  external_libs/metis-5.1/GKlib/gk_macros.h,
	  external_libs/metis-5.1/GKlib/gk_mkblas.h,
	  external_libs/metis-5.1/GKlib/gk_mkmemory.h,
	  external_libs/metis-5.1/GKlib/gk_mkpqueue.h,
	  external_libs/metis-5.1/GKlib/gk_mkpqueue2.h,
	  external_libs/metis-5.1/GKlib/gk_mkrandom.h,
	  external_libs/metis-5.1/GKlib/gk_mksort.h,
	  external_libs/metis-5.1/GKlib/gk_mkutils.h,
	  external_libs/metis-5.1/GKlib/gk_proto.h,
	  external_libs/metis-5.1/GKlib/gk_struct.h,
	  external_libs/metis-5.1/GKlib/gk_types.h,
	  external_libs/metis-5.1/GKlib/graph.c,
	  external_libs/metis-5.1/GKlib/io.c,
	  external_libs/metis-5.1/GKlib/itemsets.c,
	  external_libs/metis-5.1/GKlib/mcore.c,
	  external_libs/metis-5.1/GKlib/memory.c,
	  external_libs/metis-5.1/GKlib/pdb.c,
	  external_libs/metis-5.1/GKlib/pqueue.c,
	  external_libs/metis-5.1/GKlib/random.c,
	  external_libs/metis-5.1/GKlib/rw.c,
	  external_libs/metis-5.1/GKlib/sort.c,
	  external_libs/metis-5.1/GKlib/string.c,
	  external_libs/metis-5.1/GKlib/timers.c,
	  external_libs/metis-5.1/GKlib/tokenizer.c,
	  external_libs/metis-5.1/GKlib/util.c,
	  external_libs/metis-5.1/libmetis/auxapi.c,
	  external_libs/metis-5.1/libmetis/balance.c,
	  external_libs/metis-5.1/libmetis/coarsen.c,
	  external_libs/metis-5.1/libmetis/contig.c,
	  external_libs/metis-5.1/libmetis/defs.h,
	  external_libs/metis-5.1/libmetis/fm.c,
	  external_libs/metis-5.1/libmetis/gklib.c,
	  external_libs/metis-5.1/libmetis/gklib_defs.h,
	  external_libs/metis-5.1/libmetis/gklib_rename.h,
	  external_libs/metis-5.1/libmetis/graph.c,
	  external_libs/metis-5.1/libmetis/kmetis.c,
	  external_libs/metis-5.1/libmetis/kwayfm.c,
	  external_libs/metis-5.1/libmetis/kwayrefine.c,
	  external_libs/metis-5.1/libmetis/macros.h,
	  external_libs/metis-5.1/libmetis/mcutil.c,
	  external_libs/metis-5.1/libmetis/mesh.c,
	  external_libs/metis-5.1/libmetis/meshpart.c,
	  external_libs/metis-5.1/libmetis/metislib.h,
	  external_libs/metis-5.1/libmetis/minconn.c,
	  external_libs/metis-5.1/libmetis/mincover.c,
	  external_libs/metis-5.1/libmetis/mmd.c,
	  external_libs/metis-5.1/libmetis/ometis.c,
	  external_libs/metis-5.1/libmetis/options.c,
	  external_libs/metis-5.1/libmetis/parmetis.c,
	  external_libs/metis-5.1/libmetis/pmetis.c,
	  external_libs/metis-5.1/libmetis/proto.h,
	  external_libs/metis-5.1/libmetis/refine.c,
	  external_libs/metis-5.1/libmetis/rename.h,
	  external_libs/metis-5.1/libmetis/separator.c,
	  external_libs/metis-5.1/libmetis/sfm.c,
	  external_libs/metis-5.1/libmetis/srefine.c,
	  external_libs/metis-5.1/libmetis/stat.c,
	  external_libs/metis-5.1/libmetis/stdheaders.h,
	  external_libs/metis-5.1/libmetis/struct.h,
	  external_libs/metis-5.1/libmetis/timing.c,
	  external_libs/metis-5.1/libmetis/util.c,
	  external_libs/metis-5.1/libmetis/wspace.c: Backport of 13767 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13767 | dstrubbe | 2015-04-07 09:36:37 -0700 (Tue, 07 Apr 2015)
	  | 2 lines
	  
	  Removing svn 'Id:' fields from metis-5.1 files, which are
	  referring to the svn repository of metis-5.1 not this one. As a
	  result, the svn revision for an exported copy of Octopus came out
	  as "13936 [timing.c 2013-03-30]" referring to one of these files.
	  
	  ------------------------------------------------------------------------
	  Backport of 13769 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13769 | dstrubbe | 2015-04-07 09:54:23 -0700 (Tue, 07 Apr 2015)
	  | 2 lines
	  
	  The beginning of a comment was mistakenly deleted in r13767.
	  
	  ------------------------------------------------------------------------

2015-04-09 00:46  dstrubbe

	* [r13809] build/svn_release_number.sh: Backport of 13768 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13768 | dstrubbe | 2015-04-07 09:42:21 -0700 (Tue, 07 Apr 2015)
	  | 2 lines
	  
	  The svn revision for an exported copy should be reported in the
	  same format as for an svn checkout copy, namely without the
	  filename and date quoted.
	  
	  ------------------------------------------------------------------------

2015-04-10 01:56  xavier

	* [r13821] src/hamiltonian/epot.F90: Backport of 13820 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13820 | xavier | 2015-04-09 17:26:08 -0700 (Thu, 09 Apr 2015) |
	  5 lines
	  
	  Bugfix: The real part of the force for periodic system was wrong
	  by a
	  factor of -2. This was not detected before because the value of
	  alpha
	  is too high, so most of the force is calculated in Fourier space.
	  
	  
	  ------------------------------------------------------------------------

2015-04-15 15:35  dstrubbe

	* [r13842] doc/doxygen/create_documentation.sh: Backport of 13836
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13836 | dstrubbe | 2015-04-13 02:48:26 -0400 (Mon, 13 Apr 2015)
	  | 2 lines
	  
	  Fix to r13717, which no longer put the Doxygen results in the
	  expected place.
	  
	  ------------------------------------------------------------------------
	  Backport of 13840 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13840 | dstrubbe | 2015-04-13 21:35:01 -0400 (Mon, 13 Apr 2015)
	  | 2 lines
	  
	  Fixing locations in Doxygen script.
	  
	  ------------------------------------------------------------------------

2015-04-21 07:12  micael

	* [r13853] src/poisson/poisson.F90: Backport of 13851 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13851 | micael | 2015-04-20 18:16:06 +0200 (Mon, 20 Apr 2015) |
	  2 lines
	  
	  LibISF is not considered experimental anymore.
	  
	  ------------------------------------------------------------------------
	  Backport of 13852 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13852 | micael | 2015-04-21 08:59:47 +0200 (Tue, 21 Apr 2015) |
	  2 lines
	  
	  Updated the PoissonSolver documentation.
	  
	  ------------------------------------------------------------------------

2015-05-05 01:55  xavier

	* [r13904] src/system/current.F90: Backport of 13898 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13898 | xavier | 2015-05-01 22:24:05 -0700 (Fri, 01 May 2015) |
	  3 lines
	  
	  Bugfix: the calculation of the current was wrong for multiple
	  blocks.
	  
	  
	  ------------------------------------------------------------------------

2015-05-05 02:04  xavier

	* [r13905] src/td/td_write.F90: Backport of 13899 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13899 | xavier | 2015-05-01 23:43:59 -0700 (Fri, 01 May 2015) |
	  3 lines
	  
	  Bugfix: Only the root node should write the total_current.
	  
	  
	  ------------------------------------------------------------------------

2015-05-08 12:38  micael

	* [r13946] src/basic/io_binary.c, src/grid/partition.F90: Backport
	  of 13936 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13936 | micael | 2015-05-07 11:36:03 +0200 (Thu, 07 May 2015) |
	  3 lines
	  
	  * Reseting error codes in partition_load.
	  * Bug fix: the filename was not converted from a Fortran string
	  to a C string in get_info_binary before obtaining the file size.
	  In some cases this caused the function to return a wrong file
	  size which made the loading of the partition fail.
	  
	  ------------------------------------------------------------------------
	  Backport of 13945 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13945 | micael | 2015-05-08 14:33:56 +0200 (Fri, 08 May 2015) |
	  2 lines
	  
	  Moving declaration of variable to begining of function.
	  
	  ------------------------------------------------------------------------

2015-05-08 12:42  micael

	* [r13947] testsuite/linear_response/04-vib_modes.test: Increasing
	  tolerance of one test.

2015-05-12 09:11  micael

	* [r13955] testsuite/linear_response/04-vib_modes.test: Increase
	  several tolerances.

2015-05-12 21:27  dstrubbe

	* [r13957] testsuite/linear_response/04-vib_modes.test: Centering
	  reference values for vib_modes test in branches/5.0.x and
	  re-tightening tolerances (after r13955), after analysis with
	  buildbot_query.pl. Note: this is not a backport because the
	  adjustment of mass values in trunk slightly changed the
	  vibrational values.

2015-05-14 16:22  dstrubbe

	* [r13980] testsuite/oct-run_regression_test.pl: Bugfix in
	  branches/5.0.x to r13409 (analogous to r13406 in trunk) for
	  testsuite Options: the last option could fail to be recognized
	  because of a trailing \n in the string of available options. This
	  was making a SPARSKIT test be skipped even though sparskit was an
	  available option, for example. This commit is the equivalent of
	  r13975 in trunk.

2015-05-14 16:25  dstrubbe

	* [r13981] m4/netcdf.m4: Backport of 13843 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13843 | dstrubbe | 2015-04-15 15:32:48 -0400 (Wed, 15 Apr 2015)
	  | 2 lines
	  
	  Quoting unquoted strings being tested in netcdf m4. This avoids
	  potential errors when FCFLAGS_NETCDF contains a space, as was
	  occurring on the slave hopper buildslave: "../configure: line
	  10964: test: too many arguments"
	  
	  ------------------------------------------------------------------------

2015-05-14 16:27  dstrubbe

	* [r13982] src/utils/vibrational.F90: Backport of 13962 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13962 | dstrubbe | 2015-05-13 18:08:20 -0400 (Wed, 13 May 2015)
	  | 2 lines
	  
	  Missing word in documentation.
	  
	  ------------------------------------------------------------------------

2015-05-15 21:21  dstrubbe

	* [r14001] src/utils/vibrational.F90: Backport of 13864 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13864 | micael | 2015-04-22 08:27:24 -0400 (Wed, 22 Apr 2015) |
	  3 lines
	  
	  * Renamed PropagationSpectrumTimeStepFactor input variable to
	  VibrationalSpectrumTimeStepFactor, as it is only used by the
	  oct-vibrational_spectrum utility.
	  * Corrected documentation.
	  
	  ------------------------------------------------------------------------
	  Backport of 14000 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14000 | dstrubbe | 2015-05-15 17:17:19 -0400 (Fri, 15 May 2015)
	  | 2 lines
	  
	  Call to messages_obsolete_variable that should have been added in
	  r13864.
	  
	  ------------------------------------------------------------------------

2015-05-18 17:31  dstrubbe

	* [r14019] src/grid/mesh_partition.F90, src/grid/partition.F90:
	  Backport of 13954 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13954 | dstrubbe | 2015-05-11 15:48:15 -0400 (Mon, 11 May 2015)
	  | 4 lines
	  
	  * Call MPI_Allreduce with the variable as size that is the same
	  one used to allocate the array. It seems npart == vsize in this
	  routine, but it seems best to ensure consistency.
	  * If reading inner partition fails, do not bother trying to read
	  boundary partition.
	  * A more robust check for partition size consistency, that does
	  not suffer from truncation in integer division.
	  
	  ------------------------------------------------------------------------

2015-05-18 17:39  dstrubbe

	* [r14020] src/basic/io_binary.c: Backport of 13968 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13968 | dstrubbe | 2015-05-13 19:28:41 -0400 (Wed, 13 May 2015)
	  | 2 lines
	  
	  Fixing memory leak from r13936.
	  
	  ------------------------------------------------------------------------

2015-05-18 17:42  dstrubbe

	* [r14021] liboct_parser/string_f.h: Backport of 13979 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13979 | xavier | 2015-05-14 12:04:33 -0400 (Thu, 14 May 2015) |
	  4 lines
	  
	  Added 3 extra bytes to the fortran to c string conversion routine
	  to
	  avoid false positives with valgrind when calling strlen.
	  
	  
	  ------------------------------------------------------------------------

2015-05-18 17:43  dstrubbe

	* [r14022] src/td/spectrum.F90: Backport of 13984 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13984 | dstrubbe | 2015-05-14 15:19:00 -0400 (Thu, 14 May 2015)
	  | 12 lines
	  
	  Fix to valgrind errors about use of uninitialized data in
	  oct-propagation_spectrum, by rearranging loops. The error seems
	  like a problem with valgrind or the compiler (perhaps in
	  optimization) to be honest, since it is the loop variable 'it'
	  that is at fault. Anyway, this reordering seems more natural to
	  me anyway.
	  
	  {{{
	  Using input file :
	  ../../testsuite/real_time/12-absorption.04-spectrum.inp
	  ==483== Conditional jump or move depends on uninitialised
	  value(s)
	  ==483== at 0x427230: __spectrum_m_MOD_spectrum_cross_section
	  (spectrum.F90:618)
	  ==483== by 0x40AC2E: MAIN__ (propagation_spectrum.F90:255)
	  ==483== by 0x408C86: main (propagation_spectrum.F90:23)
	  ==483== Uninitialised value was created by a stack allocation
	  ==483== at 0x42440A: __spectrum_m_MOD_spectrum_cross_section
	  (spectrum.F90:537)
	  }}}
	  
	  ------------------------------------------------------------------------

2015-05-18 17:47  dstrubbe

	* [r14023] src/basic/loct.F90, src/basic/oct_gdlib_f.c,
	  src/ions/simul_box.F90: Backport of 13986 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13986 | dstrubbe | 2015-05-14 15:38:13 -0400 (Thu, 14 May 2015)
	  | 2 lines
	  
	  As pointed out by valgrind, an image object from gdlib should be
	  destroyed at the end to avoid a memory leak.
	  
	  ------------------------------------------------------------------------
	  Backport of 13988 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13988 | dstrubbe | 2015-05-14 16:49:07 -0400 (Thu, 14 May 2015)
	  | 2 lines
	  
	  Fixing compilation without gdlib from r13986.
	  
	  ------------------------------------------------------------------------

2015-05-18 17:52  dstrubbe

	* [r14024] src/math/lalg_adv_lapack_inc.F90: Backport of 13990 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13990 | dstrubbe | 2015-05-14 17:04:52 -0400 (Thu, 14 May 2015)
	  | 2 lines
	  
	  Correcting names of lapack routines in error messages.
	  
	  ------------------------------------------------------------------------

2015-05-18 18:02  dstrubbe

	* [r14025] src/states/modelmb_particles.F90: Backport of 13994 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13994 | dstrubbe | 2015-05-15 14:02:26 -0400 (Fri, 15 May 2015)
	  | 2 lines
	  
	  Initializing a variable for modelmb, that was otherwise causing a
	  conditional jump depending on unitialized variable in valgrind
	  from states_end.
	  
	  ------------------------------------------------------------------------

2015-05-18 18:07  dstrubbe

	* [r14026] src/main/casida.F90: Backport of 13997 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13997 | dstrubbe | 2015-05-15 16:43:20 -0400 (Fri, 15 May 2015)
	  | 2 lines
	  
	  Better speculation about causes of errors in Casida.
	  
	  ------------------------------------------------------------------------

2015-05-18 18:14  dstrubbe

	* [r14027] src/system/v_ks.F90: Backport of 14004 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14004 | dstrubbe | 2015-05-15 17:50:47 -0400 (Fri, 15 May 2015)
	  | 2 lines
	  
	  Bugfix: xc_end was not called when doing hybrids with the
	  Hartree-Fock TheoryLevel, causing a memory leak.
	  
	  ------------------------------------------------------------------------

2015-05-18 18:21  dstrubbe

	* [r14028] src/grid/mesh_init.F90, src/td/pes_mask.F90: Backport of
	  14006 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14006 | dstrubbe | 2015-05-15 19:19:41 -0400 (Fri, 15 May 2015)
	  | 2 lines
	  
	  Spelling in comments and documentation.
	  
	  ------------------------------------------------------------------------

2015-05-18 18:22  dstrubbe

	* [r14029] testsuite/oct-run_regression_test.pl: Backport of 14010
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14010 | dstrubbe | 2015-05-15 19:51:48 -0400 (Fri, 15 May 2015)
	  | 2 lines
	  
	  Stop testsuite with error message if copy operation fails. This
	  has happened on the buildslaves when the disk is full, for
	  example.
	  
	  ------------------------------------------------------------------------

2015-05-18 18:22  dstrubbe

	* [r14030] src/system/eigen_arpack.F90,
	  testsuite/complex_scaling/01-harmonic-oscillator.test,
	  testsuite/complex_scaling/02-1dwell.test,
	  testsuite/complex_scaling/03-stark.test: Backport of 14011 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14011 | dstrubbe | 2015-05-15 19:52:35 -0400 (Fri, 15 May 2015)
	  | 2 lines
	  
	  Comments and warning about PARPACK support, which is not being
	  used on any of the buildslaves (because it does not seem to
	  work).
	  
	  ------------------------------------------------------------------------

2015-05-18 18:24  dstrubbe

	* [r14031] src/ions/read_coords.F90: Backport of 14012 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14012 | dstrubbe | 2015-05-15 21:34:34 -0400 (Fri, 15 May 2015)
	  | 2 lines
	  
	  Bugfix: dim to MAX_DIM was not initialized for atomic coordinates
	  from ReducedCoordinates, which was showing up in valgrind.
	  
	  ------------------------------------------------------------------------

2015-05-20 16:28  dstrubbe

	* [r14051] m4/arch.m4, src/grid/nl_operator.F90: Backport of 14032
	  to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14032 | dstrubbe | 2015-05-18 17:36:07 -0400 (Mon, 18 May 2015)
	  | 2 lines
	  
	  Bugfix: the --disable-vectors option did not work. Now it does,
	  and there is only one of them, and it causes the default for
	  OperateDouble to be set sensibly. Also, the unused conditional
	  COMPILE_VEC is removed, which was confusing.
	  
	  ------------------------------------------------------------------------

2015-05-20 16:34  dstrubbe

	* [r14052] src/math/math.F90, src/td/spectrum.F90: Backport of
	  13998 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13998 | dstrubbe | 2015-05-15 17:03:32 -0400 (Fri, 15 May 2015)
	  | 3 lines
	  
	  * Nicer math in variable reference.
	  * Removing debug info with 'print *'
	  
	  ------------------------------------------------------------------------

2015-05-20 16:37  dstrubbe

	* [r14053] src/td/spectrum.F90: Backport of 14037 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14037 | dstrubbe | 2015-05-19 12:07:42 -0400 (Tue, 19 May 2015)
	  | 2 lines
	  
	  More documentation on PropagationSpectrum variables.
	  
	  ------------------------------------------------------------------------

2015-05-20 16:40  dstrubbe

	* [r14054] src/basic/io_binary.c: Backport of 14039 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14039 | dstrubbe | 2015-05-19 12:16:15 -0400 (Tue, 19 May 2015)
	  | 2 lines
	  
	  Bugfix: a variety of memory leaks or double frees were possible
	  in io_binary routines. Specifically, an occasional problem with
	  real_time/05-time_propagation_fast_md.inp on erlo_gnu_mpich_long
	  was a double free when free(hp) was called in get_info_binary,
	  and presumably io_read_header had already freed it.
	  
	  ------------------------------------------------------------------------

2015-05-20 17:18  dstrubbe

	* [r14055] src/td/spectrum.F90: Backport of 14040 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14040 | dstrubbe | 2015-05-19 12:57:43 -0400 (Tue, 19 May 2015)
	  | 4 lines
	  
	  * It is childish to allow input of PropagationSpectrumTransform
	  for complex scaling when there is only one acceptable choice.
	  * Comment on sum rules.
	  * Better header alignment for dipole power.
	  
	  ------------------------------------------------------------------------

2015-05-20 17:34  dstrubbe

	* [r14056] src/td/spectrum.F90,
	  testsuite/real_time/12-absorption.test,
	  testsuite/real_time/13-absorption-spin.test,
	  testsuite/real_time/14-absorption-spinors.test,
	  testsuite/real_time/17-absorption-spin_symmetry.test: Backport of
	  14041 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14041 | dstrubbe | 2015-05-19 13:40:32 -0400 (Tue, 19 May 2015)
	  | 3 lines
	  
	  * Do not write the results from two sum rules in
	  oct-propagation_spectrum unless we are using a density kick and
	  sin transform, as the implementation of the sum rules assumes
	  that (though they could be generalized).
	  * Clearer label for the polarizability.
	  
	  ------------------------------------------------------------------------

2015-05-27 14:58  dstrubbe

	* [r14085] src/basic/write_iter_low.c: Backport of 14044 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14044 | xavier | 2015-05-19 14:40:35 -0400 (Tue, 19 May 2015) |
	  3 lines
	  
	  Allocated a string with extra bytes to avoid false positives in
	  valgrind.
	  
	  
	  ------------------------------------------------------------------------

2015-05-27 15:00  dstrubbe

	* [r14086] src/sternheimer/kdotp_calc.F90: Backport of 14071 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14071 | dstrubbe | 2015-05-26 14:06:11 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Use of string concatenation rather than 'write' helps avoid an
	  error in kdotp runs from valgrind: "Source and destination
	  overlap in memcpy"
	  
	  ------------------------------------------------------------------------

2015-05-27 15:01  dstrubbe

	* [r14087] src/species/ps.F90: Backport of 14072 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14072 | dstrubbe | 2015-05-26 15:10:30 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Do not allocate ps%k unless it will be used (HGH only). Then we
	  will not get a valgrind error about trying to write its
	  uninitialized contents from ps_debug.
	  
	  ------------------------------------------------------------------------

2015-05-27 15:03  dstrubbe

	* [r14088] src/td/propagator_etrs_inc.F90: Backport of 14075 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14075 | dstrubbe | 2015-05-26 19:39:35 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Bugfix: misuse of one-line if with SAFE_ALLOCATE macro. This
	  caused an array access out of bounds with
	  real_time/06-caetrs.03-kick-tp1.inp when I set ProfilingMode =
	  prof_memory_full.
	  
	  ------------------------------------------------------------------------

2015-05-27 15:04  dstrubbe

	* [r14089] src/states/states_restart.F90: Backport of 14076 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14076 | dstrubbe | 2015-05-26 22:21:17 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Bugfix: memory leak, two arrays were not deallocated in
	  states_load.
	  
	  ------------------------------------------------------------------------

2015-05-27 15:04  dstrubbe

	* [r14090] src/grid/mesh_batch_inc.F90: Backport of 14077 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14077 | dstrubbe | 2015-05-26 22:25:34 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Bugfix: memory leak, recv_buffer was not deallocated. Made
	  treatment of send_buffer more comparable.
	  
	  ------------------------------------------------------------------------

2015-05-27 15:05  dstrubbe

	* [r14091] src/basic/ialist.F90: Backport of 14078 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14078 | dstrubbe | 2015-05-26 22:38:52 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Renaming 'old_head' to 'ptr' (same as the name when it is
	  allocated) removes the major source of false positives from
	  memory profiling and oct-check_deallocs.
	  
	  ------------------------------------------------------------------------

2015-05-27 15:06  dstrubbe

	* [r14092] src/poisson/poisson.F90: Backport of 14079 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14079 | dstrubbe | 2015-05-26 22:48:58 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Bugfix: memory leak, two arrays were not deallocated from
	  poisson_slave_work.
	  
	  ------------------------------------------------------------------------

2015-05-27 15:06  dstrubbe

	* [r14093] src/main/run.F90: Backport of 14080 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14080 | dstrubbe | 2015-05-26 22:53:37 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Bugfix: memory leaks. Most destructors were not called by the
	  slave processes since they exited the run routine prematurely.
	  
	  ------------------------------------------------------------------------

2015-05-27 15:14  dstrubbe

	* [r14094] src/main/run.F90: Backport of 14081 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14081 | dstrubbe | 2015-05-26 22:58:32 -0400 (Tue, 26 May 2015)
	  | 2 lines
	  
	  Fixing indentation after previous commit, and consolidating logic
	  for poisson_async_init and poisson_async_end.
	  
	  ------------------------------------------------------------------------

2015-05-29 15:35  dstrubbe

	* [r14142] src/hamiltonian/hamiltonian_base_inc.F90,
	  src/hamiltonian/hamiltonian_inc.F90: Backport of 14097 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14097 | dstrubbe | 2015-05-27 14:34:11 -0400 (Wed, 27 May 2015)
	  | 2 lines
	  
	  The phase is always complex, and should be declared as such.
	  
	  ------------------------------------------------------------------------

2015-05-29 15:38  dstrubbe

	* [r14143] src/states/states_dim.F90: Backport of 14102 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14102 | dstrubbe | 2015-05-27 16:44:27 -0400 (Wed, 27 May 2015)
	  | 2 lines
	  
	  Explicit allocation instead of the uninstrumented
	  loct_pointer_copy removes a false positive of non-deallocated
	  memory from profiling.
	  
	  ------------------------------------------------------------------------

2015-05-29 15:41  dstrubbe

	* [r14144] scripts/oct-check_deallocs, src/basic/profiling.F90:
	  Backport of 14103 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14103 | dstrubbe | 2015-05-27 17:03:43 -0400 (Wed, 27 May 2015)
	  | 6 lines
	  
	  * Comment on problematic nature of our profiling with OpenMP.
	  * Header line for memory profiling files.
	  * More detail on lack of matched allocations and deallocations.
	  * Bugfix: the memory log upon allocation showed the total memory
	  according to profiling before the allocation, while all other
	  data was for after the allocation. Now it is all for after the
	  allocation.
	  * oct-check_deallocs shows number of allocations and
	  deallocations.
	  
	  ------------------------------------------------------------------------

2015-05-29 15:43  dstrubbe

	* [r14145] src/basic/mpi_debug.F90: Backport of 14108 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14108 | dstrubbe | 2015-05-27 18:44:04 -0400 (Wed, 27 May 2015)
	  | 2 lines
	  
	  Bugfix: there was an inadequate attempt to avoid division by zero
	  in MPI debug info.
	  
	  ------------------------------------------------------------------------

2015-05-29 15:44  dstrubbe

	* [r14146] src/grid/par_vec.F90: Backport of 14110 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14110 | dstrubbe | 2015-05-27 19:13:23 -0400 (Wed, 27 May 2015)
	  | 2 lines
	  
	  Only write meaningful dimensions in debug partition output.
	  
	  ------------------------------------------------------------------------

2015-05-29 15:51  dstrubbe

	* [r14147] src/grid/mesh_function_inc.F90,
	  src/hamiltonian/gauge_field.F90, src/hamiltonian/hamiltonian.F90,
	  src/hamiltonian/hamiltonian_base.F90,
	  src/hamiltonian/hamiltonian_base_inc.F90,
	  src/hamiltonian/projector.F90, src/td/propagator_expmid_inc.F90,
	  src/td/td_write.F90: Backport of 14106 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14106 | dstrubbe | 2015-05-27 18:25:49 -0400 (Wed, 27 May 2015)
	  | 2 lines
	  
	  Fixing allocations involving MAX_DIM. We should only allocate and
	  operate on the meaningful dimensions of the calculation at hand.
	  This may be responsible for some floating point exceptions in the
	  hopper buildslave.
	  
	  ------------------------------------------------------------------------
	  Backport of 14111 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14111 | dstrubbe | 2015-05-27 19:14:31 -0400 (Wed, 27 May 2015)
	  | 2 lines
	  
	  Fixes to r14106: magnetic fields need the third dimension when
	  the system is 2D.
	  
	  ------------------------------------------------------------------------
	  Backport of 14112 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14112 | dstrubbe | 2015-05-27 22:16:08 -0400 (Wed, 27 May 2015)
	  | 6 lines
	  
	  Fixes and better job on r14106:
	  * vector potentials need only be to size sb%dim.
	  * get_vec_pot routines take result as argument, for flexibility
	  in giving appropriate size.
	  * explicit bounds for vector expressions.
	  * comments and assert to clarify dimensionalities.
	  
	  ------------------------------------------------------------------------
	  Backport of 14113 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14113 | dstrubbe | 2015-05-27 23:42:27 -0400 (Wed, 27 May 2015)
	  | 2 lines
	  
	  Fix to r14112: forgot to update one file.
	  
	  ------------------------------------------------------------------------

2015-05-29 16:19  dstrubbe

	* [r14148] src/hamiltonian/hamiltonian_inc.F90,
	  src/hamiltonian/pcm.F90, src/system/magnetic.F90,
	  src/system/output_states_inc.F90: Backport of 14107 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14107 | dstrubbe | 2015-05-27 18:29:38 -0400 (Wed, 27 May 2015)
	  | 2 lines
	  
	  More fixing allocations involving MAX_DIM. We should only
	  allocate and operate on the meaningful dimensions of the
	  calculation at hand. This may be responsible for some floating
	  point exceptions in the hopper buildslave.
	  
	  ------------------------------------------------------------------------

2015-05-29 16:20  dstrubbe

	* [r14149] src/states/smear.F90: Backport of 14117 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14117 | micael | 2015-05-28 12:07:03 -0400 (Thu, 28 May 2015) |
	  3 lines
	  
	  * Reverting 14115
	  * Avoiding overflow directly in the smear_calc_entropy routine.
	  
	  ------------------------------------------------------------------------

2015-05-29 16:22  dstrubbe

	* [r14150] src/states/smear.F90: Backport of 14121 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14121 | dstrubbe | 2015-05-28 13:49:46 -0400 (Thu, 28 May 2015)
	  | 2 lines
	  
	  The entropy for semiconductors should be handled along the lines
	  of fixed occupations, not real smearing, since there is not
	  really a temperature or Fermi level. The result is exactly zero
	  anyway unless there are fractional occupations. This too will
	  help avoid overflows from M_HUGE initial eigenvalues.
	  
	  ------------------------------------------------------------------------

2015-05-29 17:15  dstrubbe

	* [r14151] src/hamiltonian/gauge_field.F90: Backport of 14125 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14125 | dstrubbe | 2015-05-28 15:38:31 -0400 (Thu, 28 May 2015)
	  | 2 lines
	  
	  The gauge_field_t object now stores its dimensionality, and uses
	  that instead of MAX_DIM everywhere. This may fix the valgrind
	  errors about use of uninitialized data in the lithium test.
	  
	  ------------------------------------------------------------------------

2015-05-29 17:17  dstrubbe

	* [r14152] liboct_parser/symbols.c: Backport of 14127 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14127 | dstrubbe | 2015-05-28 16:33:17 -0400 (Thu, 28 May 2015)
	  | 2 lines
	  
	  One element was missing in the initialization of an array for the
	  parser. I think this is a purely formal problem.
	  
	  ------------------------------------------------------------------------

2015-05-29 17:18  dstrubbe

	* [r14153] src/system/eigen_rmmdiis_inc.F90: Backport of 14134 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14134 | dstrubbe | 2015-05-28 22:11:33 -0400 (Thu, 28 May 2015)
	  | 2 lines
	  
	  Bugfix: memory leak in RMMDIIS.
	  
	  ------------------------------------------------------------------------

2015-05-29 17:23  dstrubbe

	* [r14154] src/basic/profiling.F90: Backport of 14139 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14139 | dstrubbe | 2015-05-28 23:45:54 -0400 (Thu, 28 May 2015)
	  | 3 lines
	  
	  * More detailed description of ProfilingMode options.
	  * This variable is not a flag.
	  
	  ------------------------------------------------------------------------

2015-05-30 04:39  xavier

	* [r14157] src/system/preconditioners.F90,
	  testsuite/periodic_systems/08-benzene_supercell.01-gs.inp,
	  testsuite/periodic_systems/11-silicon_force.01-gs.inp,
	  testsuite/periodic_systems/12-boron_nitride.01-gs.inp: Backport
	  of 14129 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14129 | xavier | 2015-05-28 16:06:59 -0700 (Thu, 28 May 2015) |
	  5 lines
	  
	  Bugfix: The filter preconditioner continues to cause problems
	  with
	  some periodic systems, so I disabled it for those systems. I
	  updated
	  the tests accordingly.
	  
	  ------------------------------------------------------------------------
	  
	  Note: Instead of changing the test results, I modified the tests
	  to
	  reproduce the old behaviour.

2015-06-01 20:11  dstrubbe

	* [r14171]
	  testsuite/open_systems/04-propagate_eigenstate.01-square_well_1d.inp:
	  Fix to r14157 in 5.0.x: a test no longer existing in trunk needed
	  pre_filter to be set, or there was a slight difference in results
	  that made the "current" matches fail.

2015-06-02 18:59  dstrubbe

	* [r14189] src/basic/blacs_proc_grid.F90, src/basic/multicomm.F90:
	  Backport of 14140 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14140 | dstrubbe | 2015-05-29 00:09:35 -0400 (Fri, 29 May 2015)
	  | 11 lines
	  
	  I am suspicious of the use of logical to pass to a C integer
	  type, as called for in MPI routines. I think it is safer to use
	  Fortran integers. And it might solve this problem in
	  branches/5.0.x:
	  {{{
	  Using input file :
	  ../../testsuite/real_time/06-caetrs.03-kick-tp1.inp
	  Executing: cd /tmp/octopus.CgmGFg; /opt/g95/bin/mpiexec -mca btl
	  sm,self -n 6
	  /home/pulpo/buildbot/lascar_x86_64_g95_openmpi/build/_build/testsuite/../src/main/octopus_mpi
	  > out
	  [lascar:27224] *** An error occurred in MPI_Cart_create
	  [lascar:27224] *** on communicator MPI COMMUNICATOR 4 SPLIT FROM
	  3
	  [lascar:27224] *** MPI_ERR_ARG: invalid argument of some other
	  kind
	  [lascar:27224] *** MPI_ERRORS_ARE_FATAL (your MPI job will now
	  abort)
	  }}}
	  Ref:
	  https://www.open-mpi.org/community/lists/users/2009/10/10914.php
	  
	  ------------------------------------------------------------------------
	  Backport of 14155 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14155 | dstrubbe | 2015-05-29 13:27:39 -0400 (Fri, 29 May 2015)
	  | 2 lines
	  
	  Fix to r14140: need another conversion between logical and
	  integer.
	  
	  ------------------------------------------------------------------------

2015-06-02 19:01  dstrubbe

	* [r14191] src/species/ps_in_grid.F90, src/species/ps_upf.F90:
	  Backport of 14164 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14164 | dstrubbe | 2015-06-01 13:08:20 -0400 (Mon, 01 Jun 2015)
	  | 2 lines
	  
	  Removing redundant messages about angular-momentum channels for
	  UPF (they are printed elsewhere for all pseudopotential types)
	  and clarifying message.
	  
	  ------------------------------------------------------------------------

2015-06-02 19:08  dstrubbe

	* [r14192] src/states/states.F90: Backport of 14166 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14166 | dstrubbe | 2015-06-01 15:07:59 -0400 (Mon, 01 Jun 2015)
	  | 2 lines
	  
	  Better math in variable reference.
	  
	  ------------------------------------------------------------------------

2015-06-02 19:11  dstrubbe

	* [r14193] share/util/oct-display_partitions: Backport of 14174 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14174 | dstrubbe | 2015-06-01 17:32:50 -0400 (Mon, 01 Jun 2015)
	  | 8 lines
	  
	  Bugfix: oct-display_partitions and does not work in its png
	  plotting functionality with the gnuplot 4.6.
	  {{{
	  set term png color
	  ^
	  "mesh_partitions_index.gp", line 12: unrecognized terminal option
	  }}}
	  The png doesn't seem particularly useful anyway. So, I have
	  updated the "ls" command for the current filenames, and removed
	  the png plotting, and so the script just makes the gnuplot file,
	  which you can use with an interactive terminal. Also the
	  suggested command to load didn't work.
	  
	  ------------------------------------------------------------------------

2015-06-02 19:20  dstrubbe

	* [r14194] src/td/td.F90: Backport of 14176 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14176 | dstrubbe | 2015-06-01 19:34:45 -0400 (Mon, 01 Jun 2015)
	  | 2 lines
	  
	  Bugfix: memory leaks for TransformStates.
	  
	  ------------------------------------------------------------------------

2015-06-02 19:29  dstrubbe

	* [r14195] src/td/td.F90: Fix to r14194 to make it compile in
	  5.0.x: an optional argument's name had changed in trunk.

2015-06-10 20:09  dstrubbe

	* [r14240] testsuite/finite_systems_3d/21-lobpcg.test: Adjusting
	  center and precision for a match in branches/5.0.x, which failed
	  with a small discrepancy on my Macbook and Stampede, but was fine
	  in trunk.

2015-06-11 15:45  dstrubbe

	* [r14247] src/grid/derivatives.F90: Backport of 14187 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14187 | dstrubbe | 2015-06-02 14:50:09 -0400 (Tue, 02 Jun 2015)
	  | 2 lines
	  
	  Bugfix: der%zero_bc was set using 3 rather than the actual
	  dimension. Not sure if this actually affects anything though.
	  
	  ------------------------------------------------------------------------

2015-06-11 16:03  dstrubbe

	* [r14248] src/species/species.F90, src/td/pes_mask.F90: Backport
	  of 14209 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14209 | dstrubbe | 2015-06-04 13:42:21 -0400 (Thu, 04 Jun 2015)
	  | 2 lines
	  
	  Bugfix: memory leaks, two blocks were not being ended.
	  
	  ------------------------------------------------------------------------

2015-06-11 16:07  dstrubbe

	* [r14249] src/xc/xc.F90: Backport of 14235 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14235 | dstrubbe | 2015-06-10 12:41:49 -0400 (Wed, 10 Jun 2015)
	  | 2 lines
	  
	  Comments regarding XCKernel.
	  
	  ------------------------------------------------------------------------

2015-06-11 18:52  dstrubbe

	* [r14256] src/opt_control/initst.F90,
	  src/opt_control/target_gstransformation_inc.F90, src/td/td.F90,
	  testsuite/optimal_control/04-box.01-ground_state.inp: Backport of
	  14212 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14212 | dstrubbe | 2015-06-04 15:01:18 -0400 (Thu, 04 Jun 2015)
	  | 2 lines
	  
	  Consolidating very similar code for TransformStates,
	  OCTInitialTransformStates, and OCTTargetTransformStates. This
	  fixes the memory leaks for the latter two that were fixed for the
	  first recently, improves error-handling, and guards against use
	  with states parallelization.
	  
	  ------------------------------------------------------------------------
	  
	  Also r14210:
	  
	  Only 1 extra state is needed for this test, and using 5 means
	  that the specification of OCTTargetTransformStates in the
	  following steps of the calculation is incorrect as there are an
	  insufficient number of columns. (This condition was not being
	  checked though.)

2015-06-17 18:58  dstrubbe

	* [r14278] testsuite/linear_response/05-polarizability.test:
	  Updating test reference value in 5.0.x.

2015-06-18 04:13  xavier

	* [r14283] src/td/td.F90, src/td/td_write.F90: Backport of 14231 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14231 | xavier | 2015-06-09 17:00:21 -0700 (Tue, 09 Jun 2015) |
	  6 lines
	  
	  Bugfix: Since the TDOutput files are used as restart information,
	  they
	  should be written every RestartWriteInterval steps instead of
	  every OutputInterval steps. Otherwise the restart information
	  might not be
	  consistent when a TD calculation is interrupted.
	  
	  
	  ------------------------------------------------------------------------

2015-06-18 23:03  dstrubbe

	* [r14287] src/system/output.F90, src/td/td_write.F90: Backport of
	  14252 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14252 | xavier | 2015-06-11 12:48:40 -0400 (Thu, 11 Jun 2015) |
	  3 lines
	  
	  Clarified the documentation about TDOutput and
	  RestartWriteInterval.
	  
	  
	  ------------------------------------------------------------------------

2015-06-18 23:04  dstrubbe

	* [r14288] src/math/math.F90, src/math/math_inc.F90: Backport of
	  14254 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14254 | dstrubbe | 2015-06-11 14:32:51 -0400 (Thu, 11 Jun 2015)
	  | 2 lines
	  
	  Removing PUSH/POP's from two routines called too frequently from
	  optimal control.
	  
	  ------------------------------------------------------------------------

2015-06-18 23:13  dstrubbe

	* [r14289] src/states/modelmb_particles.F90: Backport of 14264 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14264 | dstrubbe | 2015-06-12 15:23:03 -0400 (Fri, 12 Jun 2015)
	  | 2 lines
	  
	  Bugfix: use of messages_print_var_option for a variable without
	  options results in no output. Instead, use
	  messages_print_var_value, and don't call when NParticleModelmb is
	  not set > 0.
	  
	  ------------------------------------------------------------------------

2015-06-18 23:24  dstrubbe

	* [r14290] src/states/modelmb_particles.F90: Bugfixes to 5.0.x
	  (already fixed at some point in trunk):
	  * defaults in code and documentation were mismatched; now they
	  match trunk.
	  * if NParticleModelmb is 0, exit the initialization and don't
	  print anything.

2015-06-18 23:25  dstrubbe

	* [r14291] src/basic/space.F90: Backport of 14265 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14265 | dstrubbe | 2015-06-12 15:42:21 -0400 (Fri, 12 Jun 2015)
	  | 2 lines
	  
	  Make clear the range of possible values for Dimensions.
	  
	  ------------------------------------------------------------------------

2015-06-18 23:27  dstrubbe

	* [r14292] src/basic/varinfo.F90: Backport of 14266 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14266 | dstrubbe | 2015-06-12 16:05:42 -0400 (Fri, 12 Jun 2015)
	  | 2 lines
	  
	  Less lenient error-handling for varinfo routines: if the variable
	  or option doesn't exist, and there isn't a way of passing this
	  information back, then an error message is written and the code
	  stops. This will help avoid incorrect calls.
	  
	  ------------------------------------------------------------------------

2015-06-18 23:27  dstrubbe

	* [r14293] src/basic/multicomm.F90: Backport of 14267 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14267 | dstrubbe | 2015-06-12 16:19:59 -0400 (Fri, 12 Jun 2015)
	  | 2 lines
	  
	  Bugfix: memory leak, not all the communicators were freed.
	  
	  ------------------------------------------------------------------------

2015-06-18 23:28  dstrubbe

	* [r14294] src/grid/mesh.F90: Backport of 14268 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14268 | dstrubbe | 2015-06-12 17:08:47 -0400 (Fri, 12 Jun 2015)
	  | 2 lines
	  
	  Bugfix: memory leak, a communicator was not freed.
	  
	  ------------------------------------------------------------------------
	  Backport of 14271 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14271 | dstrubbe | 2015-06-12 18:21:09 -0400 (Fri, 12 Jun 2015)
	  | 2 lines
	  
	  Fix to r14268: forgot argument to MPI_Comm_free.
	  
	  ------------------------------------------------------------------------

2015-06-18 23:30  dstrubbe

	* [r14295] src/sternheimer/em_resp.F90, src/system/pert.F90:
	  Backport of 14269 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14269 | dstrubbe | 2015-06-12 18:06:42 -0400 (Fri, 12 Jun 2015)
	  | 2 lines
	  
	  Bugfix: Removing mistaken call to print option of obsolete
	  variable (which would have no effect), and inserting correct call
	  in a more appropriate place.
	  
	  ------------------------------------------------------------------------

2015-06-18 23:32  dstrubbe

	* [r14296] src/basic/io_binary_f_inc.F90: Backport of 14277 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14277 | dstrubbe | 2015-06-17 14:57:21 -0400 (Wed, 17 Jun 2015)
	  | 2 lines
	  
	  Moving call to io_binary_parallel_end to avoid the possibility of
	  trying to close the file twice.
	  
	  ------------------------------------------------------------------------

2015-06-18 23:36  dstrubbe

	* [r14297] src/grid/io_function_inc.F90,
	  testsuite/finite_systems_3d/05-output.test: Backport of 14280 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14280 | dstrubbe | 2015-06-17 17:55:24 -0400 (Wed, 17 Jun 2015)
	  | 4 lines
	  
	  * Bugfix: OutputHow = out_plane did not respect OutputHow =
	  boundary_points.
	  * Fix to error message.
	  * Refrain from outputting some extra blank lines.
	  
	  ------------------------------------------------------------------------
	  Backport of 14281 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14281 | dstrubbe | 2015-06-17 18:25:57 -0400 (Wed, 17 Jun 2015)
	  | 2 lines
	  
	  Fix to last commit: update line numbers for test matches.
	  
	  ------------------------------------------------------------------------

2015-06-23 20:21  dstrubbe

	* [r14342] src/species/ps.F90: Backport of 14284 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14284 | dstrubbe | 2015-06-18 16:23:26 -0400 (Thu, 18 Jun 2015)
	  | 2 lines
	  
	  Better math in variable documentation.
	  
	  ------------------------------------------------------------------------

2015-06-23 20:22  dstrubbe

	* [r14343] src/hamiltonian/hamiltonian_base.F90,
	  src/hamiltonian/hamiltonian_base_inc.F90: Backport of 14298 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14298 | xavier | 2015-06-19 13:51:34 -0400 (Fri, 19 Jun 2015) |
	  3 lines
	  
	  Bugfix: A profiling region was reusing a profiling object.
	  
	  
	  ------------------------------------------------------------------------

2015-06-23 20:24  dstrubbe

	* [r14344] src/grid/partition.F90: Backport of 14300 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14300 | dstrubbe | 2015-06-20 14:44:53 -0400 (Sat, 20 Jun 2015)
	  | 2 lines
	  
	  Further checks on the troublesome partition loading.
	  
	  ------------------------------------------------------------------------

2015-06-23 20:26  dstrubbe

	* [r14345] m4/arch.m4: Backport of 14033 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14033 | dstrubbe | 2015-05-18 17:46:57 -0400 (Mon, 18 May 2015)
	  | 4 lines
	  
	  * Remove unused variable 'assembler'.
	  * Remove unused OCT_ARCH_ variables.
	  * Only set vector_type if that vector operation is actually
	  usable.
	  
	  ------------------------------------------------------------------------

2015-06-23 20:26  dstrubbe

	* [r14346] m4/arch.m4: Backport of 14303 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14303 | dstrubbe | 2015-06-22 11:06:22 -0400 (Mon, 22 Jun 2015)
	  | 2 lines
	  
	  To enable SSE2 instructions, check not only that the compiler
	  accepts the __m128d type but also that a program containing SSE2
	  instructions can be compiled, linked, and run.
	  
	  ------------------------------------------------------------------------

2015-06-23 20:30  dstrubbe

	* [r14347] src/basic/parser.F90, src/system/output_etsf_inc.F90:
	  Backport of 14307 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14307 | dstrubbe | 2015-06-22 12:12:49 -0400 (Mon, 22 Jun 2015)
	  | 2 lines
	  
	  Using 'stderr' instead of unit 0 for warning/error output, to
	  respect the variable 'stderr'.
	  
	  ------------------------------------------------------------------------

2015-06-23 20:32  dstrubbe

	* [r14348] src/grid/io_function.F90, src/grid/io_function_inc.F90:
	  Backport of 13716 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r13716 | dstrubbe | 2015-04-02 20:16:27 -0400 (Thu, 02 Apr 2015)
	  | 2 lines
	  
	  Improvements to OpenSCAD output: you can now set the isovalue,
	  there is a reasonable default, and some more info is written.
	  
	  ------------------------------------------------------------------------

2015-06-23 20:36  dstrubbe

	* [r14349] src/grid/io_function_inc.F90: Fix to previous commit:
	  missing adaptation to 5.0.x.

2015-06-23 20:39  dstrubbe

	* [r14350] src/grid/io_function.F90, src/grid/io_function_inc.F90:
	  Backport of 14311 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14311 | dstrubbe | 2015-06-22 16:23:10 -0400 (Mon, 22 Jun 2015)
	  | 5 lines
	  
	  * Bugfix: OpenSCAD output was incorrect when parallel in domains
	  due to mistaken use of mesh%x instead of mesh_x_global.
	  * Bugfix: same for matlab output.
	  * Comments and caveats about validity of OpenSCAD output.
	  * A function can no longer be pure; it may be possible to make
	  what it calls be pure too so it can be made pure again.
	  
	  ------------------------------------------------------------------------

2015-06-23 20:59  dstrubbe

	* [r14351] src/basic/blacs_proc_grid.F90, src/basic/multicomm.F90:
	  Backport of 14314 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14314 | dstrubbe | 2015-06-22 17:00:54 -0400 (Mon, 22 Jun 2015)
	  | 2 lines
	  
	  Reverting r14140 and r14155. The Fortran interface for
	  MPI_Cart_sub and MPI_Cart_create according to OpenMPI does use a
	  logical not an integer, so without this change it won't compile
	  with --enable-mpi_mod. And, the change did not stop the failures
	  on lascar as I had hoped.
	  
	  ------------------------------------------------------------------------

2015-06-23 21:01  dstrubbe

	* [r14352] src/grid/boundaries.F90: Backport of 14317 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14317 | dstrubbe | 2015-06-22 18:55:48 -0400 (Mon, 22 Jun 2015)
	  | 2 lines
	  
	  Bugfix: memory leak, missing deallocation.
	  
	  ------------------------------------------------------------------------

2015-06-23 21:02  dstrubbe

	* [r14353] m4/fortran.m4: Backport of 14319 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14319 | dstrubbe | 2015-06-22 19:27:10 -0400 (Mon, 22 Jun 2015)
	  | 2 lines
	  
	  cpp from GCC version 5.1.0 produces this error on many of our F90
	  files: "error: C++ style comments are not allowed in ISO C90".
	  Still looking for the proper solution to this, but in the
	  meantime, these changes ensure that the configure script
	  correctly detects that there is a problem before allowing
	  compilation. (Use of -q with grep is just to look nicer, not
	  because there was a problem with /dev/null.)
	  
	  ------------------------------------------------------------------------

2015-06-23 21:02  dstrubbe

	* [r14354] src/grid/grid.F90: Backport of 14321 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14321 | dstrubbe | 2015-06-22 22:36:56 -0400 (Mon, 22 Jun 2015)
	  | 2 lines
	  
	  Bugfix: if Spacing is set to zero, deliberately or accidentally,
	  the calculation may hang rather than give a sensible message.
	  
	  ------------------------------------------------------------------------

2015-06-25 17:00  dstrubbe

	* [r14371] src/main, src/main/Makefile.am, src/utils,
	  src/utils/Makefile.am: Backport of 14333 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14333 | dstrubbe | 2015-06-23 14:43:21 -0400 (Tue, 23 Jun 2015)
	  | 3 lines
	  
	  * gcc5 on MacOS with "-g" creates .dSYM directories of debugging
	  info for each executable. These should be svn:ignore'd and
	  cleaned by 'make clean'.
	  * Also, there is no oct-test_mpi anymore.
	  
	  ------------------------------------------------------------------------

2015-06-25 17:01  dstrubbe

	* [r14372] m4/fortran.m4: Backport of 14336 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14336 | dstrubbe | 2015-06-23 15:01:21 -0400 (Tue, 23 Jun 2015)
	  | 2 lines
	  
	  Make sure warnings and errors from FCPPP tests end up in
	  config.log, which was not necessarily happening.
	  
	  ------------------------------------------------------------------------

2015-06-25 17:02  dstrubbe

	* [r14373] src/system/xc_oep.F90: Backport of 14339 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14339 | dstrubbe | 2015-06-23 15:46:35 -0400 (Tue, 23 Jun 2015)
	  | 3 lines
	  
	  * More info on how to control OEP linear solver.
	  * Better message for not-implemented case.
	  
	  ------------------------------------------------------------------------

2015-06-25 17:10  dstrubbe

	* [r14374] src/grid/io_function.F90, src/grid/io_function_inc.F90:
	  Backport of 14359 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14359 | dstrubbe | 2015-06-24 11:43:42 -0400 (Wed, 24 Jun 2015)
	  | 5 lines
	  
	  * Further clarification in documentation about OutputHow =
	  boundary_points.
	  * Blocking attempts to use it when parallel in domains, which
	  does not work.
	  * If it is used for a field passed which does not contain the
	  boundary points, write a warning.
	  * Do not use it in the test, since it would be blocked for
	  parallel runs.
	  
	  ------------------------------------------------------------------------

2015-06-25 17:13  dstrubbe

	* [r14375] src/system/xc_kli_pauli_inc.F90, src/system/xc_oep.F90,
	  src/system/xc_oep_inc.F90: Backport of 14363 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14363 | dstrubbe | 2015-06-24 15:10:36 -0400 (Wed, 24 Jun 2015)
	  | 4 lines
	  
	  * Bugfix: number of iterations reported from OEP for residual was
	  one too high when not converged.
	  * Bugfix: incorrect variable name in call to
	  messages_input_error.
	  * More information on OEP in variable documentation.
	  
	  ------------------------------------------------------------------------

2015-06-30 09:28  micael

	* [r14395] src/hamiltonian/lasers.F90: Backport of 14392 to
	  branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14392 | micael | 2015-06-30 10:57:50 +0200 (Tue, 30 Jun 2015) |
	  2 lines
	  
	  Write a warning if the phase specified in the TDExternalFields
	  block is not found in the TDFunctions block.
	  
	  ------------------------------------------------------------------------
	  Backport of 14367 to branches/5.0.x:
	  ------------------------------------------------------------------------
	  r14367 | micael | 2015-06-25 12:45:14 +0200 (Thu, 25 Jun 2015) |
	  2 lines
	  
	  Clarified how to specify the phase in the TDExternalFields block
	  documentation.
	  
	  ------------------------------------------------------------------------

2015-07-13 16:35  xavier

	* [r14435] src/grid/mesh_init.F90: Changed the default of
	  MeshPartitionWrite to no, and declared it
	  experimental, to avoid triggering the segmentation fault in the
	  mesh
	  partition reading.

